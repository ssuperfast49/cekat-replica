var pH=Object.defineProperty;var CE=e=>{throw TypeError(e)};var gH=(e,t,n)=>t in e?pH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Kt=(e,t,n)=>gH(e,typeof t!="symbol"?t+"":t,n),X0=(e,t,n)=>t.has(e)||CE("Cannot "+n);var Me=(e,t,n)=>(X0(e,t,"read from private field"),n?n.call(e):t.get(e)),ln=(e,t,n)=>t.has(e)?CE("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),$t=(e,t,n,r)=>(X0(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),Zr=(e,t,n)=>(X0(e,t,"access private method"),n);var vg=(e,t,n,r)=>({set _(s){$t(e,t,s,n)},get _(){return Me(e,t,r)}});function vH(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var mr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function yH(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var n=function r(){return this instanceof r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(r){var s=Object.getOwnPropertyDescriptor(e,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return e[r]}})}),n}var BD={exports:{}},Ux={},zD={exports:{}},Xt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Np=Symbol.for("react.element"),xH=Symbol.for("react.portal"),bH=Symbol.for("react.fragment"),wH=Symbol.for("react.strict_mode"),jH=Symbol.for("react.profiler"),_H=Symbol.for("react.provider"),kH=Symbol.for("react.context"),SH=Symbol.for("react.forward_ref"),NH=Symbol.for("react.suspense"),CH=Symbol.for("react.memo"),AH=Symbol.for("react.lazy"),AE=Symbol.iterator;function EH(e){return e===null||typeof e!="object"?null:(e=AE&&e[AE]||e["@@iterator"],typeof e=="function"?e:null)}var WD={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},qD=Object.assign,HD={};function jh(e,t,n){this.props=e,this.context=t,this.refs=HD,this.updater=n||WD}jh.prototype.isReactComponent={};jh.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};jh.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function KD(){}KD.prototype=jh.prototype;function SS(e,t,n){this.props=e,this.context=t,this.refs=HD,this.updater=n||WD}var NS=SS.prototype=new KD;NS.constructor=SS;qD(NS,jh.prototype);NS.isPureReactComponent=!0;var EE=Array.isArray,VD=Object.prototype.hasOwnProperty,CS={current:null},GD={key:!0,ref:!0,__self:!0,__source:!0};function YD(e,t,n){var r,s={},i=null,o=null;if(t!=null)for(r in t.ref!==void 0&&(o=t.ref),t.key!==void 0&&(i=""+t.key),t)VD.call(t,r)&&!GD.hasOwnProperty(r)&&(s[r]=t[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(e&&e.defaultProps)for(r in l=e.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Np,type:e,key:i,ref:o,props:s,_owner:CS.current}}function TH(e,t){return{$$typeof:Np,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function AS(e){return typeof e=="object"&&e!==null&&e.$$typeof===Np}function PH(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var TE=/\/+/g;function J0(e,t){return typeof e=="object"&&e!==null&&e.key!=null?PH(""+e.key):t.toString(36)}function bv(e,t,n,r,s){var i=typeof e;(i==="undefined"||i==="boolean")&&(e=null);var o=!1;if(e===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case Np:case xH:o=!0}}if(o)return o=e,s=s(o),e=r===""?"."+J0(o,0):r,EE(s)?(n="",e!=null&&(n=e.replace(TE,"$&/")+"/"),bv(s,t,n,"",function(u){return u})):s!=null&&(AS(s)&&(s=TH(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(TE,"$&/")+"/")+e)),t.push(s)),1;if(o=0,r=r===""?".":r+":",EE(e))for(var l=0;l<e.length;l++){i=e[l];var c=r+J0(i,l);o+=bv(i,t,n,c,s)}else if(c=EH(e),typeof c=="function")for(e=c.call(e),l=0;!(i=e.next()).done;)i=i.value,c=r+J0(i,l++),o+=bv(i,t,n,c,s);else if(i==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function yg(e,t,n){if(e==null)return e;var r=[],s=0;return bv(e,r,"","",function(i){return t.call(n,i,s++)}),r}function OH(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var ka={current:null},wv={transition:null},IH={ReactCurrentDispatcher:ka,ReactCurrentBatchConfig:wv,ReactCurrentOwner:CS};function XD(){throw Error("act(...) is not supported in production builds of React.")}Xt.Children={map:yg,forEach:function(e,t,n){yg(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return yg(e,function(){t++}),t},toArray:function(e){return yg(e,function(t){return t})||[]},only:function(e){if(!AS(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Xt.Component=jh;Xt.Fragment=bH;Xt.Profiler=jH;Xt.PureComponent=SS;Xt.StrictMode=wH;Xt.Suspense=NH;Xt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=IH;Xt.act=XD;Xt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=qD({},e.props),s=e.key,i=e.ref,o=e._owner;if(t!=null){if(t.ref!==void 0&&(i=t.ref,o=CS.current),t.key!==void 0&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(c in t)VD.call(t,c)&&!GD.hasOwnProperty(c)&&(r[c]=t[c]===void 0&&l!==void 0?l[c]:t[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:Np,type:e.type,key:s,ref:i,props:r,_owner:o}};Xt.createContext=function(e){return e={$$typeof:kH,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:_H,_context:e},e.Consumer=e};Xt.createElement=YD;Xt.createFactory=function(e){var t=YD.bind(null,e);return t.type=e,t};Xt.createRef=function(){return{current:null}};Xt.forwardRef=function(e){return{$$typeof:SH,render:e}};Xt.isValidElement=AS;Xt.lazy=function(e){return{$$typeof:AH,_payload:{_status:-1,_result:e},_init:OH}};Xt.memo=function(e,t){return{$$typeof:CH,type:e,compare:t===void 0?null:t}};Xt.startTransition=function(e){var t=wv.transition;wv.transition={};try{e()}finally{wv.transition=t}};Xt.unstable_act=XD;Xt.useCallback=function(e,t){return ka.current.useCallback(e,t)};Xt.useContext=function(e){return ka.current.useContext(e)};Xt.useDebugValue=function(){};Xt.useDeferredValue=function(e){return ka.current.useDeferredValue(e)};Xt.useEffect=function(e,t){return ka.current.useEffect(e,t)};Xt.useId=function(){return ka.current.useId()};Xt.useImperativeHandle=function(e,t,n){return ka.current.useImperativeHandle(e,t,n)};Xt.useInsertionEffect=function(e,t){return ka.current.useInsertionEffect(e,t)};Xt.useLayoutEffect=function(e,t){return ka.current.useLayoutEffect(e,t)};Xt.useMemo=function(e,t){return ka.current.useMemo(e,t)};Xt.useReducer=function(e,t,n){return ka.current.useReducer(e,t,n)};Xt.useRef=function(e){return ka.current.useRef(e)};Xt.useState=function(e){return ka.current.useState(e)};Xt.useSyncExternalStore=function(e,t,n){return ka.current.useSyncExternalStore(e,t,n)};Xt.useTransition=function(){return ka.current.useTransition()};Xt.version="18.3.1";zD.exports=Xt;var p=zD.exports;const G=bn(p),ES=vH({__proto__:null,default:G},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RH=p,MH=Symbol.for("react.element"),DH=Symbol.for("react.fragment"),LH=Object.prototype.hasOwnProperty,$H=RH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,FH={key:!0,ref:!0,__self:!0,__source:!0};function JD(e,t,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),t.key!==void 0&&(i=""+t.key),t.ref!==void 0&&(o=t.ref);for(r in t)LH.call(t,r)&&!FH.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)s[r]===void 0&&(s[r]=t[r]);return{$$typeof:MH,type:e,key:i,ref:o,props:s,_owner:$H.current}}Ux.Fragment=DH;Ux.jsx=JD;Ux.jsxs=JD;BD.exports=Ux;var a=BD.exports,QD={exports:{}},ds={},ZD={exports:{}},eL={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(C,D){var E=C.length;C.push(D);e:for(;0<E;){var F=E-1>>>1,I=C[F];if(0<s(I,D))C[F]=D,C[E]=I,E=F;else break e}}function n(C){return C.length===0?null:C[0]}function r(C){if(C.length===0)return null;var D=C[0],E=C.pop();if(E!==D){C[0]=E;e:for(var F=0,I=C.length,P=I>>>1;F<P;){var U=2*(F+1)-1,Z=C[U],X=U+1,K=C[X];if(0>s(Z,E))X<I&&0>s(K,Z)?(C[F]=K,C[X]=E,F=X):(C[F]=Z,C[U]=E,F=U);else if(X<I&&0>s(K,E))C[F]=K,C[X]=E,F=X;else break e}}return D}function s(C,D){var E=C.sortIndex-D.sortIndex;return E!==0?E:C.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();e.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,g=!1,v=!1,y=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,w=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(C){for(var D=n(u);D!==null;){if(D.callback===null)r(u);else if(D.startTime<=C)r(u),D.sortIndex=D.expirationTime,t(c,D);else break;D=n(u)}}function _(C){if(v=!1,b(C),!g)if(n(c)!==null)g=!0,z(k);else{var D=n(u);D!==null&&R(_,D.startTime-C)}}function k(C,D){g=!1,v&&(v=!1,x(T),T=-1),m=!0;var E=f;try{for(b(D),h=n(c);h!==null&&(!(h.expirationTime>D)||C&&!N());){var F=h.callback;if(typeof F=="function"){h.callback=null,f=h.priorityLevel;var I=F(h.expirationTime<=D);D=e.unstable_now(),typeof I=="function"?h.callback=I:h===n(c)&&r(c),b(D)}else r(c);h=n(c)}if(h!==null)var P=!0;else{var U=n(u);U!==null&&R(_,U.startTime-D),P=!1}return P}finally{h=null,f=E,m=!1}}var j=!1,S=null,T=-1,O=5,A=-1;function N(){return!(e.unstable_now()-A<O)}function L(){if(S!==null){var C=e.unstable_now();A=C;var D=!0;try{D=S(!0,C)}finally{D?M():(j=!1,S=null)}}else j=!1}var M;if(typeof w=="function")M=function(){w(L)};else if(typeof MessageChannel<"u"){var B=new MessageChannel,$=B.port2;B.port1.onmessage=L,M=function(){$.postMessage(null)}}else M=function(){y(L,0)};function z(C){S=C,j||(j=!0,M())}function R(C,D){T=y(function(){C(e.unstable_now())},D)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(C){C.callback=null},e.unstable_continueExecution=function(){g||m||(g=!0,z(k))},e.unstable_forceFrameRate=function(C){0>C||125<C?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<C?Math.floor(1e3/C):5},e.unstable_getCurrentPriorityLevel=function(){return f},e.unstable_getFirstCallbackNode=function(){return n(c)},e.unstable_next=function(C){switch(f){case 1:case 2:case 3:var D=3;break;default:D=f}var E=f;f=D;try{return C()}finally{f=E}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(C,D){switch(C){case 1:case 2:case 3:case 4:case 5:break;default:C=3}var E=f;f=C;try{return D()}finally{f=E}},e.unstable_scheduleCallback=function(C,D,E){var F=e.unstable_now();switch(typeof E=="object"&&E!==null?(E=E.delay,E=typeof E=="number"&&0<E?F+E:F):E=F,C){case 1:var I=-1;break;case 2:I=250;break;case 5:I=1073741823;break;case 4:I=1e4;break;default:I=5e3}return I=E+I,C={id:d++,callback:D,priorityLevel:C,startTime:E,expirationTime:I,sortIndex:-1},E>F?(C.sortIndex=E,t(u,C),n(c)===null&&C===n(u)&&(v?(x(T),T=-1):v=!0,R(_,E-F))):(C.sortIndex=I,t(c,C),g||m||(g=!0,z(k))),C},e.unstable_shouldYield=N,e.unstable_wrapCallback=function(C){var D=f;return function(){var E=f;f=D;try{return C.apply(this,arguments)}finally{f=E}}}})(eL);ZD.exports=eL;var UH=ZD.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BH=p,us=UH;function Ge(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var tL=new Set,nm={};function ou(e,t){Md(e,t),Md(e+"Capture",t)}function Md(e,t){for(nm[e]=t,e=0;e<t.length;e++)tL.add(t[e])}var So=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),a_=Object.prototype.hasOwnProperty,zH=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,PE={},OE={};function WH(e){return a_.call(OE,e)?!0:a_.call(PE,e)?!1:zH.test(e)?OE[e]=!0:(PE[e]=!0,!1)}function qH(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function HH(e,t,n,r){if(t===null||typeof t>"u"||qH(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Sa(e,t,n,r,s,i,o){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=i,this.removeEmptyString=o}var Gr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Gr[e]=new Sa(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Gr[t]=new Sa(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Gr[e]=new Sa(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Gr[e]=new Sa(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Gr[e]=new Sa(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Gr[e]=new Sa(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Gr[e]=new Sa(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Gr[e]=new Sa(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Gr[e]=new Sa(e,5,!1,e.toLowerCase(),null,!1,!1)});var TS=/[\-:]([a-z])/g;function PS(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(TS,PS);Gr[t]=new Sa(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(TS,PS);Gr[t]=new Sa(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(TS,PS);Gr[t]=new Sa(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Gr[e]=new Sa(e,1,!1,e.toLowerCase(),null,!1,!1)});Gr.xlinkHref=new Sa("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Gr[e]=new Sa(e,1,!1,e.toLowerCase(),null,!0,!0)});function OS(e,t,n,r){var s=Gr.hasOwnProperty(t)?Gr[t]:null;(s!==null?s.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(HH(t,n,s,r)&&(n=null),r||s===null?WH(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):s.mustUseProperty?e[s.propertyName]=n===null?s.type===3?!1:"":n:(t=s.attributeName,r=s.attributeNamespace,n===null?e.removeAttribute(t):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Lo=BH.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xg=Symbol.for("react.element"),Gu=Symbol.for("react.portal"),Yu=Symbol.for("react.fragment"),IS=Symbol.for("react.strict_mode"),s_=Symbol.for("react.profiler"),nL=Symbol.for("react.provider"),rL=Symbol.for("react.context"),RS=Symbol.for("react.forward_ref"),i_=Symbol.for("react.suspense"),o_=Symbol.for("react.suspense_list"),MS=Symbol.for("react.memo"),al=Symbol.for("react.lazy"),aL=Symbol.for("react.offscreen"),IE=Symbol.iterator;function Xh(e){return e===null||typeof e!="object"?null:(e=IE&&e[IE]||e["@@iterator"],typeof e=="function"?e:null)}var Jn=Object.assign,Q0;function Sf(e){if(Q0===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);Q0=t&&t[1]||""}return`
`+Q0+e}var Z0=!1;function ew(e,t){if(!e||Z0)return"";Z0=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return e.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",e.displayName)),c}while(1<=o&&0<=l);break}}}finally{Z0=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?Sf(e):""}function KH(e){switch(e.tag){case 5:return Sf(e.type);case 16:return Sf("Lazy");case 13:return Sf("Suspense");case 19:return Sf("SuspenseList");case 0:case 2:case 15:return e=ew(e.type,!1),e;case 11:return e=ew(e.type.render,!1),e;case 1:return e=ew(e.type,!0),e;default:return""}}function l_(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Yu:return"Fragment";case Gu:return"Portal";case s_:return"Profiler";case IS:return"StrictMode";case i_:return"Suspense";case o_:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case rL:return(e.displayName||"Context")+".Consumer";case nL:return(e._context.displayName||"Context")+".Provider";case RS:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case MS:return t=e.displayName||null,t!==null?t:l_(e.type)||"Memo";case al:t=e._payload,e=e._init;try{return l_(e(t))}catch{}}return null}function VH(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return l_(t);case 8:return t===IS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Rl(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function sL(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function GH(e){var t=sL(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function bg(e){e._valueTracker||(e._valueTracker=GH(e))}function iL(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=sL(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function Vv(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function c_(e,t){var n=t.checked;return Jn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function RE(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Rl(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function oL(e,t){t=t.checked,t!=null&&OS(e,"checked",t,!1)}function u_(e,t){oL(e,t);var n=Rl(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?d_(e,t.type,n):t.hasOwnProperty("defaultValue")&&d_(e,t.type,Rl(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function ME(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function d_(e,t,n){(t!=="number"||Vv(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var Nf=Array.isArray;function ud(e,t,n,r){if(e=e.options,t){t={};for(var s=0;s<n.length;s++)t["$"+n[s]]=!0;for(n=0;n<e.length;n++)s=t.hasOwnProperty("$"+e[n].value),e[n].selected!==s&&(e[n].selected=s),s&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Rl(n),t=null,s=0;s<e.length;s++){if(e[s].value===n){e[s].selected=!0,r&&(e[s].defaultSelected=!0);return}t!==null||e[s].disabled||(t=e[s])}t!==null&&(t.selected=!0)}}function h_(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(Ge(91));return Jn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function DE(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(Ge(92));if(Nf(n)){if(1<n.length)throw Error(Ge(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Rl(n)}}function lL(e,t){var n=Rl(t.value),r=Rl(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function LE(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function cL(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function f_(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?cL(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var wg,uL=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,s){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,s)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(wg=wg||document.createElement("div"),wg.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=wg.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function rm(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var Rf={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},YH=["Webkit","ms","Moz","O"];Object.keys(Rf).forEach(function(e){YH.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Rf[t]=Rf[e]})});function dL(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||Rf.hasOwnProperty(e)&&Rf[e]?(""+t).trim():t+"px"}function hL(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=dL(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,s):e[n]=s}}var XH=Jn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function m_(e,t){if(t){if(XH[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(Ge(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(Ge(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(Ge(61))}if(t.style!=null&&typeof t.style!="object")throw Error(Ge(62))}}function p_(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var g_=null;function DS(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var v_=null,dd=null,hd=null;function $E(e){if(e=Ep(e)){if(typeof v_!="function")throw Error(Ge(280));var t=e.stateNode;t&&(t=Hx(t),v_(e.stateNode,e.type,t))}}function fL(e){dd?hd?hd.push(e):hd=[e]:dd=e}function mL(){if(dd){var e=dd,t=hd;if(hd=dd=null,$E(e),t)for(e=0;e<t.length;e++)$E(t[e])}}function pL(e,t){return e(t)}function gL(){}var tw=!1;function vL(e,t,n){if(tw)return e(t,n);tw=!0;try{return pL(e,t,n)}finally{tw=!1,(dd!==null||hd!==null)&&(gL(),mL())}}function am(e,t){var n=e.stateNode;if(n===null)return null;var r=Hx(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(Ge(231,t,typeof n));return n}var y_=!1;if(So)try{var Jh={};Object.defineProperty(Jh,"passive",{get:function(){y_=!0}}),window.addEventListener("test",Jh,Jh),window.removeEventListener("test",Jh,Jh)}catch{y_=!1}function JH(e,t,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(d){this.onError(d)}}var Mf=!1,Gv=null,Yv=!1,x_=null,QH={onError:function(e){Mf=!0,Gv=e}};function ZH(e,t,n,r,s,i,o,l,c){Mf=!1,Gv=null,JH.apply(QH,arguments)}function e7(e,t,n,r,s,i,o,l,c){if(ZH.apply(this,arguments),Mf){if(Mf){var u=Gv;Mf=!1,Gv=null}else throw Error(Ge(198));Yv||(Yv=!0,x_=u)}}function lu(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function yL(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function FE(e){if(lu(e)!==e)throw Error(Ge(188))}function t7(e){var t=e.alternate;if(!t){if(t=lu(e),t===null)throw Error(Ge(188));return t!==e?null:e}for(var n=e,r=t;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return FE(s),e;if(i===r)return FE(s),t;i=i.sibling}throw Error(Ge(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(Ge(189))}}if(n.alternate!==r)throw Error(Ge(190))}if(n.tag!==3)throw Error(Ge(188));return n.stateNode.current===n?e:t}function xL(e){return e=t7(e),e!==null?bL(e):null}function bL(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=bL(e);if(t!==null)return t;e=e.sibling}return null}var wL=us.unstable_scheduleCallback,UE=us.unstable_cancelCallback,n7=us.unstable_shouldYield,r7=us.unstable_requestPaint,lr=us.unstable_now,a7=us.unstable_getCurrentPriorityLevel,LS=us.unstable_ImmediatePriority,jL=us.unstable_UserBlockingPriority,Xv=us.unstable_NormalPriority,s7=us.unstable_LowPriority,_L=us.unstable_IdlePriority,Bx=null,Li=null;function i7(e){if(Li&&typeof Li.onCommitFiberRoot=="function")try{Li.onCommitFiberRoot(Bx,e,void 0,(e.current.flags&128)===128)}catch{}}var si=Math.clz32?Math.clz32:c7,o7=Math.log,l7=Math.LN2;function c7(e){return e>>>=0,e===0?32:31-(o7(e)/l7|0)|0}var jg=64,_g=4194304;function Cf(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Jv(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,s=e.suspendedLanes,i=e.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Cf(l):(i&=o,i!==0&&(r=Cf(i)))}else o=n&~s,o!==0?r=Cf(o):i!==0&&(r=Cf(i));if(r===0)return 0;if(t!==0&&t!==r&&!(t&s)&&(s=r&-r,i=t&-t,s>=i||s===16&&(i&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-si(t),s=1<<n,r|=e[n],t&=~s;return r}function u7(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function d7(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,s=e.expirationTimes,i=e.pendingLanes;0<i;){var o=31-si(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=u7(l,t)):c<=t&&(e.expiredLanes|=l),i&=~l}}function b_(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function kL(){var e=jg;return jg<<=1,!(jg&4194240)&&(jg=64),e}function nw(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Cp(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-si(t),e[t]=n}function h7(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var s=31-si(n),i=1<<s;t[s]=0,r[s]=-1,e[s]=-1,n&=~i}}function $S(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-si(n),s=1<<r;s&t|e[r]&t&&(e[r]|=t),n&=~s}}var jn=0;function SL(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var NL,FS,CL,AL,EL,w_=!1,kg=[],jl=null,_l=null,kl=null,sm=new Map,im=new Map,ol=[],f7="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function BE(e,t){switch(e){case"focusin":case"focusout":jl=null;break;case"dragenter":case"dragleave":_l=null;break;case"mouseover":case"mouseout":kl=null;break;case"pointerover":case"pointerout":sm.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":im.delete(t.pointerId)}}function Qh(e,t,n,r,s,i){return e===null||e.nativeEvent!==i?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},t!==null&&(t=Ep(t),t!==null&&FS(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,s!==null&&t.indexOf(s)===-1&&t.push(s),e)}function m7(e,t,n,r,s){switch(t){case"focusin":return jl=Qh(jl,e,t,n,r,s),!0;case"dragenter":return _l=Qh(_l,e,t,n,r,s),!0;case"mouseover":return kl=Qh(kl,e,t,n,r,s),!0;case"pointerover":var i=s.pointerId;return sm.set(i,Qh(sm.get(i)||null,e,t,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,im.set(i,Qh(im.get(i)||null,e,t,n,r,s)),!0}return!1}function TL(e){var t=jc(e.target);if(t!==null){var n=lu(t);if(n!==null){if(t=n.tag,t===13){if(t=yL(n),t!==null){e.blockedOn=t,EL(e.priority,function(){CL(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function jv(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=j_(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);g_=r,n.target.dispatchEvent(r),g_=null}else return t=Ep(n),t!==null&&FS(t),e.blockedOn=n,!1;t.shift()}return!0}function zE(e,t,n){jv(e)&&n.delete(t)}function p7(){w_=!1,jl!==null&&jv(jl)&&(jl=null),_l!==null&&jv(_l)&&(_l=null),kl!==null&&jv(kl)&&(kl=null),sm.forEach(zE),im.forEach(zE)}function Zh(e,t){e.blockedOn===t&&(e.blockedOn=null,w_||(w_=!0,us.unstable_scheduleCallback(us.unstable_NormalPriority,p7)))}function om(e){function t(s){return Zh(s,e)}if(0<kg.length){Zh(kg[0],e);for(var n=1;n<kg.length;n++){var r=kg[n];r.blockedOn===e&&(r.blockedOn=null)}}for(jl!==null&&Zh(jl,e),_l!==null&&Zh(_l,e),kl!==null&&Zh(kl,e),sm.forEach(t),im.forEach(t),n=0;n<ol.length;n++)r=ol[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<ol.length&&(n=ol[0],n.blockedOn===null);)TL(n),n.blockedOn===null&&ol.shift()}var fd=Lo.ReactCurrentBatchConfig,Qv=!0;function g7(e,t,n,r){var s=jn,i=fd.transition;fd.transition=null;try{jn=1,US(e,t,n,r)}finally{jn=s,fd.transition=i}}function v7(e,t,n,r){var s=jn,i=fd.transition;fd.transition=null;try{jn=4,US(e,t,n,r)}finally{jn=s,fd.transition=i}}function US(e,t,n,r){if(Qv){var s=j_(e,t,n,r);if(s===null)hw(e,t,r,Zv,n),BE(e,r);else if(m7(s,e,t,n,r))r.stopPropagation();else if(BE(e,r),t&4&&-1<f7.indexOf(e)){for(;s!==null;){var i=Ep(s);if(i!==null&&NL(i),i=j_(e,t,n,r),i===null&&hw(e,t,r,Zv,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else hw(e,t,r,null,n)}}var Zv=null;function j_(e,t,n,r){if(Zv=null,e=DS(r),e=jc(e),e!==null)if(t=lu(e),t===null)e=null;else if(n=t.tag,n===13){if(e=yL(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Zv=e,null}function PL(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(a7()){case LS:return 1;case jL:return 4;case Xv:case s7:return 16;case _L:return 536870912;default:return 16}default:return 16}}var yl=null,BS=null,_v=null;function OL(){if(_v)return _v;var e,t=BS,n=t.length,r,s="value"in yl?yl.value:yl.textContent,i=s.length;for(e=0;e<n&&t[e]===s[e];e++);var o=n-e;for(r=1;r<=o&&t[n-r]===s[i-r];r++);return _v=s.slice(e,1<r?1-r:void 0)}function kv(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Sg(){return!0}function WE(){return!1}function hs(e){function t(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in e)e.hasOwnProperty(l)&&(n=e[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Sg:WE,this.isPropagationStopped=WE,this}return Jn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Sg)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Sg)},persist:function(){},isPersistent:Sg}),t}var _h={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zS=hs(_h),Ap=Jn({},_h,{view:0,detail:0}),y7=hs(Ap),rw,aw,ef,zx=Jn({},Ap,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:WS,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ef&&(ef&&e.type==="mousemove"?(rw=e.screenX-ef.screenX,aw=e.screenY-ef.screenY):aw=rw=0,ef=e),rw)},movementY:function(e){return"movementY"in e?e.movementY:aw}}),qE=hs(zx),x7=Jn({},zx,{dataTransfer:0}),b7=hs(x7),w7=Jn({},Ap,{relatedTarget:0}),sw=hs(w7),j7=Jn({},_h,{animationName:0,elapsedTime:0,pseudoElement:0}),_7=hs(j7),k7=Jn({},_h,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),S7=hs(k7),N7=Jn({},_h,{data:0}),HE=hs(N7),C7={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},A7={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},E7={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function T7(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=E7[e])?!!t[e]:!1}function WS(){return T7}var P7=Jn({},Ap,{key:function(e){if(e.key){var t=C7[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=kv(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?A7[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:WS,charCode:function(e){return e.type==="keypress"?kv(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?kv(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),O7=hs(P7),I7=Jn({},zx,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),KE=hs(I7),R7=Jn({},Ap,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:WS}),M7=hs(R7),D7=Jn({},_h,{propertyName:0,elapsedTime:0,pseudoElement:0}),L7=hs(D7),$7=Jn({},zx,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),F7=hs($7),U7=[9,13,27,32],qS=So&&"CompositionEvent"in window,Df=null;So&&"documentMode"in document&&(Df=document.documentMode);var B7=So&&"TextEvent"in window&&!Df,IL=So&&(!qS||Df&&8<Df&&11>=Df),VE=" ",GE=!1;function RL(e,t){switch(e){case"keyup":return U7.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ML(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Xu=!1;function z7(e,t){switch(e){case"compositionend":return ML(t);case"keypress":return t.which!==32?null:(GE=!0,VE);case"textInput":return e=t.data,e===VE&&GE?null:e;default:return null}}function W7(e,t){if(Xu)return e==="compositionend"||!qS&&RL(e,t)?(e=OL(),_v=BS=yl=null,Xu=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return IL&&t.locale!=="ko"?null:t.data;default:return null}}var q7={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function YE(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!q7[e.type]:t==="textarea"}function DL(e,t,n,r){fL(r),t=ey(t,"onChange"),0<t.length&&(n=new zS("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Lf=null,lm=null;function H7(e){VL(e,0)}function Wx(e){var t=Zu(e);if(iL(t))return e}function K7(e,t){if(e==="change")return t}var LL=!1;if(So){var iw;if(So){var ow="oninput"in document;if(!ow){var XE=document.createElement("div");XE.setAttribute("oninput","return;"),ow=typeof XE.oninput=="function"}iw=ow}else iw=!1;LL=iw&&(!document.documentMode||9<document.documentMode)}function JE(){Lf&&(Lf.detachEvent("onpropertychange",$L),lm=Lf=null)}function $L(e){if(e.propertyName==="value"&&Wx(lm)){var t=[];DL(t,lm,e,DS(e)),vL(H7,t)}}function V7(e,t,n){e==="focusin"?(JE(),Lf=t,lm=n,Lf.attachEvent("onpropertychange",$L)):e==="focusout"&&JE()}function G7(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Wx(lm)}function Y7(e,t){if(e==="click")return Wx(t)}function X7(e,t){if(e==="input"||e==="change")return Wx(t)}function J7(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ui=typeof Object.is=="function"?Object.is:J7;function cm(e,t){if(ui(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!a_.call(t,s)||!ui(e[s],t[s]))return!1}return!0}function QE(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ZE(e,t){var n=QE(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=QE(n)}}function FL(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?FL(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function UL(){for(var e=window,t=Vv();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=Vv(e.document)}return t}function HS(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function Q7(e){var t=UL(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&FL(n.ownerDocument.documentElement,n)){if(r!==null&&HS(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!e.extend&&i>r&&(s=r,r=i,i=s),s=ZE(n,i);var o=ZE(n,r);s&&o&&(e.rangeCount!==1||e.anchorNode!==s.node||e.anchorOffset!==s.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&(t=t.createRange(),t.setStart(s.node,s.offset),e.removeAllRanges(),i>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Z7=So&&"documentMode"in document&&11>=document.documentMode,Ju=null,__=null,$f=null,k_=!1;function eT(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;k_||Ju==null||Ju!==Vv(r)||(r=Ju,"selectionStart"in r&&HS(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),$f&&cm($f,r)||($f=r,r=ey(__,"onSelect"),0<r.length&&(t=new zS("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=Ju)))}function Ng(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Qu={animationend:Ng("Animation","AnimationEnd"),animationiteration:Ng("Animation","AnimationIteration"),animationstart:Ng("Animation","AnimationStart"),transitionend:Ng("Transition","TransitionEnd")},lw={},BL={};So&&(BL=document.createElement("div").style,"AnimationEvent"in window||(delete Qu.animationend.animation,delete Qu.animationiteration.animation,delete Qu.animationstart.animation),"TransitionEvent"in window||delete Qu.transitionend.transition);function qx(e){if(lw[e])return lw[e];if(!Qu[e])return e;var t=Qu[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in BL)return lw[e]=t[n];return e}var zL=qx("animationend"),WL=qx("animationiteration"),qL=qx("animationstart"),HL=qx("transitionend"),KL=new Map,tT="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Wl(e,t){KL.set(e,t),ou(t,[e])}for(var cw=0;cw<tT.length;cw++){var uw=tT[cw],eK=uw.toLowerCase(),tK=uw[0].toUpperCase()+uw.slice(1);Wl(eK,"on"+tK)}Wl(zL,"onAnimationEnd");Wl(WL,"onAnimationIteration");Wl(qL,"onAnimationStart");Wl("dblclick","onDoubleClick");Wl("focusin","onFocus");Wl("focusout","onBlur");Wl(HL,"onTransitionEnd");Md("onMouseEnter",["mouseout","mouseover"]);Md("onMouseLeave",["mouseout","mouseover"]);Md("onPointerEnter",["pointerout","pointerover"]);Md("onPointerLeave",["pointerout","pointerover"]);ou("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ou("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ou("onBeforeInput",["compositionend","keypress","textInput","paste"]);ou("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ou("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ou("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Af="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nK=new Set("cancel close invalid load scroll toggle".split(" ").concat(Af));function nT(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,e7(r,t,void 0,e),e.currentTarget=null}function VL(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],s=r.event;r=r.listeners;e:{var i=void 0;if(t)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;nT(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;nT(s,l,u),i=c}}}if(Yv)throw e=x_,Yv=!1,x_=null,e}function Un(e,t){var n=t[E_];n===void 0&&(n=t[E_]=new Set);var r=e+"__bubble";n.has(r)||(GL(t,e,2,!1),n.add(r))}function dw(e,t,n){var r=0;t&&(r|=4),GL(n,e,r,t)}var Cg="_reactListening"+Math.random().toString(36).slice(2);function um(e){if(!e[Cg]){e[Cg]=!0,tL.forEach(function(n){n!=="selectionchange"&&(nK.has(n)||dw(n,!1,e),dw(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Cg]||(t[Cg]=!0,dw("selectionchange",!1,t))}}function GL(e,t,n,r){switch(PL(t)){case 1:var s=g7;break;case 4:s=v7;break;default:s=US}n=s.bind(null,t,n,e),s=void 0,!y_||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(s=!0),r?s!==void 0?e.addEventListener(t,n,{capture:!0,passive:s}):e.addEventListener(t,n,!0):s!==void 0?e.addEventListener(t,n,{passive:s}):e.addEventListener(t,n,!1)}function hw(e,t,n,r,s){var i=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=jc(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}vL(function(){var u=i,d=DS(n),h=[];e:{var f=KL.get(e);if(f!==void 0){var m=zS,g=e;switch(e){case"keypress":if(kv(n)===0)break e;case"keydown":case"keyup":m=O7;break;case"focusin":g="focus",m=sw;break;case"focusout":g="blur",m=sw;break;case"beforeblur":case"afterblur":m=sw;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=qE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=b7;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=M7;break;case zL:case WL:case qL:m=_7;break;case HL:m=L7;break;case"scroll":m=y7;break;case"wheel":m=F7;break;case"copy":case"cut":case"paste":m=S7;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=KE}var v=(t&4)!==0,y=!v&&e==="scroll",x=v?f!==null?f+"Capture":null:f;v=[];for(var w=u,b;w!==null;){b=w;var _=b.stateNode;if(b.tag===5&&_!==null&&(b=_,x!==null&&(_=am(w,x),_!=null&&v.push(dm(w,_,b)))),y)break;w=w.return}0<v.length&&(f=new m(f,g,null,n,d),h.push({event:f,listeners:v}))}}if(!(t&7)){e:{if(f=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",f&&n!==g_&&(g=n.relatedTarget||n.fromElement)&&(jc(g)||g[No]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=u,g=g?jc(g):null,g!==null&&(y=lu(g),g!==y||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(v=qE,_="onMouseLeave",x="onMouseEnter",w="mouse",(e==="pointerout"||e==="pointerover")&&(v=KE,_="onPointerLeave",x="onPointerEnter",w="pointer"),y=m==null?f:Zu(m),b=g==null?f:Zu(g),f=new v(_,w+"leave",m,n,d),f.target=y,f.relatedTarget=b,_=null,jc(d)===u&&(v=new v(x,w+"enter",g,n,d),v.target=b,v.relatedTarget=y,_=v),y=_,m&&g)t:{for(v=m,x=g,w=0,b=v;b;b=ku(b))w++;for(b=0,_=x;_;_=ku(_))b++;for(;0<w-b;)v=ku(v),w--;for(;0<b-w;)x=ku(x),b--;for(;w--;){if(v===x||x!==null&&v===x.alternate)break t;v=ku(v),x=ku(x)}v=null}else v=null;m!==null&&rT(h,f,m,v,!1),g!==null&&y!==null&&rT(h,y,g,v,!0)}}e:{if(f=u?Zu(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var k=K7;else if(YE(f))if(LL)k=X7;else{k=G7;var j=V7}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(k=Y7);if(k&&(k=k(e,u))){DL(h,k,n,d);break e}j&&j(e,f,u),e==="focusout"&&(j=f._wrapperState)&&j.controlled&&f.type==="number"&&d_(f,"number",f.value)}switch(j=u?Zu(u):window,e){case"focusin":(YE(j)||j.contentEditable==="true")&&(Ju=j,__=u,$f=null);break;case"focusout":$f=__=Ju=null;break;case"mousedown":k_=!0;break;case"contextmenu":case"mouseup":case"dragend":k_=!1,eT(h,n,d);break;case"selectionchange":if(Z7)break;case"keydown":case"keyup":eT(h,n,d)}var S;if(qS)e:{switch(e){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else Xu?RL(e,n)&&(T="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(IL&&n.locale!=="ko"&&(Xu||T!=="onCompositionStart"?T==="onCompositionEnd"&&Xu&&(S=OL()):(yl=d,BS="value"in yl?yl.value:yl.textContent,Xu=!0)),j=ey(u,T),0<j.length&&(T=new HE(T,e,null,n,d),h.push({event:T,listeners:j}),S?T.data=S:(S=ML(n),S!==null&&(T.data=S)))),(S=B7?z7(e,n):W7(e,n))&&(u=ey(u,"onBeforeInput"),0<u.length&&(d=new HE("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=S))}VL(h,t)})}function dm(e,t,n){return{instance:e,listener:t,currentTarget:n}}function ey(e,t){for(var n=t+"Capture",r=[];e!==null;){var s=e,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=am(e,n),i!=null&&r.unshift(dm(e,i,s)),i=am(e,t),i!=null&&r.push(dm(e,i,s))),e=e.return}return r}function ku(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function rT(e,t,n,r,s){for(var i=t._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=am(n,i),c!=null&&o.unshift(dm(n,c,l))):s||(c=am(n,i),c!=null&&o.push(dm(n,c,l)))),n=n.return}o.length!==0&&e.push({event:t,listeners:o})}var rK=/\r\n?/g,aK=/\u0000|\uFFFD/g;function aT(e){return(typeof e=="string"?e:""+e).replace(rK,`
`).replace(aK,"")}function Ag(e,t,n){if(t=aT(t),aT(e)!==t&&n)throw Error(Ge(425))}function ty(){}var S_=null,N_=null;function C_(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var A_=typeof setTimeout=="function"?setTimeout:void 0,sK=typeof clearTimeout=="function"?clearTimeout:void 0,sT=typeof Promise=="function"?Promise:void 0,iK=typeof queueMicrotask=="function"?queueMicrotask:typeof sT<"u"?function(e){return sT.resolve(null).then(e).catch(oK)}:A_;function oK(e){setTimeout(function(){throw e})}function fw(e,t){var n=t,r=0;do{var s=n.nextSibling;if(e.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){e.removeChild(s),om(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);om(t)}function Sl(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function iT(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var kh=Math.random().toString(36).slice(2),Ci="__reactFiber$"+kh,hm="__reactProps$"+kh,No="__reactContainer$"+kh,E_="__reactEvents$"+kh,lK="__reactListeners$"+kh,cK="__reactHandles$"+kh;function jc(e){var t=e[Ci];if(t)return t;for(var n=e.parentNode;n;){if(t=n[No]||n[Ci]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=iT(e);e!==null;){if(n=e[Ci])return n;e=iT(e)}return t}e=n,n=e.parentNode}return null}function Ep(e){return e=e[Ci]||e[No],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function Zu(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(Ge(33))}function Hx(e){return e[hm]||null}var T_=[],ed=-1;function ql(e){return{current:e}}function Wn(e){0>ed||(e.current=T_[ed],T_[ed]=null,ed--)}function Mn(e,t){ed++,T_[ed]=e.current,e.current=t}var Ml={},la=ql(Ml),Ba=ql(!1),Uc=Ml;function Dd(e,t){var n=e.type.contextTypes;if(!n)return Ml;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=t[i];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function za(e){return e=e.childContextTypes,e!=null}function ny(){Wn(Ba),Wn(la)}function oT(e,t,n){if(la.current!==Ml)throw Error(Ge(168));Mn(la,t),Mn(Ba,n)}function YL(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in t))throw Error(Ge(108,VH(e)||"Unknown",s));return Jn({},n,r)}function ry(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ml,Uc=la.current,Mn(la,e),Mn(Ba,Ba.current),!0}function lT(e,t,n){var r=e.stateNode;if(!r)throw Error(Ge(169));n?(e=YL(e,t,Uc),r.__reactInternalMemoizedMergedChildContext=e,Wn(Ba),Wn(la),Mn(la,e)):Wn(Ba),Mn(Ba,n)}var io=null,Kx=!1,mw=!1;function XL(e){io===null?io=[e]:io.push(e)}function uK(e){Kx=!0,XL(e)}function Hl(){if(!mw&&io!==null){mw=!0;var e=0,t=jn;try{var n=io;for(jn=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}io=null,Kx=!1}catch(s){throw io!==null&&(io=io.slice(e+1)),wL(LS,Hl),s}finally{jn=t,mw=!1}}return null}var td=[],nd=0,ay=null,sy=0,js=[],_s=0,Bc=null,uo=1,ho="";function cc(e,t){td[nd++]=sy,td[nd++]=ay,ay=e,sy=t}function JL(e,t,n){js[_s++]=uo,js[_s++]=ho,js[_s++]=Bc,Bc=e;var r=uo;e=ho;var s=32-si(r)-1;r&=~(1<<s),n+=1;var i=32-si(t)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,uo=1<<32-si(t)+s|n<<s|r,ho=i+e}else uo=1<<i|n<<s|r,ho=e}function KS(e){e.return!==null&&(cc(e,1),JL(e,1,0))}function VS(e){for(;e===ay;)ay=td[--nd],td[nd]=null,sy=td[--nd],td[nd]=null;for(;e===Bc;)Bc=js[--_s],js[_s]=null,ho=js[--_s],js[_s]=null,uo=js[--_s],js[_s]=null}var os=null,is=null,Hn=!1,ei=null;function QL(e,t){var n=Cs(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function cT(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,os=e,is=Sl(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,os=e,is=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Bc!==null?{id:uo,overflow:ho}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=Cs(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,os=e,is=null,!0):!1;default:return!1}}function P_(e){return(e.mode&1)!==0&&(e.flags&128)===0}function O_(e){if(Hn){var t=is;if(t){var n=t;if(!cT(e,t)){if(P_(e))throw Error(Ge(418));t=Sl(n.nextSibling);var r=os;t&&cT(e,t)?QL(r,n):(e.flags=e.flags&-4097|2,Hn=!1,os=e)}}else{if(P_(e))throw Error(Ge(418));e.flags=e.flags&-4097|2,Hn=!1,os=e}}}function uT(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;os=e}function Eg(e){if(e!==os)return!1;if(!Hn)return uT(e),Hn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!C_(e.type,e.memoizedProps)),t&&(t=is)){if(P_(e))throw ZL(),Error(Ge(418));for(;t;)QL(e,t),t=Sl(t.nextSibling)}if(uT(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(Ge(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){is=Sl(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}is=null}}else is=os?Sl(e.stateNode.nextSibling):null;return!0}function ZL(){for(var e=is;e;)e=Sl(e.nextSibling)}function Ld(){is=os=null,Hn=!1}function GS(e){ei===null?ei=[e]:ei.push(e)}var dK=Lo.ReactCurrentBatchConfig;function tf(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ge(309));var r=n.stateNode}if(!r)throw Error(Ge(147,e));var s=r,i=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===i?t.ref:(t=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},t._stringRef=i,t)}if(typeof e!="string")throw Error(Ge(284));if(!n._owner)throw Error(Ge(290,e))}return e}function Tg(e,t){throw e=Object.prototype.toString.call(t),Error(Ge(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function dT(e){var t=e._init;return t(e._payload)}function e$(e){function t(x,w){if(e){var b=x.deletions;b===null?(x.deletions=[w],x.flags|=16):b.push(w)}}function n(x,w){if(!e)return null;for(;w!==null;)t(x,w),w=w.sibling;return null}function r(x,w){for(x=new Map;w!==null;)w.key!==null?x.set(w.key,w):x.set(w.index,w),w=w.sibling;return x}function s(x,w){return x=El(x,w),x.index=0,x.sibling=null,x}function i(x,w,b){return x.index=b,e?(b=x.alternate,b!==null?(b=b.index,b<w?(x.flags|=2,w):b):(x.flags|=2,w)):(x.flags|=1048576,w)}function o(x){return e&&x.alternate===null&&(x.flags|=2),x}function l(x,w,b,_){return w===null||w.tag!==6?(w=ww(b,x.mode,_),w.return=x,w):(w=s(w,b),w.return=x,w)}function c(x,w,b,_){var k=b.type;return k===Yu?d(x,w,b.props.children,_,b.key):w!==null&&(w.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===al&&dT(k)===w.type)?(_=s(w,b.props),_.ref=tf(x,w,b),_.return=x,_):(_=Pv(b.type,b.key,b.props,null,x.mode,_),_.ref=tf(x,w,b),_.return=x,_)}function u(x,w,b,_){return w===null||w.tag!==4||w.stateNode.containerInfo!==b.containerInfo||w.stateNode.implementation!==b.implementation?(w=jw(b,x.mode,_),w.return=x,w):(w=s(w,b.children||[]),w.return=x,w)}function d(x,w,b,_,k){return w===null||w.tag!==7?(w=Dc(b,x.mode,_,k),w.return=x,w):(w=s(w,b),w.return=x,w)}function h(x,w,b){if(typeof w=="string"&&w!==""||typeof w=="number")return w=ww(""+w,x.mode,b),w.return=x,w;if(typeof w=="object"&&w!==null){switch(w.$$typeof){case xg:return b=Pv(w.type,w.key,w.props,null,x.mode,b),b.ref=tf(x,null,w),b.return=x,b;case Gu:return w=jw(w,x.mode,b),w.return=x,w;case al:var _=w._init;return h(x,_(w._payload),b)}if(Nf(w)||Xh(w))return w=Dc(w,x.mode,b,null),w.return=x,w;Tg(x,w)}return null}function f(x,w,b,_){var k=w!==null?w.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return k!==null?null:l(x,w,""+b,_);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case xg:return b.key===k?c(x,w,b,_):null;case Gu:return b.key===k?u(x,w,b,_):null;case al:return k=b._init,f(x,w,k(b._payload),_)}if(Nf(b)||Xh(b))return k!==null?null:d(x,w,b,_,null);Tg(x,b)}return null}function m(x,w,b,_,k){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(b)||null,l(w,x,""+_,k);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case xg:return x=x.get(_.key===null?b:_.key)||null,c(w,x,_,k);case Gu:return x=x.get(_.key===null?b:_.key)||null,u(w,x,_,k);case al:var j=_._init;return m(x,w,b,j(_._payload),k)}if(Nf(_)||Xh(_))return x=x.get(b)||null,d(w,x,_,k,null);Tg(w,_)}return null}function g(x,w,b,_){for(var k=null,j=null,S=w,T=w=0,O=null;S!==null&&T<b.length;T++){S.index>T?(O=S,S=null):O=S.sibling;var A=f(x,S,b[T],_);if(A===null){S===null&&(S=O);break}e&&S&&A.alternate===null&&t(x,S),w=i(A,w,T),j===null?k=A:j.sibling=A,j=A,S=O}if(T===b.length)return n(x,S),Hn&&cc(x,T),k;if(S===null){for(;T<b.length;T++)S=h(x,b[T],_),S!==null&&(w=i(S,w,T),j===null?k=S:j.sibling=S,j=S);return Hn&&cc(x,T),k}for(S=r(x,S);T<b.length;T++)O=m(S,x,T,b[T],_),O!==null&&(e&&O.alternate!==null&&S.delete(O.key===null?T:O.key),w=i(O,w,T),j===null?k=O:j.sibling=O,j=O);return e&&S.forEach(function(N){return t(x,N)}),Hn&&cc(x,T),k}function v(x,w,b,_){var k=Xh(b);if(typeof k!="function")throw Error(Ge(150));if(b=k.call(b),b==null)throw Error(Ge(151));for(var j=k=null,S=w,T=w=0,O=null,A=b.next();S!==null&&!A.done;T++,A=b.next()){S.index>T?(O=S,S=null):O=S.sibling;var N=f(x,S,A.value,_);if(N===null){S===null&&(S=O);break}e&&S&&N.alternate===null&&t(x,S),w=i(N,w,T),j===null?k=N:j.sibling=N,j=N,S=O}if(A.done)return n(x,S),Hn&&cc(x,T),k;if(S===null){for(;!A.done;T++,A=b.next())A=h(x,A.value,_),A!==null&&(w=i(A,w,T),j===null?k=A:j.sibling=A,j=A);return Hn&&cc(x,T),k}for(S=r(x,S);!A.done;T++,A=b.next())A=m(S,x,T,A.value,_),A!==null&&(e&&A.alternate!==null&&S.delete(A.key===null?T:A.key),w=i(A,w,T),j===null?k=A:j.sibling=A,j=A);return e&&S.forEach(function(L){return t(x,L)}),Hn&&cc(x,T),k}function y(x,w,b,_){if(typeof b=="object"&&b!==null&&b.type===Yu&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case xg:e:{for(var k=b.key,j=w;j!==null;){if(j.key===k){if(k=b.type,k===Yu){if(j.tag===7){n(x,j.sibling),w=s(j,b.props.children),w.return=x,x=w;break e}}else if(j.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===al&&dT(k)===j.type){n(x,j.sibling),w=s(j,b.props),w.ref=tf(x,j,b),w.return=x,x=w;break e}n(x,j);break}else t(x,j);j=j.sibling}b.type===Yu?(w=Dc(b.props.children,x.mode,_,b.key),w.return=x,x=w):(_=Pv(b.type,b.key,b.props,null,x.mode,_),_.ref=tf(x,w,b),_.return=x,x=_)}return o(x);case Gu:e:{for(j=b.key;w!==null;){if(w.key===j)if(w.tag===4&&w.stateNode.containerInfo===b.containerInfo&&w.stateNode.implementation===b.implementation){n(x,w.sibling),w=s(w,b.children||[]),w.return=x,x=w;break e}else{n(x,w);break}else t(x,w);w=w.sibling}w=jw(b,x.mode,_),w.return=x,x=w}return o(x);case al:return j=b._init,y(x,w,j(b._payload),_)}if(Nf(b))return g(x,w,b,_);if(Xh(b))return v(x,w,b,_);Tg(x,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,w!==null&&w.tag===6?(n(x,w.sibling),w=s(w,b),w.return=x,x=w):(n(x,w),w=ww(b,x.mode,_),w.return=x,x=w),o(x)):n(x,w)}return y}var $d=e$(!0),t$=e$(!1),iy=ql(null),oy=null,rd=null,YS=null;function XS(){YS=rd=oy=null}function JS(e){var t=iy.current;Wn(iy),e._currentValue=t}function I_(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function md(e,t){oy=e,YS=rd=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&($a=!0),e.firstContext=null)}function Is(e){var t=e._currentValue;if(YS!==e)if(e={context:e,memoizedValue:t,next:null},rd===null){if(oy===null)throw Error(Ge(308));rd=e,oy.dependencies={lanes:0,firstContext:e}}else rd=rd.next=e;return t}var _c=null;function QS(e){_c===null?_c=[e]:_c.push(e)}function n$(e,t,n,r){var s=t.interleaved;return s===null?(n.next=n,QS(t)):(n.next=s.next,s.next=n),t.interleaved=n,Co(e,r)}function Co(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var sl=!1;function ZS(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function r$(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function yo(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Nl(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,sn&2){var s=r.pending;return s===null?t.next=t:(t.next=s.next,s.next=t),r.pending=t,Co(e,n)}return s=r.interleaved,s===null?(t.next=t,QS(r)):(t.next=s.next,s.next=t),r.interleaved=t,Co(e,n)}function Sv(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,$S(e,n)}}function hT(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=t:i=i.next=t}else s=i=t;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function ly(e,t,n,r){var s=e.updateQueue;sl=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=e.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,m=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=e,v=l;switch(f=t,m=n,v.tag){case 1:if(g=v.payload,typeof g=="function"){h=g.call(m,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=v.payload,f=typeof g=="function"?g.call(m,h,f):g,f==null)break e;h=Jn({},h,f);break e;case 2:sl=!0}}l.callback!==null&&l.lane!==0&&(e.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,t=s.shared.interleaved,t!==null){s=t;do o|=s.lane,s=s.next;while(s!==t)}else i===null&&(s.shared.lanes=0);Wc|=o,e.lanes=o,e.memoizedState=h}}function fT(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Ge(191,s));s.call(r)}}}var Tp={},$i=ql(Tp),fm=ql(Tp),mm=ql(Tp);function kc(e){if(e===Tp)throw Error(Ge(174));return e}function eN(e,t){switch(Mn(mm,t),Mn(fm,e),Mn($i,Tp),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:f_(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=f_(t,e)}Wn($i),Mn($i,t)}function Fd(){Wn($i),Wn(fm),Wn(mm)}function a$(e){kc(mm.current);var t=kc($i.current),n=f_(t,e.type);t!==n&&(Mn(fm,e),Mn($i,n))}function tN(e){fm.current===e&&(Wn($i),Wn(fm))}var Yn=ql(0);function cy(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var pw=[];function nN(){for(var e=0;e<pw.length;e++)pw[e]._workInProgressVersionPrimary=null;pw.length=0}var Nv=Lo.ReactCurrentDispatcher,gw=Lo.ReactCurrentBatchConfig,zc=0,Xn=null,jr=null,Or=null,uy=!1,Ff=!1,pm=0,hK=0;function ea(){throw Error(Ge(321))}function rN(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ui(e[n],t[n]))return!1;return!0}function aN(e,t,n,r,s,i){if(zc=i,Xn=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Nv.current=e===null||e.memoizedState===null?gK:vK,e=n(r,s),Ff){i=0;do{if(Ff=!1,pm=0,25<=i)throw Error(Ge(301));i+=1,Or=jr=null,t.updateQueue=null,Nv.current=yK,e=n(r,s)}while(Ff)}if(Nv.current=dy,t=jr!==null&&jr.next!==null,zc=0,Or=jr=Xn=null,uy=!1,t)throw Error(Ge(300));return e}function sN(){var e=pm!==0;return pm=0,e}function wi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Or===null?Xn.memoizedState=Or=e:Or=Or.next=e,Or}function Rs(){if(jr===null){var e=Xn.alternate;e=e!==null?e.memoizedState:null}else e=jr.next;var t=Or===null?Xn.memoizedState:Or.next;if(t!==null)Or=t,jr=e;else{if(e===null)throw Error(Ge(310));jr=e,e={memoizedState:jr.memoizedState,baseState:jr.baseState,baseQueue:jr.baseQueue,queue:jr.queue,next:null},Or===null?Xn.memoizedState=Or=e:Or=Or.next=e}return Or}function gm(e,t){return typeof t=="function"?t(e):t}function vw(e){var t=Rs(),n=t.queue;if(n===null)throw Error(Ge(311));n.lastRenderedReducer=e;var r=jr,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((zc&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,Xn.lanes|=d,Wc|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,ui(r,t.memoizedState)||($a=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=c,n.lastRenderedState=r}if(e=n.interleaved,e!==null){s=e;do i=s.lane,Xn.lanes|=i,Wc|=i,s=s.next;while(s!==e)}else s===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function yw(e){var t=Rs(),n=t.queue;if(n===null)throw Error(Ge(311));n.lastRenderedReducer=e;var r=n.dispatch,s=n.pending,i=t.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=e(i,o.action),o=o.next;while(o!==s);ui(i,t.memoizedState)||($a=!0),t.memoizedState=i,t.baseQueue===null&&(t.baseState=i),n.lastRenderedState=i}return[i,r]}function s$(){}function i$(e,t){var n=Xn,r=Rs(),s=t(),i=!ui(r.memoizedState,s);if(i&&(r.memoizedState=s,$a=!0),r=r.queue,iN(c$.bind(null,n,r,e),[e]),r.getSnapshot!==t||i||Or!==null&&Or.memoizedState.tag&1){if(n.flags|=2048,vm(9,l$.bind(null,n,r,s,t),void 0,null),Rr===null)throw Error(Ge(349));zc&30||o$(n,t,s)}return s}function o$(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=Xn.updateQueue,t===null?(t={lastEffect:null,stores:null},Xn.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function l$(e,t,n,r){t.value=n,t.getSnapshot=r,u$(t)&&d$(e)}function c$(e,t,n){return n(function(){u$(t)&&d$(e)})}function u$(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ui(e,n)}catch{return!0}}function d$(e){var t=Co(e,1);t!==null&&ii(t,e,1,-1)}function mT(e){var t=wi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:gm,lastRenderedState:e},t.queue=e,e=e.dispatch=pK.bind(null,Xn,e),[t.memoizedState,e]}function vm(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=Xn.updateQueue,t===null?(t={lastEffect:null,stores:null},Xn.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function h$(){return Rs().memoizedState}function Cv(e,t,n,r){var s=wi();Xn.flags|=e,s.memoizedState=vm(1|t,n,void 0,r===void 0?null:r)}function Vx(e,t,n,r){var s=Rs();r=r===void 0?null:r;var i=void 0;if(jr!==null){var o=jr.memoizedState;if(i=o.destroy,r!==null&&rN(r,o.deps)){s.memoizedState=vm(t,n,i,r);return}}Xn.flags|=e,s.memoizedState=vm(1|t,n,i,r)}function pT(e,t){return Cv(8390656,8,e,t)}function iN(e,t){return Vx(2048,8,e,t)}function f$(e,t){return Vx(4,2,e,t)}function m$(e,t){return Vx(4,4,e,t)}function p$(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function g$(e,t,n){return n=n!=null?n.concat([e]):null,Vx(4,4,p$.bind(null,t,e),n)}function oN(){}function v$(e,t){var n=Rs();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&rN(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function y$(e,t){var n=Rs();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&rN(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function x$(e,t,n){return zc&21?(ui(n,t)||(n=kL(),Xn.lanes|=n,Wc|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,$a=!0),e.memoizedState=n)}function fK(e,t){var n=jn;jn=n!==0&&4>n?n:4,e(!0);var r=gw.transition;gw.transition={};try{e(!1),t()}finally{jn=n,gw.transition=r}}function b$(){return Rs().memoizedState}function mK(e,t,n){var r=Al(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},w$(e))j$(t,n);else if(n=n$(e,t,n,r),n!==null){var s=_a();ii(n,e,r,s),_$(n,t,r)}}function pK(e,t,n){var r=Al(e),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(w$(e))j$(t,s);else{var i=e.alternate;if(e.lanes===0&&(i===null||i.lanes===0)&&(i=t.lastRenderedReducer,i!==null))try{var o=t.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,ui(l,o)){var c=t.interleaved;c===null?(s.next=s,QS(t)):(s.next=c.next,c.next=s),t.interleaved=s;return}}catch{}finally{}n=n$(e,t,s,r),n!==null&&(s=_a(),ii(n,e,r,s),_$(n,t,r))}}function w$(e){var t=e.alternate;return e===Xn||t!==null&&t===Xn}function j$(e,t){Ff=uy=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function _$(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,$S(e,n)}}var dy={readContext:Is,useCallback:ea,useContext:ea,useEffect:ea,useImperativeHandle:ea,useInsertionEffect:ea,useLayoutEffect:ea,useMemo:ea,useReducer:ea,useRef:ea,useState:ea,useDebugValue:ea,useDeferredValue:ea,useTransition:ea,useMutableSource:ea,useSyncExternalStore:ea,useId:ea,unstable_isNewReconciler:!1},gK={readContext:Is,useCallback:function(e,t){return wi().memoizedState=[e,t===void 0?null:t],e},useContext:Is,useEffect:pT,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,Cv(4194308,4,p$.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Cv(4194308,4,e,t)},useInsertionEffect:function(e,t){return Cv(4,2,e,t)},useMemo:function(e,t){var n=wi();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=wi();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=mK.bind(null,Xn,e),[r.memoizedState,e]},useRef:function(e){var t=wi();return e={current:e},t.memoizedState=e},useState:mT,useDebugValue:oN,useDeferredValue:function(e){return wi().memoizedState=e},useTransition:function(){var e=mT(!1),t=e[0];return e=fK.bind(null,e[1]),wi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=Xn,s=wi();if(Hn){if(n===void 0)throw Error(Ge(407));n=n()}else{if(n=t(),Rr===null)throw Error(Ge(349));zc&30||o$(r,t,n)}s.memoizedState=n;var i={value:n,getSnapshot:t};return s.queue=i,pT(c$.bind(null,r,i,e),[e]),r.flags|=2048,vm(9,l$.bind(null,r,i,n,t),void 0,null),n},useId:function(){var e=wi(),t=Rr.identifierPrefix;if(Hn){var n=ho,r=uo;n=(r&~(1<<32-si(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=pm++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=hK++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},vK={readContext:Is,useCallback:v$,useContext:Is,useEffect:iN,useImperativeHandle:g$,useInsertionEffect:f$,useLayoutEffect:m$,useMemo:y$,useReducer:vw,useRef:h$,useState:function(){return vw(gm)},useDebugValue:oN,useDeferredValue:function(e){var t=Rs();return x$(t,jr.memoizedState,e)},useTransition:function(){var e=vw(gm)[0],t=Rs().memoizedState;return[e,t]},useMutableSource:s$,useSyncExternalStore:i$,useId:b$,unstable_isNewReconciler:!1},yK={readContext:Is,useCallback:v$,useContext:Is,useEffect:iN,useImperativeHandle:g$,useInsertionEffect:f$,useLayoutEffect:m$,useMemo:y$,useReducer:yw,useRef:h$,useState:function(){return yw(gm)},useDebugValue:oN,useDeferredValue:function(e){var t=Rs();return jr===null?t.memoizedState=e:x$(t,jr.memoizedState,e)},useTransition:function(){var e=yw(gm)[0],t=Rs().memoizedState;return[e,t]},useMutableSource:s$,useSyncExternalStore:i$,useId:b$,unstable_isNewReconciler:!1};function Ks(e,t){if(e&&e.defaultProps){t=Jn({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function R_(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:Jn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Gx={isMounted:function(e){return(e=e._reactInternals)?lu(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=_a(),s=Al(e),i=yo(r,s);i.payload=t,n!=null&&(i.callback=n),t=Nl(e,i,s),t!==null&&(ii(t,e,s,r),Sv(t,e,s))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=_a(),s=Al(e),i=yo(r,s);i.tag=1,i.payload=t,n!=null&&(i.callback=n),t=Nl(e,i,s),t!==null&&(ii(t,e,s,r),Sv(t,e,s))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=_a(),r=Al(e),s=yo(n,r);s.tag=2,t!=null&&(s.callback=t),t=Nl(e,s,r),t!==null&&(ii(t,e,r,n),Sv(t,e,r))}};function gT(e,t,n,r,s,i,o){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,i,o):t.prototype&&t.prototype.isPureReactComponent?!cm(n,r)||!cm(s,i):!0}function k$(e,t,n){var r=!1,s=Ml,i=t.contextType;return typeof i=="object"&&i!==null?i=Is(i):(s=za(t)?Uc:la.current,r=t.contextTypes,i=(r=r!=null)?Dd(e,s):Ml),t=new t(n,i),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Gx,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=s,e.__reactInternalMemoizedMaskedChildContext=i),t}function vT(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Gx.enqueueReplaceState(t,t.state,null)}function M_(e,t,n,r){var s=e.stateNode;s.props=n,s.state=e.memoizedState,s.refs={},ZS(e);var i=t.contextType;typeof i=="object"&&i!==null?s.context=Is(i):(i=za(t)?Uc:la.current,s.context=Dd(e,i)),s.state=e.memoizedState,i=t.getDerivedStateFromProps,typeof i=="function"&&(R_(e,t,i,n),s.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(t=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),t!==s.state&&Gx.enqueueReplaceState(s,s.state,null),ly(e,n,s,r),s.state=e.memoizedState),typeof s.componentDidMount=="function"&&(e.flags|=4194308)}function Ud(e,t){try{var n="",r=t;do n+=KH(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:e,source:t,stack:s,digest:null}}function xw(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function D_(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var xK=typeof WeakMap=="function"?WeakMap:Map;function S$(e,t,n){n=yo(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){fy||(fy=!0,K_=r),D_(e,t)},n}function N$(e,t,n){n=yo(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var s=t.value;n.payload=function(){return r(s)},n.callback=function(){D_(e,t)}}var i=e.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){D_(e,t),typeof r!="function"&&(Cl===null?Cl=new Set([this]):Cl.add(this));var o=t.stack;this.componentDidCatch(t.value,{componentStack:o!==null?o:""})}),n}function yT(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new xK;var s=new Set;r.set(t,s)}else s=r.get(t),s===void 0&&(s=new Set,r.set(t,s));s.has(n)||(s.add(n),e=IK.bind(null,e,t,n),t.then(e,e))}function xT(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function bT(e,t,n,r,s){return e.mode&1?(e.flags|=65536,e.lanes=s,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=yo(-1,1),t.tag=2,Nl(n,t,1))),n.lanes|=1),e)}var bK=Lo.ReactCurrentOwner,$a=!1;function va(e,t,n,r){t.child=e===null?t$(t,null,n,r):$d(t,e.child,n,r)}function wT(e,t,n,r,s){n=n.render;var i=t.ref;return md(t,s),r=aN(e,t,n,r,i,s),n=sN(),e!==null&&!$a?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ao(e,t,s)):(Hn&&n&&KS(t),t.flags|=1,va(e,t,r,s),t.child)}function jT(e,t,n,r,s){if(e===null){var i=n.type;return typeof i=="function"&&!pN(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=i,C$(e,t,i,r,s)):(e=Pv(n.type,null,r,t,t.mode,s),e.ref=t.ref,e.return=t,t.child=e)}if(i=e.child,!(e.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:cm,n(o,r)&&e.ref===t.ref)return Ao(e,t,s)}return t.flags|=1,e=El(i,r),e.ref=t.ref,e.return=t,t.child=e}function C$(e,t,n,r,s){if(e!==null){var i=e.memoizedProps;if(cm(i,r)&&e.ref===t.ref)if($a=!1,t.pendingProps=r=i,(e.lanes&s)!==0)e.flags&131072&&($a=!0);else return t.lanes=e.lanes,Ao(e,t,s)}return L_(e,t,n,r,s)}function A$(e,t,n){var r=t.pendingProps,s=r.children,i=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Mn(sd,ns),ns|=n;else{if(!(n&1073741824))return e=i!==null?i.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Mn(sd,ns),ns|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Mn(sd,ns),ns|=r}else i!==null?(r=i.baseLanes|n,t.memoizedState=null):r=n,Mn(sd,ns),ns|=r;return va(e,t,s,n),t.child}function E$(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function L_(e,t,n,r,s){var i=za(n)?Uc:la.current;return i=Dd(t,i),md(t,s),n=aN(e,t,n,r,i,s),r=sN(),e!==null&&!$a?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~s,Ao(e,t,s)):(Hn&&r&&KS(t),t.flags|=1,va(e,t,n,s),t.child)}function _T(e,t,n,r,s){if(za(n)){var i=!0;ry(t)}else i=!1;if(md(t,s),t.stateNode===null)Av(e,t),k$(t,n,r),M_(t,n,r,s),r=!0;else if(e===null){var o=t.stateNode,l=t.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=Is(u):(u=za(n)?Uc:la.current,u=Dd(t,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&vT(t,o,r,u),sl=!1;var f=t.memoizedState;o.state=f,ly(t,r,o,s),c=t.memoizedState,l!==r||f!==c||Ba.current||sl?(typeof d=="function"&&(R_(t,n,d,r),c=t.memoizedState),(l=sl||gT(t,n,l,r,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(t.flags|=4194308)):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,r$(e,t),l=t.memoizedProps,u=t.type===t.elementType?l:Ks(t.type,l),o.props=u,h=t.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=Is(c):(c=za(n)?Uc:la.current,c=Dd(t,c));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&vT(t,o,r,c),sl=!1,f=t.memoizedState,o.state=f,ly(t,r,o,s);var g=t.memoizedState;l!==h||f!==g||Ba.current||sl?(typeof m=="function"&&(R_(t,n,m,r),g=t.memoizedState),(u=sl||gT(t,n,u,r,f,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,c)),typeof o.componentDidUpdate=="function"&&(t.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=g),o.props=r,o.state=g,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===e.memoizedProps&&f===e.memoizedState||(t.flags|=1024),r=!1)}return $_(e,t,n,r,i,s)}function $_(e,t,n,r,s,i){E$(e,t);var o=(t.flags&128)!==0;if(!r&&!o)return s&&lT(t,n,!1),Ao(e,t,i);r=t.stateNode,bK.current=t;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&o?(t.child=$d(t,e.child,null,i),t.child=$d(t,null,l,i)):va(e,t,l,i),t.memoizedState=r.state,s&&lT(t,n,!0),t.child}function T$(e){var t=e.stateNode;t.pendingContext?oT(e,t.pendingContext,t.pendingContext!==t.context):t.context&&oT(e,t.context,!1),eN(e,t.containerInfo)}function kT(e,t,n,r,s){return Ld(),GS(s),t.flags|=256,va(e,t,n,r),t.child}var F_={dehydrated:null,treeContext:null,retryLane:0};function U_(e){return{baseLanes:e,cachePool:null,transitions:null}}function P$(e,t,n){var r=t.pendingProps,s=Yn.current,i=!1,o=(t.flags&128)!==0,l;if((l=o)||(l=e!==null&&e.memoizedState===null?!1:(s&2)!==0),l?(i=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(s|=1),Mn(Yn,s&1),e===null)return O_(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(o=r.children,e=r.fallback,i?(r=t.mode,i=t.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Jx(o,r,0,null),e=Dc(e,r,n,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=U_(n),t.memoizedState=F_,e):lN(t,o));if(s=e.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return wK(e,t,o,r,l,s,n);if(i){i=r.fallback,o=t.mode,s=e.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&t.child!==s?(r=t.child,r.childLanes=0,r.pendingProps=c,t.deletions=null):(r=El(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=El(l,i):(i=Dc(i,o,n,null),i.flags|=2),i.return=t,r.return=t,r.sibling=i,t.child=r,r=i,i=t.child,o=e.child.memoizedState,o=o===null?U_(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~n,t.memoizedState=F_,r}return i=e.child,e=i.sibling,r=El(i,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function lN(e,t){return t=Jx({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Pg(e,t,n,r){return r!==null&&GS(r),$d(t,e.child,null,n),e=lN(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function wK(e,t,n,r,s,i,o){if(n)return t.flags&256?(t.flags&=-257,r=xw(Error(Ge(422))),Pg(e,t,o,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(i=r.fallback,s=t.mode,r=Jx({mode:"visible",children:r.children},s,0,null),i=Dc(i,s,o,null),i.flags|=2,r.return=t,i.return=t,r.sibling=i,t.child=r,t.mode&1&&$d(t,e.child,null,o),t.child.memoizedState=U_(o),t.memoizedState=F_,i);if(!(t.mode&1))return Pg(e,t,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(Ge(419)),r=xw(i,r,void 0),Pg(e,t,o,r)}if(l=(o&e.childLanes)!==0,$a||l){if(r=Rr,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Co(e,s),ii(r,e,s,-1))}return mN(),r=xw(Error(Ge(421))),Pg(e,t,o,r)}return s.data==="$?"?(t.flags|=128,t.child=e.child,t=RK.bind(null,e),s._reactRetry=t,null):(e=i.treeContext,is=Sl(s.nextSibling),os=t,Hn=!0,ei=null,e!==null&&(js[_s++]=uo,js[_s++]=ho,js[_s++]=Bc,uo=e.id,ho=e.overflow,Bc=t),t=lN(t,r.children),t.flags|=4096,t)}function ST(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),I_(e.return,t,n)}function bw(e,t,n,r,s){var i=e.memoizedState;i===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function O$(e,t,n){var r=t.pendingProps,s=r.revealOrder,i=r.tail;if(va(e,t,r.children,n),r=Yn.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&ST(e,n,t);else if(e.tag===19)ST(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Mn(Yn,r),!(t.mode&1))t.memoizedState=null;else switch(s){case"forwards":for(n=t.child,s=null;n!==null;)e=n.alternate,e!==null&&cy(e)===null&&(s=n),n=n.sibling;n=s,n===null?(s=t.child,t.child=null):(s=n.sibling,n.sibling=null),bw(t,!1,s,n,i);break;case"backwards":for(n=null,s=t.child,t.child=null;s!==null;){if(e=s.alternate,e!==null&&cy(e)===null){t.child=s;break}e=s.sibling,s.sibling=n,n=s,s=e}bw(t,!0,n,null,i);break;case"together":bw(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Av(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ao(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Wc|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(Ge(153));if(t.child!==null){for(e=t.child,n=El(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=El(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function jK(e,t,n){switch(t.tag){case 3:T$(t),Ld();break;case 5:a$(t);break;case 1:za(t.type)&&ry(t);break;case 4:eN(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,s=t.memoizedProps.value;Mn(iy,r._currentValue),r._currentValue=s;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Mn(Yn,Yn.current&1),t.flags|=128,null):n&t.child.childLanes?P$(e,t,n):(Mn(Yn,Yn.current&1),e=Ao(e,t,n),e!==null?e.sibling:null);Mn(Yn,Yn.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return O$(e,t,n);t.flags|=128}if(s=t.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Mn(Yn,Yn.current),r)break;return null;case 22:case 23:return t.lanes=0,A$(e,t,n)}return Ao(e,t,n)}var I$,B_,R$,M$;I$=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};B_=function(){};R$=function(e,t,n,r){var s=e.memoizedProps;if(s!==r){e=t.stateNode,kc($i.current);var i=null;switch(n){case"input":s=c_(e,s),r=c_(e,r),i=[];break;case"select":s=Jn({},s,{value:void 0}),r=Jn({},r,{value:void 0}),i=[];break;case"textarea":s=h_(e,s),r=h_(e,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=ty)}m_(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(nm.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(nm.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Un("scroll",e),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(t.updateQueue=u)&&(t.flags|=4)}};M$=function(e,t,n,r){n!==r&&(t.flags|=4)};function nf(e,t){if(!Hn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function ta(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=e,s=s.sibling;else for(s=e.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=e,s=s.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function _K(e,t,n){var r=t.pendingProps;switch(VS(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ta(t),null;case 1:return za(t.type)&&ny(),ta(t),null;case 3:return r=t.stateNode,Fd(),Wn(Ba),Wn(la),nN(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(Eg(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,ei!==null&&(Y_(ei),ei=null))),B_(e,t),ta(t),null;case 5:tN(t);var s=kc(mm.current);if(n=t.type,e!==null&&t.stateNode!=null)R$(e,t,n,r,s),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(Ge(166));return ta(t),null}if(e=kc($i.current),Eg(t)){r=t.stateNode,n=t.type;var i=t.memoizedProps;switch(r[Ci]=t,r[hm]=i,e=(t.mode&1)!==0,n){case"dialog":Un("cancel",r),Un("close",r);break;case"iframe":case"object":case"embed":Un("load",r);break;case"video":case"audio":for(s=0;s<Af.length;s++)Un(Af[s],r);break;case"source":Un("error",r);break;case"img":case"image":case"link":Un("error",r),Un("load",r);break;case"details":Un("toggle",r);break;case"input":RE(r,i),Un("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Un("invalid",r);break;case"textarea":DE(r,i),Un("invalid",r)}m_(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ag(r.textContent,l,e),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ag(r.textContent,l,e),s=["children",""+l]):nm.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Un("scroll",r)}switch(n){case"input":bg(r),ME(r,i,!0);break;case"textarea":bg(r),LE(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ty)}r=s,t.updateQueue=r,r!==null&&(t.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=cL(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=o.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=o.createElement(n,{is:r.is}):(e=o.createElement(n),n==="select"&&(o=e,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):e=o.createElementNS(e,n),e[Ci]=t,e[hm]=r,I$(e,t,!1,!1),t.stateNode=e;e:{switch(o=p_(n,r),n){case"dialog":Un("cancel",e),Un("close",e),s=r;break;case"iframe":case"object":case"embed":Un("load",e),s=r;break;case"video":case"audio":for(s=0;s<Af.length;s++)Un(Af[s],e);s=r;break;case"source":Un("error",e),s=r;break;case"img":case"image":case"link":Un("error",e),Un("load",e),s=r;break;case"details":Un("toggle",e),s=r;break;case"input":RE(e,r),s=c_(e,r),Un("invalid",e);break;case"option":s=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},s=Jn({},r,{value:void 0}),Un("invalid",e);break;case"textarea":DE(e,r),s=h_(e,r),Un("invalid",e);break;default:s=r}m_(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?hL(e,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&uL(e,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&rm(e,c):typeof c=="number"&&rm(e,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(nm.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Un("scroll",e):c!=null&&OS(e,i,c,o))}switch(n){case"input":bg(e),ME(e,r,!1);break;case"textarea":bg(e),LE(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Rl(r.value));break;case"select":e.multiple=!!r.multiple,i=r.value,i!=null?ud(e,!!r.multiple,i,!1):r.defaultValue!=null&&ud(e,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(e.onclick=ty)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return ta(t),null;case 6:if(e&&t.stateNode!=null)M$(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(Ge(166));if(n=kc(mm.current),kc($i.current),Eg(t)){if(r=t.stateNode,n=t.memoizedProps,r[Ci]=t,(i=r.nodeValue!==n)&&(e=os,e!==null))switch(e.tag){case 3:Ag(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&Ag(r.nodeValue,n,(e.mode&1)!==0)}i&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ci]=t,t.stateNode=r}return ta(t),null;case 13:if(Wn(Yn),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(Hn&&is!==null&&t.mode&1&&!(t.flags&128))ZL(),Ld(),t.flags|=98560,i=!1;else if(i=Eg(t),r!==null&&r.dehydrated!==null){if(e===null){if(!i)throw Error(Ge(318));if(i=t.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ge(317));i[Ci]=t}else Ld(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;ta(t),i=!1}else ei!==null&&(Y_(ei),ei=null),i=!0;if(!i)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||Yn.current&1?kr===0&&(kr=3):mN())),t.updateQueue!==null&&(t.flags|=4),ta(t),null);case 4:return Fd(),B_(e,t),e===null&&um(t.stateNode.containerInfo),ta(t),null;case 10:return JS(t.type._context),ta(t),null;case 17:return za(t.type)&&ny(),ta(t),null;case 19:if(Wn(Yn),i=t.memoizedState,i===null)return ta(t),null;if(r=(t.flags&128)!==0,o=i.rendering,o===null)if(r)nf(i,!1);else{if(kr!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(o=cy(e),o!==null){for(t.flags|=128,nf(i,!1),r=o.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)i=n,e=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=e,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,e=o.dependencies,i.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Mn(Yn,Yn.current&1|2),t.child}e=e.sibling}i.tail!==null&&lr()>Bd&&(t.flags|=128,r=!0,nf(i,!1),t.lanes=4194304)}else{if(!r)if(e=cy(o),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),nf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Hn)return ta(t),null}else 2*lr()-i.renderingStartTime>Bd&&n!==1073741824&&(t.flags|=128,r=!0,nf(i,!1),t.lanes=4194304);i.isBackwards?(o.sibling=t.child,t.child=o):(n=i.last,n!==null?n.sibling=o:t.child=o,i.last=o)}return i.tail!==null?(t=i.tail,i.rendering=t,i.tail=t.sibling,i.renderingStartTime=lr(),t.sibling=null,n=Yn.current,Mn(Yn,r?n&1|2:n&1),t):(ta(t),null);case 22:case 23:return fN(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?ns&1073741824&&(ta(t),t.subtreeFlags&6&&(t.flags|=8192)):ta(t),null;case 24:return null;case 25:return null}throw Error(Ge(156,t.tag))}function kK(e,t){switch(VS(t),t.tag){case 1:return za(t.type)&&ny(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return Fd(),Wn(Ba),Wn(la),nN(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return tN(t),null;case 13:if(Wn(Yn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(Ge(340));Ld()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Wn(Yn),null;case 4:return Fd(),null;case 10:return JS(t.type._context),null;case 22:case 23:return fN(),null;case 24:return null;default:return null}}var Og=!1,aa=!1,SK=typeof WeakSet=="function"?WeakSet:Set,pt=null;function ad(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){nr(e,t,r)}else n.current=null}function z_(e,t,n){try{n()}catch(r){nr(e,t,r)}}var NT=!1;function NK(e,t){if(S_=Qv,e=UL(),HS(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=e,f=null;t:for(;;){for(var m;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===e)break t;if(f===n&&++u===s&&(l=o),f===i&&++d===r&&(c=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(N_={focusedElem:e,selectionRange:n},Qv=!1,pt=t;pt!==null;)if(t=pt,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,pt=e;else for(;pt!==null;){t=pt;try{var g=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var v=g.memoizedProps,y=g.memoizedState,x=t.stateNode,w=x.getSnapshotBeforeUpdate(t.elementType===t.type?v:Ks(t.type,v),y);x.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ge(163))}}catch(_){nr(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,pt=e;break}pt=t.return}return g=NT,NT=!1,g}function Uf(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&e)===e){var i=s.destroy;s.destroy=void 0,i!==void 0&&z_(t,n,i)}s=s.next}while(s!==r)}}function Yx(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function W_(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function D$(e){var t=e.alternate;t!==null&&(e.alternate=null,D$(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[Ci],delete t[hm],delete t[E_],delete t[lK],delete t[cK])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function L$(e){return e.tag===5||e.tag===3||e.tag===4}function CT(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||L$(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function q_(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=ty));else if(r!==4&&(e=e.child,e!==null))for(q_(e,t,n),e=e.sibling;e!==null;)q_(e,t,n),e=e.sibling}function H_(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(H_(e,t,n),e=e.sibling;e!==null;)H_(e,t,n),e=e.sibling}var zr=null,Js=!1;function Vo(e,t,n){for(n=n.child;n!==null;)$$(e,t,n),n=n.sibling}function $$(e,t,n){if(Li&&typeof Li.onCommitFiberUnmount=="function")try{Li.onCommitFiberUnmount(Bx,n)}catch{}switch(n.tag){case 5:aa||ad(n,t);case 6:var r=zr,s=Js;zr=null,Vo(e,t,n),zr=r,Js=s,zr!==null&&(Js?(e=zr,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):zr.removeChild(n.stateNode));break;case 18:zr!==null&&(Js?(e=zr,n=n.stateNode,e.nodeType===8?fw(e.parentNode,n):e.nodeType===1&&fw(e,n),om(e)):fw(zr,n.stateNode));break;case 4:r=zr,s=Js,zr=n.stateNode.containerInfo,Js=!0,Vo(e,t,n),zr=r,Js=s;break;case 0:case 11:case 14:case 15:if(!aa&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&z_(n,t,o),s=s.next}while(s!==r)}Vo(e,t,n);break;case 1:if(!aa&&(ad(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){nr(n,t,l)}Vo(e,t,n);break;case 21:Vo(e,t,n);break;case 22:n.mode&1?(aa=(r=aa)||n.memoizedState!==null,Vo(e,t,n),aa=r):Vo(e,t,n);break;default:Vo(e,t,n)}}function AT(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new SK),t.forEach(function(r){var s=MK.bind(null,e,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Bs(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=e,o=t,l=o;e:for(;l!==null;){switch(l.tag){case 5:zr=l.stateNode,Js=!1;break e;case 3:zr=l.stateNode.containerInfo,Js=!0;break e;case 4:zr=l.stateNode.containerInfo,Js=!0;break e}l=l.return}if(zr===null)throw Error(Ge(160));$$(i,o,s),zr=null,Js=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){nr(s,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)F$(t,e),t=t.sibling}function F$(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Bs(t,e),bi(e),r&4){try{Uf(3,e,e.return),Yx(3,e)}catch(v){nr(e,e.return,v)}try{Uf(5,e,e.return)}catch(v){nr(e,e.return,v)}}break;case 1:Bs(t,e),bi(e),r&512&&n!==null&&ad(n,n.return);break;case 5:if(Bs(t,e),bi(e),r&512&&n!==null&&ad(n,n.return),e.flags&32){var s=e.stateNode;try{rm(s,"")}catch(v){nr(e,e.return,v)}}if(r&4&&(s=e.stateNode,s!=null)){var i=e.memoizedProps,o=n!==null?n.memoizedProps:i,l=e.type,c=e.updateQueue;if(e.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&oL(s,i),p_(l,o);var u=p_(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?hL(s,h):d==="dangerouslySetInnerHTML"?uL(s,h):d==="children"?rm(s,h):OS(s,d,h,u)}switch(l){case"input":u_(s,i);break;case"textarea":lL(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?ud(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?ud(s,!!i.multiple,i.defaultValue,!0):ud(s,!!i.multiple,i.multiple?[]:"",!1))}s[hm]=i}catch(v){nr(e,e.return,v)}}break;case 6:if(Bs(t,e),bi(e),r&4){if(e.stateNode===null)throw Error(Ge(162));s=e.stateNode,i=e.memoizedProps;try{s.nodeValue=i}catch(v){nr(e,e.return,v)}}break;case 3:if(Bs(t,e),bi(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{om(t.containerInfo)}catch(v){nr(e,e.return,v)}break;case 4:Bs(t,e),bi(e);break;case 13:Bs(t,e),bi(e),s=e.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(dN=lr())),r&4&&AT(e);break;case 22:if(d=n!==null&&n.memoizedState!==null,e.mode&1?(aa=(u=aa)||d,Bs(t,e),aa=u):Bs(t,e),bi(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!d&&e.mode&1)for(pt=e,d=e.child;d!==null;){for(h=pt=d;pt!==null;){switch(f=pt,m=f.child,f.tag){case 0:case 11:case 14:case 15:Uf(4,f,f.return);break;case 1:ad(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){r=f,n=f.return;try{t=r,g.props=t.memoizedProps,g.state=t.memoizedState,g.componentWillUnmount()}catch(v){nr(r,n,v)}}break;case 5:ad(f,f.return);break;case 22:if(f.memoizedState!==null){TT(h);continue}}m!==null?(m.return=f,pt=m):TT(h)}d=d.sibling}e:for(d=null,h=e;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=dL("display",o))}catch(v){nr(e,e.return,v)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(v){nr(e,e.return,v)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Bs(t,e),bi(e),r&4&&AT(e);break;case 21:break;default:Bs(t,e),bi(e)}}function bi(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(L$(n)){var r=n;break e}n=n.return}throw Error(Ge(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(rm(s,""),r.flags&=-33);var i=CT(e);H_(e,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=CT(e);q_(e,l,o);break;default:throw Error(Ge(161))}}catch(c){nr(e,e.return,c)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function CK(e,t,n){pt=e,U$(e)}function U$(e,t,n){for(var r=(e.mode&1)!==0;pt!==null;){var s=pt,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Og;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||aa;l=Og;var u=aa;if(Og=o,(aa=c)&&!u)for(pt=s;pt!==null;)o=pt,c=o.child,o.tag===22&&o.memoizedState!==null?PT(s):c!==null?(c.return=o,pt=c):PT(s);for(;i!==null;)pt=i,U$(i),i=i.sibling;pt=s,Og=l,aa=u}ET(e)}else s.subtreeFlags&8772&&i!==null?(i.return=s,pt=i):ET(e)}}function ET(e){for(;pt!==null;){var t=pt;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:aa||Yx(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!aa)if(n===null)r.componentDidMount();else{var s=t.elementType===t.type?n.memoizedProps:Ks(t.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=t.updateQueue;i!==null&&fT(t,i,r);break;case 3:var o=t.updateQueue;if(o!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}fT(t,o,n)}break;case 5:var l=t.stateNode;if(n===null&&t.flags&4){n=l;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&om(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ge(163))}aa||t.flags&512&&W_(t)}catch(f){nr(t,t.return,f)}}if(t===e){pt=null;break}if(n=t.sibling,n!==null){n.return=t.return,pt=n;break}pt=t.return}}function TT(e){for(;pt!==null;){var t=pt;if(t===e){pt=null;break}var n=t.sibling;if(n!==null){n.return=t.return,pt=n;break}pt=t.return}}function PT(e){for(;pt!==null;){var t=pt;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Yx(4,t)}catch(c){nr(t,n,c)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var s=t.return;try{r.componentDidMount()}catch(c){nr(t,s,c)}}var i=t.return;try{W_(t)}catch(c){nr(t,i,c)}break;case 5:var o=t.return;try{W_(t)}catch(c){nr(t,o,c)}}}catch(c){nr(t,t.return,c)}if(t===e){pt=null;break}var l=t.sibling;if(l!==null){l.return=t.return,pt=l;break}pt=t.return}}var AK=Math.ceil,hy=Lo.ReactCurrentDispatcher,cN=Lo.ReactCurrentOwner,Es=Lo.ReactCurrentBatchConfig,sn=0,Rr=null,fr=null,Vr=0,ns=0,sd=ql(0),kr=0,ym=null,Wc=0,Xx=0,uN=0,Bf=null,Oa=null,dN=0,Bd=1/0,ao=null,fy=!1,K_=null,Cl=null,Ig=!1,xl=null,my=0,zf=0,V_=null,Ev=-1,Tv=0;function _a(){return sn&6?lr():Ev!==-1?Ev:Ev=lr()}function Al(e){return e.mode&1?sn&2&&Vr!==0?Vr&-Vr:dK.transition!==null?(Tv===0&&(Tv=kL()),Tv):(e=jn,e!==0||(e=window.event,e=e===void 0?16:PL(e.type)),e):1}function ii(e,t,n,r){if(50<zf)throw zf=0,V_=null,Error(Ge(185));Cp(e,n,r),(!(sn&2)||e!==Rr)&&(e===Rr&&(!(sn&2)&&(Xx|=n),kr===4&&ll(e,Vr)),Wa(e,r),n===1&&sn===0&&!(t.mode&1)&&(Bd=lr()+500,Kx&&Hl()))}function Wa(e,t){var n=e.callbackNode;d7(e,t);var r=Jv(e,e===Rr?Vr:0);if(r===0)n!==null&&UE(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&UE(n),t===1)e.tag===0?uK(OT.bind(null,e)):XL(OT.bind(null,e)),iK(function(){!(sn&6)&&Hl()}),n=null;else{switch(SL(r)){case 1:n=LS;break;case 4:n=jL;break;case 16:n=Xv;break;case 536870912:n=_L;break;default:n=Xv}n=G$(n,B$.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function B$(e,t){if(Ev=-1,Tv=0,sn&6)throw Error(Ge(327));var n=e.callbackNode;if(pd()&&e.callbackNode!==n)return null;var r=Jv(e,e===Rr?Vr:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=py(e,r);else{t=r;var s=sn;sn|=2;var i=W$();(Rr!==e||Vr!==t)&&(ao=null,Bd=lr()+500,Mc(e,t));do try{PK();break}catch(l){z$(e,l)}while(!0);XS(),hy.current=i,sn=s,fr!==null?t=0:(Rr=null,Vr=0,t=kr)}if(t!==0){if(t===2&&(s=b_(e),s!==0&&(r=s,t=G_(e,s))),t===1)throw n=ym,Mc(e,0),ll(e,r),Wa(e,lr()),n;if(t===6)ll(e,r);else{if(s=e.current.alternate,!(r&30)&&!EK(s)&&(t=py(e,r),t===2&&(i=b_(e),i!==0&&(r=i,t=G_(e,i))),t===1))throw n=ym,Mc(e,0),ll(e,r),Wa(e,lr()),n;switch(e.finishedWork=s,e.finishedLanes=r,t){case 0:case 1:throw Error(Ge(345));case 2:uc(e,Oa,ao);break;case 3:if(ll(e,r),(r&130023424)===r&&(t=dN+500-lr(),10<t)){if(Jv(e,0)!==0)break;if(s=e.suspendedLanes,(s&r)!==r){_a(),e.pingedLanes|=e.suspendedLanes&s;break}e.timeoutHandle=A_(uc.bind(null,e,Oa,ao),t);break}uc(e,Oa,ao);break;case 4:if(ll(e,r),(r&4194240)===r)break;for(t=e.eventTimes,s=-1;0<r;){var o=31-si(r);i=1<<o,o=t[o],o>s&&(s=o),r&=~i}if(r=s,r=lr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*AK(r/1960))-r,10<r){e.timeoutHandle=A_(uc.bind(null,e,Oa,ao),r);break}uc(e,Oa,ao);break;case 5:uc(e,Oa,ao);break;default:throw Error(Ge(329))}}}return Wa(e,lr()),e.callbackNode===n?B$.bind(null,e):null}function G_(e,t){var n=Bf;return e.current.memoizedState.isDehydrated&&(Mc(e,t).flags|=256),e=py(e,t),e!==2&&(t=Oa,Oa=n,t!==null&&Y_(t)),e}function Y_(e){Oa===null?Oa=e:Oa.push.apply(Oa,e)}function EK(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!ui(i(),s))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ll(e,t){for(t&=~uN,t&=~Xx,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-si(t),r=1<<n;e[n]=-1,t&=~r}}function OT(e){if(sn&6)throw Error(Ge(327));pd();var t=Jv(e,0);if(!(t&1))return Wa(e,lr()),null;var n=py(e,t);if(e.tag!==0&&n===2){var r=b_(e);r!==0&&(t=r,n=G_(e,r))}if(n===1)throw n=ym,Mc(e,0),ll(e,t),Wa(e,lr()),n;if(n===6)throw Error(Ge(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,uc(e,Oa,ao),Wa(e,lr()),null}function hN(e,t){var n=sn;sn|=1;try{return e(t)}finally{sn=n,sn===0&&(Bd=lr()+500,Kx&&Hl())}}function qc(e){xl!==null&&xl.tag===0&&!(sn&6)&&pd();var t=sn;sn|=1;var n=Es.transition,r=jn;try{if(Es.transition=null,jn=1,e)return e()}finally{jn=r,Es.transition=n,sn=t,!(sn&6)&&Hl()}}function fN(){ns=sd.current,Wn(sd)}function Mc(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,sK(n)),fr!==null)for(n=fr.return;n!==null;){var r=n;switch(VS(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&ny();break;case 3:Fd(),Wn(Ba),Wn(la),nN();break;case 5:tN(r);break;case 4:Fd();break;case 13:Wn(Yn);break;case 19:Wn(Yn);break;case 10:JS(r.type._context);break;case 22:case 23:fN()}n=n.return}if(Rr=e,fr=e=El(e.current,null),Vr=ns=t,kr=0,ym=null,uN=Xx=Wc=0,Oa=Bf=null,_c!==null){for(t=0;t<_c.length;t++)if(n=_c[t],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}_c=null}return e}function z$(e,t){do{var n=fr;try{if(XS(),Nv.current=dy,uy){for(var r=Xn.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}uy=!1}if(zc=0,Or=jr=Xn=null,Ff=!1,pm=0,cN.current=null,n===null||n.return===null){kr=1,ym=t,fr=null;break}e:{var i=e,o=n.return,l=n,c=t;if(t=Vr,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=xT(o);if(m!==null){m.flags&=-257,bT(m,o,l,i,t),m.mode&1&&yT(i,u,t),t=m,c=u;var g=t.updateQueue;if(g===null){var v=new Set;v.add(c),t.updateQueue=v}else g.add(c);break e}else{if(!(t&1)){yT(i,u,t),mN();break e}c=Error(Ge(426))}}else if(Hn&&l.mode&1){var y=xT(o);if(y!==null){!(y.flags&65536)&&(y.flags|=256),bT(y,o,l,i,t),GS(Ud(c,l));break e}}i=c=Ud(c,l),kr!==4&&(kr=2),Bf===null?Bf=[i]:Bf.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,t&=-t,i.lanes|=t;var x=S$(i,c,t);hT(i,x);break e;case 1:l=c;var w=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof w.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Cl===null||!Cl.has(b)))){i.flags|=65536,t&=-t,i.lanes|=t;var _=N$(i,l,t);hT(i,_);break e}}i=i.return}while(i!==null)}H$(n)}catch(k){t=k,fr===n&&n!==null&&(fr=n=n.return);continue}break}while(!0)}function W$(){var e=hy.current;return hy.current=dy,e===null?dy:e}function mN(){(kr===0||kr===3||kr===2)&&(kr=4),Rr===null||!(Wc&268435455)&&!(Xx&268435455)||ll(Rr,Vr)}function py(e,t){var n=sn;sn|=2;var r=W$();(Rr!==e||Vr!==t)&&(ao=null,Mc(e,t));do try{TK();break}catch(s){z$(e,s)}while(!0);if(XS(),sn=n,hy.current=r,fr!==null)throw Error(Ge(261));return Rr=null,Vr=0,kr}function TK(){for(;fr!==null;)q$(fr)}function PK(){for(;fr!==null&&!n7();)q$(fr)}function q$(e){var t=V$(e.alternate,e,ns);e.memoizedProps=e.pendingProps,t===null?H$(e):fr=t,cN.current=null}function H$(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=kK(n,t),n!==null){n.flags&=32767,fr=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{kr=6,fr=null;return}}else if(n=_K(n,t,ns),n!==null){fr=n;return}if(t=t.sibling,t!==null){fr=t;return}fr=t=e}while(t!==null);kr===0&&(kr=5)}function uc(e,t,n){var r=jn,s=Es.transition;try{Es.transition=null,jn=1,OK(e,t,n,r)}finally{Es.transition=s,jn=r}return null}function OK(e,t,n,r){do pd();while(xl!==null);if(sn&6)throw Error(Ge(327));n=e.finishedWork;var s=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(Ge(177));e.callbackNode=null,e.callbackPriority=0;var i=n.lanes|n.childLanes;if(h7(e,i),e===Rr&&(fr=Rr=null,Vr=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ig||(Ig=!0,G$(Xv,function(){return pd(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=Es.transition,Es.transition=null;var o=jn;jn=1;var l=sn;sn|=4,cN.current=null,NK(e,n),F$(n,e),Q7(N_),Qv=!!S_,N_=S_=null,e.current=n,CK(n),r7(),sn=l,jn=o,Es.transition=i}else e.current=n;if(Ig&&(Ig=!1,xl=e,my=s),i=e.pendingLanes,i===0&&(Cl=null),i7(n.stateNode),Wa(e,lr()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)s=t[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(fy)throw fy=!1,e=K_,K_=null,e;return my&1&&e.tag!==0&&pd(),i=e.pendingLanes,i&1?e===V_?zf++:(zf=0,V_=e):zf=0,Hl(),null}function pd(){if(xl!==null){var e=SL(my),t=Es.transition,n=jn;try{if(Es.transition=null,jn=16>e?16:e,xl===null)var r=!1;else{if(e=xl,xl=null,my=0,sn&6)throw Error(Ge(331));var s=sn;for(sn|=4,pt=e.current;pt!==null;){var i=pt,o=i.child;if(pt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(pt=u;pt!==null;){var d=pt;switch(d.tag){case 0:case 11:case 15:Uf(8,d,i)}var h=d.child;if(h!==null)h.return=d,pt=h;else for(;pt!==null;){d=pt;var f=d.sibling,m=d.return;if(D$(d),d===u){pt=null;break}if(f!==null){f.return=m,pt=f;break}pt=m}}}var g=i.alternate;if(g!==null){var v=g.child;if(v!==null){g.child=null;do{var y=v.sibling;v.sibling=null,v=y}while(v!==null)}}pt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,pt=o;else e:for(;pt!==null;){if(i=pt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Uf(9,i,i.return)}var x=i.sibling;if(x!==null){x.return=i.return,pt=x;break e}pt=i.return}}var w=e.current;for(pt=w;pt!==null;){o=pt;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,pt=b;else e:for(o=w;pt!==null;){if(l=pt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Yx(9,l)}}catch(k){nr(l,l.return,k)}if(l===o){pt=null;break e}var _=l.sibling;if(_!==null){_.return=l.return,pt=_;break e}pt=l.return}}if(sn=s,Hl(),Li&&typeof Li.onPostCommitFiberRoot=="function")try{Li.onPostCommitFiberRoot(Bx,e)}catch{}r=!0}return r}finally{jn=n,Es.transition=t}}return!1}function IT(e,t,n){t=Ud(n,t),t=S$(e,t,1),e=Nl(e,t,1),t=_a(),e!==null&&(Cp(e,1,t),Wa(e,t))}function nr(e,t,n){if(e.tag===3)IT(e,e,n);else for(;t!==null;){if(t.tag===3){IT(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Cl===null||!Cl.has(r))){e=Ud(n,e),e=N$(t,e,1),t=Nl(t,e,1),e=_a(),t!==null&&(Cp(t,1,e),Wa(t,e));break}}t=t.return}}function IK(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=_a(),e.pingedLanes|=e.suspendedLanes&n,Rr===e&&(Vr&n)===n&&(kr===4||kr===3&&(Vr&130023424)===Vr&&500>lr()-dN?Mc(e,0):uN|=n),Wa(e,t)}function K$(e,t){t===0&&(e.mode&1?(t=_g,_g<<=1,!(_g&130023424)&&(_g=4194304)):t=1);var n=_a();e=Co(e,t),e!==null&&(Cp(e,t,n),Wa(e,n))}function RK(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),K$(e,n)}function MK(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,s=e.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(Ge(314))}r!==null&&r.delete(t),K$(e,n)}var V$;V$=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Ba.current)$a=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return $a=!1,jK(e,t,n);$a=!!(e.flags&131072)}else $a=!1,Hn&&t.flags&1048576&&JL(t,sy,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Av(e,t),e=t.pendingProps;var s=Dd(t,la.current);md(t,n),s=aN(null,t,r,e,s,n);var i=sN();return t.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,za(r)?(i=!0,ry(t)):i=!1,t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,ZS(t),s.updater=Gx,t.stateNode=s,s._reactInternals=t,M_(t,r,e,n),t=$_(null,t,r,!0,i,n)):(t.tag=0,Hn&&i&&KS(t),va(null,t,s,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Av(e,t),e=t.pendingProps,s=r._init,r=s(r._payload),t.type=r,s=t.tag=LK(r),e=Ks(r,e),s){case 0:t=L_(null,t,r,e,n);break e;case 1:t=_T(null,t,r,e,n);break e;case 11:t=wT(null,t,r,e,n);break e;case 14:t=jT(null,t,r,Ks(r.type,e),n);break e}throw Error(Ge(306,r,""))}return t;case 0:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ks(r,s),L_(e,t,r,s,n);case 1:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ks(r,s),_T(e,t,r,s,n);case 3:e:{if(T$(t),e===null)throw Error(Ge(387));r=t.pendingProps,i=t.memoizedState,s=i.element,r$(e,t),ly(t,r,null,n);var o=t.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},t.updateQueue.baseState=i,t.memoizedState=i,t.flags&256){s=Ud(Error(Ge(423)),t),t=kT(e,t,r,n,s);break e}else if(r!==s){s=Ud(Error(Ge(424)),t),t=kT(e,t,r,n,s);break e}else for(is=Sl(t.stateNode.containerInfo.firstChild),os=t,Hn=!0,ei=null,n=t$(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ld(),r===s){t=Ao(e,t,n);break e}va(e,t,r,n)}t=t.child}return t;case 5:return a$(t),e===null&&O_(t),r=t.type,s=t.pendingProps,i=e!==null?e.memoizedProps:null,o=s.children,C_(r,s)?o=null:i!==null&&C_(r,i)&&(t.flags|=32),E$(e,t),va(e,t,o,n),t.child;case 6:return e===null&&O_(t),null;case 13:return P$(e,t,n);case 4:return eN(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=$d(t,null,r,n):va(e,t,r,n),t.child;case 11:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ks(r,s),wT(e,t,r,s,n);case 7:return va(e,t,t.pendingProps,n),t.child;case 8:return va(e,t,t.pendingProps.children,n),t.child;case 12:return va(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,s=t.pendingProps,i=t.memoizedProps,o=s.value,Mn(iy,r._currentValue),r._currentValue=o,i!==null)if(ui(i.value,o)){if(i.children===s.children&&!Ba.current){t=Ao(e,t,n);break e}}else for(i=t.child,i!==null&&(i.return=t);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=yo(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),I_(i.return,n,t),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===t.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Ge(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),I_(o,n,t),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===t){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}va(e,t,s.children,n),t=t.child}return t;case 9:return s=t.type,r=t.pendingProps.children,md(t,n),s=Is(s),r=r(s),t.flags|=1,va(e,t,r,n),t.child;case 14:return r=t.type,s=Ks(r,t.pendingProps),s=Ks(r.type,s),jT(e,t,r,s,n);case 15:return C$(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,s=t.pendingProps,s=t.elementType===r?s:Ks(r,s),Av(e,t),t.tag=1,za(r)?(e=!0,ry(t)):e=!1,md(t,n),k$(t,r,s),M_(t,r,s,n),$_(null,t,r,!0,e,n);case 19:return O$(e,t,n);case 22:return A$(e,t,n)}throw Error(Ge(156,t.tag))};function G$(e,t){return wL(e,t)}function DK(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Cs(e,t,n,r){return new DK(e,t,n,r)}function pN(e){return e=e.prototype,!(!e||!e.isReactComponent)}function LK(e){if(typeof e=="function")return pN(e)?1:0;if(e!=null){if(e=e.$$typeof,e===RS)return 11;if(e===MS)return 14}return 2}function El(e,t){var n=e.alternate;return n===null?(n=Cs(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Pv(e,t,n,r,s,i){var o=2;if(r=e,typeof e=="function")pN(e)&&(o=1);else if(typeof e=="string")o=5;else e:switch(e){case Yu:return Dc(n.children,s,i,t);case IS:o=8,s|=8;break;case s_:return e=Cs(12,n,t,s|2),e.elementType=s_,e.lanes=i,e;case i_:return e=Cs(13,n,t,s),e.elementType=i_,e.lanes=i,e;case o_:return e=Cs(19,n,t,s),e.elementType=o_,e.lanes=i,e;case aL:return Jx(n,s,i,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case nL:o=10;break e;case rL:o=9;break e;case RS:o=11;break e;case MS:o=14;break e;case al:o=16,r=null;break e}throw Error(Ge(130,e==null?e:typeof e,""))}return t=Cs(o,n,t,s),t.elementType=e,t.type=r,t.lanes=i,t}function Dc(e,t,n,r){return e=Cs(7,e,r,t),e.lanes=n,e}function Jx(e,t,n,r){return e=Cs(22,e,r,t),e.elementType=aL,e.lanes=n,e.stateNode={isHidden:!1},e}function ww(e,t,n){return e=Cs(6,e,null,t),e.lanes=n,e}function jw(e,t,n){return t=Cs(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function $K(e,t,n,r,s){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nw(0),this.expirationTimes=nw(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nw(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function gN(e,t,n,r,s,i,o,l,c){return e=new $K(e,t,n,l,c),t===1?(t=1,i===!0&&(t|=8)):t=0,i=Cs(3,null,null,t),e.current=i,i.stateNode=e,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ZS(i),e}function FK(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Gu,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function Y$(e){if(!e)return Ml;e=e._reactInternals;e:{if(lu(e)!==e||e.tag!==1)throw Error(Ge(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(za(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(Ge(171))}if(e.tag===1){var n=e.type;if(za(n))return YL(e,n,t)}return t}function X$(e,t,n,r,s,i,o,l,c){return e=gN(n,r,!0,e,s,i,o,l,c),e.context=Y$(null),n=e.current,r=_a(),s=Al(n),i=yo(r,s),i.callback=t??null,Nl(n,i,s),e.current.lanes=s,Cp(e,s,r),Wa(e,r),e}function Qx(e,t,n,r){var s=t.current,i=_a(),o=Al(s);return n=Y$(n),t.context===null?t.context=n:t.pendingContext=n,t=yo(i,o),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=Nl(s,t,o),e!==null&&(ii(e,s,o,i),Sv(e,s,o)),o}function gy(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function RT(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function vN(e,t){RT(e,t),(e=e.alternate)&&RT(e,t)}function UK(){return null}var J$=typeof reportError=="function"?reportError:function(e){console.error(e)};function yN(e){this._internalRoot=e}Zx.prototype.render=yN.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(Ge(409));Qx(e,t,null,null)};Zx.prototype.unmount=yN.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;qc(function(){Qx(null,e,null,null)}),t[No]=null}};function Zx(e){this._internalRoot=e}Zx.prototype.unstable_scheduleHydration=function(e){if(e){var t=AL();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ol.length&&t!==0&&t<ol[n].priority;n++);ol.splice(n,0,e),n===0&&TL(e)}};function xN(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function eb(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function MT(){}function BK(e,t,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=gy(o);i.call(u)}}var o=X$(t,r,e,0,null,!1,!1,"",MT);return e._reactRootContainer=o,e[No]=o.current,um(e.nodeType===8?e.parentNode:e),qc(),o}for(;s=e.lastChild;)e.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=gy(c);l.call(u)}}var c=gN(e,0,!1,null,null,!1,!1,"",MT);return e._reactRootContainer=c,e[No]=c.current,um(e.nodeType===8?e.parentNode:e),qc(function(){Qx(t,c,n,r)}),c}function tb(e,t,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=gy(o);l.call(c)}}Qx(t,o,e,s)}else o=BK(n,t,e,s,r);return gy(o)}NL=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=Cf(t.pendingLanes);n!==0&&($S(t,n|1),Wa(t,lr()),!(sn&6)&&(Bd=lr()+500,Hl()))}break;case 13:qc(function(){var r=Co(e,1);if(r!==null){var s=_a();ii(r,e,1,s)}}),vN(e,1)}};FS=function(e){if(e.tag===13){var t=Co(e,134217728);if(t!==null){var n=_a();ii(t,e,134217728,n)}vN(e,134217728)}};CL=function(e){if(e.tag===13){var t=Al(e),n=Co(e,t);if(n!==null){var r=_a();ii(n,e,t,r)}vN(e,t)}};AL=function(){return jn};EL=function(e,t){var n=jn;try{return jn=e,t()}finally{jn=n}};v_=function(e,t,n){switch(t){case"input":if(u_(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var s=Hx(r);if(!s)throw Error(Ge(90));iL(r),u_(r,s)}}}break;case"textarea":lL(e,n);break;case"select":t=n.value,t!=null&&ud(e,!!n.multiple,t,!1)}};pL=hN;gL=qc;var zK={usingClientEntryPoint:!1,Events:[Ep,Zu,Hx,fL,mL,hN]},rf={findFiberByHostInstance:jc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},WK={bundleType:rf.bundleType,version:rf.version,rendererPackageName:rf.rendererPackageName,rendererConfig:rf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Lo.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=xL(e),e===null?null:e.stateNode},findFiberByHostInstance:rf.findFiberByHostInstance||UK,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Rg=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Rg.isDisabled&&Rg.supportsFiber)try{Bx=Rg.inject(WK),Li=Rg}catch{}}ds.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=zK;ds.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xN(t))throw Error(Ge(200));return FK(e,t,null,n)};ds.createRoot=function(e,t){if(!xN(e))throw Error(Ge(299));var n=!1,r="",s=J$;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),t=gN(e,1,!1,null,null,n,!1,r,s),e[No]=t.current,um(e.nodeType===8?e.parentNode:e),new yN(t)};ds.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(Ge(188)):(e=Object.keys(e).join(","),Error(Ge(268,e)));return e=xL(t),e=e===null?null:e.stateNode,e};ds.flushSync=function(e){return qc(e)};ds.hydrate=function(e,t,n){if(!eb(t))throw Error(Ge(200));return tb(null,e,t,!0,n)};ds.hydrateRoot=function(e,t,n){if(!xN(e))throw Error(Ge(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=J$;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),t=X$(t,null,e,1,n??null,s,!1,i,o),e[No]=t.current,um(e),r)for(e=0;e<r.length;e++)n=r[e],s=n._getVersion,s=s(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,s]:t.mutableSourceEagerHydrationData.push(n,s);return new Zx(t)};ds.render=function(e,t,n){if(!eb(t))throw Error(Ge(200));return tb(null,e,t,!1,n)};ds.unmountComponentAtNode=function(e){if(!eb(e))throw Error(Ge(40));return e._reactRootContainer?(qc(function(){tb(null,null,e,!1,function(){e._reactRootContainer=null,e[No]=null})}),!0):!1};ds.unstable_batchedUpdates=hN;ds.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!eb(n))throw Error(Ge(200));if(e==null||e._reactInternals===void 0)throw Error(Ge(38));return tb(e,t,n,!1,r)};ds.version="18.3.1-next-f1338f8080-20240426";function Q$(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Q$)}catch(e){console.error(e)}}Q$(),QD.exports=ds;var cu=QD.exports;const Z$=bn(cu);var e4,DT=cu;e4=DT.createRoot,DT.hydrateRoot;const qK=1,HK=1e6;let _w=0;function KK(){return _w=(_w+1)%Number.MAX_SAFE_INTEGER,_w.toString()}const kw=new Map,LT=e=>{if(kw.has(e))return;const t=setTimeout(()=>{kw.delete(e),Wf({type:"REMOVE_TOAST",toastId:e})},HK);kw.set(e,t)},VK=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,qK)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(n=>n.id===t.toast.id?{...n,...t.toast}:n)};case"DISMISS_TOAST":{const{toastId:n}=t;return n?LT(n):e.toasts.forEach(r=>{LT(r.id)}),{...e,toasts:e.toasts.map(r=>r.id===n||n===void 0?{...r,open:!1}:r)}}case"REMOVE_TOAST":return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(n=>n.id!==t.toastId)}}},Ov=[];let Iv={toasts:[]};function Wf(e){Iv=VK(Iv,e),Ov.forEach(t=>{t(Iv)})}function GK({...e}){const t=KK(),n=s=>Wf({type:"UPDATE_TOAST",toast:{...s,id:t}}),r=()=>Wf({type:"DISMISS_TOAST",toastId:t});return Wf({type:"ADD_TOAST",toast:{...e,id:t,open:!0,onOpenChange:s=>{s||r()}}}),{id:t,dismiss:r,update:n}}function uu(){const[e,t]=p.useState(Iv);return p.useEffect(()=>(Ov.push(t),()=>{const n=Ov.indexOf(t);n>-1&&Ov.splice(n,1)}),[e]),{...e,toast:GK,dismiss:n=>Wf({type:"DISMISS_TOAST",toastId:n})}}function Ve(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function $T(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Eo(...e){return t=>{let n=!1;const r=e.map(s=>{const i=$T(s,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():$T(e[s],null)}}}}function Ot(...e){return p.useCallback(Eo(...e),e)}function YK(e,t){const n=p.createContext(t),r=i=>{const{children:o,...l}=i,c=p.useMemo(()=>l,Object.values(l));return a.jsx(n.Provider,{value:c,children:o})};r.displayName=e+"Provider";function s(i){const o=p.useContext(n);if(o)return o;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[r,s]}function Mr(e,t=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];const u=h=>{var x;const{scope:f,children:m,...g}=h,v=((x=f==null?void 0:f[e])==null?void 0:x[c])||l,y=p.useMemo(()=>g,Object.values(g));return a.jsx(v.Provider,{value:y,children:m})};u.displayName=i+"Provider";function d(h,f){var v;const m=((v=f==null?void 0:f[e])==null?void 0:v[c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[e])||i;return p.useMemo(()=>({[`__scope${e}`]:{...l,[e]:c}}),[l,c])}};return s.scopeName=e,[r,XK(s,...t)]}function XK(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${t.scopeName}`]:o}),[o])}};return n.scopeName=t.scopeName,n}function Dl(e){const t=JK(e),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(QK);if(c){const u=c.props.children,d=l.map(h=>h===c?p.Children.count(u)>1?p.Children.only(null):p.isValidElement(u)?u.props.children:null:h);return a.jsx(t,{...o,ref:s,children:p.isValidElement(u)?p.cloneElement(u,void 0,d):null})}return a.jsx(t,{...o,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}var bN=Dl("Slot");function JK(e){const t=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=eV(s),l=ZK(i,s.props);return s.type!==p.Fragment&&(l.ref=r?Eo(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var t4=Symbol("radix.slottable");function n4(e){const t=({children:n})=>a.jsx(a.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=t4,t}function QK(e){return p.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===t4}function ZK(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function eV(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function Pp(e){const t=e+"CollectionProvider",[n,r]=Mr(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),o=v=>{const{scope:y,children:x}=v,w=G.useRef(null),b=G.useRef(new Map).current;return a.jsx(s,{scope:y,itemMap:b,collectionRef:w,children:x})};o.displayName=t;const l=e+"CollectionSlot",c=Dl(l),u=G.forwardRef((v,y)=>{const{scope:x,children:w}=v,b=i(l,x),_=Ot(y,b.collectionRef);return a.jsx(c,{ref:_,children:w})});u.displayName=l;const d=e+"CollectionItemSlot",h="data-radix-collection-item",f=Dl(d),m=G.forwardRef((v,y)=>{const{scope:x,children:w,...b}=v,_=G.useRef(null),k=Ot(y,_),j=i(d,x);return G.useEffect(()=>(j.itemMap.set(_,{ref:_,...b}),()=>void j.itemMap.delete(_))),a.jsx(f,{[h]:"",ref:k,children:w})});m.displayName=d;function g(v){const y=i(e+"CollectionConsumer",v);return G.useCallback(()=>{const w=y.collectionRef.current;if(!w)return[];const b=Array.from(w.querySelectorAll(`[${h}]`));return Array.from(y.itemMap.values()).sort((j,S)=>b.indexOf(j.ref.current)-b.indexOf(S.ref.current))},[y.collectionRef,y.itemMap])}return[{Provider:o,Slot:u,ItemSlot:m},g,r]}var tV=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ot=tV.reduce((e,t)=>{const n=Dl(`Primitive.${t}`),r=p.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function wN(e,t){e&&cu.flushSync(()=>e.dispatchEvent(t))}function ar(e){const t=p.useRef(e);return p.useEffect(()=>{t.current=e}),p.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function nV(e,t=globalThis==null?void 0:globalThis.document){const n=ar(e);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var rV="DismissableLayer",X_="dismissableLayer.update",aV="dismissableLayer.pointerDownOutside",sV="dismissableLayer.focusOutside",FT,r4=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),du=p.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=e,u=p.useContext(r4),[d,h]=p.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=p.useState({}),g=Ot(t,S=>h(S)),v=Array.from(u.layers),[y]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),x=v.indexOf(y),w=d?v.indexOf(d):-1,b=u.layersWithOutsidePointerEventsDisabled.size>0,_=w>=x,k=oV(S=>{const T=S.target,O=[...u.branches].some(A=>A.contains(T));!_||O||(s==null||s(S),o==null||o(S),S.defaultPrevented||l==null||l())},f),j=lV(S=>{const T=S.target;[...u.branches].some(A=>A.contains(T))||(i==null||i(S),o==null||o(S),S.defaultPrevented||l==null||l())},f);return nV(S=>{w===u.layers.size-1&&(r==null||r(S),!S.defaultPrevented&&l&&(S.preventDefault(),l()))},f),p.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(FT=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),UT(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=FT)}},[d,f,n,u]),p.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),UT())},[d,u]),p.useEffect(()=>{const S=()=>m({});return document.addEventListener(X_,S),()=>document.removeEventListener(X_,S)},[]),a.jsx(ot.div,{...c,ref:g,style:{pointerEvents:b?_?"auto":"none":void 0,...e.style},onFocusCapture:Ve(e.onFocusCapture,j.onFocusCapture),onBlurCapture:Ve(e.onBlurCapture,j.onBlurCapture),onPointerDownCapture:Ve(e.onPointerDownCapture,k.onPointerDownCapture)})});du.displayName=rV;var iV="DismissableLayerBranch",a4=p.forwardRef((e,t)=>{const n=p.useContext(r4),r=p.useRef(null),s=Ot(t,r);return p.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),a.jsx(ot.div,{...e,ref:s})});a4.displayName=iV;function oV(e,t=globalThis==null?void 0:globalThis.document){const n=ar(e),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let c=function(){s4(aV,n,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=c,t.addEventListener("click",s.current,{once:!0})):c()}else t.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function lV(e,t=globalThis==null?void 0:globalThis.document){const n=ar(e),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&s4(sV,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function UT(){const e=new CustomEvent(X_);document.dispatchEvent(e)}function s4(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?wN(s,i):s.dispatchEvent(i)}var cV=du,uV=a4,sr=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},dV="Portal",Sh=p.forwardRef((e,t)=>{var l;const{container:n,...r}=e,[s,i]=p.useState(!1);sr(()=>i(!0),[]);const o=n||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?Z$.createPortal(a.jsx(ot.div,{...r,ref:t}),o):null});Sh.displayName=dV;function hV(e,t){return p.useReducer((n,r)=>t[n][r]??n,e)}var Cr=e=>{const{present:t,children:n}=e,r=fV(t),s=typeof n=="function"?n({present:r.isPresent}):p.Children.only(n),i=Ot(r.ref,mV(s));return typeof n=="function"||r.isPresent?p.cloneElement(s,{ref:i}):null};Cr.displayName="Presence";function fV(e){const[t,n]=p.useState(),r=p.useRef(null),s=p.useRef(e),i=p.useRef("none"),o=e?"mounted":"unmounted",[l,c]=hV(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const u=Mg(r.current);i.current=l==="mounted"?u:"none"},[l]),sr(()=>{const u=r.current,d=s.current;if(d!==e){const f=i.current,m=Mg(u);e?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,c]),sr(()=>{if(t){let u;const d=t.ownerDocument.defaultView??window,h=m=>{const v=Mg(r.current).includes(m.animationName);if(m.target===t&&v&&(c("ANIMATION_END"),!s.current)){const y=t.style.animationFillMode;t.style.animationFillMode="forwards",u=d.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=y)})}},f=m=>{m.target===t&&(i.current=Mg(r.current))};return t.addEventListener("animationstart",f),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{d.clearTimeout(u),t.removeEventListener("animationstart",f),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(u=>{r.current=u?getComputedStyle(u):null,n(u)},[])}}function Mg(e){return(e==null?void 0:e.animationName)||"none"}function mV(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var pV=ES[" useInsertionEffect ".trim().toString()]||sr;function Ha({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[s,i,o]=gV({defaultProp:t,onChange:n}),l=e!==void 0,c=l?e:s;{const d=p.useRef(e!==void 0);p.useEffect(()=>{const h=d.current;h!==l&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,r])}const u=p.useCallback(d=>{var h;if(l){const f=vV(d)?d(e):d;f!==e&&((h=o.current)==null||h.call(o,f))}else i(d)},[l,e,i,o]);return[c,u]}function gV({defaultProp:e,onChange:t}){const[n,r]=p.useState(e),s=p.useRef(n),i=p.useRef(t);return pV(()=>{i.current=t},[t]),p.useEffect(()=>{var o;s.current!==n&&((o=i.current)==null||o.call(i,n),s.current=n)},[n,s]),[n,r,i]}function vV(e){return typeof e=="function"}var i4=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),yV="VisuallyHidden",nb=p.forwardRef((e,t)=>a.jsx(ot.span,{...e,ref:t,style:{...i4,...e.style}}));nb.displayName=yV;var xV=nb,jN="ToastProvider",[_N,bV,wV]=Pp("Toast"),[o4,aUe]=Mr("Toast",[wV]),[jV,rb]=o4(jN),l4=e=>{const{__scopeToast:t,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=e,[l,c]=p.useState(null),[u,d]=p.useState(0),h=p.useRef(!1),f=p.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${jN}\`. Expected non-empty \`string\`.`),a.jsx(_N.Provider,{scope:t,children:a.jsx(jV,{scope:t,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>d(m=>m+1),[]),onToastRemove:p.useCallback(()=>d(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};l4.displayName=jN;var c4="ToastViewport",_V=["F8"],J_="toast.viewportPause",Q_="toast.viewportResume",u4=p.forwardRef((e,t)=>{const{__scopeToast:n,hotkey:r=_V,label:s="Notifications ({hotkey})",...i}=e,o=rb(c4,n),l=bV(n),c=p.useRef(null),u=p.useRef(null),d=p.useRef(null),h=p.useRef(null),f=Ot(t,h,o.onViewportChange),m=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;p.useEffect(()=>{const y=x=>{var b;r.length!==0&&r.every(_=>x[_]||x.code===_)&&((b=h.current)==null||b.focus())};return document.addEventListener("keydown",y),()=>document.removeEventListener("keydown",y)},[r]),p.useEffect(()=>{const y=c.current,x=h.current;if(g&&y&&x){const w=()=>{if(!o.isClosePausedRef.current){const j=new CustomEvent(J_);x.dispatchEvent(j),o.isClosePausedRef.current=!0}},b=()=>{if(o.isClosePausedRef.current){const j=new CustomEvent(Q_);x.dispatchEvent(j),o.isClosePausedRef.current=!1}},_=j=>{!y.contains(j.relatedTarget)&&b()},k=()=>{y.contains(document.activeElement)||b()};return y.addEventListener("focusin",w),y.addEventListener("focusout",_),y.addEventListener("pointermove",w),y.addEventListener("pointerleave",k),window.addEventListener("blur",w),window.addEventListener("focus",b),()=>{y.removeEventListener("focusin",w),y.removeEventListener("focusout",_),y.removeEventListener("pointermove",w),y.removeEventListener("pointerleave",k),window.removeEventListener("blur",w),window.removeEventListener("focus",b)}}},[g,o.isClosePausedRef]);const v=p.useCallback(({tabbingDirection:y})=>{const w=l().map(b=>{const _=b.ref.current,k=[_,...DV(_)];return y==="forwards"?k:k.reverse()});return(y==="forwards"?w.reverse():w).flat()},[l]);return p.useEffect(()=>{const y=h.current;if(y){const x=w=>{var k,j,S;const b=w.altKey||w.ctrlKey||w.metaKey;if(w.key==="Tab"&&!b){const T=document.activeElement,O=w.shiftKey;if(w.target===y&&O){(k=u.current)==null||k.focus();return}const L=v({tabbingDirection:O?"backwards":"forwards"}),M=L.findIndex(B=>B===T);Sw(L.slice(M+1))?w.preventDefault():O?(j=u.current)==null||j.focus():(S=d.current)==null||S.focus()}};return y.addEventListener("keydown",x),()=>y.removeEventListener("keydown",x)}},[l,v]),a.jsxs(uV,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&a.jsx(Z_,{ref:u,onFocusFromOutsideViewport:()=>{const y=v({tabbingDirection:"forwards"});Sw(y)}}),a.jsx(_N.Slot,{scope:n,children:a.jsx(ot.ol,{tabIndex:-1,...i,ref:f})}),g&&a.jsx(Z_,{ref:d,onFocusFromOutsideViewport:()=>{const y=v({tabbingDirection:"backwards"});Sw(y)}})]})});u4.displayName=c4;var d4="ToastFocusProxy",Z_=p.forwardRef((e,t)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=e,i=rb(d4,n);return a.jsx(nb,{"aria-hidden":!0,tabIndex:0,...s,ref:t,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&r()}})});Z_.displayName=d4;var Op="Toast",kV="toast.swipeStart",SV="toast.swipeMove",NV="toast.swipeCancel",CV="toast.swipeEnd",h4=p.forwardRef((e,t)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=e,[l,c]=Ha({prop:r,defaultProp:s??!0,onChange:i,caller:Op});return a.jsx(Cr,{present:n||l,children:a.jsx(TV,{open:l,...o,ref:t,onClose:()=>c(!1),onPause:ar(e.onPause),onResume:ar(e.onResume),onSwipeStart:Ve(e.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Ve(e.onSwipeMove,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:Ve(e.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Ve(e.onSwipeEnd,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});h4.displayName=Op;var[AV,EV]=o4(Op,{onClose(){}}),TV=p.forwardRef((e,t)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:m,...g}=e,v=rb(Op,n),[y,x]=p.useState(null),w=Ot(t,B=>x(B)),b=p.useRef(null),_=p.useRef(null),k=s||v.duration,j=p.useRef(0),S=p.useRef(k),T=p.useRef(0),{onToastAdd:O,onToastRemove:A}=v,N=ar(()=>{var $;(y==null?void 0:y.contains(document.activeElement))&&(($=v.viewport)==null||$.focus()),o()}),L=p.useCallback(B=>{!B||B===1/0||(window.clearTimeout(T.current),j.current=new Date().getTime(),T.current=window.setTimeout(N,B))},[N]);p.useEffect(()=>{const B=v.viewport;if(B){const $=()=>{L(S.current),u==null||u()},z=()=>{const R=new Date().getTime()-j.current;S.current=S.current-R,window.clearTimeout(T.current),c==null||c()};return B.addEventListener(J_,z),B.addEventListener(Q_,$),()=>{B.removeEventListener(J_,z),B.removeEventListener(Q_,$)}}},[v.viewport,k,c,u,L]),p.useEffect(()=>{i&&!v.isClosePausedRef.current&&L(k)},[i,k,v.isClosePausedRef,L]),p.useEffect(()=>(O(),()=>A()),[O,A]);const M=p.useMemo(()=>y?x4(y):null,[y]);return v.viewport?a.jsxs(a.Fragment,{children:[M&&a.jsx(PV,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:M}),a.jsx(AV,{scope:n,onClose:N,children:cu.createPortal(a.jsx(_N.ItemSlot,{scope:n,children:a.jsx(cV,{asChild:!0,onEscapeKeyDown:Ve(l,()=>{v.isFocusedToastEscapeKeyDownRef.current||N(),v.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(ot.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":v.swipeDirection,...g,ref:w,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:Ve(e.onKeyDown,B=>{B.key==="Escape"&&(l==null||l(B.nativeEvent),B.nativeEvent.defaultPrevented||(v.isFocusedToastEscapeKeyDownRef.current=!0,N()))}),onPointerDown:Ve(e.onPointerDown,B=>{B.button===0&&(b.current={x:B.clientX,y:B.clientY})}),onPointerMove:Ve(e.onPointerMove,B=>{if(!b.current)return;const $=B.clientX-b.current.x,z=B.clientY-b.current.y,R=!!_.current,C=["left","right"].includes(v.swipeDirection),D=["left","up"].includes(v.swipeDirection)?Math.min:Math.max,E=C?D(0,$):0,F=C?0:D(0,z),I=B.pointerType==="touch"?10:2,P={x:E,y:F},U={originalEvent:B,delta:P};R?(_.current=P,Dg(SV,h,U,{discrete:!1})):BT(P,v.swipeDirection,I)?(_.current=P,Dg(kV,d,U,{discrete:!1}),B.target.setPointerCapture(B.pointerId)):(Math.abs($)>I||Math.abs(z)>I)&&(b.current=null)}),onPointerUp:Ve(e.onPointerUp,B=>{const $=_.current,z=B.target;if(z.hasPointerCapture(B.pointerId)&&z.releasePointerCapture(B.pointerId),_.current=null,b.current=null,$){const R=B.currentTarget,C={originalEvent:B,delta:$};BT($,v.swipeDirection,v.swipeThreshold)?Dg(CV,m,C,{discrete:!0}):Dg(NV,f,C,{discrete:!0}),R.addEventListener("click",D=>D.preventDefault(),{once:!0})}})})})}),v.viewport)})]}):null}),PV=e=>{const{__scopeToast:t,children:n,...r}=e,s=rb(Op,t),[i,o]=p.useState(!1),[l,c]=p.useState(!1);return RV(()=>o(!0)),p.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:a.jsx(Sh,{asChild:!0,children:a.jsx(nb,{...r,children:i&&a.jsxs(a.Fragment,{children:[s.label," ",n]})})})},OV="ToastTitle",f4=p.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return a.jsx(ot.div,{...r,ref:t})});f4.displayName=OV;var IV="ToastDescription",m4=p.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e;return a.jsx(ot.div,{...r,ref:t})});m4.displayName=IV;var p4="ToastAction",g4=p.forwardRef((e,t)=>{const{altText:n,...r}=e;return n.trim()?a.jsx(y4,{altText:n,asChild:!0,children:a.jsx(kN,{...r,ref:t})}):(console.error(`Invalid prop \`altText\` supplied to \`${p4}\`. Expected non-empty \`string\`.`),null)});g4.displayName=p4;var v4="ToastClose",kN=p.forwardRef((e,t)=>{const{__scopeToast:n,...r}=e,s=EV(v4,n);return a.jsx(y4,{asChild:!0,children:a.jsx(ot.button,{type:"button",...r,ref:t,onClick:Ve(e.onClick,s.onClose)})})});kN.displayName=v4;var y4=p.forwardRef((e,t)=>{const{__scopeToast:n,altText:r,...s}=e;return a.jsx(ot.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:t})});function x4(e){const t=[];return Array.from(e.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&t.push(r.textContent),MV(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&t.push(o)}else t.push(...x4(r))}}),t}function Dg(e,t,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?wN(s,i):s.dispatchEvent(i)}var BT=(e,t,n=0)=>{const r=Math.abs(e.x),s=Math.abs(e.y),i=r>s;return t==="left"||t==="right"?i&&r>n:!i&&s>n};function RV(e=()=>{}){const t=ar(e);sr(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(t)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[t])}function MV(e){return e.nodeType===e.ELEMENT_NODE}function DV(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Sw(e){const t=document.activeElement;return e.some(n=>n===t?!0:(n.focus(),document.activeElement!==t))}var LV=l4,b4=u4,w4=h4,j4=f4,_4=m4,k4=g4,S4=kN;function N4(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=N4(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function on(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=N4(e))&&(r&&(r+=" "),r+=t);return r}const zT=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,WT=on,Ip=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return WT(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=t,o=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const f=zT(d)||zT(h);return s[u][f]}),l=n&&Object.entries(n).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),c=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:h,className:f,...m}=d;return Object.entries(m).every(g=>{let[v,y]=g;return Array.isArray(y)?y.includes({...i,...l}[v]):{...i,...l}[v]===y})?[...u,h,f]:u},[]);return WT(e,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $V=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),C4=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var FV={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UV=p.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:o,...l},c)=>p.createElement("svg",{ref:c,...FV,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:C4("lucide",s),...l},[...o.map(([u,d])=>p.createElement(u,d)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const at=(e,t)=>{const n=p.forwardRef(({className:r,...s},i)=>p.createElement(UV,{ref:i,iconNode:t,className:C4(`lucide-${$V(e)}`,r),...s}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const to=at("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rp=at("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Go=at("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yo=at("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rv=at("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A4=at("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qT=at("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hc=at("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const af=at("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E4=at("ChartNoAxesColumn",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BV=at("CheckCheck",[["path",{d:"M18 6 7 17l-5-5",key:"116fxf"}],["path",{d:"m22 10-7.5 7.5L13 16",key:"ke71qq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SN=at("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=at("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NN=at("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mp=at("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T4=at("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P4=at("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ef=at("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=at("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zV=at("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WV=at("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qV=at("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O4=at("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HT=at("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qf=at("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nw=at("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HV=at("Dot",[["circle",{cx:"12.1",cy:"12.1",r:"1",key:"18d7e5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KT=at("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VT=at("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I4=at("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CN=at("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R4=at("FileAudio",[["path",{d:"M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"rslqgf"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0",key:"9f7x3i"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KV=at("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VV=at("FileVideo",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m10 11 5 3-5 3v-6Z",key:"7ntvm4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gd=at("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M4=at("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GT=at("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GV=at("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D4=at("Key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YT=at("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ht=at("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xm=at("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AN=at("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vy=at("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mv=at("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lc=at("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YV=at("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XT=at("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XV=at("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JV=at("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QV=at("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZV=at("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L4=at("PlugZap",[["path",{d:"M6.3 20.3a2.4 2.4 0 0 0 3.4 0L12 18l-6-6-2.3 2.3a2.4 2.4 0 0 0 0 3.4Z",key:"goz73y"}],["path",{d:"m2 22 3-3",key:"19mgm9"}],["path",{d:"M7.5 13.5 10 11",key:"7xgeeb"}],["path",{d:"M10.5 16.5 13 14",key:"10btkg"}],["path",{d:"m18 3-4 4h6l-4 4",key:"16psg9"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zi=at("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ab=at("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $4=at("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JT=at("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oi=at("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bm=at("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xo=at("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F4=at("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bo=at("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QT=at("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=at("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZT=at("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=at("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oo=at("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kc=at("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eG=at("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tG=at("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nG=at("UserRound",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yy=at("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EN=at("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nh=at("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eP=at("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rG=at("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aG=at("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),TN="-",sG=e=>{const t=oG(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:o=>{const l=o.split(TN);return l[0]===""&&l.length!==1&&l.shift(),U4(l,t)||iG(o)},getConflictingClassGroupIds:(o,l)=>{const c=n[o]||[];return l&&r[o]?[...c,...r[o]]:c}}},U4=(e,t)=>{var o;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?U4(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(TN);return(o=t.validators.find(({validator:l})=>l(i)))==null?void 0:o.classGroupId},tP=/^\[(.+)\]$/,iG=e=>{if(tP.test(e)){const t=tP.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},oG=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return cG(Object.entries(e.classGroups),n).forEach(([i,o])=>{e1(o,r,i,t)}),r},e1=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:nP(t,s);i.classGroupId=n;return}if(typeof s=="function"){if(lG(s)){e1(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,o])=>{e1(o,nP(t,i),n,r)})})},nP=(e,t)=>{let n=e;return t.split(TN).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},lG=e=>e.isThemeGetter,cG=(e,t)=>t?e.map(([n,r])=>{const s=r.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([o,l])=>[t+o,l])):i);return[n,s]}):e,uG=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(i,o)=>{n.set(i,o),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let o=n.get(i);if(o!==void 0)return o;if((o=r.get(i))!==void 0)return s(i,o),o},set(i,o){n.has(i)?n.set(i,o):s(i,o)}}},B4="!",dG=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,s=t[0],i=t.length,o=l=>{const c=[];let u=0,d=0,h;for(let y=0;y<l.length;y++){let x=l[y];if(u===0){if(x===s&&(r||l.slice(y,y+i)===t)){c.push(l.slice(d,y)),d=y+i;continue}if(x==="/"){h=y;continue}}x==="["?u++:x==="]"&&u--}const f=c.length===0?l:l.substring(d),m=f.startsWith(B4),g=m?f.substring(1):f,v=h&&h>d?h-d:void 0;return{modifiers:c,hasImportantModifier:m,baseClassName:g,maybePostfixModifierPosition:v}};return n?l=>n({className:l,parseClassName:o}):o},hG=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},fG=e=>({cache:uG(e.cacheSize),parseClassName:dG(e),...sG(e)}),mG=/\s+/,pG=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=t,i=[],o=e.trim().split(mG);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{modifiers:d,hasImportantModifier:h,baseClassName:f,maybePostfixModifierPosition:m}=n(u);let g=!!m,v=r(g?f.substring(0,m):f);if(!v){if(!g){l=u+(l.length>0?" "+l:l);continue}if(v=r(f),!v){l=u+(l.length>0?" "+l:l);continue}g=!1}const y=hG(d).join(":"),x=h?y+B4:y,w=x+v;if(i.includes(w))continue;i.push(w);const b=s(v,g);for(let _=0;_<b.length;++_){const k=b[_];i.push(x+k)}l=u+(l.length>0?" "+l:l)}return l};function gG(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=z4(t))&&(r&&(r+=" "),r+=n);return r}const z4=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=z4(e[r]))&&(n&&(n+=" "),n+=t);return n};function vG(e,...t){let n,r,s,i=o;function o(c){const u=t.reduce((d,h)=>h(d),e());return n=fG(u),r=n.cache.get,s=n.cache.set,i=l,l(c)}function l(c){const u=r(c);if(u)return u;const d=pG(c,n);return s(c,d),d}return function(){return i(gG.apply(null,arguments))}}const Fn=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},W4=/^\[(?:([a-z-]+):)?(.+)\]$/i,yG=/^\d+\/\d+$/,xG=new Set(["px","full","screen"]),bG=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,wG=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,jG=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,_G=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,kG=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Qi=e=>vd(e)||xG.has(e)||yG.test(e),Xo=e=>Ch(e,"length",OG),vd=e=>!!e&&!Number.isNaN(Number(e)),Cw=e=>Ch(e,"number",vd),sf=e=>!!e&&Number.isInteger(Number(e)),SG=e=>e.endsWith("%")&&vd(e.slice(0,-1)),Ut=e=>W4.test(e),Jo=e=>bG.test(e),NG=new Set(["length","size","percentage"]),CG=e=>Ch(e,NG,q4),AG=e=>Ch(e,"position",q4),EG=new Set(["image","url"]),TG=e=>Ch(e,EG,RG),PG=e=>Ch(e,"",IG),of=()=>!0,Ch=(e,t,n)=>{const r=W4.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},OG=e=>wG.test(e)&&!jG.test(e),q4=()=>!1,IG=e=>_G.test(e),RG=e=>kG.test(e),MG=()=>{const e=Fn("colors"),t=Fn("spacing"),n=Fn("blur"),r=Fn("brightness"),s=Fn("borderColor"),i=Fn("borderRadius"),o=Fn("borderSpacing"),l=Fn("borderWidth"),c=Fn("contrast"),u=Fn("grayscale"),d=Fn("hueRotate"),h=Fn("invert"),f=Fn("gap"),m=Fn("gradientColorStops"),g=Fn("gradientColorStopPositions"),v=Fn("inset"),y=Fn("margin"),x=Fn("opacity"),w=Fn("padding"),b=Fn("saturate"),_=Fn("scale"),k=Fn("sepia"),j=Fn("skew"),S=Fn("space"),T=Fn("translate"),O=()=>["auto","contain","none"],A=()=>["auto","hidden","clip","visible","scroll"],N=()=>["auto",Ut,t],L=()=>[Ut,t],M=()=>["",Qi,Xo],B=()=>["auto",vd,Ut],$=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],z=()=>["solid","dashed","dotted","double","none"],R=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],C=()=>["start","end","center","between","around","evenly","stretch"],D=()=>["","0",Ut],E=()=>["auto","avoid","all","avoid-page","page","left","right","column"],F=()=>[vd,Ut];return{cacheSize:500,separator:":",theme:{colors:[of],spacing:[Qi,Xo],blur:["none","",Jo,Ut],brightness:F(),borderColor:[e],borderRadius:["none","","full",Jo,Ut],borderSpacing:L(),borderWidth:M(),contrast:F(),grayscale:D(),hueRotate:F(),invert:D(),gap:L(),gradientColorStops:[e],gradientColorStopPositions:[SG,Xo],inset:N(),margin:N(),opacity:F(),padding:L(),saturate:F(),scale:F(),sepia:D(),skew:F(),space:L(),translate:L()},classGroups:{aspect:[{aspect:["auto","square","video",Ut]}],container:["container"],columns:[{columns:[Jo]}],"break-after":[{"break-after":E()}],"break-before":[{"break-before":E()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...$(),Ut]}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:O()}],"overscroll-x":[{"overscroll-x":O()}],"overscroll-y":[{"overscroll-y":O()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[v]}],"inset-x":[{"inset-x":[v]}],"inset-y":[{"inset-y":[v]}],start:[{start:[v]}],end:[{end:[v]}],top:[{top:[v]}],right:[{right:[v]}],bottom:[{bottom:[v]}],left:[{left:[v]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",sf,Ut]}],basis:[{basis:N()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Ut]}],grow:[{grow:D()}],shrink:[{shrink:D()}],order:[{order:["first","last","none",sf,Ut]}],"grid-cols":[{"grid-cols":[of]}],"col-start-end":[{col:["auto",{span:["full",sf,Ut]},Ut]}],"col-start":[{"col-start":B()}],"col-end":[{"col-end":B()}],"grid-rows":[{"grid-rows":[of]}],"row-start-end":[{row:["auto",{span:[sf,Ut]},Ut]}],"row-start":[{"row-start":B()}],"row-end":[{"row-end":B()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Ut]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Ut]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...C()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...C(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...C(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[y]}],mx:[{mx:[y]}],my:[{my:[y]}],ms:[{ms:[y]}],me:[{me:[y]}],mt:[{mt:[y]}],mr:[{mr:[y]}],mb:[{mb:[y]}],ml:[{ml:[y]}],"space-x":[{"space-x":[S]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[S]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Ut,t]}],"min-w":[{"min-w":[Ut,t,"min","max","fit"]}],"max-w":[{"max-w":[Ut,t,"none","full","min","max","fit","prose",{screen:[Jo]},Jo]}],h:[{h:[Ut,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Ut,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Ut,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Ut,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Jo,Xo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Cw]}],"font-family":[{font:[of]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Ut]}],"line-clamp":[{"line-clamp":["none",vd,Cw]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Qi,Ut]}],"list-image":[{"list-image":["none",Ut]}],"list-style-type":[{list:["none","disc","decimal",Ut]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...z(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Qi,Xo]}],"underline-offset":[{"underline-offset":["auto",Qi,Ut]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:L()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ut]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ut]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...$(),AG]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",CG]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},TG]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...z(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:z()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...z()]}],"outline-offset":[{"outline-offset":[Qi,Ut]}],"outline-w":[{outline:[Qi,Xo]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[Qi,Xo]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Jo,PG]}],"shadow-color":[{shadow:[of]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...R(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":R()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Jo,Ut]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[b]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[b]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Ut]}],duration:[{duration:F()}],ease:[{ease:["linear","in","out","in-out",Ut]}],delay:[{delay:F()}],animate:[{animate:["none","spin","ping","pulse","bounce",Ut]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[_]}],"scale-x":[{"scale-x":[_]}],"scale-y":[{"scale-y":[_]}],rotate:[{rotate:[sf,Ut]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[j]}],"skew-y":[{"skew-y":[j]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Ut]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ut]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":L()}],"scroll-mx":[{"scroll-mx":L()}],"scroll-my":[{"scroll-my":L()}],"scroll-ms":[{"scroll-ms":L()}],"scroll-me":[{"scroll-me":L()}],"scroll-mt":[{"scroll-mt":L()}],"scroll-mr":[{"scroll-mr":L()}],"scroll-mb":[{"scroll-mb":L()}],"scroll-ml":[{"scroll-ml":L()}],"scroll-p":[{"scroll-p":L()}],"scroll-px":[{"scroll-px":L()}],"scroll-py":[{"scroll-py":L()}],"scroll-ps":[{"scroll-ps":L()}],"scroll-pe":[{"scroll-pe":L()}],"scroll-pt":[{"scroll-pt":L()}],"scroll-pr":[{"scroll-pr":L()}],"scroll-pb":[{"scroll-pb":L()}],"scroll-pl":[{"scroll-pl":L()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ut]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Qi,Xo,Cw]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},DG=vG(MG);function Ie(...e){return DG(on(e))}function LG(e,t){if(!t||t.length===0)return;const n=Object.keys(t[0]),r=[n.join(","),...t.map(l=>n.map(c=>{const u=l[c],d=u==null?"":String(u),h='"'+d.replace(/"/g,'""')+'"';return/[",\n]/.test(d)?h:d}).join(","))].join(`
`),s=new Blob([r],{type:"text/csv;charset=utf-8;"}),i=document.createElement("a"),o=URL.createObjectURL(s);i.setAttribute("href",o),i.setAttribute("download",e),i.style.visibility="hidden",document.body.appendChild(i),i.click(),document.body.removeChild(i)}function H4(e){if(typeof e=="string"){let t=e.replace(/([A-Z0-9._%+-]+)@([A-Z0-9.-]+)\.[A-Z]{2,}/gi,"***@***");return t=t.replace(/\b\+?\d[\d\s-]{6,}\b/g,n=>n.slice(0,Math.max(0,n.length-4)).replace(/\d/g,"*")+n.slice(-4)),t=t.replace(/(\d+\.\d+\.\d+)\.\d+/g,"$1.*"),t}if(e&&typeof e=="object"){const t=Array.isArray(e)?[]:{};for(const n of Object.keys(e))t[n]=H4(e[n]);return t}return e}function K4(e){return e?e.replace(/\*\*(.+?)\*\*/g,"$1").replace(/\*(.+?)\*/g,"$1").replace(/__(.+?)__/g,"$1").replace(/_(.+?)_/g,"$1").replace(/~~(.+?)~~/g,"$1").replace(/`(.+?)`/g,"$1").replace(/\[(.+?)\]\([^)]+\)/g,"$1").replace(/^#{1,6}\s+/gm,"").trim():""}function Hf(e){if(!e)return!1;const t=e.split("?")[0].split("#")[0];return/\.(jpg|jpeg|png|webp|avif|gif|svg)$/i.test(t)?!0:[/https?:\/\/picsum\.photos\//,/https?:\/\/placehold\.co\//,/https?:\/\/via\.placeholder\.com\//].some(r=>r.test(e))}function V4(e){if(!e)return[];const t=/https?:\/\/[^\s]+/g,n=e.match(t);if(!n)return[];const r=n.map(s=>s.replace(/[.,)\]}]+$/,""));return Array.from(new Set(r))}const $G=LV,G4=p.forwardRef(({className:e,...t},n)=>a.jsx(b4,{ref:n,className:Ie("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...t}));G4.displayName=b4.displayName;const FG=Ip("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Y4=p.forwardRef(({className:e,variant:t,...n},r)=>a.jsx(w4,{ref:r,className:Ie(FG({variant:t}),e),...n}));Y4.displayName=w4.displayName;const UG=p.forwardRef(({className:e,...t},n)=>a.jsx(k4,{ref:n,className:Ie("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...t}));UG.displayName=k4.displayName;const X4=p.forwardRef(({className:e,...t},n)=>a.jsx(S4,{ref:n,className:Ie("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...t,children:a.jsx(Nh,{className:"h-4 w-4"})}));X4.displayName=S4.displayName;const J4=p.forwardRef(({className:e,...t},n)=>a.jsx(j4,{ref:n,className:Ie("text-sm font-semibold",e),...t}));J4.displayName=j4.displayName;const Q4=p.forwardRef(({className:e,...t},n)=>a.jsx(_4,{ref:n,className:Ie("text-sm opacity-90",e),...t}));Q4.displayName=_4.displayName;function BG(){const{toasts:e}=uu();return a.jsxs($G,{children:[e.map(function({id:t,title:n,description:r,action:s,...i}){return a.jsxs(Y4,{...i,children:[a.jsxs("div",{className:"grid gap-1",children:[n&&a.jsx(J4,{children:n}),r&&a.jsx(Q4,{children:r})]}),s,a.jsx(X4,{})]},t)}),a.jsx(G4,{})]})}var rP=["light","dark"],zG="(prefers-color-scheme: dark)",WG=p.createContext(void 0),qG={setTheme:e=>{},themes:[]},HG=()=>{var e;return(e=p.useContext(WG))!=null?e:qG};p.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:o,attrs:l,nonce:c})=>{let u=i==="system",d=n==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${l.map(g=>`'${g}'`).join(",")})`};`:`var d=document.documentElement,n='${n}',s='setAttribute';`,h=s?rP.includes(i)&&i?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${i}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",f=(g,v=!1,y=!0)=>{let x=o?o[g]:g,w=v?g+"|| ''":`'${x}'`,b="";return s&&y&&!v&&rP.includes(g)&&(b+=`d.style.colorScheme = '${g}';`),n==="class"?v||x?b+=`c.add(${w})`:b+="null":x&&(b+=`d[s](n,${w})`),b},m=e?`!function(){${d}${f(e)}}()`:r?`!function(){try{${d}var e=localStorage.getItem('${t}');if('system'===e||(!e&&${u})){var t='${zG}',m=window.matchMedia(t);if(m.media!==t||m.matches){${f("dark")}}else{${f("light")}}}else if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}${u?"":"else{"+f(i,!1,!1)+"}"}${h}}catch(e){}}()`:`!function(){try{${d}var e=localStorage.getItem('${t}');if(e){${o?`var x=${JSON.stringify(o)};`:""}${f(o?"x[e]":"e",!0)}}else{${f(i,!1,!1)};}${h}}catch(t){}}();`;return p.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:m}})});var KG=e=>{switch(e){case"success":return YG;case"info":return JG;case"warning":return XG;case"error":return QG;default:return null}},VG=Array(12).fill(0),GG=({visible:e,className:t})=>G.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},G.createElement("div",{className:"sonner-spinner"},VG.map((n,r)=>G.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),YG=G.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},G.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),XG=G.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},G.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),JG=G.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},G.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),QG=G.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},G.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),ZG=G.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},G.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),G.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),eY=()=>{let[e,t]=G.useState(document.hidden);return G.useEffect(()=>{let n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e},t1=1,tY=class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let t=this.subscribers.indexOf(e);this.subscribers.splice(t,1)}),this.publish=e=>{this.subscribers.forEach(t=>t(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var t;let{message:n,...r}=e,s=typeof(e==null?void 0:e.id)=="number"||((t=e.id)==null?void 0:t.length)>0?e.id:t1++,i=this.toasts.find(l=>l.id===s),o=e.dismissible===void 0?!0:e.dismissible;return this.dismissedToasts.has(s)&&this.dismissedToasts.delete(s),i?this.toasts=this.toasts.map(l=>l.id===s?(this.publish({...l,...e,id:s,title:n}),{...l,...e,id:s,dismissible:o,title:n}):l):this.addToast({title:n,...r,dismissible:o,id:s}),s},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(t=>{this.subscribers.forEach(n=>n({id:t.id,dismiss:!0}))}),this.subscribers.forEach(t=>t({id:e,dismiss:!0})),e),this.message=(e,t)=>this.create({...t,message:e}),this.error=(e,t)=>this.create({...t,message:e,type:"error"}),this.success=(e,t)=>this.create({...t,type:"success",message:e}),this.info=(e,t)=>this.create({...t,type:"info",message:e}),this.warning=(e,t)=>this.create({...t,type:"warning",message:e}),this.loading=(e,t)=>this.create({...t,type:"loading",message:e}),this.promise=(e,t)=>{if(!t)return;let n;t.loading!==void 0&&(n=this.create({...t,promise:e,type:"loading",message:t.loading,description:typeof t.description!="function"?t.description:void 0}));let r=e instanceof Promise?e:e(),s=n!==void 0,i,o=r.then(async c=>{if(i=["resolve",c],G.isValidElement(c))s=!1,this.create({id:n,type:"default",message:c});else if(rY(c)&&!c.ok){s=!1;let u=typeof t.error=="function"?await t.error(`HTTP error! status: ${c.status}`):t.error,d=typeof t.description=="function"?await t.description(`HTTP error! status: ${c.status}`):t.description;this.create({id:n,type:"error",message:u,description:d})}else if(t.success!==void 0){s=!1;let u=typeof t.success=="function"?await t.success(c):t.success,d=typeof t.description=="function"?await t.description(c):t.description;this.create({id:n,type:"success",message:u,description:d})}}).catch(async c=>{if(i=["reject",c],t.error!==void 0){s=!1;let u=typeof t.error=="function"?await t.error(c):t.error,d=typeof t.description=="function"?await t.description(c):t.description;this.create({id:n,type:"error",message:u,description:d})}}).finally(()=>{var c;s&&(this.dismiss(n),n=void 0),(c=t.finally)==null||c.call(t)}),l=()=>new Promise((c,u)=>o.then(()=>i[0]==="reject"?u(i[1]):c(i[1])).catch(u));return typeof n!="string"&&typeof n!="number"?{unwrap:l}:Object.assign(n,{unwrap:l})},this.custom=(e,t)=>{let n=(t==null?void 0:t.id)||t1++;return this.create({jsx:e(n),id:n,...t}),n},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},Ta=new tY,nY=(e,t)=>{let n=(t==null?void 0:t.id)||t1++;return Ta.addToast({title:e,...t,id:n}),n},rY=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",aY=nY,sY=()=>Ta.toasts,iY=()=>Ta.getActiveToasts(),ze=Object.assign(aY,{success:Ta.success,info:Ta.info,warning:Ta.warning,error:Ta.error,custom:Ta.custom,message:Ta.message,promise:Ta.promise,dismiss:Ta.dismiss,loading:Ta.loading},{getHistory:sY,getToasts:iY});function oY(e,{insertAt:t}={}){if(typeof document>"u")return;let n=document.head||document.getElementsByTagName("head")[0],r=document.createElement("style");r.type="text/css",t==="top"&&n.firstChild?n.insertBefore(r,n.firstChild):n.appendChild(r),r.styleSheet?r.styleSheet.cssText=e:r.appendChild(document.createTextNode(e))}oY(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function Lg(e){return e.label!==void 0}var lY=3,cY="32px",uY="16px",aP=4e3,dY=356,hY=14,fY=20,mY=200;function zs(...e){return e.filter(Boolean).join(" ")}function pY(e){let[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}var gY=e=>{var t,n,r,s,i,o,l,c,u,d,h;let{invert:f,toast:m,unstyled:g,interacting:v,setHeights:y,visibleToasts:x,heights:w,index:b,toasts:_,expanded:k,removeToast:j,defaultRichColors:S,closeButton:T,style:O,cancelButtonStyle:A,actionButtonStyle:N,className:L="",descriptionClassName:M="",duration:B,position:$,gap:z,loadingIcon:R,expandByDefault:C,classNames:D,icons:E,closeButtonAriaLabel:F="Close toast",pauseWhenPageIsHidden:I}=e,[P,U]=G.useState(null),[Z,X]=G.useState(null),[K,ie]=G.useState(!1),[H,he]=G.useState(!1),[me,ae]=G.useState(!1),[Ne,de]=G.useState(!1),[Q,fe]=G.useState(!1),[Be,je]=G.useState(0),[Ce,Ze]=G.useState(0),rt=G.useRef(m.duration||B||aP),Je=G.useRef(null),te=G.useRef(null),We=b===0,Ue=b+1<=x,ue=m.type,xe=m.dismissible!==!1,ce=m.className||"",qe=m.descriptionClassName||"",Se=G.useMemo(()=>w.findIndex(Le=>Le.toastId===m.id)||0,[w,m.id]),nt=G.useMemo(()=>{var Le;return(Le=m.closeButton)!=null?Le:T},[m.closeButton,T]),vt=G.useMemo(()=>m.duration||B||aP,[m.duration,B]),xt=G.useRef(0),wt=G.useRef(0),ht=G.useRef(0),_t=G.useRef(null),[Wt,pe]=$.split("-"),Oe=G.useMemo(()=>w.reduce((Le,be,ee)=>ee>=Se?Le:Le+be.height,0),[w,Se]),W=eY(),q=m.invert||f,Y=ue==="loading";wt.current=G.useMemo(()=>Se*z+Oe,[Se,Oe]),G.useEffect(()=>{rt.current=vt},[vt]),G.useEffect(()=>{ie(!0)},[]),G.useEffect(()=>{let Le=te.current;if(Le){let be=Le.getBoundingClientRect().height;return Ze(be),y(ee=>[{toastId:m.id,height:be,position:m.position},...ee]),()=>y(ee=>ee.filter(oe=>oe.toastId!==m.id))}},[y,m.id]),G.useLayoutEffect(()=>{if(!K)return;let Le=te.current,be=Le.style.height;Le.style.height="auto";let ee=Le.getBoundingClientRect().height;Le.style.height=be,Ze(ee),y(oe=>oe.find(Ee=>Ee.toastId===m.id)?oe.map(Ee=>Ee.toastId===m.id?{...Ee,height:ee}:Ee):[{toastId:m.id,height:ee,position:m.position},...oe])},[K,m.title,m.description,y,m.id]);let ne=G.useCallback(()=>{he(!0),je(wt.current),y(Le=>Le.filter(be=>be.toastId!==m.id)),setTimeout(()=>{j(m)},mY)},[m,j,y,wt]);G.useEffect(()=>{if(m.promise&&ue==="loading"||m.duration===1/0||m.type==="loading")return;let Le;return k||v||I&&W?(()=>{if(ht.current<xt.current){let be=new Date().getTime()-xt.current;rt.current=rt.current-be}ht.current=new Date().getTime()})():rt.current!==1/0&&(xt.current=new Date().getTime(),Le=setTimeout(()=>{var be;(be=m.onAutoClose)==null||be.call(m,m),ne()},rt.current)),()=>clearTimeout(Le)},[k,v,m,ue,I,W,ne]),G.useEffect(()=>{m.delete&&ne()},[ne,m.delete]);function _e(){var Le,be,ee;return E!=null&&E.loading?G.createElement("div",{className:zs(D==null?void 0:D.loader,(Le=m==null?void 0:m.classNames)==null?void 0:Le.loader,"sonner-loader"),"data-visible":ue==="loading"},E.loading):R?G.createElement("div",{className:zs(D==null?void 0:D.loader,(be=m==null?void 0:m.classNames)==null?void 0:be.loader,"sonner-loader"),"data-visible":ue==="loading"},R):G.createElement(GG,{className:zs(D==null?void 0:D.loader,(ee=m==null?void 0:m.classNames)==null?void 0:ee.loader),visible:ue==="loading"})}return G.createElement("li",{tabIndex:0,ref:te,className:zs(L,ce,D==null?void 0:D.toast,(t=m==null?void 0:m.classNames)==null?void 0:t.toast,D==null?void 0:D.default,D==null?void 0:D[ue],(n=m==null?void 0:m.classNames)==null?void 0:n[ue]),"data-sonner-toast":"","data-rich-colors":(r=m.richColors)!=null?r:S,"data-styled":!(m.jsx||m.unstyled||g),"data-mounted":K,"data-promise":!!m.promise,"data-swiped":Q,"data-removed":H,"data-visible":Ue,"data-y-position":Wt,"data-x-position":pe,"data-index":b,"data-front":We,"data-swiping":me,"data-dismissible":xe,"data-type":ue,"data-invert":q,"data-swipe-out":Ne,"data-swipe-direction":Z,"data-expanded":!!(k||C&&K),style:{"--index":b,"--toasts-before":b,"--z-index":_.length-b,"--offset":`${H?Be:wt.current}px`,"--initial-height":C?"auto":`${Ce}px`,...O,...m.style},onDragEnd:()=>{ae(!1),U(null),_t.current=null},onPointerDown:Le=>{Y||!xe||(Je.current=new Date,je(wt.current),Le.target.setPointerCapture(Le.pointerId),Le.target.tagName!=="BUTTON"&&(ae(!0),_t.current={x:Le.clientX,y:Le.clientY}))},onPointerUp:()=>{var Le,be,ee,oe;if(Ne||!xe)return;_t.current=null;let Ee=Number(((Le=te.current)==null?void 0:Le.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Xe=Number(((be=te.current)==null?void 0:be.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),$e=new Date().getTime()-((ee=Je.current)==null?void 0:ee.getTime()),jt=P==="x"?Ee:Xe,et=Math.abs(jt)/$e;if(Math.abs(jt)>=fY||et>.11){je(wt.current),(oe=m.onDismiss)==null||oe.call(m,m),X(P==="x"?Ee>0?"right":"left":Xe>0?"down":"up"),ne(),de(!0),fe(!1);return}ae(!1),U(null)},onPointerMove:Le=>{var be,ee,oe,Ee;if(!_t.current||!xe||((be=window.getSelection())==null?void 0:be.toString().length)>0)return;let Xe=Le.clientY-_t.current.y,$e=Le.clientX-_t.current.x,jt=(ee=e.swipeDirections)!=null?ee:pY($);!P&&(Math.abs($e)>1||Math.abs(Xe)>1)&&U(Math.abs($e)>Math.abs(Xe)?"x":"y");let et={x:0,y:0};P==="y"?(jt.includes("top")||jt.includes("bottom"))&&(jt.includes("top")&&Xe<0||jt.includes("bottom")&&Xe>0)&&(et.y=Xe):P==="x"&&(jt.includes("left")||jt.includes("right"))&&(jt.includes("left")&&$e<0||jt.includes("right")&&$e>0)&&(et.x=$e),(Math.abs(et.x)>0||Math.abs(et.y)>0)&&fe(!0),(oe=te.current)==null||oe.style.setProperty("--swipe-amount-x",`${et.x}px`),(Ee=te.current)==null||Ee.style.setProperty("--swipe-amount-y",`${et.y}px`)}},nt&&!m.jsx?G.createElement("button",{"aria-label":F,"data-disabled":Y,"data-close-button":!0,onClick:Y||!xe?()=>{}:()=>{var Le;ne(),(Le=m.onDismiss)==null||Le.call(m,m)},className:zs(D==null?void 0:D.closeButton,(s=m==null?void 0:m.classNames)==null?void 0:s.closeButton)},(i=E==null?void 0:E.close)!=null?i:ZG):null,m.jsx||p.isValidElement(m.title)?m.jsx?m.jsx:typeof m.title=="function"?m.title():m.title:G.createElement(G.Fragment,null,ue||m.icon||m.promise?G.createElement("div",{"data-icon":"",className:zs(D==null?void 0:D.icon,(o=m==null?void 0:m.classNames)==null?void 0:o.icon)},m.promise||m.type==="loading"&&!m.icon?m.icon||_e():null,m.type!=="loading"?m.icon||(E==null?void 0:E[ue])||KG(ue):null):null,G.createElement("div",{"data-content":"",className:zs(D==null?void 0:D.content,(l=m==null?void 0:m.classNames)==null?void 0:l.content)},G.createElement("div",{"data-title":"",className:zs(D==null?void 0:D.title,(c=m==null?void 0:m.classNames)==null?void 0:c.title)},typeof m.title=="function"?m.title():m.title),m.description?G.createElement("div",{"data-description":"",className:zs(M,qe,D==null?void 0:D.description,(u=m==null?void 0:m.classNames)==null?void 0:u.description)},typeof m.description=="function"?m.description():m.description):null),p.isValidElement(m.cancel)?m.cancel:m.cancel&&Lg(m.cancel)?G.createElement("button",{"data-button":!0,"data-cancel":!0,style:m.cancelButtonStyle||A,onClick:Le=>{var be,ee;Lg(m.cancel)&&xe&&((ee=(be=m.cancel).onClick)==null||ee.call(be,Le),ne())},className:zs(D==null?void 0:D.cancelButton,(d=m==null?void 0:m.classNames)==null?void 0:d.cancelButton)},m.cancel.label):null,p.isValidElement(m.action)?m.action:m.action&&Lg(m.action)?G.createElement("button",{"data-button":!0,"data-action":!0,style:m.actionButtonStyle||N,onClick:Le=>{var be,ee;Lg(m.action)&&((ee=(be=m.action).onClick)==null||ee.call(be,Le),!Le.defaultPrevented&&ne())},className:zs(D==null?void 0:D.actionButton,(h=m==null?void 0:m.classNames)==null?void 0:h.actionButton)},m.action.label):null))};function sP(){if(typeof window>"u"||typeof document>"u")return"ltr";let e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function vY(e,t){let n={};return[e,t].forEach((r,s)=>{let i=s===1,o=i?"--mobile-offset":"--offset",l=i?uY:cY;function c(u){["top","right","bottom","left"].forEach(d=>{n[`${o}-${d}`]=typeof u=="number"?`${u}px`:u})}typeof r=="number"||typeof r=="string"?c(r):typeof r=="object"?["top","right","bottom","left"].forEach(u=>{r[u]===void 0?n[`${o}-${u}`]=l:n[`${o}-${u}`]=typeof r[u]=="number"?`${r[u]}px`:r[u]}):c(l)}),n}var yY=p.forwardRef(function(e,t){let{invert:n,position:r="bottom-right",hotkey:s=["altKey","KeyT"],expand:i,closeButton:o,className:l,offset:c,mobileOffset:u,theme:d="light",richColors:h,duration:f,style:m,visibleToasts:g=lY,toastOptions:v,dir:y=sP(),gap:x=hY,loadingIcon:w,icons:b,containerAriaLabel:_="Notifications",pauseWhenPageIsHidden:k}=e,[j,S]=G.useState([]),T=G.useMemo(()=>Array.from(new Set([r].concat(j.filter(I=>I.position).map(I=>I.position)))),[j,r]),[O,A]=G.useState([]),[N,L]=G.useState(!1),[M,B]=G.useState(!1),[$,z]=G.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),R=G.useRef(null),C=s.join("+").replace(/Key/g,"").replace(/Digit/g,""),D=G.useRef(null),E=G.useRef(!1),F=G.useCallback(I=>{S(P=>{var U;return(U=P.find(Z=>Z.id===I.id))!=null&&U.delete||Ta.dismiss(I.id),P.filter(({id:Z})=>Z!==I.id)})},[]);return G.useEffect(()=>Ta.subscribe(I=>{if(I.dismiss){S(P=>P.map(U=>U.id===I.id?{...U,delete:!0}:U));return}setTimeout(()=>{Z$.flushSync(()=>{S(P=>{let U=P.findIndex(Z=>Z.id===I.id);return U!==-1?[...P.slice(0,U),{...P[U],...I},...P.slice(U+1)]:[I,...P]})})})}),[]),G.useEffect(()=>{if(d!=="system"){z(d);return}if(d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?z("dark"):z("light")),typeof window>"u")return;let I=window.matchMedia("(prefers-color-scheme: dark)");try{I.addEventListener("change",({matches:P})=>{z(P?"dark":"light")})}catch{I.addListener(({matches:U})=>{try{z(U?"dark":"light")}catch(Z){console.error(Z)}})}},[d]),G.useEffect(()=>{j.length<=1&&L(!1)},[j]),G.useEffect(()=>{let I=P=>{var U,Z;s.every(X=>P[X]||P.code===X)&&(L(!0),(U=R.current)==null||U.focus()),P.code==="Escape"&&(document.activeElement===R.current||(Z=R.current)!=null&&Z.contains(document.activeElement))&&L(!1)};return document.addEventListener("keydown",I),()=>document.removeEventListener("keydown",I)},[s]),G.useEffect(()=>{if(R.current)return()=>{D.current&&(D.current.focus({preventScroll:!0}),D.current=null,E.current=!1)}},[R.current]),G.createElement("section",{ref:t,"aria-label":`${_} ${C}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},T.map((I,P)=>{var U;let[Z,X]=I.split("-");return j.length?G.createElement("ol",{key:I,dir:y==="auto"?sP():y,tabIndex:-1,ref:R,className:l,"data-sonner-toaster":!0,"data-theme":$,"data-y-position":Z,"data-lifted":N&&j.length>1&&!i,"data-x-position":X,style:{"--front-toast-height":`${((U=O[0])==null?void 0:U.height)||0}px`,"--width":`${dY}px`,"--gap":`${x}px`,...m,...vY(c,u)},onBlur:K=>{E.current&&!K.currentTarget.contains(K.relatedTarget)&&(E.current=!1,D.current&&(D.current.focus({preventScroll:!0}),D.current=null))},onFocus:K=>{K.target instanceof HTMLElement&&K.target.dataset.dismissible==="false"||E.current||(E.current=!0,D.current=K.relatedTarget)},onMouseEnter:()=>L(!0),onMouseMove:()=>L(!0),onMouseLeave:()=>{M||L(!1)},onDragEnd:()=>L(!1),onPointerDown:K=>{K.target instanceof HTMLElement&&K.target.dataset.dismissible==="false"||B(!0)},onPointerUp:()=>B(!1)},j.filter(K=>!K.position&&P===0||K.position===I).map((K,ie)=>{var H,he;return G.createElement(gY,{key:K.id,icons:b,index:ie,toast:K,defaultRichColors:h,duration:(H=v==null?void 0:v.duration)!=null?H:f,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:n,visibleToasts:g,closeButton:(he=v==null?void 0:v.closeButton)!=null?he:o,interacting:M,position:I,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,removeToast:F,toasts:j.filter(me=>me.position==K.position),heights:O.filter(me=>me.position==K.position),setHeights:A,expandByDefault:i,gap:x,loadingIcon:w,expanded:N,pauseWhenPageIsHidden:k,swipeDirections:e.swipeDirections})})):null}))});const xY=({...e})=>{const{theme:t="system"}=HG();return a.jsx(yY,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var bY=ES[" useId ".trim().toString()]||(()=>{}),wY=0;function pr(e){const[t,n]=p.useState(bY());return sr(()=>{e||n(r=>r??String(wY++))},[e]),e||(t?`radix-${t}`:"")}const jY=["top","right","bottom","left"],Ll=Math.min,as=Math.max,xy=Math.round,$g=Math.floor,Fi=e=>({x:e,y:e}),_Y={left:"right",right:"left",bottom:"top",top:"bottom"},kY={start:"end",end:"start"};function n1(e,t,n){return as(e,Ll(t,n))}function To(e,t){return typeof e=="function"?e(t):e}function Po(e){return e.split("-")[0]}function Ah(e){return e.split("-")[1]}function PN(e){return e==="x"?"y":"x"}function ON(e){return e==="y"?"height":"width"}const SY=new Set(["top","bottom"]);function Pi(e){return SY.has(Po(e))?"y":"x"}function IN(e){return PN(Pi(e))}function NY(e,t,n){n===void 0&&(n=!1);const r=Ah(e),s=IN(e),i=ON(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(o=by(o)),[o,by(o)]}function CY(e){const t=by(e);return[r1(e),t,r1(t)]}function r1(e){return e.replace(/start|end/g,t=>kY[t])}const iP=["left","right"],oP=["right","left"],AY=["top","bottom"],EY=["bottom","top"];function TY(e,t,n){switch(e){case"top":case"bottom":return n?t?oP:iP:t?iP:oP;case"left":case"right":return t?AY:EY;default:return[]}}function PY(e,t,n,r){const s=Ah(e);let i=TY(Po(e),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),t&&(i=i.concat(i.map(r1)))),i}function by(e){return e.replace(/left|right|bottom|top/g,t=>_Y[t])}function OY(e){return{top:0,right:0,bottom:0,left:0,...e}}function Z4(e){return typeof e!="number"?OY(e):{top:e,right:e,bottom:e,left:e}}function wy(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function lP(e,t,n){let{reference:r,floating:s}=e;const i=Pi(t),o=IN(t),l=ON(o),c=Po(t),u=i==="y",d=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,f=r[l]/2-s[l]/2;let m;switch(c){case"top":m={x:d,y:r.y-s.height};break;case"bottom":m={x:d,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:h};break;case"left":m={x:r.x-s.width,y:h};break;default:m={x:r.x,y:r.y}}switch(Ah(t)){case"start":m[o]-=f*(n&&u?-1:1);break;case"end":m[o]+=f*(n&&u?-1:1);break}return m}const IY=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(t));let u=await o.getElementRects({reference:e,floating:t,strategy:s}),{x:d,y:h}=lP(u,r,c),f=r,m={},g=0;for(let v=0;v<l.length;v++){const{name:y,fn:x}=l[v],{x:w,y:b,data:_,reset:k}=await x({x:d,y:h,initialPlacement:r,placement:f,strategy:s,middlewareData:m,rects:u,platform:o,elements:{reference:e,floating:t}});d=w??d,h=b??h,m={...m,[y]:{...m[y],..._}},k&&g<=50&&(g++,typeof k=="object"&&(k.placement&&(f=k.placement),k.rects&&(u=k.rects===!0?await o.getElementRects({reference:e,floating:t,strategy:s}):k.rects),{x:d,y:h}=lP(u,f,c)),v=-1)}return{x:d,y:h,placement:f,strategy:s,middlewareData:m}};async function wm(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:i,rects:o,elements:l,strategy:c}=e,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:m=0}=To(t,e),g=Z4(m),y=l[f?h==="floating"?"reference":"floating":h],x=wy(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(y)))==null||n?y:y.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),w=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,b=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),_=await(i.isElement==null?void 0:i.isElement(b))?await(i.getScale==null?void 0:i.getScale(b))||{x:1,y:1}:{x:1,y:1},k=wy(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:w,offsetParent:b,strategy:c}):w);return{top:(x.top-k.top+g.top)/_.y,bottom:(k.bottom-x.bottom+g.bottom)/_.y,left:(x.left-k.left+g.left)/_.x,right:(k.right-x.right+g.right)/_.x}}const RY=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:i,platform:o,elements:l,middlewareData:c}=t,{element:u,padding:d=0}=To(e,t)||{};if(u==null)return{};const h=Z4(d),f={x:n,y:r},m=IN(s),g=ON(m),v=await o.getDimensions(u),y=m==="y",x=y?"top":"left",w=y?"bottom":"right",b=y?"clientHeight":"clientWidth",_=i.reference[g]+i.reference[m]-f[m]-i.floating[g],k=f[m]-i.reference[m],j=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let S=j?j[b]:0;(!S||!await(o.isElement==null?void 0:o.isElement(j)))&&(S=l.floating[b]||i.floating[g]);const T=_/2-k/2,O=S/2-v[g]/2-1,A=Ll(h[x],O),N=Ll(h[w],O),L=A,M=S-v[g]-N,B=S/2-v[g]/2+T,$=n1(L,B,M),z=!c.arrow&&Ah(s)!=null&&B!==$&&i.reference[g]/2-(B<L?A:N)-v[g]/2<0,R=z?B<L?B-L:B-M:0;return{[m]:f[m]+R,data:{[m]:$,centerOffset:B-$-R,...z&&{alignmentOffset:R}},reset:z}}}),MY=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:u}=t,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:v=!0,...y}=To(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const x=Po(s),w=Pi(l),b=Po(l)===l,_=await(c.isRTL==null?void 0:c.isRTL(u.floating)),k=f||(b||!v?[by(l)]:CY(l)),j=g!=="none";!f&&j&&k.push(...PY(l,v,g,_));const S=[l,...k],T=await wm(t,y),O=[];let A=((r=i.flip)==null?void 0:r.overflows)||[];if(d&&O.push(T[x]),h){const B=NY(s,o,_);O.push(T[B[0]],T[B[1]])}if(A=[...A,{placement:s,overflows:O}],!O.every(B=>B<=0)){var N,L;const B=(((N=i.flip)==null?void 0:N.index)||0)+1,$=S[B];if($&&(!(h==="alignment"?w!==Pi($):!1)||A.every(C=>C.overflows[0]>0&&Pi(C.placement)===w)))return{data:{index:B,overflows:A},reset:{placement:$}};let z=(L=A.filter(R=>R.overflows[0]<=0).sort((R,C)=>R.overflows[1]-C.overflows[1])[0])==null?void 0:L.placement;if(!z)switch(m){case"bestFit":{var M;const R=(M=A.filter(C=>{if(j){const D=Pi(C.placement);return D===w||D==="y"}return!0}).map(C=>[C.placement,C.overflows.filter(D=>D>0).reduce((D,E)=>D+E,0)]).sort((C,D)=>C[1]-D[1])[0])==null?void 0:M[0];R&&(z=R);break}case"initialPlacement":z=l;break}if(s!==z)return{reset:{placement:z}}}return{}}}};function cP(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function uP(e){return jY.some(t=>e[t]>=0)}const DY=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=To(e,t);switch(r){case"referenceHidden":{const i=await wm(t,{...s,elementContext:"reference"}),o=cP(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:uP(o)}}}case"escaped":{const i=await wm(t,{...s,altBoundary:!0}),o=cP(i,n.floating);return{data:{escapedOffsets:o,escaped:uP(o)}}}default:return{}}}}},eF=new Set(["left","top"]);async function LY(e,t){const{placement:n,platform:r,elements:s}=e,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=Po(n),l=Ah(n),c=Pi(n)==="y",u=eF.has(o)?-1:1,d=i&&c?-1:1,h=To(t,e);let{mainAxis:f,crossAxis:m,alignmentAxis:g}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof g=="number"&&(m=l==="end"?g*-1:g),c?{x:m*d,y:f*u}:{x:f*u,y:m*d}}const $Y=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:i,placement:o,middlewareData:l}=t,c=await LY(t,e);return o===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},FY=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:y=>{let{x,y:w}=y;return{x,y:w}}},...c}=To(e,t),u={x:n,y:r},d=await wm(t,c),h=Pi(Po(s)),f=PN(h);let m=u[f],g=u[h];if(i){const y=f==="y"?"top":"left",x=f==="y"?"bottom":"right",w=m+d[y],b=m-d[x];m=n1(w,m,b)}if(o){const y=h==="y"?"top":"left",x=h==="y"?"bottom":"right",w=g+d[y],b=g-d[x];g=n1(w,g,b)}const v=l.fn({...t,[f]:m,[h]:g});return{...v,data:{x:v.x-n,y:v.y-r,enabled:{[f]:i,[h]:o}}}}}},UY=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=t,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=To(e,t),d={x:n,y:r},h=Pi(s),f=PN(h);let m=d[f],g=d[h];const v=To(l,t),y=typeof v=="number"?{mainAxis:v,crossAxis:0}:{mainAxis:0,crossAxis:0,...v};if(c){const b=f==="y"?"height":"width",_=i.reference[f]-i.floating[b]+y.mainAxis,k=i.reference[f]+i.reference[b]-y.mainAxis;m<_?m=_:m>k&&(m=k)}if(u){var x,w;const b=f==="y"?"width":"height",_=eF.has(Po(s)),k=i.reference[h]-i.floating[b]+(_&&((x=o.offset)==null?void 0:x[h])||0)+(_?0:y.crossAxis),j=i.reference[h]+i.reference[b]+(_?0:((w=o.offset)==null?void 0:w[h])||0)-(_?y.crossAxis:0);g<k?g=k:g>j&&(g=j)}return{[f]:m,[h]:g}}}},BY=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:i,platform:o,elements:l}=t,{apply:c=()=>{},...u}=To(e,t),d=await wm(t,u),h=Po(s),f=Ah(s),m=Pi(s)==="y",{width:g,height:v}=i.floating;let y,x;h==="top"||h==="bottom"?(y=h,x=f===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(x=h,y=f==="end"?"top":"bottom");const w=v-d.top-d.bottom,b=g-d.left-d.right,_=Ll(v-d[y],w),k=Ll(g-d[x],b),j=!t.middlewareData.shift;let S=_,T=k;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(T=b),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(S=w),j&&!f){const A=as(d.left,0),N=as(d.right,0),L=as(d.top,0),M=as(d.bottom,0);m?T=g-2*(A!==0||N!==0?A+N:as(d.left,d.right)):S=v-2*(L!==0||M!==0?L+M:as(d.top,d.bottom))}await c({...t,availableWidth:T,availableHeight:S});const O=await o.getDimensions(l.floating);return g!==O.width||v!==O.height?{reset:{rects:!0}}:{}}}};function sb(){return typeof window<"u"}function Eh(e){return tF(e)?(e.nodeName||"").toLowerCase():"#document"}function ls(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function Vi(e){var t;return(t=(tF(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function tF(e){return sb()?e instanceof Node||e instanceof ls(e).Node:!1}function di(e){return sb()?e instanceof Element||e instanceof ls(e).Element:!1}function Wi(e){return sb()?e instanceof HTMLElement||e instanceof ls(e).HTMLElement:!1}function dP(e){return!sb()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof ls(e).ShadowRoot}const zY=new Set(["inline","contents"]);function Dp(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=hi(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!zY.has(s)}const WY=new Set(["table","td","th"]);function qY(e){return WY.has(Eh(e))}const HY=[":popover-open",":modal"];function ib(e){return HY.some(t=>{try{return e.matches(t)}catch{return!1}})}const KY=["transform","translate","scale","rotate","perspective"],VY=["transform","translate","scale","rotate","perspective","filter"],GY=["paint","layout","strict","content"];function RN(e){const t=MN(),n=di(e)?hi(e):e;return KY.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||VY.some(r=>(n.willChange||"").includes(r))||GY.some(r=>(n.contain||"").includes(r))}function YY(e){let t=$l(e);for(;Wi(t)&&!zd(t);){if(RN(t))return t;if(ib(t))return null;t=$l(t)}return null}function MN(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const XY=new Set(["html","body","#document"]);function zd(e){return XY.has(Eh(e))}function hi(e){return ls(e).getComputedStyle(e)}function ob(e){return di(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function $l(e){if(Eh(e)==="html")return e;const t=e.assignedSlot||e.parentNode||dP(e)&&e.host||Vi(e);return dP(t)?t.host:t}function nF(e){const t=$l(e);return zd(t)?e.ownerDocument?e.ownerDocument.body:e.body:Wi(t)&&Dp(t)?t:nF(t)}function jm(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=nF(e),i=s===((r=e.ownerDocument)==null?void 0:r.body),o=ls(s);if(i){const l=a1(o);return t.concat(o,o.visualViewport||[],Dp(s)?s:[],l&&n?jm(l):[])}return t.concat(s,jm(s,[],n))}function a1(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function rF(e){const t=hi(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=Wi(e),i=s?e.offsetWidth:n,o=s?e.offsetHeight:r,l=xy(n)!==i||xy(r)!==o;return l&&(n=i,r=o),{width:n,height:r,$:l}}function DN(e){return di(e)?e:e.contextElement}function yd(e){const t=DN(e);if(!Wi(t))return Fi(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:i}=rF(t);let o=(i?xy(n.width):n.width)/r,l=(i?xy(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const JY=Fi(0);function aF(e){const t=ls(e);return!MN()||!t.visualViewport?JY:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function QY(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==ls(e)?!1:t}function Vc(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=DN(e);let o=Fi(1);t&&(r?di(r)&&(o=yd(r)):o=yd(e));const l=QY(i,n,r)?aF(i):Fi(0);let c=(s.left+l.x)/o.x,u=(s.top+l.y)/o.y,d=s.width/o.x,h=s.height/o.y;if(i){const f=ls(i),m=r&&di(r)?ls(r):r;let g=f,v=a1(g);for(;v&&r&&m!==g;){const y=yd(v),x=v.getBoundingClientRect(),w=hi(v),b=x.left+(v.clientLeft+parseFloat(w.paddingLeft))*y.x,_=x.top+(v.clientTop+parseFloat(w.paddingTop))*y.y;c*=y.x,u*=y.y,d*=y.x,h*=y.y,c+=b,u+=_,g=ls(v),v=a1(g)}}return wy({width:d,height:h,x:c,y:u})}function LN(e,t){const n=ob(e).scrollLeft;return t?t.left+n:Vc(Vi(e)).left+n}function sF(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),s=r.left+t.scrollLeft-(n?0:LN(e,r)),i=r.top+t.scrollTop;return{x:s,y:i}}function ZY(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const i=s==="fixed",o=Vi(r),l=t?ib(t.floating):!1;if(r===o||l&&i)return n;let c={scrollLeft:0,scrollTop:0},u=Fi(1);const d=Fi(0),h=Wi(r);if((h||!h&&!i)&&((Eh(r)!=="body"||Dp(o))&&(c=ob(r)),Wi(r))){const m=Vc(r);u=yd(r),d.x=m.x+r.clientLeft,d.y=m.y+r.clientTop}const f=o&&!h&&!i?sF(o,c,!0):Fi(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-c.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-c.scrollTop*u.y+d.y+f.y}}function eX(e){return Array.from(e.getClientRects())}function tX(e){const t=Vi(e),n=ob(e),r=e.ownerDocument.body,s=as(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=as(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+LN(e);const l=-n.scrollTop;return hi(r).direction==="rtl"&&(o+=as(t.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:l}}function nX(e,t){const n=ls(e),r=Vi(e),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,l=0,c=0;if(s){i=s.width,o=s.height;const u=MN();(!u||u&&t==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:i,height:o,x:l,y:c}}const rX=new Set(["absolute","fixed"]);function aX(e,t){const n=Vc(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,i=Wi(e)?yd(e):Fi(1),o=e.clientWidth*i.x,l=e.clientHeight*i.y,c=s*i.x,u=r*i.y;return{width:o,height:l,x:c,y:u}}function hP(e,t,n){let r;if(t==="viewport")r=nX(e,n);else if(t==="document")r=tX(Vi(e));else if(di(t))r=aX(t,n);else{const s=aF(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return wy(r)}function iF(e,t){const n=$l(e);return n===t||!di(n)||zd(n)?!1:hi(n).position==="fixed"||iF(n,t)}function sX(e,t){const n=t.get(e);if(n)return n;let r=jm(e,[],!1).filter(l=>di(l)&&Eh(l)!=="body"),s=null;const i=hi(e).position==="fixed";let o=i?$l(e):e;for(;di(o)&&!zd(o);){const l=hi(o),c=RN(o);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&rX.has(s.position)||Dp(o)&&!c&&iF(e,o))?r=r.filter(d=>d!==o):s=l,o=$l(o)}return t.set(e,r),r}function iX(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const o=[...n==="clippingAncestors"?ib(t)?[]:sX(t,this._c):[].concat(n),r],l=o[0],c=o.reduce((u,d)=>{const h=hP(t,d,s);return u.top=as(h.top,u.top),u.right=Ll(h.right,u.right),u.bottom=Ll(h.bottom,u.bottom),u.left=as(h.left,u.left),u},hP(t,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function oX(e){const{width:t,height:n}=rF(e);return{width:t,height:n}}function lX(e,t,n){const r=Wi(t),s=Vi(t),i=n==="fixed",o=Vc(e,!0,i,t);let l={scrollLeft:0,scrollTop:0};const c=Fi(0);function u(){c.x=LN(s)}if(r||!r&&!i)if((Eh(t)!=="body"||Dp(s))&&(l=ob(t)),r){const m=Vc(t,!0,i,t);c.x=m.x+t.clientLeft,c.y=m.y+t.clientTop}else s&&u();i&&!r&&s&&u();const d=s&&!r&&!i?sF(s,l):Fi(0),h=o.left+l.scrollLeft-c.x-d.x,f=o.top+l.scrollTop-c.y-d.y;return{x:h,y:f,width:o.width,height:o.height}}function Aw(e){return hi(e).position==="static"}function fP(e,t){if(!Wi(e)||hi(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return Vi(e)===n&&(n=n.ownerDocument.body),n}function oF(e,t){const n=ls(e);if(ib(e))return n;if(!Wi(e)){let s=$l(e);for(;s&&!zd(s);){if(di(s)&&!Aw(s))return s;s=$l(s)}return n}let r=fP(e,t);for(;r&&qY(r)&&Aw(r);)r=fP(r,t);return r&&zd(r)&&Aw(r)&&!RN(r)?n:r||YY(e)||n}const cX=async function(e){const t=this.getOffsetParent||oF,n=this.getDimensions,r=await n(e.floating);return{reference:lX(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function uX(e){return hi(e).direction==="rtl"}const dX={convertOffsetParentRelativeRectToViewportRelativeRect:ZY,getDocumentElement:Vi,getClippingRect:iX,getOffsetParent:oF,getElementRects:cX,getClientRects:eX,getDimensions:oX,getScale:yd,isElement:di,isRTL:uX};function lF(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function hX(e,t){let n=null,r;const s=Vi(e);function i(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const u=e.getBoundingClientRect(),{left:d,top:h,width:f,height:m}=u;if(l||t(),!f||!m)return;const g=$g(h),v=$g(s.clientWidth-(d+f)),y=$g(s.clientHeight-(h+m)),x=$g(d),b={rootMargin:-g+"px "+-v+"px "+-y+"px "+-x+"px",threshold:as(0,Ll(1,c))||1};let _=!0;function k(j){const S=j[0].intersectionRatio;if(S!==c){if(!_)return o();S?o(!1,S):r=setTimeout(()=>{o(!1,1e-7)},1e3)}S===1&&!lF(u,e.getBoundingClientRect())&&o(),_=!1}try{n=new IntersectionObserver(k,{...b,root:s.ownerDocument})}catch{n=new IntersectionObserver(k,b)}n.observe(e)}return o(!0),i}function fX(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,u=DN(e),d=s||i?[...u?jm(u):[],...jm(t)]:[];d.forEach(x=>{s&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});const h=u&&l?hX(u,n):null;let f=-1,m=null;o&&(m=new ResizeObserver(x=>{let[w]=x;w&&w.target===u&&m&&(m.unobserve(t),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var b;(b=m)==null||b.observe(t)})),n()}),u&&!c&&m.observe(u),m.observe(t));let g,v=c?Vc(e):null;c&&y();function y(){const x=Vc(e);v&&!lF(v,x)&&n(),v=x,g=requestAnimationFrame(y)}return n(),()=>{var x;d.forEach(w=>{s&&w.removeEventListener("scroll",n),i&&w.removeEventListener("resize",n)}),h==null||h(),(x=m)==null||x.disconnect(),m=null,c&&cancelAnimationFrame(g)}}const mX=$Y,pX=FY,gX=MY,vX=BY,yX=DY,mP=RY,xX=UY,bX=(e,t,n)=>{const r=new Map,s={platform:dX,...n},i={...s.platform,_c:r};return IY(e,t,{...s,platform:i})};var wX=typeof document<"u",jX=function(){},Dv=wX?p.useLayoutEffect:jX;function jy(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!jy(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&e.$$typeof)&&!jy(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function cF(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function pP(e,t){const n=cF(e);return Math.round(t*n)/n}function Ew(e){const t=p.useRef(e);return Dv(()=>{t.current=e}),t}function _X(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=e,[d,h]=p.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[f,m]=p.useState(r);jy(f,r)||m(r);const[g,v]=p.useState(null),[y,x]=p.useState(null),w=p.useCallback(C=>{C!==j.current&&(j.current=C,v(C))},[]),b=p.useCallback(C=>{C!==S.current&&(S.current=C,x(C))},[]),_=i||g,k=o||y,j=p.useRef(null),S=p.useRef(null),T=p.useRef(d),O=c!=null,A=Ew(c),N=Ew(s),L=Ew(u),M=p.useCallback(()=>{if(!j.current||!S.current)return;const C={placement:t,strategy:n,middleware:f};N.current&&(C.platform=N.current),bX(j.current,S.current,C).then(D=>{const E={...D,isPositioned:L.current!==!1};B.current&&!jy(T.current,E)&&(T.current=E,cu.flushSync(()=>{h(E)}))})},[f,t,n,N,L]);Dv(()=>{u===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,h(C=>({...C,isPositioned:!1})))},[u]);const B=p.useRef(!1);Dv(()=>(B.current=!0,()=>{B.current=!1}),[]),Dv(()=>{if(_&&(j.current=_),k&&(S.current=k),_&&k){if(A.current)return A.current(_,k,M);M()}},[_,k,M,A,O]);const $=p.useMemo(()=>({reference:j,floating:S,setReference:w,setFloating:b}),[w,b]),z=p.useMemo(()=>({reference:_,floating:k}),[_,k]),R=p.useMemo(()=>{const C={position:n,left:0,top:0};if(!z.floating)return C;const D=pP(z.floating,d.x),E=pP(z.floating,d.y);return l?{...C,transform:"translate("+D+"px, "+E+"px)",...cF(z.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:D,top:E}},[n,l,z.floating,d.x,d.y]);return p.useMemo(()=>({...d,update:M,refs:$,elements:z,floatingStyles:R}),[d,M,$,z,R])}const kX=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?mP({element:r.current,padding:s}).fn(n):{}:r?mP({element:r,padding:s}).fn(n):{}}}},SX=(e,t)=>({...mX(e),options:[e,t]}),NX=(e,t)=>({...pX(e),options:[e,t]}),CX=(e,t)=>({...xX(e),options:[e,t]}),AX=(e,t)=>({...gX(e),options:[e,t]}),EX=(e,t)=>({...vX(e),options:[e,t]}),TX=(e,t)=>({...yX(e),options:[e,t]}),PX=(e,t)=>({...kX(e),options:[e,t]});var OX="Arrow",uF=p.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return a.jsx(ot.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});uF.displayName=OX;var IX=uF;function $N(e){const[t,n]=p.useState(void 0);return sr(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=e.offsetWidth,l=e.offsetHeight;n({width:o,height:l})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var FN="Popper",[dF,Kl]=Mr(FN),[RX,hF]=dF(FN),fF=e=>{const{__scopePopper:t,children:n}=e,[r,s]=p.useState(null);return a.jsx(RX,{scope:t,anchor:r,onAnchorChange:s,children:n})};fF.displayName=FN;var mF="PopperAnchor",pF=p.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=hF(mF,n),o=p.useRef(null),l=Ot(t,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:a.jsx(ot.div,{...s,ref:l})});pF.displayName=mF;var UN="PopperContent",[MX,DX]=dF(UN),gF=p.forwardRef((e,t)=>{var K,ie,H,he,me,ae;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:g,...v}=e,y=hF(UN,n),[x,w]=p.useState(null),b=Ot(t,Ne=>w(Ne)),[_,k]=p.useState(null),j=$N(_),S=(j==null?void 0:j.width)??0,T=(j==null?void 0:j.height)??0,O=r+(i!=="center"?"-"+i:""),A=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},N=Array.isArray(u)?u:[u],L=N.length>0,M={padding:A,boundary:N.filter($X),altBoundary:L},{refs:B,floatingStyles:$,placement:z,isPositioned:R,middlewareData:C}=_X({strategy:"fixed",placement:O,whileElementsMounted:(...Ne)=>fX(...Ne,{animationFrame:m==="always"}),elements:{reference:y.anchor},middleware:[SX({mainAxis:s+T,alignmentAxis:o}),c&&NX({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?CX():void 0,...M}),c&&AX({...M}),EX({...M,apply:({elements:Ne,rects:de,availableWidth:Q,availableHeight:fe})=>{const{width:Be,height:je}=de.reference,Ce=Ne.floating.style;Ce.setProperty("--radix-popper-available-width",`${Q}px`),Ce.setProperty("--radix-popper-available-height",`${fe}px`),Ce.setProperty("--radix-popper-anchor-width",`${Be}px`),Ce.setProperty("--radix-popper-anchor-height",`${je}px`)}}),_&&PX({element:_,padding:l}),FX({arrowWidth:S,arrowHeight:T}),f&&TX({strategy:"referenceHidden",...M})]}),[D,E]=xF(z),F=ar(g);sr(()=>{R&&(F==null||F())},[R,F]);const I=(K=C.arrow)==null?void 0:K.x,P=(ie=C.arrow)==null?void 0:ie.y,U=((H=C.arrow)==null?void 0:H.centerOffset)!==0,[Z,X]=p.useState();return sr(()=>{x&&X(window.getComputedStyle(x).zIndex)},[x]),a.jsx("div",{ref:B.setFloating,"data-radix-popper-content-wrapper":"",style:{...$,transform:R?$.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Z,"--radix-popper-transform-origin":[(he=C.transformOrigin)==null?void 0:he.x,(me=C.transformOrigin)==null?void 0:me.y].join(" "),...((ae=C.hide)==null?void 0:ae.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:a.jsx(MX,{scope:n,placedSide:D,onArrowChange:k,arrowX:I,arrowY:P,shouldHideArrow:U,children:a.jsx(ot.div,{"data-side":D,"data-align":E,...v,ref:b,style:{...v.style,animation:R?void 0:"none"}})})})});gF.displayName=UN;var vF="PopperArrow",LX={top:"bottom",right:"left",bottom:"top",left:"right"},yF=p.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=DX(vF,r),o=LX[i.placedSide];return a.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:a.jsx(IX,{...s,ref:n,style:{...s.style,display:"block"}})})});yF.displayName=vF;function $X(e){return e!==null}var FX=e=>({name:"transformOrigin",options:e,fn(t){var y,x,w;const{placement:n,rects:r,middlewareData:s}=t,o=((y=s.arrow)==null?void 0:y.centerOffset)!==0,l=o?0:e.arrowWidth,c=o?0:e.arrowHeight,[u,d]=xF(n),h={start:"0%",center:"50%",end:"100%"}[d],f=(((x=s.arrow)==null?void 0:x.x)??0)+l/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+c/2;let g="",v="";return u==="bottom"?(g=o?h:`${f}px`,v=`${-c}px`):u==="top"?(g=o?h:`${f}px`,v=`${r.floating.height+c}px`):u==="right"?(g=`${-c}px`,v=o?h:`${m}px`):u==="left"&&(g=`${r.floating.width+c}px`,v=o?h:`${m}px`),{data:{x:g,y:v}}}});function xF(e){const[t,n="center"]=e.split("-");return[t,n]}var lb=fF,Lp=pF,cb=gF,ub=yF,[db,sUe]=Mr("Tooltip",[Kl]),hb=Kl(),bF="TooltipProvider",UX=700,s1="tooltip.open",[BX,BN]=db(bF),wF=e=>{const{__scopeTooltip:t,delayDuration:n=UX,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=e,o=p.useRef(!0),l=p.useRef(!1),c=p.useRef(0);return p.useEffect(()=>{const u=c.current;return()=>window.clearTimeout(u)},[]),a.jsx(BX,{scope:t,isOpenDelayedRef:o,delayDuration:n,onOpen:p.useCallback(()=>{window.clearTimeout(c.current),o.current=!1},[]),onClose:p.useCallback(()=>{window.clearTimeout(c.current),c.current=window.setTimeout(()=>o.current=!0,r)},[r]),isPointerInTransitRef:l,onPointerInTransitChange:p.useCallback(u=>{l.current=u},[]),disableHoverableContent:s,children:i})};wF.displayName=bF;var _m="Tooltip",[zX,fb]=db(_m),jF=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:s,onOpenChange:i,disableHoverableContent:o,delayDuration:l}=e,c=BN(_m,e.__scopeTooltip),u=hb(t),[d,h]=p.useState(null),f=pr(),m=p.useRef(0),g=o??c.disableHoverableContent,v=l??c.delayDuration,y=p.useRef(!1),[x,w]=Ha({prop:r,defaultProp:s??!1,onChange:S=>{S?(c.onOpen(),document.dispatchEvent(new CustomEvent(s1))):c.onClose(),i==null||i(S)},caller:_m}),b=p.useMemo(()=>x?y.current?"delayed-open":"instant-open":"closed",[x]),_=p.useCallback(()=>{window.clearTimeout(m.current),m.current=0,y.current=!1,w(!0)},[w]),k=p.useCallback(()=>{window.clearTimeout(m.current),m.current=0,w(!1)},[w]),j=p.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{y.current=!0,w(!0),m.current=0},v)},[v,w]);return p.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),a.jsx(lb,{...u,children:a.jsx(zX,{scope:t,contentId:f,open:x,stateAttribute:b,trigger:d,onTriggerChange:h,onTriggerEnter:p.useCallback(()=>{c.isOpenDelayedRef.current?j():_()},[c.isOpenDelayedRef,j,_]),onTriggerLeave:p.useCallback(()=>{g?k():(window.clearTimeout(m.current),m.current=0)},[k,g]),onOpen:_,onClose:k,disableHoverableContent:g,children:n})})};jF.displayName=_m;var i1="TooltipTrigger",_F=p.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=fb(i1,n),i=BN(i1,n),o=hb(n),l=p.useRef(null),c=Ot(t,l,s.onTriggerChange),u=p.useRef(!1),d=p.useRef(!1),h=p.useCallback(()=>u.current=!1,[]);return p.useEffect(()=>()=>document.removeEventListener("pointerup",h),[h]),a.jsx(Lp,{asChild:!0,...o,children:a.jsx(ot.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:c,onPointerMove:Ve(e.onPointerMove,f=>{f.pointerType!=="touch"&&!d.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),d.current=!0)}),onPointerLeave:Ve(e.onPointerLeave,()=>{s.onTriggerLeave(),d.current=!1}),onPointerDown:Ve(e.onPointerDown,()=>{s.open&&s.onClose(),u.current=!0,document.addEventListener("pointerup",h,{once:!0})}),onFocus:Ve(e.onFocus,()=>{u.current||s.onOpen()}),onBlur:Ve(e.onBlur,s.onClose),onClick:Ve(e.onClick,s.onClose)})})});_F.displayName=i1;var WX="TooltipPortal",[iUe,qX]=db(WX,{forceMount:void 0}),Wd="TooltipContent",kF=p.forwardRef((e,t)=>{const n=qX(Wd,e.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=e,o=fb(Wd,e.__scopeTooltip);return a.jsx(Cr,{present:r||o.open,children:o.disableHoverableContent?a.jsx(SF,{side:s,...i,ref:t}):a.jsx(HX,{side:s,...i,ref:t})})}),HX=p.forwardRef((e,t)=>{const n=fb(Wd,e.__scopeTooltip),r=BN(Wd,e.__scopeTooltip),s=p.useRef(null),i=Ot(t,s),[o,l]=p.useState(null),{trigger:c,onClose:u}=n,d=s.current,{onPointerInTransitChange:h}=r,f=p.useCallback(()=>{l(null),h(!1)},[h]),m=p.useCallback((g,v)=>{const y=g.currentTarget,x={x:g.clientX,y:g.clientY},w=XX(x,y.getBoundingClientRect()),b=JX(x,w),_=QX(v.getBoundingClientRect()),k=eJ([...b,..._]);l(k),h(!0)},[h]);return p.useEffect(()=>()=>f(),[f]),p.useEffect(()=>{if(c&&d){const g=y=>m(y,d),v=y=>m(y,c);return c.addEventListener("pointerleave",g),d.addEventListener("pointerleave",v),()=>{c.removeEventListener("pointerleave",g),d.removeEventListener("pointerleave",v)}}},[c,d,m,f]),p.useEffect(()=>{if(o){const g=v=>{const y=v.target,x={x:v.clientX,y:v.clientY},w=(c==null?void 0:c.contains(y))||(d==null?void 0:d.contains(y)),b=!ZX(x,o);w?f():b&&(f(),u())};return document.addEventListener("pointermove",g),()=>document.removeEventListener("pointermove",g)}},[c,d,o,u,f]),a.jsx(SF,{...e,ref:i})}),[KX,VX]=db(_m,{isInside:!1}),GX=n4("TooltipContent"),SF=p.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:o,...l}=e,c=fb(Wd,n),u=hb(n),{onClose:d}=c;return p.useEffect(()=>(document.addEventListener(s1,d),()=>document.removeEventListener(s1,d)),[d]),p.useEffect(()=>{if(c.trigger){const h=f=>{const m=f.target;m!=null&&m.contains(c.trigger)&&d()};return window.addEventListener("scroll",h,{capture:!0}),()=>window.removeEventListener("scroll",h,{capture:!0})}},[c.trigger,d]),a.jsx(du,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:h=>h.preventDefault(),onDismiss:d,children:a.jsxs(cb,{"data-state":c.stateAttribute,...u,...l,ref:t,style:{...l.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[a.jsx(GX,{children:r}),a.jsx(KX,{scope:n,isInside:!0,children:a.jsx(xV,{id:c.contentId,role:"tooltip",children:s||r})})]})})});kF.displayName=Wd;var NF="TooltipArrow",YX=p.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=hb(n);return VX(NF,n).isInside?null:a.jsx(ub,{...s,...r,ref:t})});YX.displayName=NF;function XX(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function JX(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function QX(e){const{top:t,right:n,bottom:r,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:r},{x:s,y:r}]}function ZX(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],c=t[o],u=l.x,d=l.y,h=c.x,f=c.y;d>r!=f>r&&n<(h-u)*(r-d)/(f-d)+u&&(s=!s)}return s}function eJ(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),tJ(t)}function tJ(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const i=t[t.length-1],o=t[t.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))t.pop();else break}t.push(s)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const s=e[r];for(;n.length>=2;){const i=n[n.length-1],o=n[n.length-2];if((i.x-o.x)*(s.y-o.y)>=(i.y-o.y)*(s.x-o.x))n.pop();else break}n.push(s)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var nJ=wF,rJ=jF,aJ=_F,CF=kF;const o1=nJ,ve=rJ,ye=aJ,ge=p.forwardRef(({className:e,sideOffset:t=4,...n},r)=>a.jsx(CF,{ref:r,sideOffset:t,className:Ie("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n}));ge.displayName=CF.displayName;var mb=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},pb=typeof window>"u"||"Deno"in globalThis;function Vs(){}function sJ(e,t){return typeof e=="function"?e(t):e}function iJ(e){return typeof e=="number"&&e>=0&&e!==1/0}function oJ(e,t){return Math.max(e+(t||0)-Date.now(),0)}function l1(e,t){return typeof e=="function"?e(t):e}function lJ(e,t){return typeof e=="function"?e(t):e}function gP(e,t){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:o,stale:l}=e;if(o){if(r){if(t.queryHash!==zN(o,t.options))return!1}else if(!Sm(t.queryKey,o))return!1}if(n!=="all"){const c=t.isActive();if(n==="active"&&!c||n==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||s&&s!==t.state.fetchStatus||i&&!i(t))}function vP(e,t){const{exact:n,status:r,predicate:s,mutationKey:i}=e;if(i){if(!t.options.mutationKey)return!1;if(n){if(km(t.options.mutationKey)!==km(i))return!1}else if(!Sm(t.options.mutationKey,i))return!1}return!(r&&t.state.status!==r||s&&!s(t))}function zN(e,t){return((t==null?void 0:t.queryKeyHashFn)||km)(e)}function km(e){return JSON.stringify(e,(t,n)=>c1(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function Sm(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Sm(e[n],t[n])):!1}function AF(e,t){if(e===t)return e;const n=yP(e)&&yP(t);if(n||c1(e)&&c1(t)){const r=n?e:Object.keys(e),s=r.length,i=n?t:Object.keys(t),o=i.length,l=n?[]:{},c=new Set(r);let u=0;for(let d=0;d<o;d++){const h=n?d:i[d];(!n&&c.has(h)||n)&&e[h]===void 0&&t[h]===void 0?(l[h]=void 0,u++):(l[h]=AF(e[h],t[h]),l[h]===e[h]&&e[h]!==void 0&&u++)}return s===o&&u===s?e:l}return t}function yP(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function c1(e){if(!xP(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!xP(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function xP(e){return Object.prototype.toString.call(e)==="[object Object]"}function cJ(e){return new Promise(t=>{setTimeout(t,e)})}function uJ(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?AF(e,t):t}function dJ(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function hJ(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var WN=Symbol();function EF(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===WN?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var Ec,fl,Cd,ID,fJ=(ID=class extends mb{constructor(){super();ln(this,Ec);ln(this,fl);ln(this,Cd);$t(this,Cd,t=>{if(!pb&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){Me(this,fl)||this.setEventListener(Me(this,Cd))}onUnsubscribe(){var t;this.hasListeners()||((t=Me(this,fl))==null||t.call(this),$t(this,fl,void 0))}setEventListener(t){var n;$t(this,Cd,t),(n=Me(this,fl))==null||n.call(this),$t(this,fl,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){Me(this,Ec)!==t&&($t(this,Ec,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof Me(this,Ec)=="boolean"?Me(this,Ec):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},Ec=new WeakMap,fl=new WeakMap,Cd=new WeakMap,ID),TF=new fJ,Ad,ml,Ed,RD,mJ=(RD=class extends mb{constructor(){super();ln(this,Ad,!0);ln(this,ml);ln(this,Ed);$t(this,Ed,t=>{if(!pb&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){Me(this,ml)||this.setEventListener(Me(this,Ed))}onUnsubscribe(){var t;this.hasListeners()||((t=Me(this,ml))==null||t.call(this),$t(this,ml,void 0))}setEventListener(t){var n;$t(this,Ed,t),(n=Me(this,ml))==null||n.call(this),$t(this,ml,t(this.setOnline.bind(this)))}setOnline(t){Me(this,Ad)!==t&&($t(this,Ad,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return Me(this,Ad)}},Ad=new WeakMap,ml=new WeakMap,Ed=new WeakMap,RD),_y=new mJ;function pJ(){let e,t;const n=new Promise((s,i)=>{e=s,t=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),e(s)},n.reject=s=>{r({status:"rejected",reason:s}),t(s)},n}function gJ(e){return Math.min(1e3*2**e,3e4)}function PF(e){return(e??"online")==="online"?_y.isOnline():!0}var OF=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function Tw(e){return e instanceof OF}function IF(e){let t=!1,n=0,r=!1,s;const i=pJ(),o=v=>{var y;r||(f(new OF(v)),(y=e.abort)==null||y.call(e))},l=()=>{t=!0},c=()=>{t=!1},u=()=>TF.isFocused()&&(e.networkMode==="always"||_y.isOnline())&&e.canRun(),d=()=>PF(e.networkMode)&&e.canRun(),h=v=>{var y;r||(r=!0,(y=e.onSuccess)==null||y.call(e,v),s==null||s(),i.resolve(v))},f=v=>{var y;r||(r=!0,(y=e.onError)==null||y.call(e,v),s==null||s(),i.reject(v))},m=()=>new Promise(v=>{var y;s=x=>{(r||u())&&v(x)},(y=e.onPause)==null||y.call(e)}).then(()=>{var v;s=void 0,r||(v=e.onContinue)==null||v.call(e)}),g=()=>{if(r)return;let v;const y=n===0?e.initialPromise:void 0;try{v=y??e.fn()}catch(x){v=Promise.reject(x)}Promise.resolve(v).then(h).catch(x=>{var j;if(r)return;const w=e.retry??(pb?0:3),b=e.retryDelay??gJ,_=typeof b=="function"?b(n,x):b,k=w===!0||typeof w=="number"&&n<w||typeof w=="function"&&w(n,x);if(t||!k){f(x);return}n++,(j=e.onFail)==null||j.call(e,n,x),cJ(_).then(()=>u()?void 0:m()).then(()=>{t?f(x):g()})})};return{promise:i,cancel:o,continue:()=>(s==null||s(),i),cancelRetry:l,continueRetry:c,canStart:d,start:()=>(d()?g():m().then(g),i)}}var vJ=e=>setTimeout(e,0);function yJ(){let e=[],t=0,n=l=>{l()},r=l=>{l()},s=vJ;const i=l=>{t?e.push(l):s(()=>{n(l)})},o=()=>{const l=e;e=[],l.length&&s(()=>{r(()=>{l.forEach(c=>{n(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||o()}return c},batchCalls:l=>(...c)=>{i(()=>{l(...c)})},schedule:i,setNotifyFunction:l=>{n=l},setBatchNotifyFunction:l=>{r=l},setScheduler:l=>{s=l}}}var ba=yJ(),Tc,MD,RF=(MD=class{constructor(){ln(this,Tc)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),iJ(this.gcTime)&&$t(this,Tc,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(pb?1/0:5*60*1e3))}clearGcTimeout(){Me(this,Tc)&&(clearTimeout(Me(this,Tc)),$t(this,Tc,void 0))}},Tc=new WeakMap,MD),Td,Pc,ws,Oc,na,kp,Ic,Ys,no,DD,xJ=(DD=class extends RF{constructor(t){super();ln(this,Ys);ln(this,Td);ln(this,Pc);ln(this,ws);ln(this,Oc);ln(this,na);ln(this,kp);ln(this,Ic);$t(this,Ic,!1),$t(this,kp,t.defaultOptions),this.setOptions(t.options),this.observers=[],$t(this,Oc,t.client),$t(this,ws,Me(this,Oc).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,$t(this,Td,wJ(this.options)),this.state=t.state??Me(this,Td),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=Me(this,na))==null?void 0:t.promise}setOptions(t){this.options={...Me(this,kp),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Me(this,ws).remove(this)}setData(t,n){const r=uJ(this.state.data,t,this.options);return Zr(this,Ys,no).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){Zr(this,Ys,no).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,s;const n=(r=Me(this,na))==null?void 0:r.promise;return(s=Me(this,na))==null||s.cancel(t),n?n.then(Vs).catch(Vs):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Me(this,Td))}isActive(){return this.observers.some(t=>lJ(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===WN||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>l1(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!oJ(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=Me(this,na))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=Me(this,na))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),Me(this,ws).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(Me(this,na)&&(Me(this,Ic)?Me(this,na).cancel({revert:!0}):Me(this,na).cancelRetry()),this.scheduleGc()),Me(this,ws).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Zr(this,Ys,no).call(this,{type:"invalidate"})}fetch(t,n){var u,d,h;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(Me(this,na))return Me(this,na).continueRetry(),Me(this,na).promise}if(t&&this.setOptions(t),!this.options.queryFn){const f=this.observers.find(m=>m.options.queryFn);f&&this.setOptions(f.options)}const r=new AbortController,s=f=>{Object.defineProperty(f,"signal",{enumerable:!0,get:()=>($t(this,Ic,!0),r.signal)})},i=()=>{const f=EF(this.options,n),g=(()=>{const v={client:Me(this,Oc),queryKey:this.queryKey,meta:this.meta};return s(v),v})();return $t(this,Ic,!1),this.options.persister?this.options.persister(f,g,this):f(g)},l=(()=>{const f={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:Me(this,Oc),state:this.state,fetchFn:i};return s(f),f})();(u=this.options.behavior)==null||u.onFetch(l,this),$t(this,Pc,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((d=l.fetchOptions)==null?void 0:d.meta))&&Zr(this,Ys,no).call(this,{type:"fetch",meta:(h=l.fetchOptions)==null?void 0:h.meta});const c=f=>{var m,g,v,y;Tw(f)&&f.silent||Zr(this,Ys,no).call(this,{type:"error",error:f}),Tw(f)||((g=(m=Me(this,ws).config).onError)==null||g.call(m,f,this),(y=(v=Me(this,ws).config).onSettled)==null||y.call(v,this.state.data,f,this)),this.scheduleGc()};return $t(this,na,IF({initialPromise:n==null?void 0:n.initialPromise,fn:l.fetchFn,abort:r.abort.bind(r),onSuccess:f=>{var m,g,v,y;if(f===void 0){c(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(f)}catch(x){c(x);return}(g=(m=Me(this,ws).config).onSuccess)==null||g.call(m,f,this),(y=(v=Me(this,ws).config).onSettled)==null||y.call(v,f,this.state.error,this),this.scheduleGc()},onError:c,onFail:(f,m)=>{Zr(this,Ys,no).call(this,{type:"failed",failureCount:f,error:m})},onPause:()=>{Zr(this,Ys,no).call(this,{type:"pause"})},onContinue:()=>{Zr(this,Ys,no).call(this,{type:"continue"})},retry:l.options.retry,retryDelay:l.options.retryDelay,networkMode:l.options.networkMode,canRun:()=>!0})),Me(this,na).start()}},Td=new WeakMap,Pc=new WeakMap,ws=new WeakMap,Oc=new WeakMap,na=new WeakMap,kp=new WeakMap,Ic=new WeakMap,Ys=new WeakSet,no=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...bJ(r.data,this.options),fetchMeta:t.meta??null};case"success":return $t(this,Pc,void 0),{...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const s=t.error;return Tw(s)&&s.revert&&Me(this,Pc)?{...Me(this,Pc),fetchStatus:"idle"}:{...r,error:s,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),ba.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),Me(this,ws).notify({query:this,type:"updated",action:t})})},DD);function bJ(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:PF(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function wJ(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var ki,LD,jJ=(LD=class extends mb{constructor(t={}){super();ln(this,ki);this.config=t,$t(this,ki,new Map)}build(t,n,r){const s=n.queryKey,i=n.queryHash??zN(s,n);let o=this.get(i);return o||(o=new xJ({client:t,queryKey:s,queryHash:i,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(s)}),this.add(o)),o}add(t){Me(this,ki).has(t.queryHash)||(Me(this,ki).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=Me(this,ki).get(t.queryHash);n&&(t.destroy(),n===t&&Me(this,ki).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ba.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return Me(this,ki).get(t)}getAll(){return[...Me(this,ki).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>gP(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>gP(t,r)):n}notify(t){ba.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){ba.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ba.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ki=new WeakMap,LD),Si,fa,Rc,Ni,tl,$D,_J=($D=class extends RF{constructor(t){super();ln(this,Ni);ln(this,Si);ln(this,fa);ln(this,Rc);this.mutationId=t.mutationId,$t(this,fa,t.mutationCache),$t(this,Si,[]),this.state=t.state||kJ(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){Me(this,Si).includes(t)||(Me(this,Si).push(t),this.clearGcTimeout(),Me(this,fa).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){$t(this,Si,Me(this,Si).filter(n=>n!==t)),this.scheduleGc(),Me(this,fa).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){Me(this,Si).length||(this.state.status==="pending"?this.scheduleGc():Me(this,fa).remove(this))}continue(){var t;return((t=Me(this,Rc))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var i,o,l,c,u,d,h,f,m,g,v,y,x,w,b,_,k,j,S,T;const n=()=>{Zr(this,Ni,tl).call(this,{type:"continue"})};$t(this,Rc,IF({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(O,A)=>{Zr(this,Ni,tl).call(this,{type:"failed",failureCount:O,error:A})},onPause:()=>{Zr(this,Ni,tl).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Me(this,fa).canRun(this)}));const r=this.state.status==="pending",s=!Me(this,Rc).canStart();try{if(r)n();else{Zr(this,Ni,tl).call(this,{type:"pending",variables:t,isPaused:s}),await((o=(i=Me(this,fa).config).onMutate)==null?void 0:o.call(i,t,this));const A=await((c=(l=this.options).onMutate)==null?void 0:c.call(l,t));A!==this.state.context&&Zr(this,Ni,tl).call(this,{type:"pending",context:A,variables:t,isPaused:s})}const O=await Me(this,Rc).start();return await((d=(u=Me(this,fa).config).onSuccess)==null?void 0:d.call(u,O,t,this.state.context,this)),await((f=(h=this.options).onSuccess)==null?void 0:f.call(h,O,t,this.state.context)),await((g=(m=Me(this,fa).config).onSettled)==null?void 0:g.call(m,O,null,this.state.variables,this.state.context,this)),await((y=(v=this.options).onSettled)==null?void 0:y.call(v,O,null,t,this.state.context)),Zr(this,Ni,tl).call(this,{type:"success",data:O}),O}catch(O){try{throw await((w=(x=Me(this,fa).config).onError)==null?void 0:w.call(x,O,t,this.state.context,this)),await((_=(b=this.options).onError)==null?void 0:_.call(b,O,t,this.state.context)),await((j=(k=Me(this,fa).config).onSettled)==null?void 0:j.call(k,void 0,O,this.state.variables,this.state.context,this)),await((T=(S=this.options).onSettled)==null?void 0:T.call(S,void 0,O,t,this.state.context)),O}finally{Zr(this,Ni,tl).call(this,{type:"error",error:O})}}finally{Me(this,fa).runNext(this)}}},Si=new WeakMap,fa=new WeakMap,Rc=new WeakMap,Ni=new WeakSet,tl=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),ba.batch(()=>{Me(this,Si).forEach(r=>{r.onMutationUpdate(t)}),Me(this,fa).notify({mutation:this,type:"updated",action:t})})},$D);function kJ(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var co,Xs,Sp,FD,SJ=(FD=class extends mb{constructor(t={}){super();ln(this,co);ln(this,Xs);ln(this,Sp);this.config=t,$t(this,co,new Set),$t(this,Xs,new Map),$t(this,Sp,0)}build(t,n,r){const s=new _J({mutationCache:this,mutationId:++vg(this,Sp)._,options:t.defaultMutationOptions(n),state:r});return this.add(s),s}add(t){Me(this,co).add(t);const n=Fg(t);if(typeof n=="string"){const r=Me(this,Xs).get(n);r?r.push(t):Me(this,Xs).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(Me(this,co).delete(t)){const n=Fg(t);if(typeof n=="string"){const r=Me(this,Xs).get(n);if(r)if(r.length>1){const s=r.indexOf(t);s!==-1&&r.splice(s,1)}else r[0]===t&&Me(this,Xs).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Fg(t);if(typeof n=="string"){const r=Me(this,Xs).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===t}else return!0}runNext(t){var r;const n=Fg(t);if(typeof n=="string"){const s=(r=Me(this,Xs).get(n))==null?void 0:r.find(i=>i!==t&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){ba.batch(()=>{Me(this,co).forEach(t=>{this.notify({type:"removed",mutation:t})}),Me(this,co).clear(),Me(this,Xs).clear()})}getAll(){return Array.from(Me(this,co))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>vP(n,r))}findAll(t={}){return this.getAll().filter(n=>vP(t,n))}notify(t){ba.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return ba.batch(()=>Promise.all(t.map(n=>n.continue().catch(Vs))))}},co=new WeakMap,Xs=new WeakMap,Sp=new WeakMap,FD);function Fg(e){var t;return(t=e.options.scope)==null?void 0:t.id}function bP(e){return{onFetch:(t,n)=>{var d,h,f,m,g;const r=t.options,s=(f=(h=(d=t.fetchOptions)==null?void 0:d.meta)==null?void 0:h.fetchMore)==null?void 0:f.direction,i=((m=t.state.data)==null?void 0:m.pages)||[],o=((g=t.state.data)==null?void 0:g.pageParams)||[];let l={pages:[],pageParams:[]},c=0;const u=async()=>{let v=!1;const y=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(t.signal.aborted?v=!0:t.signal.addEventListener("abort",()=>{v=!0}),t.signal)})},x=EF(t.options,t.fetchOptions),w=async(b,_,k)=>{if(v)return Promise.reject();if(_==null&&b.pages.length)return Promise.resolve(b);const S=(()=>{const N={client:t.client,queryKey:t.queryKey,pageParam:_,direction:k?"backward":"forward",meta:t.options.meta};return y(N),N})(),T=await x(S),{maxPages:O}=t.options,A=k?hJ:dJ;return{pages:A(b.pages,T,O),pageParams:A(b.pageParams,_,O)}};if(s&&i.length){const b=s==="backward",_=b?NJ:wP,k={pages:i,pageParams:o},j=_(r,k);l=await w(k,j,b)}else{const b=e??i.length;do{const _=c===0?o[0]??r.initialPageParam:wP(r,l);if(c>0&&_==null)break;l=await w(l,_),c++}while(c<b)}return l};t.options.persister?t.fetchFn=()=>{var v,y;return(y=(v=t.options).persister)==null?void 0:y.call(v,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=u}}}function wP(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function NJ(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var er,pl,gl,Pd,Od,vl,Id,Rd,UD,CJ=(UD=class{constructor(e={}){ln(this,er);ln(this,pl);ln(this,gl);ln(this,Pd);ln(this,Od);ln(this,vl);ln(this,Id);ln(this,Rd);$t(this,er,e.queryCache||new jJ),$t(this,pl,e.mutationCache||new SJ),$t(this,gl,e.defaultOptions||{}),$t(this,Pd,new Map),$t(this,Od,new Map),$t(this,vl,0)}mount(){vg(this,vl)._++,Me(this,vl)===1&&($t(this,Id,TF.subscribe(async e=>{e&&(await this.resumePausedMutations(),Me(this,er).onFocus())})),$t(this,Rd,_y.subscribe(async e=>{e&&(await this.resumePausedMutations(),Me(this,er).onOnline())})))}unmount(){var e,t;vg(this,vl)._--,Me(this,vl)===0&&((e=Me(this,Id))==null||e.call(this),$t(this,Id,void 0),(t=Me(this,Rd))==null||t.call(this),$t(this,Rd,void 0))}isFetching(e){return Me(this,er).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return Me(this,pl).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Me(this,er).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=Me(this,er).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(l1(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return Me(this,er).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),s=Me(this,er).get(r.queryHash),i=s==null?void 0:s.state.data,o=sJ(t,i);if(o!==void 0)return Me(this,er).build(this,r).setData(o,{...n,manual:!0})}setQueriesData(e,t,n){return ba.batch(()=>Me(this,er).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=Me(this,er).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=Me(this,er);ba.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=Me(this,er);return ba.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=ba.batch(()=>Me(this,er).findAll(e).map(s=>s.cancel(n)));return Promise.all(r).then(Vs).catch(Vs)}invalidateQueries(e,t={}){return ba.batch(()=>(Me(this,er).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=ba.batch(()=>Me(this,er).findAll(e).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Vs)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Vs)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=Me(this,er).build(this,t);return n.isStaleByTime(l1(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Vs).catch(Vs)}fetchInfiniteQuery(e){return e.behavior=bP(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Vs).catch(Vs)}ensureInfiniteQueryData(e){return e.behavior=bP(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return _y.isOnline()?Me(this,pl).resumePausedMutations():Promise.resolve()}getQueryCache(){return Me(this,er)}getMutationCache(){return Me(this,pl)}getDefaultOptions(){return Me(this,gl)}setDefaultOptions(e){$t(this,gl,e)}setQueryDefaults(e,t){Me(this,Pd).set(km(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...Me(this,Pd).values()],n={};return t.forEach(r=>{Sm(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){Me(this,Od).set(km(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...Me(this,Od).values()],n={};return t.forEach(r=>{Sm(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...Me(this,gl).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=zN(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===WN&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...Me(this,gl).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){Me(this,er).clear(),Me(this,pl).clear()}},er=new WeakMap,pl=new WeakMap,gl=new WeakMap,Pd=new WeakMap,Od=new WeakMap,vl=new WeakMap,Id=new WeakMap,Rd=new WeakMap,UD),AJ=p.createContext(void 0),EJ=({client:e,children:t})=>(p.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),a.jsx(AJ.Provider,{value:e,children:t}));/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Nm(){return Nm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Nm.apply(this,arguments)}var bl;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(bl||(bl={}));const jP="popstate";function TJ(e){e===void 0&&(e={});function t(r,s){let{pathname:i,search:o,hash:l}=r.location;return u1("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:ky(s)}return OJ(t,n,null,e)}function gr(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function MF(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function PJ(){return Math.random().toString(36).substr(2,8)}function _P(e,t){return{usr:e.state,key:e.key,idx:t}}function u1(e,t,n,r){return n===void 0&&(n=null),Nm({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Th(t):t,{state:n,key:t&&t.key||r||PJ()})}function ky(e){let{pathname:t="/",search:n="",hash:r=""}=e;return n&&n!=="?"&&(t+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(t+=r.charAt(0)==="#"?r:"#"+r),t}function Th(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substr(n),e=e.substr(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substr(r),e=e.substr(0,r)),e&&(t.pathname=e)}return t}function OJ(e,t,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=bl.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(Nm({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){l=bl.Pop;let y=d(),x=y==null?null:y-u;u=y,c&&c({action:l,location:v.location,delta:x})}function f(y,x){l=bl.Push;let w=u1(v.location,y,x);u=d()+1;let b=_P(w,u),_=v.createHref(w);try{o.pushState(b,"",_)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;s.location.assign(_)}i&&c&&c({action:l,location:v.location,delta:1})}function m(y,x){l=bl.Replace;let w=u1(v.location,y,x);u=d();let b=_P(w,u),_=v.createHref(w);o.replaceState(b,"",_),i&&c&&c({action:l,location:v.location,delta:0})}function g(y){let x=s.location.origin!=="null"?s.location.origin:s.location.href,w=typeof y=="string"?y:ky(y);return w=w.replace(/ $/,"%20"),gr(x,"No window.location.(origin|href) available to create URL for href: "+w),new URL(w,x)}let v={get action(){return l},get location(){return e(s,o)},listen(y){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(jP,h),c=y,()=>{s.removeEventListener(jP,h),c=null}},createHref(y){return t(s,y)},createURL:g,encodeLocation(y){let x=g(y);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:f,replace:m,go(y){return o.go(y)}};return v}var kP;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(kP||(kP={}));function IJ(e,t,n){return n===void 0&&(n="/"),RJ(e,t,n,!1)}function RJ(e,t,n,r){let s=typeof t=="string"?Th(t):t,i=qN(s.pathname||"/",n);if(i==null)return null;let o=DF(e);MJ(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=KJ(i);l=qJ(o[c],u,r)}return l}function DF(e,t,n,r){t===void 0&&(t=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(gr(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Tl([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(gr(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),DF(i.children,t,d,u)),!(i.path==null&&!i.index)&&t.push({path:u,score:zJ(u,i.index),routesMeta:d})};return e.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of LF(i.path))s(i,o,c)}),t}function LF(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=LF(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>e.startsWith("/")&&c===""?"/":c)}function MJ(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:WJ(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const DJ=/^:[\w-]+$/,LJ=3,$J=2,FJ=1,UJ=10,BJ=-2,SP=e=>e==="*";function zJ(e,t){let n=e.split("/"),r=n.length;return n.some(SP)&&(r+=BJ),t&&(r+=$J),n.filter(s=>!SP(s)).reduce((s,i)=>s+(DJ.test(i)?LJ:i===""?FJ:UJ),r)}function WJ(e,t){return e.length===t.length&&e.slice(0,-1).every((r,s)=>r===t[s])?e[e.length-1]-t[t.length-1]:0}function qJ(e,t,n){let{routesMeta:r}=e,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=i==="/"?t:t.slice(i.length)||"/",h=NP({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h&&u&&n&&!r[r.length-1].route.index&&(h=NP({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Tl([i,h.pathname]),pathnameBase:XJ(Tl([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=Tl([i,h.pathnameBase]))}return o}function NP(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=HJ(e.path,e.caseSensitive,e.end),s=t.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,h)=>{let{paramName:f,isOptional:m}=d;if(f==="*"){let v=l[h]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const g=l[h];return m&&!g?u[f]=void 0:u[f]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:e}}function HJ(e,t,n){t===void 0&&(t=!1),n===void 0&&(n=!0),MF(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let r=[],s="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),s+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":e!==""&&e!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,t?void 0:"i"),r]}function KJ(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return MF(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function qN(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function VJ(e,t){t===void 0&&(t="/");let{pathname:n,search:r="",hash:s=""}=typeof e=="string"?Th(e):e;return{pathname:n?n.startsWith("/")?n:GJ(n,t):t,search:JJ(r),hash:QJ(s)}}function GJ(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Pw(e,t,n,r){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function YJ(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function $F(e,t){let n=YJ(e);return t?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function FF(e,t,n,r){r===void 0&&(r=!1);let s;typeof e=="string"?s=Th(e):(s=Nm({},e),gr(!s.pathname||!s.pathname.includes("?"),Pw("?","pathname","search",s)),gr(!s.pathname||!s.pathname.includes("#"),Pw("#","pathname","hash",s)),gr(!s.search||!s.search.includes("#"),Pw("#","search","hash",s)));let i=e===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let h=t.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}l=h>=0?t[h]:"/"}let c=VJ(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Tl=e=>e.join("/").replace(/\/\/+/g,"/"),XJ=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),JJ=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,QJ=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function ZJ(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const UF=["post","put","patch","delete"];new Set(UF);const eQ=["get",...UF];new Set(eQ);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Cm(){return Cm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Cm.apply(this,arguments)}const HN=p.createContext(null),tQ=p.createContext(null),hu=p.createContext(null),gb=p.createContext(null),Vl=p.createContext({outlet:null,matches:[],isDataRoute:!1}),BF=p.createContext(null);function nQ(e,t){let{relative:n}=t===void 0?{}:t;$p()||gr(!1);let{basename:r,navigator:s}=p.useContext(hu),{hash:i,pathname:o,search:l}=WF(e,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Tl([r,o])),s.createHref({pathname:c,search:l,hash:i})}function $p(){return p.useContext(gb)!=null}function $o(){return $p()||gr(!1),p.useContext(gb).location}function zF(e){p.useContext(hu).static||p.useLayoutEffect(e)}function Va(){let{isDataRoute:e}=p.useContext(Vl);return e?gQ():rQ()}function rQ(){$p()||gr(!1);let e=p.useContext(HN),{basename:t,future:n,navigator:r}=p.useContext(hu),{matches:s}=p.useContext(Vl),{pathname:i}=$o(),o=JSON.stringify($F(s,n.v7_relativeSplatPath)),l=p.useRef(!1);return zF(()=>{l.current=!0}),p.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let h=FF(u,JSON.parse(o),i,d.relative==="path");e==null&&t!=="/"&&(h.pathname=h.pathname==="/"?t:Tl([t,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[t,r,o,i,e])}function aQ(){let{matches:e}=p.useContext(Vl),t=e[e.length-1];return t?t.params:{}}function WF(e,t){let{relative:n}=t===void 0?{}:t,{future:r}=p.useContext(hu),{matches:s}=p.useContext(Vl),{pathname:i}=$o(),o=JSON.stringify($F(s,r.v7_relativeSplatPath));return p.useMemo(()=>FF(e,JSON.parse(o),i,n==="path"),[e,o,i,n])}function sQ(e,t){return iQ(e,t)}function iQ(e,t,n,r){$p()||gr(!1);let{navigator:s}=p.useContext(hu),{matches:i}=p.useContext(Vl),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=$o(),d;if(t){var h;let y=typeof t=="string"?Th(t):t;c==="/"||(h=y.pathname)!=null&&h.startsWith(c)||gr(!1),d=y}else d=u;let f=d.pathname||"/",m=f;if(c!=="/"){let y=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(y.length).join("/")}let g=IJ(e,{pathname:m}),v=dQ(g&&g.map(y=>Object.assign({},y,{params:Object.assign({},l,y.params),pathname:Tl([c,s.encodeLocation?s.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?c:Tl([c,s.encodeLocation?s.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),i,n,r);return t&&v?p.createElement(gb.Provider,{value:{location:Cm({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:bl.Pop}},v):v}function oQ(){let e=pQ(),t=ZJ(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},t),n?p.createElement("pre",{style:s},n):null,null)}const lQ=p.createElement(oQ,null);class cQ extends p.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,n){return n.location!==t.location||n.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:n.error,location:n.location,revalidation:t.revalidation||n.revalidation}}componentDidCatch(t,n){console.error("React Router caught the following error during render",t,n)}render(){return this.state.error!==void 0?p.createElement(Vl.Provider,{value:this.props.routeContext},p.createElement(BF.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function uQ(e){let{routeContext:t,match:n,children:r}=e,s=p.useContext(HN);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),p.createElement(Vl.Provider,{value:t},r)}function dQ(e,t,n,r){var s;if(t===void 0&&(t=[]),n===void 0&&(n=null),r===void 0&&(r=null),e==null){var i;if(!n)return null;if(n.errors)e=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let o=e,l=(s=n)==null?void 0:s.errors;if(l!=null){let d=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||gr(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:m}=n,g=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||g){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let m,g=!1,v=null,y=null;n&&(m=l&&h.route.id?l[h.route.id]:void 0,v=h.route.errorElement||lQ,c&&(u<0&&f===0?(g=!0,y=null):u===f&&(g=!0,y=h.route.hydrateFallbackElement||null)));let x=t.concat(o.slice(0,f+1)),w=()=>{let b;return m?b=v:g?b=y:h.route.Component?b=p.createElement(h.route.Component,null):h.route.element?b=h.route.element:b=d,p.createElement(uQ,{match:h,routeContext:{outlet:d,matches:x,isDataRoute:n!=null},children:b})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?p.createElement(cQ,{location:n.location,revalidation:n.revalidation,component:v,error:m,children:w(),routeContext:{outlet:null,matches:x,isDataRoute:!0}}):w()},null)}var qF=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(qF||{}),Sy=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Sy||{});function hQ(e){let t=p.useContext(HN);return t||gr(!1),t}function fQ(e){let t=p.useContext(tQ);return t||gr(!1),t}function mQ(e){let t=p.useContext(Vl);return t||gr(!1),t}function HF(e){let t=mQ(),n=t.matches[t.matches.length-1];return n.route.id||gr(!1),n.route.id}function pQ(){var e;let t=p.useContext(BF),n=fQ(Sy.UseRouteError),r=HF(Sy.UseRouteError);return t!==void 0?t:(e=n.errors)==null?void 0:e[r]}function gQ(){let{router:e}=hQ(qF.UseNavigateStable),t=HF(Sy.UseNavigateStable),n=p.useRef(!1);return zF(()=>{n.current=!0}),p.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?e.navigate(s):e.navigate(s,Cm({fromRouteId:t},i)))},[e,t])}function vQ(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function Za(e){gr(!1)}function yQ(e){let{basename:t="/",children:n=null,location:r,navigationType:s=bl.Pop,navigator:i,static:o=!1,future:l}=e;$p()&&gr(!1);let c=t.replace(/^\/*/,"/"),u=p.useMemo(()=>({basename:c,navigator:i,static:o,future:Cm({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=Th(r));let{pathname:d="/",search:h="",hash:f="",state:m=null,key:g="default"}=r,v=p.useMemo(()=>{let y=qN(d,c);return y==null?null:{location:{pathname:y,search:h,hash:f,state:m,key:g},navigationType:s}},[c,d,h,f,m,g,s]);return v==null?null:p.createElement(hu.Provider,{value:u},p.createElement(gb.Provider,{children:n,value:v}))}function xQ(e){let{children:t,location:n}=e;return sQ(d1(t),n)}new Promise(()=>{});function d1(e,t){t===void 0&&(t=[]);let n=[];return p.Children.forEach(e,(r,s)=>{if(!p.isValidElement(r))return;let i=[...t,s];if(r.type===p.Fragment){n.push.apply(n,d1(r.props.children,i));return}r.type!==Za&&gr(!1),!r.props.index||!r.props.children||gr(!1);let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=d1(r.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function h1(){return h1=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},h1.apply(this,arguments)}function bQ(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,i;for(i=0;i<r.length;i++)s=r[i],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function wQ(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function jQ(e,t){return e.button===0&&(!t||t==="_self")&&!wQ(e)}function f1(e){return e===void 0&&(e=""),new URLSearchParams(typeof e=="string"||Array.isArray(e)||e instanceof URLSearchParams?e:Object.keys(e).reduce((t,n)=>{let r=e[n];return t.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function _Q(e,t){let n=f1(e);return t&&t.forEach((r,s)=>{n.has(s)||t.getAll(s).forEach(i=>{n.append(s,i)})}),n}const kQ=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],SQ="6";try{window.__reactRouterVersion=SQ}catch{}const NQ="startTransition",CP=ES[NQ];function CQ(e){let{basename:t,children:n,future:r,window:s}=e,i=p.useRef();i.current==null&&(i.current=TJ({window:s,v5Compat:!0}));let o=i.current,[l,c]=p.useState({action:o.action,location:o.location}),{v7_startTransition:u}=r||{},d=p.useCallback(h=>{u&&CP?CP(()=>c(h)):c(h)},[c,u]);return p.useLayoutEffect(()=>o.listen(d),[o,d]),p.useEffect(()=>vQ(r),[r]),p.createElement(yQ,{basename:t,children:n,location:l.location,navigationType:l.action,navigator:o,future:r})}const AQ=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",EQ=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,TQ=p.forwardRef(function(t,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h}=t,f=bQ(t,kQ),{basename:m}=p.useContext(hu),g,v=!1;if(typeof u=="string"&&EQ.test(u)&&(g=u,AQ))try{let b=new URL(window.location.href),_=u.startsWith("//")?new URL(b.protocol+u):new URL(u),k=qN(_.pathname,m);_.origin===b.origin&&k!=null?u=k+_.search+_.hash:v=!0}catch{}let y=nQ(u,{relative:s}),x=PQ(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:h});function w(b){r&&r(b),b.defaultPrevented||x(b)}return p.createElement("a",h1({},f,{href:g||y,onClick:v||i?r:w,ref:n,target:c}))});var AP;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(AP||(AP={}));var EP;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(EP||(EP={}));function PQ(e,t){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=t===void 0?{}:t,c=Va(),u=$o(),d=WF(e,{relative:o});return p.useCallback(h=>{if(jQ(h,n)){h.preventDefault();let f=r!==void 0?r:ky(u)===ky(d);c(e,{replace:f,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,d,r,s,n,e,i,o,l])}function KN(e){let t=p.useRef(f1(e)),n=p.useRef(!1),r=$o(),s=p.useMemo(()=>_Q(r.search,n.current?null:t.current),[r.search]),i=Va(),o=p.useCallback((l,c)=>{const u=f1(typeof l=="function"?l(s):l);n.current=!0,i("?"+u,c)},[i,s]);return[s,o]}const OQ="modulepreload",IQ=function(e){return"/"+e},TP={},fu=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=IQ(c),c in TP)return;TP[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":OQ,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((f,m)=>{h.addEventListener("load",f),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return t().catch(i)})},RQ=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>fu(async()=>{const{default:r}=await Promise.resolve().then(()=>Ph);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)};class VN extends Error{constructor(t,n="FunctionsError",r){super(t),this.name=n,this.context=r}}class MQ extends VN{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class PP extends VN{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class OP extends VN{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var m1;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(m1||(m1={}));var DQ=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};class LQ{constructor(t,{headers:n={},customFetch:r,region:s=m1.Any}={}){this.url=t,this.headers=n,this.region=s,this.fetch=RQ(r)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,n={}){var r;return DQ(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:o}=n;let l={},{region:c}=n;c||(c=this.region);const u=new URL(`${this.url}/${t}`);c&&c!=="any"&&(l["x-region"]=c,u.searchParams.set("forceFunctionRegion",c));let d;o&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&o instanceof Blob||o instanceof ArrayBuffer?(l["Content-Type"]="application/octet-stream",d=o):typeof o=="string"?(l["Content-Type"]="text/plain",d=o):typeof FormData<"u"&&o instanceof FormData?d=o:(l["Content-Type"]="application/json",d=JSON.stringify(o)));const h=yield this.fetch(u.toString(),{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},l),this.headers),s),body:d}).catch(v=>{throw new MQ(v)}),f=h.headers.get("x-relay-error");if(f&&f==="true")throw new PP(h);if(!h.ok)throw new OP(h);let m=((r=h.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),g;return m==="application/json"?g=yield h.json():m==="application/octet-stream"?g=yield h.blob():m==="text/event-stream"?g=h:m==="multipart/form-data"?g=yield h.formData():g=yield h.text(),{data:g,error:null,response:h}}catch(s){return{data:null,error:s,response:s instanceof OP||s instanceof PP?s.context:void 0}}})}}var Ra={},GN={},vb={},Fp={},yb={},xb={},$Q=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},qd=$Q();const FQ=qd.fetch,KF=qd.fetch.bind(qd),VF=qd.Headers,UQ=qd.Request,BQ=qd.Response,Ph=Object.freeze(Object.defineProperty({__proto__:null,Headers:VF,Request:UQ,Response:BQ,default:KF,fetch:FQ},Symbol.toStringTag,{value:"Module"})),zQ=yH(Ph);var bb={};Object.defineProperty(bb,"__esModule",{value:!0});let WQ=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};bb.default=WQ;var GF=mr&&mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(xb,"__esModule",{value:!0});const qQ=GF(zQ),HQ=GF(bb);let KQ=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=qQ.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,n){return this.headers=Object.assign({},this.headers),this.headers[t]=n,this}then(t,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var o,l,c;let u=null,d=null,h=null,f=i.status,m=i.statusText;if(i.ok){if(this.method!=="HEAD"){const x=await i.text();x===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?d=x:d=JSON.parse(x))}const v=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),y=(l=i.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");v&&y&&y.length>1&&(h=parseInt(y[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(d)&&(d.length>1?(u={code:"PGRST116",details:`Results contain ${d.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},d=null,h=null,f=406,m="Not Acceptable"):d.length===1?d=d[0]:d=null)}else{const v=await i.text();try{u=JSON.parse(v),Array.isArray(u)&&i.status===404&&(d=[],u=null,f=200,m="OK")}catch{i.status===404&&v===""?(f=204,m="No Content"):u={message:v}}if(u&&this.isMaybeSingle&&(!((c=u==null?void 0:u.details)===null||c===void 0)&&c.includes("0 rows"))&&(u=null,f=200,m="OK"),u&&this.shouldThrowOnError)throw new HQ.default(u)}return{error:u,data:d,count:h,status:f,statusText:m}});return this.shouldThrowOnError||(s=s.catch(i=>{var o,l,c;return{error:{message:`${(o=i==null?void 0:i.name)!==null&&o!==void 0?o:"FetchError"}: ${i==null?void 0:i.message}`,details:`${(l=i==null?void 0:i.stack)!==null&&l!==void 0?l:""}`,hint:"",code:`${(c=i==null?void 0:i.code)!==null&&c!==void 0?c:""}`},data:null,count:null,status:0,statusText:""}})),s.then(t,n)}returns(){return this}overrideTypes(){return this}};xb.default=KQ;var VQ=mr&&mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(yb,"__esModule",{value:!0});const GQ=VQ(xb);let YQ=class extends GQ.default{select(t){let n=!1;const r=(t??"*").split("").map(s=>/\s/.test(s)&&!n?"":(s==='"'&&(n=!n),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:n=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const o=i?`${i}.order`:"order",l=this.url.searchParams.get(o);return this.url.searchParams.set(o,`${l?`${l},`:""}${t}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${t}`),this}range(t,n,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,o=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${t}`),this.url.searchParams.set(o,`${n-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:n=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:o="text"}={}){var l;const c=[t?"analyze":null,n?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),u=(l=this.headers.Accept)!==null&&l!==void 0?l:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${o}; for="${u}"; options=${c};`,o==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};yb.default=YQ;var XQ=mr&&mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Fp,"__esModule",{value:!0});const JQ=XQ(yb);let QQ=class extends JQ.default{eq(t,n){return this.url.searchParams.append(t,`eq.${n}`),this}neq(t,n){return this.url.searchParams.append(t,`neq.${n}`),this}gt(t,n){return this.url.searchParams.append(t,`gt.${n}`),this}gte(t,n){return this.url.searchParams.append(t,`gte.${n}`),this}lt(t,n){return this.url.searchParams.append(t,`lt.${n}`),this}lte(t,n){return this.url.searchParams.append(t,`lte.${n}`),this}like(t,n){return this.url.searchParams.append(t,`like.${n}`),this}likeAllOf(t,n){return this.url.searchParams.append(t,`like(all).{${n.join(",")}}`),this}likeAnyOf(t,n){return this.url.searchParams.append(t,`like(any).{${n.join(",")}}`),this}ilike(t,n){return this.url.searchParams.append(t,`ilike.${n}`),this}ilikeAllOf(t,n){return this.url.searchParams.append(t,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(t,n){return this.url.searchParams.append(t,`ilike(any).{${n.join(",")}}`),this}is(t,n){return this.url.searchParams.append(t,`is.${n}`),this}in(t,n){const r=Array.from(new Set(n)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(t,`in.(${r})`),this}contains(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cs.{${n.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(n)}`),this}containedBy(t,n){return typeof n=="string"?this.url.searchParams.append(t,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(t,`cd.{${n.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(n)}`),this}rangeGt(t,n){return this.url.searchParams.append(t,`sr.${n}`),this}rangeGte(t,n){return this.url.searchParams.append(t,`nxl.${n}`),this}rangeLt(t,n){return this.url.searchParams.append(t,`sl.${n}`),this}rangeLte(t,n){return this.url.searchParams.append(t,`nxr.${n}`),this}rangeAdjacent(t,n){return this.url.searchParams.append(t,`adj.${n}`),this}overlaps(t,n){return typeof n=="string"?this.url.searchParams.append(t,`ov.${n}`):this.url.searchParams.append(t,`ov.{${n.join(",")}}`),this}textSearch(t,n,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const o=r===void 0?"":`(${r})`;return this.url.searchParams.append(t,`${i}fts${o}.${n}`),this}match(t){return Object.entries(t).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(t,n,r){return this.url.searchParams.append(t,`not.${n}.${r}`),this}or(t,{foreignTable:n,referencedTable:r=n}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${t})`),this}filter(t,n,r){return this.url.searchParams.append(t,`${n}.${r}`),this}};Fp.default=QQ;var ZQ=mr&&mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(vb,"__esModule",{value:!0});const lf=ZQ(Fp);let eZ=class{constructor(t,{headers:n={},schema:r,fetch:s}){this.url=t,this.headers=n,this.schema=r,this.fetch=s}select(t,{head:n=!1,count:r}={}){const s=n?"HEAD":"GET";let i=!1;const o=(t??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),r&&(this.headers.Prefer=`count=${r}`),new lf.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:n,defaultToNull:r=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(t)){const o=t.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(o.length>0){const l=[...new Set(o)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new lf.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:n,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){const o="POST",l=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&l.push(this.headers.Prefer),s&&l.push(`count=${s}`),i||l.push("missing=default"),this.headers.Prefer=l.join(","),Array.isArray(t)){const c=t.reduce((u,d)=>u.concat(Object.keys(d)),[]);if(c.length>0){const u=[...new Set(c)].map(d=>`"${d}"`);this.url.searchParams.set("columns",u.join(","))}}return new lf.default({method:o,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:n}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),this.headers.Prefer=s.join(","),new lf.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const n="DELETE",r=[];return t&&r.push(`count=${t}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new lf.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};vb.default=eZ;var wb={},jb={};Object.defineProperty(jb,"__esModule",{value:!0});jb.version=void 0;jb.version="0.0.0-automated";Object.defineProperty(wb,"__esModule",{value:!0});wb.DEFAULT_HEADERS=void 0;const tZ=jb;wb.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${tZ.version}`};var YF=mr&&mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(GN,"__esModule",{value:!0});const nZ=YF(vb),rZ=YF(Fp),aZ=wb;let sZ=class XF{constructor(t,{headers:n={},schema:r,fetch:s}={}){this.url=t,this.headers=Object.assign(Object.assign({},aZ.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=s}from(t){const n=new URL(`${this.url}/${t}`);return new nZ.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new XF(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,n={},{head:r=!1,get:s=!1,count:i}={}){let o;const l=new URL(`${this.url}/rpc/${t}`);let c;r||s?(o=r?"HEAD":"GET",Object.entries(n).filter(([d,h])=>h!==void 0).map(([d,h])=>[d,Array.isArray(h)?`{${h.join(",")}}`:`${h}`]).forEach(([d,h])=>{l.searchParams.append(d,h)})):(o="POST",c=n);const u=Object.assign({},this.headers);return i&&(u.Prefer=`count=${i}`),new rZ.default({method:o,url:l,headers:u,schema:this.schemaName,body:c,fetch:this.fetch,allowEmpty:!1})}};GN.default=sZ;var Oh=mr&&mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ra,"__esModule",{value:!0});Ra.PostgrestError=Ra.PostgrestBuilder=Ra.PostgrestTransformBuilder=Ra.PostgrestFilterBuilder=Ra.PostgrestQueryBuilder=Ra.PostgrestClient=void 0;const JF=Oh(GN);Ra.PostgrestClient=JF.default;const QF=Oh(vb);Ra.PostgrestQueryBuilder=QF.default;const ZF=Oh(Fp);Ra.PostgrestFilterBuilder=ZF.default;const e3=Oh(yb);Ra.PostgrestTransformBuilder=e3.default;const t3=Oh(xb);Ra.PostgrestBuilder=t3.default;const n3=Oh(bb);Ra.PostgrestError=n3.default;var iZ=Ra.default={PostgrestClient:JF.default,PostgrestQueryBuilder:QF.default,PostgrestFilterBuilder:ZF.default,PostgrestTransformBuilder:e3.default,PostgrestBuilder:t3.default,PostgrestError:n3.default};const{PostgrestClient:oZ,PostgrestQueryBuilder:hUe,PostgrestFilterBuilder:fUe,PostgrestTransformBuilder:mUe,PostgrestBuilder:pUe,PostgrestError:gUe}=iZ;class lZ{static detectEnvironment(){var t;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((t=navigator.userAgent)===null||t===void 0)&&t.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const n=parseInt(process.versions.node.split(".")[0]);return n>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${n} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${n} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const t=this.detectEnvironment();if(t.constructor)return t.constructor;let n=t.error||"WebSocket not supported in this environment.";throw t.workaround&&(n+=`

Suggested solution: ${t.workaround}`),new Error(n)}static createWebSocket(t,n){const r=this.getWebSocketConstructor();return new r(t,n)}static isWebSocketSupported(){try{const t=this.detectEnvironment();return t.type==="native"||t.type==="ws"}catch{return!1}}}const cZ="2.15.1",uZ=`realtime-js/${cZ}`,dZ="1.0.0",p1=1e4,hZ=1e3,fZ=100;var Kf;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(Kf||(Kf={}));var br;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(br||(br={}));var Qs;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(Qs||(Qs={}));var g1;(function(e){e.websocket="websocket"})(g1||(g1={}));var yc;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(yc||(yc={}));class mZ{constructor(){this.HEADER_LENGTH=1}decode(t,n){return t.constructor===ArrayBuffer?n(this._binaryDecode(t)):n(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const n=new DataView(t),r=new TextDecoder;return this._decodeBroadcast(t,n,r)}_decodeBroadcast(t,n,r){const s=n.getUint8(1),i=n.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(t.slice(o,o+s));o=o+s;const c=r.decode(t.slice(o,o+i));o=o+i;const u=JSON.parse(r.decode(t.slice(o,t.byteLength)));return{ref:null,topic:l,event:c,payload:u}}}class r3{constructor(t,n){this.callback=t,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var On;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(On||(On={}));const IP=(e,t,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(t).reduce((i,o)=>(i[o]=pZ(o,e,t,s),i),{})},pZ=(e,t,n,r)=>{const s=t.find(l=>l.name===e),i=s==null?void 0:s.type,o=n[e];return i&&!r.includes(i)?a3(i,o):v1(o)},a3=(e,t)=>{if(e.charAt(0)==="_"){const n=e.slice(1,e.length);return xZ(t,n)}switch(e){case On.bool:return gZ(t);case On.float4:case On.float8:case On.int2:case On.int4:case On.int8:case On.numeric:case On.oid:return vZ(t);case On.json:case On.jsonb:return yZ(t);case On.timestamp:return bZ(t);case On.abstime:case On.date:case On.daterange:case On.int4range:case On.int8range:case On.money:case On.reltime:case On.text:case On.time:case On.timestamptz:case On.timetz:case On.tsrange:case On.tstzrange:return v1(t);default:return v1(t)}},v1=e=>e,gZ=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},vZ=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},yZ=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},xZ=(e,t)=>{if(typeof e!="string")return e;const n=e.length-1,r=e[n];if(e[0]==="{"&&r==="}"){let i;const o=e.slice(1,n);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>a3(t,l))}return e},bZ=e=>typeof e=="string"?e.replace(" ","T"):e,s3=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")+"/api/broadcast"};class Ow{constructor(t,n,r={},s=p1){this.channel=t,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,n){var r;return this._hasReceived(t)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:t,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:n}){this.recHooks.filter(r=>r.status===t).forEach(r=>r.callback(n))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var RP;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(RP||(RP={}));class Vf{constructor(t,n){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(n==null?void 0:n.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Vf.syncState(this.state,s,i,o),this.pendingDiffs.forEach(c=>{this.state=Vf.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Vf.syncDiff(this.state,s,i,o),l())}),this.onJoin((s,i,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:o})}),this.onLeave((s,i,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,n,r,s){const i=this.cloneDeep(t),o=this.transformState(n),l={},c={};return this.map(i,(u,d)=>{o[u]||(c[u]=d)}),this.map(o,(u,d)=>{const h=i[u];if(h){const f=d.map(y=>y.presence_ref),m=h.map(y=>y.presence_ref),g=d.filter(y=>m.indexOf(y.presence_ref)<0),v=h.filter(y=>f.indexOf(y.presence_ref)<0);g.length>0&&(l[u]=g),v.length>0&&(c[u]=v)}else l[u]=d}),this.syncDiff(i,{joins:l,leaves:c},r,s)}static syncDiff(t,n,r,s){const{joins:i,leaves:o}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(l,c)=>{var u;const d=(u=t[l])!==null&&u!==void 0?u:[];if(t[l]=this.cloneDeep(c),d.length>0){const h=t[l].map(m=>m.presence_ref),f=d.filter(m=>h.indexOf(m.presence_ref)<0);t[l].unshift(...f)}r(l,d,c)}),this.map(o,(l,c)=>{let u=t[l];if(!u)return;const d=c.map(h=>h.presence_ref);u=u.filter(h=>d.indexOf(h.presence_ref)<0),t[l]=u,s(l,u,c),u.length===0&&delete t[l]}),t}static map(t,n){return Object.getOwnPropertyNames(t).map(r=>n(r,t[r]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((n,r)=>{const s=t[r];return"metas"in s?n[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=s,n},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var MP;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(MP||(MP={}));var Gf;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(Gf||(Gf={}));var so;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(so||(so={}));class YN{constructor(t,n={config:{}},r){this.topic=t,this.params=n,this.socket=r,this.bindings={},this.state=br.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Ow(this,Qs.join,this.params,this.timeout),this.rejoinTimer=new r3(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=br.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=br.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=br.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=br.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=br.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Qs.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new Vf(this),this.broadcastEndpointURL=s3(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(t,n=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.state==br.closed){const{config:{broadcast:i,presence:o,private:l}}=this.params,c=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(f=>f.filter))!==null&&s!==void 0?s:[],u=!!this.bindings[Gf.PRESENCE]&&this.bindings[Gf.PRESENCE].length>0,d={},h={broadcast:i,presence:Object.assign(Object.assign({},o),{enabled:u}),postgres_changes:c,private:l};this.socket.accessTokenValue&&(d.access_token=this.socket.accessTokenValue),this._onError(f=>t==null?void 0:t(so.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(so.CLOSED)),this.updateJoinPayload(Object.assign({config:h},d)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:f})=>{var m;if(this.socket.setAuth(),f===void 0){t==null||t(so.SUBSCRIBED);return}else{const g=this.bindings.postgres_changes,v=(m=g==null?void 0:g.length)!==null&&m!==void 0?m:0,y=[];for(let x=0;x<v;x++){const w=g[x],{filter:{event:b,schema:_,table:k,filter:j}}=w,S=f&&f[x];if(S&&S.event===b&&S.schema===_&&S.table===k&&S.filter===j)y.push(Object.assign(Object.assign({},w),{id:S.id}));else{this.unsubscribe(),this.state=br.errored,t==null||t(so.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=y,t&&t(so.SUBSCRIBED);return}}).receive("error",f=>{this.state=br.errored,t==null||t(so.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(so.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,n={}){return await this.send({type:"presence",event:"track",payload:t},n.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,n,r){return this.state===br.joined&&t===Gf.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(t,n,r)}async send(t,n={}){var r,s;if(!this._canPush()&&t.type==="broadcast"){const{event:i,payload:o}=t,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const u=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=u.body)===null||s===void 0?void 0:s.cancel()),u.ok?"ok":"error"}catch(u){return u.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const u=this._push(t.type,t,n.timeout||this.timeout);t.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),u.receive("ok",()=>i("ok")),u.receive("error",()=>i("error")),u.receive("timeout",()=>i("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=br.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Qs.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new Ow(this,Qs.leave,{},t),r.receive("ok",()=>{n(),s("ok")}).receive("timeout",()=>{n(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(t=>t.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=br.closed,this.bindings={}}async _fetchWithTimeout(t,n,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(t,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(i),o}_push(t,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Ow(this,t,n,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(t){if(t.startTimeout(),this.pushBuffer.push(t),this.pushBuffer.length>fZ){const n=this.pushBuffer.shift();n&&(n.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${n.event}`,n.payload))}}_onMessage(t,n,r){return n}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,n,r){var s,i;const o=t.toLocaleLowerCase(),{close:l,error:c,leave:u,join:d}=Qs;if(r&&[l,c,u,d].indexOf(o)>=0&&r!==this._joinRef())return;let f=this._onMessage(o,n,r);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(m=>{var g,v,y;return((g=m.filter)===null||g===void 0?void 0:g.event)==="*"||((y=(v=m.filter)===null||v===void 0?void 0:v.event)===null||y===void 0?void 0:y.toLocaleLowerCase())===o}).map(m=>m.callback(f,r)):(i=this.bindings[o])===null||i===void 0||i.filter(m=>{var g,v,y,x,w,b;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in m){const _=m.id,k=(g=m.filter)===null||g===void 0?void 0:g.event;return _&&((v=n.ids)===null||v===void 0?void 0:v.includes(_))&&(k==="*"||(k==null?void 0:k.toLocaleLowerCase())===((y=n.data)===null||y===void 0?void 0:y.type.toLocaleLowerCase()))}else{const _=(w=(x=m==null?void 0:m.filter)===null||x===void 0?void 0:x.event)===null||w===void 0?void 0:w.toLocaleLowerCase();return _==="*"||_===((b=n==null?void 0:n.event)===null||b===void 0?void 0:b.toLocaleLowerCase())}else return m.type.toLocaleLowerCase()===o}).map(m=>{if(typeof f=="object"&&"ids"in f){const g=f.data,{schema:v,table:y,commit_timestamp:x,type:w,errors:b}=g;f=Object.assign(Object.assign({},{schema:v,table:y,commit_timestamp:x,eventType:w,new:{},old:{},errors:b}),this._getPayloadRecords(g))}m.callback(f,r)})}_isClosed(){return this.state===br.closed}_isJoined(){return this.state===br.joined}_isJoining(){return this.state===br.joining}_isLeaving(){return this.state===br.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,n,r){const s=t.toLocaleLowerCase(),i={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(t,n){const r=t.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&YN.isEqual(s.filter,n))})),this}static isEqual(t,n){if(Object.keys(t).length!==Object.keys(n).length)return!1;for(const r in t)if(t[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(Qs.close,{},t)}_onError(t){this._on(Qs.error,{},n=>t(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=br.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const n={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(n.new=IP(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(n.old=IP(t.columns,t.old_record)),n}}const DP=()=>{},Ug={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},wZ=[1e3,2e3,5e3,1e4],jZ=1e4,_Z=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class kZ{constructor(t,n){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=p1,this.transport=null,this.heartbeatIntervalMs=Ug.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=DP,this.ref=0,this.reconnectTimer=null,this.logger=DP,this.conn=null,this.sendBuffer=[],this.serializer=new mZ,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>fu(async()=>{const{default:l}=await Promise.resolve().then(()=>Ph);return{default:l}},void 0).then(({default:l})=>l(...o)).catch(l=>{throw new Error(`Failed to load @supabase/node-fetch: ${l.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):i=fetch,(...o)=>i(...o)},!(!((r=n==null?void 0:n.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=n.params.apikey,this.endPoint=`${t}/${g1.websocket}`,this.httpEndpoint=s3(t),this._initializeOptions(n),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(n==null?void 0:n.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=lZ.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");const n=t.message;throw n.includes("Node.js")?new Error(`${n}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${n}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:dZ}))}disconnect(t,n){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},t?this.conn.close(t,n??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(t){const n=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const t=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.channels=[],this.disconnect(),t}log(t,n,r){this.logger(t,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case Kf.connecting:return yc.Connecting;case Kf.open:return yc.Open;case Kf.closing:return yc.Closing;default:return yc.Closed}}isConnected(){return this.connectionState()===yc.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(t,n={config:{}}){const r=`realtime:${t}`,s=this.getChannels().find(i=>i.topic===r);if(s)return s;{const i=new YN(`realtime:${t}`,n,this);return this.channels.push(i),i}}push(t){const{topic:n,event:r,payload:s,ref:i}=t,o=()=>{this.encode(t,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${n} ${r} (${i})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(t=null){this._authPromise=this._performAuth(t);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var t;if(!this.isConnected()){this.heartbeatCallback("disconnected");return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),this.heartbeatCallback("timeout"),this._wasManualDisconnect=!1,(t=this.conn)===null||t===void 0||t.close(hZ,"heartbeat timeout"),setTimeout(()=>{var n;this.isConnected()||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout()},Ug.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.heartbeatCallback("sent"),this._setAuthSafely("heartbeat")}onHeartbeat(t){this.heartbeatCallback=t}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let n=this.channels.find(r=>r.topic===t&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${t}"`),n.unsubscribe())}_remove(t){this.channels=this.channels.filter(n=>n.topic!==t.topic)}_onConnMessage(t){this.decode(t.data,n=>{n.topic==="phoenix"&&n.event==="phx_reply"&&this.heartbeatCallback(n.payload.status==="ok"?"ok":"error"),n.ref&&n.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:i,ref:o}=n,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${r} ${s} ${l}`.trim(),i),this.channels.filter(u=>u._isMember(r)).forEach(u=>u._trigger(s,i,o)),this._triggerStateCallbacks("message",n)})}_clearTimer(t){var n;t==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):t==="reconnect"&&((n=this.reconnectTimer)===null||n===void 0||n.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(t=>t.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(t){var n;this._setConnectionState("disconnected"),this.log("transport","close",t),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(n=this.reconnectTimer)===null||n===void 0||n.scheduleTimeout(),this._triggerStateCallbacks("close",t)}_onConnError(t){this._setConnectionState("disconnected"),this.log("transport",`${t}`),this._triggerChanError(),this._triggerStateCallbacks("error",t)}_triggerChanError(){this.channels.forEach(t=>t._trigger(Qs.error))}_appendParams(t,n){if(Object.keys(n).length===0)return t;const r=t.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${t}${r}${s}`}_workerObjectUrl(t){let n;if(t)n=t;else{const r=new Blob([_Z],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}_setConnectionState(t,n=!1){this._connectionState=t,t==="connecting"?this._wasManualDisconnect=!1:t==="disconnecting"&&(this._wasManualDisconnect=n)}async _performAuth(t=null){let n;t?n=t:this.accessToken?n=await this.accessToken():n=this.accessTokenValue,this.accessTokenValue!=n&&(this.accessTokenValue=n,this.channels.forEach(r=>{const s={access_token:n,version:uZ};n&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(Qs.access_token,{access_token:n})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(t="general"){this.setAuth().catch(n=>{this.log("error",`error setting auth in ${t}`,n)})}_triggerStateCallbacks(t,n){try{this.stateChangeCallbacks[t].forEach(r=>{try{r(n)}catch(s){this.log("error",`error in ${t} callback`,s)}})}catch(r){this.log("error",`error triggering ${t} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new r3(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Ug.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(t){var n,r,s,i,o,l,c,u;if(this.transport=(n=t==null?void 0:t.transport)!==null&&n!==void 0?n:null,this.timeout=(r=t==null?void 0:t.timeout)!==null&&r!==void 0?r:p1,this.heartbeatIntervalMs=(s=t==null?void 0:t.heartbeatIntervalMs)!==null&&s!==void 0?s:Ug.HEARTBEAT_INTERVAL,this.worker=(i=t==null?void 0:t.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=t==null?void 0:t.accessToken)!==null&&o!==void 0?o:null,t!=null&&t.params&&(this.params=t.params),t!=null&&t.logger&&(this.logger=t.logger),(t!=null&&t.logLevel||t!=null&&t.log_level)&&(this.logLevel=t.logLevel||t.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(l=t==null?void 0:t.reconnectAfterMs)!==null&&l!==void 0?l:d=>wZ[d-1]||jZ,this.encode=(c=t==null?void 0:t.encode)!==null&&c!==void 0?c:(d,h)=>h(JSON.stringify(d)),this.decode=(u=t==null?void 0:t.decode)!==null&&u!==void 0?u:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=t==null?void 0:t.workerUrl}}}class XN extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function wr(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class SZ extends XN{constructor(t,n,r){super(t),this.name="StorageApiError",this.status=n,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class y1 extends XN{constructor(t,n){super(t),this.name="StorageUnknownError",this.originalError=n}}var NZ=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const i3=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>fu(async()=>{const{default:r}=await Promise.resolve().then(()=>Ph);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},CZ=()=>NZ(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield fu(()=>Promise.resolve().then(()=>Ph),void 0)).Response:Response}),x1=e=>{if(Array.isArray(e))return e.map(n=>x1(n));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));t[s]=x1(r)}),t},AZ=e=>{if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)};var mu=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const Iw=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),EZ=(e,t,n)=>mu(void 0,void 0,void 0,function*(){const r=yield CZ();e instanceof r&&!(n!=null&&n.noResolveJson)?e.json().then(s=>{const i=e.status||500,o=(s==null?void 0:s.statusCode)||i+"";t(new SZ(Iw(s),i,o))}).catch(s=>{t(new y1(Iw(s),s))}):t(new y1(Iw(e),e))}),TZ=(e,t,n,r)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"||!r?s:(AZ(r)?(s.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),s.body=JSON.stringify(r)):s.body=r,t!=null&&t.duplex&&(s.duplex=t.duplex),Object.assign(Object.assign({},s),n))};function Up(e,t,n,r,s,i){return mu(this,void 0,void 0,function*(){return new Promise((o,l)=>{e(n,TZ(t,r,s,i)).then(c=>{if(!c.ok)throw c;return r!=null&&r.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>EZ(c,l,r))})})}function Ny(e,t,n,r){return mu(this,void 0,void 0,function*(){return Up(e,"GET",t,n,r)})}function ji(e,t,n,r,s){return mu(this,void 0,void 0,function*(){return Up(e,"POST",t,r,s,n)})}function b1(e,t,n,r,s){return mu(this,void 0,void 0,function*(){return Up(e,"PUT",t,r,s,n)})}function PZ(e,t,n,r){return mu(this,void 0,void 0,function*(){return Up(e,"HEAD",t,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function o3(e,t,n,r,s){return mu(this,void 0,void 0,function*(){return Up(e,"DELETE",t,r,s,n)})}var ha=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const OZ={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},LP={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class IZ{constructor(t,n={},r,s){this.url=t,this.headers=n,this.bucketId=r,this.fetch=i3(s)}uploadOrUpdate(t,n,r,s){return ha(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},LP),s);let l=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c))):(i=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c)))),s!=null&&s.headers&&(l=Object.assign(Object.assign({},l),s.headers));const u=this._removeEmptyFolders(n),d=this._getFinalPath(u),h=yield(t=="PUT"?b1:ji)(this.fetch,`${this.url}/object/${d}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:u,id:h.Id,fullPath:h.Key},error:null}}catch(i){if(wr(i))return{data:null,error:i};throw i}})}upload(t,n,r){return ha(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,n,r)})}uploadToSignedUrl(t,n,r,s){return ha(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(t),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",n);try{let c;const u=Object.assign({upsert:LP.upsert},s),d=Object.assign(Object.assign({},this.headers),{"x-upsert":String(u.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",u.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",u.cacheControl)):(c=r,d["cache-control"]=`max-age=${u.cacheControl}`,d["content-type"]=u.contentType);const h=yield b1(this.fetch,l.toString(),c,{headers:d});return{data:{path:i,fullPath:h.Key},error:null}}catch(c){if(wr(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(t,n){return ha(this,void 0,void 0,function*(){try{let r=this._getFinalPath(t);const s=Object.assign({},this.headers);n!=null&&n.upsert&&(s["x-upsert"]="true");const i=yield ji(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new XN("No token returned by API");return{data:{signedUrl:o.toString(),path:t,token:l},error:null}}catch(r){if(wr(r))return{data:null,error:r};throw r}})}update(t,n,r){return ha(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,n,r)})}move(t,n,r){return ha(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(wr(s))return{data:null,error:s};throw s}})}copy(t,n,r){return ha(this,void 0,void 0,function*(){try{return{data:{path:(yield ji(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:n,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(wr(s))return{data:null,error:s};throw s}})}createSignedUrl(t,n,r){return ha(this,void 0,void 0,function*(){try{let s=this._getFinalPath(t),i=yield ji(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:n},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(s){if(wr(s))return{data:null,error:s};throw s}})}createSignedUrls(t,n,r){return ha(this,void 0,void 0,function*(){try{const s=yield ji(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:t},{headers:this.headers}),i=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(s){if(wr(s))return{data:null,error:s};throw s}})}download(t,n){return ha(this,void 0,void 0,function*(){const s=typeof(n==null?void 0:n.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((n==null?void 0:n.transform)||{}),o=i?`?${i}`:"";try{const l=this._getFinalPath(t);return{data:yield(yield Ny(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(l){if(wr(l))return{data:null,error:l};throw l}})}info(t){return ha(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{const r=yield Ny(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:x1(r),error:null}}catch(r){if(wr(r))return{data:null,error:r};throw r}})}exists(t){return ha(this,void 0,void 0,function*(){const n=this._getFinalPath(t);try{return yield PZ(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(wr(r)&&r instanceof y1){const s=r.originalError;if([400,404].includes(s==null?void 0:s.status))return{data:!1,error:r}}throw r}})}getPublicUrl(t,n){const r=this._getFinalPath(t),s=[],i=n!=null&&n.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&s.push(i);const l=typeof(n==null?void 0:n.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((n==null?void 0:n.transform)||{});c!==""&&s.push(c);let u=s.join("&");return u!==""&&(u=`?${u}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${u}`)}}}remove(t){return ha(this,void 0,void 0,function*(){try{return{data:yield o3(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(n){if(wr(n))return{data:null,error:n};throw n}})}list(t,n,r){return ha(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},OZ),n),{prefix:t||""});return{data:yield ji(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(wr(s))return{data:null,error:s};throw s}})}listV2(t,n){return ha(this,void 0,void 0,function*(){try{const r=Object.assign({},t);return{data:yield ji(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},n),error:null}}catch(r){if(wr(r))return{data:null,error:r};throw r}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t.replace(/^\/+/,"")}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const n=[];return t.width&&n.push(`width=${t.width}`),t.height&&n.push(`height=${t.height}`),t.resize&&n.push(`resize=${t.resize}`),t.format&&n.push(`format=${t.format}`),t.quality&&n.push(`quality=${t.quality}`),n.join("&")}}const RZ="2.11.0",MZ={"X-Client-Info":`storage-js/${RZ}`};var Su=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};class DZ{constructor(t,n={},r,s){const i=new URL(t);s!=null&&s.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href,this.headers=Object.assign(Object.assign({},MZ),n),this.fetch=i3(r)}listBuckets(){return Su(this,void 0,void 0,function*(){try{return{data:yield Ny(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(wr(t))return{data:null,error:t};throw t}})}getBucket(t){return Su(this,void 0,void 0,function*(){try{return{data:yield Ny(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(n){if(wr(n))return{data:null,error:n};throw n}})}createBucket(t,n={public:!1}){return Su(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:n.type,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(wr(r))return{data:null,error:r};throw r}})}updateBucket(t,n){return Su(this,void 0,void 0,function*(){try{return{data:yield b1(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(wr(r))return{data:null,error:r};throw r}})}emptyBucket(t){return Su(this,void 0,void 0,function*(){try{return{data:yield ji(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(wr(n))return{data:null,error:n};throw n}})}deleteBucket(t){return Su(this,void 0,void 0,function*(){try{return{data:yield o3(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(n){if(wr(n))return{data:null,error:n};throw n}})}}class LZ extends DZ{constructor(t,n={},r,s){super(t,n,r,s)}from(t){return new IZ(this.url,this.headers,t,this.fetch)}}const $Z="2.55.0";let Tf="";typeof Deno<"u"?Tf="deno":typeof document<"u"?Tf="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Tf="react-native":Tf="node";const FZ={"X-Client-Info":`supabase-js-${Tf}/${$Z}`},UZ={headers:FZ},BZ={schema:"public"},zZ={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},WZ={};var qZ=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};const HZ=e=>{let t;return e?t=e:typeof fetch>"u"?t=KF:t=fetch,(...n)=>t(...n)},KZ=()=>typeof Headers>"u"?VF:Headers,VZ=(e,t,n)=>{const r=HZ(n),s=KZ();return(i,o)=>qZ(void 0,void 0,void 0,function*(){var l;const c=(l=yield t())!==null&&l!==void 0?l:e;let u=new s(o==null?void 0:o.headers);return u.has("apikey")||u.set("apikey",e),u.has("Authorization")||u.set("Authorization",`Bearer ${c}`),r(i,Object.assign(Object.assign({},o),{headers:u}))})};var GZ=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};function YZ(e){return e.endsWith("/")?e:e+"/"}function XZ(e,t){var n,r;const{db:s,auth:i,realtime:o,global:l}=e,{db:c,auth:u,realtime:d,global:h}=t,f={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},u),i),realtime:Object.assign(Object.assign({},d),o),storage:{},global:Object.assign(Object.assign(Object.assign({},h),l),{headers:Object.assign(Object.assign({},(n=h==null?void 0:h.headers)!==null&&n!==void 0?n:{}),(r=l==null?void 0:l.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>GZ(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}const l3="2.71.1",zu=30*1e3,w1=3,Rw=w1*zu,JZ="http://localhost:9999",QZ="supabase.auth.token",ZZ={"X-Client-Info":`gotrue-js/${l3}`},j1="X-Supabase-Api-Version",c3={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},eee=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,tee=10*60*1e3;class JN extends Error{constructor(t,n,r){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function Ft(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class nee extends JN{constructor(t,n,r){super(t,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function ree(e){return Ft(e)&&e.name==="AuthApiError"}class u3 extends JN{constructor(t,n){super(t),this.name="AuthUnknownError",this.originalError=n}}class Gl extends JN{constructor(t,n,r,s){super(t,r,s),this.name=n,this.status=r}}class nl extends Gl{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function aee(e){return Ft(e)&&e.name==="AuthSessionMissingError"}class Bg extends Gl{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class zg extends Gl{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class Wg extends Gl{constructor(t,n=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function see(e){return Ft(e)&&e.name==="AuthImplicitGrantRedirectError"}class $P extends Gl{constructor(t,n=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class _1 extends Gl{constructor(t,n){super(t,"AuthRetryableFetchError",n,void 0)}}function Mw(e){return Ft(e)&&e.name==="AuthRetryableFetchError"}class FP extends Gl{constructor(t,n,r){super(t,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}class k1 extends Gl{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const Cy="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),UP=` 	
\r=`.split(""),iee=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<UP.length;t+=1)e[UP[t].charCodeAt(0)]=-2;for(let t=0;t<Cy.length;t+=1)e[Cy[t].charCodeAt(0)]=t;return e})();function BP(e,t,n){if(e!==null)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(Cy[r]),t.queuedBits-=6}else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;){const r=t.queue>>t.queuedBits-6&63;n(Cy[r]),t.queuedBits-=6}}function d3(e,t,n){const r=iee[e];if(r>-1)for(t.queue=t.queue<<6|r,t.queuedBits+=6;t.queuedBits>=8;)n(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function zP(e){const t=[],n=o=>{t.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},i=o=>{cee(o,r,n)};for(let o=0;o<e.length;o+=1)d3(e.charCodeAt(o),s,i);return t.join("")}function oee(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function lee(e,t){for(let n=0;n<e.length;n+=1){let r=e.charCodeAt(n);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(e.charCodeAt(n+1)-56320&65535|s)+65536,n+=1}oee(r,t)}}function cee(e,t,n){if(t.utf8seq===0){if(e<=127){n(e);return}for(let r=1;r<6;r+=1)if(!(e>>7-r&1)){t.utf8seq=r;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&n(t.codepoint)}}function uee(e){const t=[],n={queue:0,queuedBits:0},r=s=>{t.push(s)};for(let s=0;s<e.length;s+=1)d3(e.charCodeAt(s),n,r);return new Uint8Array(t)}function dee(e){const t=[];return lee(e,n=>t.push(n)),new Uint8Array(t)}function hee(e){const t=[],n={queue:0,queuedBits:0},r=s=>{t.push(s)};return e.forEach(s=>BP(s,n,r)),BP(null,n,r),t.join("")}function fee(e){return Math.round(Date.now()/1e3)+e}function mee(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const qs=()=>typeof window<"u"&&typeof document<"u",sc={tested:!1,writable:!1},h3=()=>{if(!qs())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(sc.tested)return sc.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),sc.tested=!0,sc.writable=!0}catch{sc.tested=!0,sc.writable=!1}return sc.writable};function pee(e){const t={},n=new URL(e);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,i)=>{t[i]=s})}catch{}return n.searchParams.forEach((r,s)=>{t[s]=r}),t}const f3=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...n)=>fu(async()=>{const{default:r}=await Promise.resolve().then(()=>Ph);return{default:r}},void 0).then(({default:r})=>r(...n)):t=fetch,(...n)=>t(...n)},gee=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",Wu=async(e,t,n)=>{await e.setItem(t,JSON.stringify(n))},ic=async(e,t)=>{const n=await e.getItem(t);if(!n)return null;try{return JSON.parse(n)}catch{return n}},Qo=async(e,t)=>{await e.removeItem(t)};class _b{constructor(){this.promise=new _b.promiseConstructor((t,n)=>{this.resolve=t,this.reject=n})}}_b.promiseConstructor=Promise;function Dw(e){const t=e.split(".");if(t.length!==3)throw new k1("Invalid JWT structure");for(let r=0;r<t.length;r++)if(!eee.test(t[r]))throw new k1("JWT not in base64url format");return{header:JSON.parse(zP(t[0])),payload:JSON.parse(zP(t[1])),signature:uee(t[2]),raw:{header:t[0],payload:t[1]}}}async function vee(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function yee(e,t){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await e(i);if(!t(i,null,o)){r(o);return}}catch(o){if(!t(i,o)){s(o);return}}})()})}function xee(e){return("0"+e.toString(16)).substr(-2)}function bee(){const t=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let i=0;i<56;i++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(t),Array.from(t,xee).join("")}async function wee(e){const n=new TextEncoder().encode(e),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}async function jee(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const n=await wee(e);return btoa(n).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Nu(e,t,n=!1){const r=bee();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await Wu(e,`${t}-code-verifier`,s);const i=await jee(r);return[i,r===i?"plain":"s256"]}const _ee=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function kee(e){const t=e.headers.get(j1);if(!t||!t.match(_ee))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function See(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function Nee(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const Cee=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Cu(e){if(!Cee.test(e))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function Lw(){const e={};return new Proxy(e,{get:(t,n)=>{if(n==="__isUserNotAvailableProxy")return!0;if(typeof n=="symbol"){const r=n.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${n}" property of the session object is not supported. Please use getUser() instead.`)},set:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(t,n)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${n}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function WP(e){return JSON.parse(JSON.stringify(e))}var Aee=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n};const dc=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),Eee=[502,503,504];async function qP(e){var t;if(!gee(e))throw new _1(dc(e),0);if(Eee.includes(e.status))throw new _1(dc(e),e.status);let n;try{n=await e.json()}catch(i){throw new u3(dc(i),i)}let r;const s=kee(e);if(s&&s.getTime()>=c3["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new FP(dc(n),e.status,((t=n.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(r==="session_not_found")throw new nl}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new FP(dc(n),e.status,n.weak_password.reasons);throw new nee(dc(n),e.status||500,r)}const Tee=(e,t,n,r)=>{const s={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function Vt(e,t,n,r){var s;const i=Object.assign({},r==null?void 0:r.headers);i[j1]||(i[j1]=c3["2024-01-01"].name),r!=null&&r.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const o=(s=r==null?void 0:r.query)!==null&&s!==void 0?s:{};r!=null&&r.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await Pee(e,t,n+l,{headers:i,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(c):{data:Object.assign({},c),error:null}}async function Pee(e,t,n,r,s,i){const o=Tee(t,r,s,i);let l;try{l=await e(n,Object.assign({},o))}catch(c){throw console.error(c),new _1(dc(c),0)}if(l.ok||await qP(l),r!=null&&r.noResolveJson)return l;try{return await l.json()}catch(c){await qP(c)}}function ro(e){var t;let n=null;Mee(e)&&(n=Object.assign({},e),e.expires_at||(n.expires_at=fee(e.expires_in)));const r=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:n,user:r},error:null}}function HP(e){const t=ro(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(t.data.weak_password=e.weak_password),t}function cl(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function Oee(e){return{data:e,error:null}}function Iee(e){const{action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i}=e,o=Aee(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:t,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Ree(e){return e}function Mee(e){return e.access_token&&e.refresh_token&&e.expires_in}const $w=["global","local","others"];var Dee=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n};class Lee{constructor({url:t="",headers:n={},fetch:r}){this.url=t,this.headers=n,this.fetch=f3(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,n=$w[0]){if($w.indexOf(n)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${$w.join(", ")}`);try{return await Vt(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ft(r))return{data:null,error:r};throw r}}async inviteUserByEmail(t,n={}){try{return await Vt(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:cl})}catch(r){if(Ft(r))return{data:{user:null},error:r};throw r}}async generateLink(t){try{const{options:n}=t,r=Dee(t,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r==null?void 0:r.newEmail,delete s.newEmail),await Vt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:Iee,redirectTo:n==null?void 0:n.redirectTo})}catch(n){if(Ft(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(t){try{return await Vt(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:cl})}catch(n){if(Ft(n))return{data:{user:null},error:n};throw n}}async listUsers(t){var n,r,s,i,o,l,c;try{const u={nextPage:null,lastPage:0,total:0},d=await Vt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=t==null?void 0:t.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=t==null?void 0:t.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:Ree});if(d.error)throw d.error;const h=await d.json(),f=(o=d.headers.get("x-total-count"))!==null&&o!==void 0?o:0,m=(c=(l=d.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return m.length>0&&(m.forEach(g=>{const v=parseInt(g.split(";")[0].split("=")[1].substring(0,1)),y=JSON.parse(g.split(";")[1].split("=")[1]);u[`${y}Page`]=v}),u.total=parseInt(f)),{data:Object.assign(Object.assign({},h),u),error:null}}catch(u){if(Ft(u))return{data:{users:[]},error:u};throw u}}async getUserById(t){Cu(t);try{return await Vt(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:cl})}catch(n){if(Ft(n))return{data:{user:null},error:n};throw n}}async updateUserById(t,n){Cu(t);try{return await Vt(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:n,headers:this.headers,xform:cl})}catch(r){if(Ft(r))return{data:{user:null},error:r};throw r}}async deleteUser(t,n=!1){Cu(t);try{return await Vt(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:n},xform:cl})}catch(r){if(Ft(r))return{data:{user:null},error:r};throw r}}async _listFactors(t){Cu(t.userId);try{const{data:n,error:r}=await Vt(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(Ft(n))return{data:null,error:n};throw n}}async _deleteFactor(t){Cu(t.userId),Cu(t.id);try{return{data:await Vt(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(n){if(Ft(n))return{data:null,error:n};throw n}}}function KP(e={}){return{getItem:t=>e[t]||null,setItem:(t,n)=>{e[t]=n},removeItem:t=>{delete e[t]}}}function $ee(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Au={debug:!!(globalThis&&h3()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class m3 extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class Fee extends m3{}async function Uee(e,t,n){Au.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const r=new globalThis.AbortController;return t>0&&setTimeout(()=>{r.abort(),Au.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Au.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await n()}finally{Au.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}else{if(t===0)throw Au.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new Fee(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(Au.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}$ee();const Bee={url:JZ,storageKey:QZ,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:ZZ,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function VP(e,t,n){return await n()}const Eu={};class Am{constructor(t){var n,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Am.nextInstanceID,Am.nextInstanceID+=1,this.instanceID>0&&qs()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},Bee),t);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new Lee({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=f3(s.fetch),this.lock=s.lock||VP,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:qs()&&(!((n=globalThis==null?void 0:globalThis.navigator)===null||n===void 0)&&n.locks)?this.lock=Uee:this.lock=VP,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(s.storage?this.storage=s.storage:h3()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=KP(this.memoryStorage)),s.userStorage&&(this.userStorage=s.userStorage)):(this.memoryStorage={},this.storage=KP(this.memoryStorage)),qs()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}get jwks(){var t,n;return(n=(t=Eu[this.storageKey])===null||t===void 0?void 0:t.jwks)!==null&&n!==void 0?n:{keys:[]}}set jwks(t){Eu[this.storageKey]=Object.assign(Object.assign({},Eu[this.storageKey]),{jwks:t})}get jwks_cached_at(){var t,n;return(n=(t=Eu[this.storageKey])===null||t===void 0?void 0:t.cachedAt)!==null&&n!==void 0?n:Number.MIN_SAFE_INTEGER}set jwks_cached_at(t){Eu[this.storageKey]=Object.assign(Object.assign({},Eu[this.storageKey]),{cachedAt:t})}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${l3}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const n=pee(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),qs()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),see(i)){const c=(t=i.details)===null||t===void 0?void 0:t.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return Ft(n)?{error:n}:{error:new u3("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var n,r,s;try{const i=await Vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=t==null?void 0:t.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=t==null?void 0:t.options)===null||s===void 0?void 0:s.captchaToken}},xform:ro}),{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Ft(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(t){var n,r,s;try{let i;if("email"in t){const{email:d,password:h,options:f}=t;let m=null,g=null;this.flowType==="pkce"&&([m,g]=await Nu(this.storage,this.storageKey)),i=await Vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f==null?void 0:f.emailRedirectTo,body:{email:d,password:h,data:(n=f==null?void 0:f.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken},code_challenge:m,code_challenge_method:g},xform:ro})}else if("phone"in t){const{phone:d,password:h,options:f}=t;i=await Vt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:d,password:h,data:(r=f==null?void 0:f.data)!==null&&r!==void 0?r:{},channel:(s=f==null?void 0:f.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f==null?void 0:f.captchaToken}},xform:ro})}else throw new zg("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return{data:{user:null,session:null},error:l};const c=o.session,u=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(i){if(Ft(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(t){try{let n;if("email"in t){const{email:i,password:o,options:l}=t;n=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:HP})}else if("phone"in t){const{phone:i,password:o,options:l}=t;n=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:HP})}else throw new zg("You must provide either an email or phone number and a password");const{data:r,error:s}=n;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Bg}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(Ft(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(t){var n,r,s,i;return await this._handleProviderSignIn(t.provider,{redirectTo:(n=t.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=t.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=t.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=t.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async signInWithWeb3(t){const{chain:n}=t;if(n==="solana")return await this.signInWithSolana(t);throw new Error(`@supabase/auth-js: Unsupported chain "${n}"`)}async signInWithSolana(t){var n,r,s,i,o,l,c,u,d,h,f,m;let g,v;if("message"in t)g=t.message,v=t.signature;else{const{chain:y,wallet:x,statement:w,options:b}=t;let _;if(qs())if(typeof x=="object")_=x;else{const j=window;if("solana"in j&&typeof j.solana=="object"&&("signIn"in j.solana&&typeof j.solana.signIn=="function"||"signMessage"in j.solana&&typeof j.solana.signMessage=="function"))_=j.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof x!="object"||!(b!=null&&b.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");_=x}const k=new URL((n=b==null?void 0:b.url)!==null&&n!==void 0?n:window.location.href);if("signIn"in _&&_.signIn){const j=await _.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},b==null?void 0:b.signInWithSolana),{version:"1",domain:k.host,uri:k.href}),w?{statement:w}:null));let S;if(Array.isArray(j)&&j[0]&&typeof j[0]=="object")S=j[0];else if(j&&typeof j=="object"&&"signedMessage"in j&&"signature"in j)S=j;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in S&&"signature"in S&&(typeof S.signedMessage=="string"||S.signedMessage instanceof Uint8Array)&&S.signature instanceof Uint8Array)g=typeof S.signedMessage=="string"?S.signedMessage:new TextDecoder().decode(S.signedMessage),v=S.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in _)||typeof _.signMessage!="function"||!("publicKey"in _)||typeof _!="object"||!_.publicKey||!("toBase58"in _.publicKey)||typeof _.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");g=[`${k.host} wants you to sign in with your Solana account:`,_.publicKey.toBase58(),...w?["",w,""]:[""],"Version: 1",`URI: ${k.href}`,`Issued At: ${(s=(r=b==null?void 0:b.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((i=b==null?void 0:b.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${b.signInWithSolana.notBefore}`]:[],...!((o=b==null?void 0:b.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${b.signInWithSolana.expirationTime}`]:[],...!((l=b==null?void 0:b.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${b.signInWithSolana.chainId}`]:[],...!((c=b==null?void 0:b.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${b.signInWithSolana.nonce}`]:[],...!((u=b==null?void 0:b.signInWithSolana)===null||u===void 0)&&u.requestId?[`Request ID: ${b.signInWithSolana.requestId}`]:[],...!((h=(d=b==null?void 0:b.signInWithSolana)===null||d===void 0?void 0:d.resources)===null||h===void 0)&&h.length?["Resources",...b.signInWithSolana.resources.map(S=>`- ${S}`)]:[]].join(`
`);const j=await _.signMessage(new TextEncoder().encode(g),"utf8");if(!j||!(j instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=j}}try{const{data:y,error:x}=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:g,signature:hee(v)},!((f=t.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(m=t.options)===null||m===void 0?void 0:m.captchaToken}}:null),xform:ro});if(x)throw x;return!y||!y.session||!y.user?{data:{user:null,session:null},error:new Bg}:(y.session&&(await this._saveSession(y.session),await this._notifyAllSubscribers("SIGNED_IN",y.session)),{data:Object.assign({},y),error:x})}catch(y){if(Ft(y))return{data:{user:null,session:null},error:y};throw y}}async _exchangeCodeForSession(t){const n=await ic(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{const{data:i,error:o}=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:r},xform:ro});if(await Qo(this.storage,`${this.storageKey}-code-verifier`),o)throw o;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Bg}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:o})}catch(i){if(Ft(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(t){try{const{options:n,provider:r,token:s,access_token:i,nonce:o}=t,l=await Vt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:n==null?void 0:n.captchaToken}},xform:ro}),{data:c,error:u}=l;return u?{data:{user:null,session:null},error:u}:!c||!c.session||!c.user?{data:{user:null,session:null},error:new Bg}:(c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),{data:c,error:u})}catch(n){if(Ft(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(t){var n,r,s,i,o;try{if("email"in t){const{email:l,options:c}=t;let u=null,d=null;this.flowType==="pkce"&&([u,d]=await Nu(this.storage,this.storageKey));const{error:h}=await Vt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(n=c==null?void 0:c.data)!==null&&n!==void 0?n:{},create_user:(r=c==null?void 0:c.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:u,code_challenge_method:d},redirectTo:c==null?void 0:c.emailRedirectTo});return{data:{user:null,session:null},error:h}}if("phone"in t){const{phone:l,options:c}=t,{data:u,error:d}=await Vt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c==null?void 0:c.data)!==null&&s!==void 0?s:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return{data:{user:null,session:null,messageId:u==null?void 0:u.message_id},error:d}}throw new zg("You must provide either an email or phone number.")}catch(l){if(Ft(l))return{data:{user:null,session:null},error:l};throw l}}async verifyOtp(t){var n,r;try{let s,i;"options"in t&&(s=(n=t.options)===null||n===void 0?void 0:n.redirectTo,i=(r=t.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await Vt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:ro});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,u=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),{data:{user:u,session:c},error:null}}catch(s){if(Ft(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(t){var n,r,s;try{let i=null,o=null;return this.flowType==="pkce"&&([i,o]=await Nu(this.storage,this.storageKey)),await Vt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(r=(n=t.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=t==null?void 0:t.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:o}),headers:this.headers,xform:Oee})}catch(i){if(Ft(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:n},error:r}=t;if(r)throw r;if(!n)throw new nl;const{error:s}=await Vt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:s}})}catch(t){if(Ft(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const n=`${this.url}/resend`;if("email"in t){const{email:r,type:s,options:i}=t,{error:o}=await Vt(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return{data:{user:null,session:null},error:o}}else if("phone"in t){const{phone:r,type:s,options:i}=t,{data:o,error:l}=await Vt(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return{data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l}}throw new zg("You must provide either an email or phone number and a type")}catch(n){if(Ft(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(t,n){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await t(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const n=await ic(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?t=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const r=t.expires_at?t.expires_at*1e3-Date.now()<Rw:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",t.expires_at),!r){if(this.userStorage){const o=await ic(this.userStorage,this.storageKey+"-user");o!=null&&o.user?t.user=o.user:t.user=Lw()}if(this.storage.isServer&&t.user){let o=this.suppressGetSessionWarning;t=new Proxy(t,{get:(c,u,d)=>(!o&&u==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),o=!0,this.suppressGetSessionWarning=!0),Reflect.get(c,u,d))})}return{data:{session:t},error:null}}const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Vt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:cl}):await this._useSession(async n=>{var r,s,i;const{data:o,error:l}=n;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new nl}:await Vt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:cl})})}catch(n){if(Ft(n))return aee(n)&&(await this._removeSession(),await Qo(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(t,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,n))}async _updateUser(t,n={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new nl;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&t.email!=null&&([l,c]=await Nu(this.storage,this.storageKey));const{data:u,error:d}=await Vt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n==null?void 0:n.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:cl});if(d)throw d;return o.user=u.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),{data:{user:o.user},error:null}})}catch(r){if(Ft(r))return{data:{user:null},error:r};throw r}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new nl;const n=Date.now()/1e3;let r=n,s=!0,i=null;const{payload:o}=Dw(t.access_token);if(o.exp&&(r=o.exp,s=r<=n),s){const{session:l,error:c}=await this._callRefreshToken(t.refresh_token);if(c)return{data:{user:null,session:null},error:c};if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(t.access_token);if(c)throw c;i={access_token:t.access_token,refresh_token:t.refresh_token,user:l.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(Ft(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async n=>{var r;if(!t){const{data:o,error:l}=n;if(l)throw l;t=(r=o.session)!==null&&r!==void 0?r:void 0}if(!(t!=null&&t.refresh_token))throw new nl;const{session:s,error:i}=await this._callRefreshToken(t.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(Ft(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(t,n){try{if(!qs())throw new Wg("No browser detected.");if(t.error||t.error_description||t.error_code)throw new Wg(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new $P("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Wg("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new $P("No code detected.");const{data:w,error:b}=await this._exchangeCodeForSession(t.code);if(b)throw b;const _=new URL(window.location.href);return _.searchParams.delete("code"),window.history.replaceState(window.history.state,"",_.toString()),{data:{session:w.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:u}=t;if(!i||!l||!o||!u)throw new Wg("No session defined in URL");const d=Math.round(Date.now()/1e3),h=parseInt(l);let f=d+h;c&&(f=parseInt(c));const m=f-d;m*1e3<=zu&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${m}s, should have been closer to ${h}s`);const g=f-h;d-g>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",g,f,d):d-g<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",g,f,d);const{data:v,error:y}=await this._getUser(i);if(y)throw y;const x={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:h,expires_at:f,refresh_token:o,token_type:u,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:x,redirectType:t.type},error:null}}catch(r){if(Ft(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const n=await ic(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&n)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return{error:i};const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,t);if(l&&!(ree(l)&&(l.status===404||l.status===401||l.status===403)))return{error:l}}return t!=="others"&&(await this._removeSession(),await Qo(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const n=mee(),r={id:n,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(t){return await this._useSession(async n=>{var r,s;try{const{data:{session:i},error:o}=n;if(o)throw o;await((r=this.stateChangeEmitters.get(t))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",t,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(t))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",i),console.error(i)}})}async resetPasswordForEmail(t,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Nu(this.storage,this.storageKey,!0));try{return await Vt(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(Ft(i))return{data:null,error:i};throw i}}async getUserIdentities(){var t;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(t=n.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(n){if(Ft(n))return{data:null,error:n};throw n}}async linkIdentity(t){var n;try{const{data:r,error:s}=await this._useSession(async i=>{var o,l,c,u,d;const{data:h,error:f}=i;if(f)throw f;const m=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(o=t.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=t.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=t.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await Vt(this.fetch,"GET",m,{headers:this.headers,jwt:(d=(u=h.session)===null||u===void 0?void 0:u.access_token)!==null&&d!==void 0?d:void 0})});if(s)throw s;return qs()&&!(!((n=t.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:t.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Ft(r))return{data:{provider:t.provider,url:null},error:r};throw r}}async unlinkIdentity(t){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)throw o;return await Vt(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(Ft(n))return{data:null,error:n};throw n}}async _refreshAccessToken(t){const n=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await yee(async s=>(s>0&&await vee(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await Vt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:ro})),(s,i)=>{const o=200*Math.pow(2,s);return i&&Mw(i)&&Date.now()+o-r<zu})}catch(r){if(this._debug(n,"error",r),Ft(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",n,"url",r),qs()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:t,url:r},error:null}}async _recoverAndRefresh(){var t,n;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await ic(this.storage,this.storageKey);if(s&&this.userStorage){let o=await ic(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await Wu(this.userStorage,this.storageKey+"-user",o)),s.user=(t=o==null?void 0:o.user)!==null&&t!==void 0?t:Lw()}else if(s&&!s.user&&!s.user){const o=await ic(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(s.user=o.user,await Qo(this.storage,this.storageKey+"-user"),await Wu(this.storage,this.storageKey,s)):s.user=Lw()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const i=((n=s.expires_at)!==null&&n!==void 0?n:1/0)*1e3-Date.now()<Rw;if(this._debug(r,`session has${i?"":" not"} expired with margin of ${Rw}s`),i){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),Mw(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&(o!=null&&o.user)?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var n,r;if(!t)throw new nl;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new _b;const{data:i,error:o}=await this._refreshAccessToken(t);if(o)throw o;if(!i.session)throw new nl;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={session:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(s,"error",i),Ft(i)){const o={session:null,error:i};return Mw(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(t,n,r=!0){const s=`#_notifyAllSubscribers(${t})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:t,session:n});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(t,n)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0;const n=Object.assign({},t),r=n.user&&n.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&n.user&&await Wu(this.userStorage,this.storageKey+"-user",{user:n.user});const s=Object.assign({},n);delete s.user;const i=WP(s);await Wu(this.storage,this.storageKey,i)}else{const s=WP(n);await Wu(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await Qo(this.storage,this.storageKey),await Qo(this.storage,this.storageKey+"-code-verifier"),await Qo(this.storage,this.storageKey+"-user"),this.userStorage&&await Qo(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&qs()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),zu);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-t)/zu);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${zu}ms, refresh threshold is ${w1} ticks`),s<=w1&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof m3)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!qs()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const n=`#_onVisibilityChanged(${t})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r!=null&&r.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,o]=await Nu(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r!=null&&r.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r!=null&&r.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${t}?${s.join("&")}`}async _unenroll(t){try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?{data:null,error:i}:await Vt(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Ft(n))return{data:null,error:n};throw n}}async _enroll(t){try{return await this._useSession(async n=>{var r,s;const{data:i,error:o}=n;if(o)return{data:null,error:o};const l=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:c,error:u}=await Vt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=i==null?void 0:i.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(t.factorType==="totp"&&(!((s=c==null?void 0:c.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),{data:c,error:null})})}catch(n){if(Ft(n))return{data:null,error:n};throw n}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return{data:null,error:i};const{data:o,error:l}=await Vt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+o.expires_in},o)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",o),{data:o,error:l})})}catch(n){if(Ft(n))return{data:null,error:n};throw n}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?{data:null,error:i}:await Vt(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(r=s==null?void 0:s.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(Ft(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(t){const{data:n,error:r}=await this._challenge({factorId:t.factorId});return r?{data:null,error:r}:await this._verify({factorId:t.factorId,challengeId:n.id,code:t.code})}async _listFactors(){const{data:{user:t},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=(t==null?void 0:t.factors)||[],s=r.filter(o=>o.factor_type==="totp"&&o.status==="verified"),i=r.filter(o=>o.factor_type==="phone"&&o.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var n,r;const{data:{session:s},error:i}=t;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:o}=Dw(s.access_token);let l=null;o.aal&&(l=o.aal);let c=l;((r=(n=s.user.factors)===null||n===void 0?void 0:n.filter(h=>h.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(c="aal2");const d=o.amr||[];return{data:{currentLevel:l,nextLevel:c,currentAuthenticationMethods:d},error:null}}))}async fetchJwk(t,n={keys:[]}){let r=n.keys.find(l=>l.kid===t);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(l=>l.kid===t),r&&this.jwks_cached_at+tee>s)return r;const{data:i,error:o}=await Vt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=s,r=i.keys.find(l=>l.kid===t),!r)?null:r}async getClaims(t,n={}){try{let r=t;if(!r){const{data:m,error:g}=await this.getSession();if(g||!m.session)return{data:null,error:g};r=m.session.access_token}const{header:s,payload:i,signature:o,raw:{header:l,payload:c}}=Dw(r);n!=null&&n.allowExpired||See(i.exp);const u=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,n!=null&&n.keys?{keys:n.keys}:n==null?void 0:n.jwks);if(!u){const{error:m}=await this.getUser(r);if(m)throw m;return{data:{claims:i,header:s,signature:o},error:null}}const d=Nee(s.alg),h=await crypto.subtle.importKey("jwk",u,d,!0,["verify"]);if(!await crypto.subtle.verify(d,h,o,dee(`${l}.${c}`)))throw new k1("Invalid JWT signature");return{data:{claims:i,header:s,signature:o},error:null}}catch(r){if(Ft(r))return{data:null,error:r};throw r}}}Am.nextInstanceID=0;const zee=Am;class Wee extends zee{constructor(t){super(t)}}var qee=function(e,t,n,r){function s(i){return i instanceof n?i:new n(function(o){o(i)})}return new(n||(n=Promise))(function(i,o){function l(d){try{u(r.next(d))}catch(h){o(h)}}function c(d){try{u(r.throw(d))}catch(h){o(h)}}function u(d){d.done?i(d.value):s(d.value).then(l,c)}u((r=r.apply(e,t||[])).next())})};class Hee{constructor(t,n,r){var s,i,o;if(this.supabaseUrl=t,this.supabaseKey=n,!t)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const l=YZ(t),c=new URL(l);this.realtimeUrl=new URL("realtime/v1",c),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",c),this.storageUrl=new URL("storage/v1",c),this.functionsUrl=new URL("functions/v1",c);const u=`sb-${c.hostname.split(".")[0]}-auth-token`,d={db:BZ,realtime:WZ,auth:Object.assign(Object.assign({},zZ),{storageKey:u}),global:UZ},h=XZ(r??{},d);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,m)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(m)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=VZ(n,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.rest=new oZ(new URL("rest/v1",c).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new LZ(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new LQ(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,n={},r={}){return this.rest.rpc(t,n,r)}channel(t,n={config:{}}){return this.realtime.channel(t,n)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,n;return qee(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(t=r.session)===null||t===void 0?void 0:t.access_token)!==null&&n!==void 0?n:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:s,storageKey:i,flowType:o,lock:l,debug:c},u,d){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Wee({url:this.authUrl.href,headers:Object.assign(Object.assign({},h),u),storageKey:i,autoRefreshToken:t,persistSession:n,detectSessionInUrl:r,storage:s,flowType:o,lock:l,debug:c,fetch:d,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new kZ(this.realtimeUrl.href,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(t,n,r){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:t==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const p3=(e,t,n)=>new Hee(e,t,n);function Kee(){if(typeof window<"u"||typeof process>"u")return!1;const e=process.version;if(e==null)return!1;const t=e.match(/^v(\d+)\./);return t?parseInt(t[1],10)<=18:!1}Kee()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const Vee={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_HCAPTCHA_SITEKEY:"30583a2e-84ac-496a-8ec2-23043ae06dc0",VITE_SUPABASE_PROJECT_ID:"bkynymyhbfrhvwxqqttk",VITE_SUPABASE_PUBLISHABLE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJreW55bXloYmZyaHZ3eHFxdHRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5Mzk1NzIsImV4cCI6MjA3OTUxNTU3Mn0.4ELI9s6908SdW2jd1BM_ht8pTIyLAwPpsqGiGNCdcC0",VITE_SUPABASE_URL:"https://bkynymyhbfrhvwxqqttk.supabase.co",VITE_WEBHOOK_BASE_URL:"https://primary-production-376c.up.railway.app/webhook"},lo=Vee??{},Gee=e=>e.replace(/\/$/,""),g3=(e,t)=>{const n=(e??"").trim();if(!n)throw new Error(`[Supabase config] Missing ${t}. Set ${t} in your environment.`);return n},Oo=Gee(g3(lo==null?void 0:lo.VITE_SUPABASE_URL,"VITE_SUPABASE_URL")),QN=g3((lo==null?void 0:lo.VITE_SUPABASE_ANON_KEY)??(lo==null?void 0:lo.VITE_SUPABASE_PUBLISHABLE_KEY),"VITE_SUPABASE_ANON_KEY (or VITE_SUPABASE_PUBLISHABLE_KEY)"),Wr=p3(Oo,QN,{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}});var hc=(e=>(e.CLOSED="CLOSED",e.OPEN="OPEN",e.HALF_OPEN="HALF_OPEN",e))(hc||{});const Yee={failureThreshold:5,resetTimeout:3e4,successThreshold:2,monitoringPeriod:1e4,timeout:1e4},Xee="circuit_breaker_";class Jee{constructor(t,n={}){Kt(this,"config");Kt(this,"state");Kt(this,"failures",[]);Kt(this,"successes",0);Kt(this,"stateChangedAt");Kt(this,"lastFailureTime",null);Kt(this,"lastSuccessTime",null);Kt(this,"totalRequests",0);Kt(this,"listeners",[]);Kt(this,"storageKey");this.name=t,this.config={...Yee,...n},this.storageKey=`${Xee}${t}`,this.state=this.loadState()||"CLOSED",this.stateChangedAt=Date.now(),this.failures=[],this.loadFromStorage()}async execute(t,n){if(this.totalRequests++,!this.canExecute()){const s=new Error(`Circuit breaker is ${this.state}. Request rejected.`);throw s.circuitBreaker={state:this.state,name:this.name},s}const r=n||this.config.timeout;try{const s=new Promise((o,l)=>{setTimeout(()=>{l(new Error(`Request timeout after ${r}ms`))},r)}),i=await Promise.race([t(),s]);return this.recordSuccess(),i}catch(s){throw s instanceof Error&&s.message.includes("timeout")&&this.emitEvent({type:"timeout"}),this.recordFailure(s),s}}canExecute(){const t=Date.now();switch(this.state){case"CLOSED":return!0;case"OPEN":return t-this.stateChangedAt>=this.config.resetTimeout?(this.transitionTo("HALF_OPEN"),!0):!1;case"HALF_OPEN":return!0;default:return!1}}recordSuccess(){this.lastSuccessTime=Date.now(),this.emitEvent({type:"success"}),this.state==="HALF_OPEN"&&(this.successes++,this.successes>=this.config.successThreshold&&(this.transitionTo("CLOSED"),this.successes=0,this.failures=[])),this.saveToStorage()}recordFailure(t){const n=Date.now();this.lastFailureTime=n,this.emitEvent({type:"failure",error:t}),this.failures.push({time:n});const r=n-this.config.monitoringPeriod;this.failures=this.failures.filter(s=>s.time>r),(this.state==="CLOSED"||this.state==="HALF_OPEN")&&this.failures.length>=this.config.failureThreshold&&(this.transitionTo("OPEN"),this.successes=0),this.state==="HALF_OPEN"&&(this.transitionTo("OPEN"),this.successes=0),this.saveToStorage()}transitionTo(t){if(this.state===t)return;const n=this.state;this.state=t,this.stateChangedAt=Date.now(),this.emitEvent({type:"stateChange",from:n,to:t}),this.saveToStorage()}getStats(){return{failures:this.failures.length,successes:this.successes,state:this.state,lastFailureTime:this.lastFailureTime,lastSuccessTime:this.lastSuccessTime,stateChangedAt:this.stateChangedAt,totalRequests:this.totalRequests}}getState(){return this.state}getConfig(){return{...this.config}}updateConfig(t){this.config={...this.config,...t};try{if(typeof localStorage<"u"){const n=localStorage.getItem(this.storageKey),r=n?JSON.parse(n):{};r.config=this.config,localStorage.setItem(this.storageKey,JSON.stringify(r))}}catch(n){console.warn("Failed to save circuit breaker config:",n)}}reset(){this.transitionTo("CLOSED"),this.failures=[],this.successes=0,this.lastFailureTime=null,this.lastSuccessTime=null,this.totalRequests=0,this.saveToStorage()}open(){this.transitionTo("OPEN")}on(t,n){this.listeners.push(n)}off(t){this.listeners=this.listeners.filter(n=>n!==t)}emitEvent(t){this.listeners.forEach(n=>{try{n(t)}catch(r){console.error("Circuit breaker event listener error:",r)}})}saveToStorage(){try{if(typeof localStorage<"u"){const t={state:this.state,stateChangedAt:this.stateChangedAt,failures:this.failures,successes:this.successes,lastFailureTime:this.lastFailureTime,lastSuccessTime:this.lastSuccessTime,totalRequests:this.totalRequests};localStorage.setItem(this.storageKey,JSON.stringify(t))}}catch(t){console.warn("Failed to save circuit breaker state:",t)}}loadState(){try{if(typeof localStorage<"u"){const t=localStorage.getItem(this.storageKey);if(t)return JSON.parse(t).state}}catch(t){console.warn("Failed to load circuit breaker state:",t)}return null}loadFromStorage(){try{if(typeof localStorage<"u"){const t=localStorage.getItem(this.storageKey);if(t){const n=JSON.parse(t);n.config&&(this.config={...this.config,...n.config}),this.state=n.state||"CLOSED",this.stateChangedAt=n.stateChangedAt||Date.now(),this.failures=(n.failures||[]).filter(r=>{const s=Date.now()-this.config.monitoringPeriod;return r.time>s}),this.successes=n.successes||0,this.lastFailureTime=n.lastFailureTime||null,this.lastSuccessTime=n.lastSuccessTime||null,this.totalRequests=n.totalRequests||0,this.state==="OPEN"&&Date.now()-this.stateChangedAt>=this.config.resetTimeout&&this.transitionTo("HALF_OPEN")}}}catch(t){console.warn("Failed to load circuit breaker state:",t)}}}const an=new Jee("database",{failureThreshold:5,resetTimeout:3e4,successThreshold:2,monitoringPeriod:1e4,timeout:1e4}),Qee=["ECONNRESET","ENOTFOUND","ETIMEDOUT","ECONNREFUSED","NetworkError"],Zee=["Timeout","ETIMEDOUT"],ete=[500,502,503,504,429];function Gs(e){var s;const t=(e==null?void 0:e.message)||String(e),n=(e==null?void 0:e.code)||(e==null?void 0:e.error_code)||"",r=(e==null?void 0:e.status)||(e==null?void 0:e.statusCode)||((s=e==null?void 0:e.response)==null?void 0:s.status);if(Qee.some(i=>t.includes(i)||n.includes(i)||t.toLowerCase().includes("network")))return{category:"NETWORK",isRetryable:!0,retryDelay:1e3,userMessage:"Koneksi jaringan bermasalah. Mencoba lagi...",originalError:e};if(Zee.some(i=>t.includes(i)||n.includes(i)||t.toLowerCase().includes("timeout")))return{category:"TIMEOUT",isRetryable:!0,retryDelay:2e3,userMessage:"Permintaan memakan waktu terlalu lama. Mencoba lagi...",originalError:e};if(r===429||t.includes("rate limit")||t.includes("too many requests")||n==="PGRST301")return{category:"RATE_LIMIT",isRetryable:!0,retryDelay:5e3,userMessage:"Terlalu banyak permintaan. Mohon tunggu sebentar...",originalError:e};if(r===401||r===403||t.includes("JWT")||t.includes("token")||t.includes("unauthorized")||t.includes("forbidden")||n==="PGRST301"||n==="PGRST302")return{category:"AUTH_ERROR",isRetryable:!1,userMessage:"Sesi Anda telah berakhir. Silakan login kembali.",originalError:e};if(r===400||t.includes("validation")||t.includes("invalid")||t.includes("constraint")||n==="23505"||n==="23503"||n==="23514")return{category:"VALIDATION_ERROR",isRetryable:!1,userMessage:"Data yang dimasukkan tidak valid. Silakan periksa kembali.",originalError:e};if(ete.includes(r)||n!=null&&n.startsWith("PGRST")||n!=null&&n.startsWith("P0001")||t.includes("database")||t.includes("connection")){const i=r>=500||r===429;return{category:"DATABASE_ERROR",isRetryable:i,retryDelay:i?2e3:void 0,userMessage:i?"Database sedang bermasalah. Mencoba lagi...":"Terjadi kesalahan database. Silakan coba lagi nanti.",originalError:e}}return r===404?{category:"VALIDATION_ERROR",isRetryable:!1,userMessage:"Data yang dicari tidak ditemukan.",originalError:e}:{category:"UNKNOWN",isRetryable:!0,retryDelay:1e3,userMessage:"Terjadi kesalahan. Mencoba lagi...",originalError:e}}const v3={reads:{limit:100,window:6e4},writes:{limit:30,window:6e4},rpc:{limit:20,window:6e4},auth:{limit:10,window:6e4}},tte="rate_limit_";class S1{constructor(t="default",n={}){Kt(this,"config");Kt(this,"requests",new Map);Kt(this,"storageKey");this.name=t,this.config={...v3,...n},this.storageKey=`${tte}${t}`,this.loadFromStorage(),typeof window<"u"&&setInterval(()=>this.cleanup(),6e4)}checkLimit(t,n,r){const s=this.getKey(t,n,r),i=Date.now(),o=this.getConfig(n);let l=this.requests.get(s)||[];const c=i-o.window;l=l.filter(v=>v.timestamp>c);const u=l.length,d=u<o.limit,h=l[0],f=h?h.timestamp+o.window:i+o.window,m=d?void 0:Math.ceil((f-i)/1e3)*1e3,g={allowed:d,remaining:Math.max(0,o.limit-u-1),resetAt:f,retryAfter:m};return d&&(l.push({timestamp:i,operation:n,endpoint:r}),this.requests.set(s,l),this.saveToStorage(s,l)),g}recordRequest(t,n,r){const s=this.getKey(t,n,r),i=Date.now();let o=this.requests.get(s)||[];o.push({timestamp:i,operation:n,endpoint:r});const l=this.getConfig(n),c=i-l.window;o=o.filter(u=>u.timestamp>c),this.requests.set(s,o),this.saveToStorage(s,o)}getUsage(t,n,r){const s=this.getKey(t,n,r),i=Date.now(),o=this.getConfig(n);let l=this.requests.get(s)||[];const c=i-o.window;l=l.filter(h=>h.timestamp>c);const u=l[0],d=u?u.timestamp+o.window:i+o.window;return{count:l.length,limit:o.limit,resetAt:d}}reset(t,n,r){if(n){const s=this.getKey(t,n,r);this.requests.delete(s),this.deleteFromStorage(s)}else{const s=t?`${t}:`:"anonymous:";for(const i of this.requests.keys())i.startsWith(s)&&(this.requests.delete(i),this.deleteFromStorage(i))}}cleanup(){const t=Date.now(),n=Math.max(this.config.reads.window,this.config.writes.window,this.config.rpc.window,this.config.auth.window),r=t-n;for(const[s,i]of this.requests.entries()){const o=i.filter(l=>l.timestamp>r);o.length===0?(this.requests.delete(s),this.deleteFromStorage(s)):o.length!==i.length&&(this.requests.set(s,o),this.saveToStorage(s,o))}}getConfig(t){return this.config[t]}getKey(t,n,r){return`${t||"anonymous"}:${n}${r?`:${r}`:""}`}saveToStorage(t,n){try{if(typeof localStorage<"u"){const r=`${this.storageKey}:${t}`,s=Date.now(),i=n.filter(o=>s-o.timestamp<6e4);localStorage.setItem(r,JSON.stringify({requests:i,savedAt:s}))}}catch(r){console.warn("Failed to save rate limit data:",r)}}loadFromStorage(){try{if(typeof localStorage<"u"){const t=Date.now(),n=`${this.storageKey}:`;for(let r=0;r<localStorage.length;r++){const s=localStorage.key(r);if(s&&s.startsWith(n))try{const i=JSON.parse(localStorage.getItem(s)||"{}"),o=i.savedAt||0;if(t-o<3e5){const l=(i.requests||[]).filter(c=>{const u=c.operation||"read",d=this.getConfig(u);return t-c.timestamp<d.window});if(l.length>0){const c=s.replace(n,"");this.requests.set(c,l)}else localStorage.removeItem(s)}else localStorage.removeItem(s)}catch{localStorage.removeItem(s)}}}}catch(t){console.warn("Failed to load rate limit data:",t)}}deleteFromStorage(t){try{if(typeof localStorage<"u"){const n=`${this.storageKey}:${t}`;localStorage.removeItem(n)}}catch{}}}new S1("default",v3);class nte{constructor(){Kt(this,"queue",[]);Kt(this,"batchSize",50);Kt(this,"batchInterval",3e4);Kt(this,"intervalId",null);Kt(this,"enabled",!0);Kt(this,"lastFlushTime",0);Kt(this,"flushThrottle",1e4);typeof window<"u"&&this.startBatching()}record(t){if(!this.enabled)return;this.queue.length>=1e3&&(this.queue=this.queue.slice(-500)),this.queue.push({...t,timestamp:Date.now()});const n=Date.now();this.queue.length>=this.batchSize&&n-this.lastFlushTime>=this.flushThrottle&&this.flush()}startBatching(){this.intervalId&&clearInterval(this.intervalId),this.intervalId=setInterval(()=>{this.flush()},this.batchInterval)}stopBatching(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)}async flush(){if(this.queue.length===0)return;const t=Date.now();if(t-this.lastFlushTime<this.flushThrottle)return;const n=[...this.queue];this.queue=[],this.lastFlushTime=t;try{const{error:r}=await le.from("circuit_breaker_metrics").insert(n.map(s=>({operation_type:s.operationType,endpoint:s.endpoint||null,user_id:s.userId||null,circuit_breaker_state:s.circuitBreakerState,success:s.success,error_category:s.errorCategory||null,response_time_ms:s.responseTimeMs,metadata:s.metadata||{}})));r&&(console.warn("Failed to send metrics:",r),this.queue.length<100&&(this.queue=[...n,...this.queue]))}catch(r){console.warn("Failed to flush metrics:",r),this.queue.length<100&&(this.queue=[...n,...this.queue])}}setEnabled(t){this.enabled=t,t?this.startBatching():(this.stopBatching(),this.queue=[])}getQueueSize(){return this.queue.length}async forceFlush(){await this.flush()}}function Fw(e,t){if(e.length===0)return 0;const n=[...e].sort((s,i)=>s-i),r=Math.ceil(t/100*n.length)-1;return n[Math.max(0,r)]}async function y3(e,t,n){try{let r=le.from("circuit_breaker_metrics").select("*");e&&(r=r.gte("created_at",e.toISOString())),t&&(r=r.lt("created_at",t.toISOString()));const{data:s,error:i}=await r;if(i||!s)return{totalOperations:0,successRate:0,failureRate:0,avgResponseTime:0,p50ResponseTime:0,p95ResponseTime:0,p99ResponseTime:0,circuitBreakerStates:{},errorCategories:{},operationsByType:{}};const o=s.length,l=s.filter(g=>g.success).length,c=s.filter(g=>!g.success).length,u=s.map(g=>g.response_time_ms||0).filter(g=>g>0),d={},h={},f={};s.forEach(g=>{const v=g.circuit_breaker_state||"UNKNOWN";if(d[v]=(d[v]||0)+1,g.error_category){const x=g.error_category;h[x]=(h[x]||0)+1}const y=g.operation_type||"unknown";f[y]=(f[y]||0)+1});const m=u.length>0?u.reduce((g,v)=>g+v,0)/u.length:0;return{totalOperations:o,successRate:o>0?l/o:0,failureRate:o>0?c/o:0,avgResponseTime:m,p50ResponseTime:Fw(u,50),p95ResponseTime:Fw(u,95),p99ResponseTime:Fw(u,99),circuitBreakerStates:d,errorCategories:h,operationsByType:f}}catch(r){return console.error("Failed to get metrics stats:",r),{totalOperations:0,successRate:0,failureRate:0,avgResponseTime:0,p50ResponseTime:0,p95ResponseTime:0,p99ResponseTime:0,circuitBreakerStates:{},errorCategories:{},operationsByType:{}}}}const Em=new nte,GP={baseConfig:{read:{limit:100,window:6e4},write:{limit:30,window:6e4},rpc:{limit:20,window:6e4},auth:{limit:10,window:6e4}},minMultiplier:.5,maxMultiplier:2,adjustmentInterval:6e4,healthyLatencyThreshold:200,stressLatencyThreshold:1e3};class rte{constructor(t={}){Kt(this,"config");Kt(this,"currentMultipliers",new Map);Kt(this,"lastAdjustment",Date.now());Kt(this,"rateLimiters",new Map);Kt(this,"storageKey","adaptive_rate_limiter");Kt(this,"adjustmentIntervalId",null);this.config={...GP,...t},this.loadFromStorage(),Object.keys(this.config.baseConfig).forEach(n=>{this.currentMultipliers.has(n)||this.currentMultipliers.set(n,1)}),typeof window<"u"&&(this.adjustmentIntervalId=setInterval(()=>this.adjustLimits(),this.config.adjustmentInterval))}getLimiter(t){if(!this.rateLimiters.has(t)){const n=this.config.baseConfig[t],r=this.currentMultipliers.get(t)||1,s={limit:Math.round(n.limit*r),window:n.window};this.rateLimiters.set(t,new S1(`adaptive_${t}`,{[t]:s}))}return this.rateLimiters.get(t)}async adjustLimits(){try{const t=Date.now(),n=new Date(t-5*60*1e3),r=await this.getRecentStats(n,new Date(t));for(const s of Object.keys(this.config.baseConfig))await this.adjustOperationLimit(s,r);this.lastAdjustment=t}catch(t){console.warn("Failed to adjust rate limits:",t)}}async getRecentStats(t,n){try{const r=await y3(t,n);return{avgResponseTime:r.avgResponseTime,errorRate:r.failureRate,requestVolume:r.totalOperations}}catch{return{avgResponseTime:300,errorRate:.01,requestVolume:100}}}async adjustOperationLimit(t,n){const r=this.currentMultipliers.get(t)||1,s=this.config.baseConfig[t];let i=r;const{avgResponseTime:o,errorRate:l}=n;o<this.config.healthyLatencyThreshold&&l<.05?i=Math.min(r*1.1,this.config.maxMultiplier):o>this.config.stressLatencyThreshold||l>.2?i=Math.max(r*.8,this.config.minMultiplier):r>1?i=Math.max(r*.95,1):r<1&&(i=Math.min(r*1.05,1)),this.currentMultipliers.set(t,i);const c={limit:Math.round(s.limit*i),window:s.window};this.rateLimiters.set(t,new S1(`adaptive_${t}`,{[t]:c})),this.saveToStorage()}getMultiplier(t){return this.currentMultipliers.get(t)||1}getEffectiveLimit(t){const n=this.config.baseConfig[t],r=this.currentMultipliers.get(t)||1;return Math.round(n.limit*r)}reset(){Object.keys(this.config.baseConfig).forEach(t=>{this.currentMultipliers.set(t,1),this.rateLimiters.delete(t)}),this.saveToStorage()}getConfig(){return{...this.config}}updateConfig(t){this.config={...this.config,...t},t.adjustmentInterval&&typeof window<"u"&&(this.adjustmentIntervalId&&clearInterval(this.adjustmentIntervalId),this.adjustmentIntervalId=setInterval(()=>this.adjustLimits(),this.config.adjustmentInterval)),this.rateLimiters.clear(),this.saveToStorage()}checkLimit(t,n,r){return this.getLimiter(n).checkLimit(t,n,r)}recordRequest(t,n,r){this.getLimiter(n).recordRequest(t,n,r)}getUsage(t,n,r){return this.getLimiter(n).getUsage(t,n,r)}saveToStorage(){try{if(typeof localStorage<"u"){const t={config:this.config,multipliers:Object.fromEntries(this.currentMultipliers),lastAdjustment:this.lastAdjustment};localStorage.setItem(this.storageKey,JSON.stringify(t))}}catch(t){console.warn("Failed to save adaptive rate limiter config:",t)}}loadFromStorage(){try{if(typeof localStorage<"u"){const t=localStorage.getItem(this.storageKey);if(t){const n=JSON.parse(t);n.config&&(this.config={...GP,...n.config}),n.multipliers&&Object.entries(n.multipliers).forEach(([r,s])=>{this.currentMultipliers.set(r,s)}),n.lastAdjustment&&(this.lastAdjustment=n.lastAdjustment)}}}catch(t){console.warn("Failed to load adaptive rate limiter config:",t)}}}const zt=new rte;async function x3(e,t=3,n=1e3){let r;for(let s=0;s<=t;s++)try{return await e()}catch(i){r=i;const o=Gs(i);if(!o.isRetryable||an.getState()!=="CLOSED")throw i;if(s>=t)break;const l=Math.min(n*Math.pow(2,s),8e3),c=o.retryDelay||l;await new Promise(u=>setTimeout(u,c))}throw r}let cf=null,Uw=0;const ate=6e4;async function ZN(e,t=!1){var r,s;const n=Date.now();if(!t&&cf!==null&&n-Uw<ate)return cf;try{const i=e.auth.getSession(),o=new Promise(c=>{setTimeout(()=>c({data:{session:null}}),500)}),{data:l}=await Promise.race([i,o]);return cf=((s=(r=l==null?void 0:l.session)==null?void 0:r.user)==null?void 0:s.id)||null,Uw=n,cf}catch{return cf=null,Uw=n,null}}async function b3(e,t,n,r,s=!1){if(s)return;const i=r!==void 0?r:await ZN(e).catch(()=>null);if(t==="rpc"){const l=zt.getUsage(i,t,n);if(l.count<l.limit*.9){zt.recordRequest(i,t,n);return}const c=zt.checkLimit(i,t,n);if(!c.allowed){const u=new Error(c.retryAfter?`Rate limit exceeded. Please wait ${Math.ceil(c.retryAfter/1e3)} seconds.`:"Rate limit exceeded. Please try again later.");throw u.code="RATE_LIMIT_EXCEEDED",u.status=429,u.retryAfter=c.retryAfter,u.category="RATE_LIMIT",u}return}const o=zt.checkLimit(i,t,n);if(!o.allowed){const l=new Error(o.retryAfter?`Rate limit exceeded. Please wait ${Math.ceil(o.retryAfter/1e3)} seconds.`:"Rate limit exceeded. Please try again later.");throw l.code="RATE_LIMIT_EXCEEDED",l.status=429,l.retryAfter=o.retryAfter,l.category="RATE_LIMIT",l}}function N1(e){return e===void 0?"u":e===null?"n":typeof e=="function"?"f":typeof e=="number"||typeof e=="boolean"||typeof e=="bigint"?`p:${String(e)}`:typeof e=="string"?`s:${e}`:e instanceof Date?`d:${e.toISOString()}`:Array.isArray(e)?`a:[${e.map(t=>N1(t)).join(",")}]`:typeof e=="object"?`o:{${Object.keys(e).sort().map(r=>`${r}:${N1(e[r])}`).join(",")}}`:`x:${String(e)}`}function ste(e){return!e||e.length===0?"":e.map(t=>N1(t)).join("|")}function ite(e){if(!e)return"base";let t=0;for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t=(t<<5)-t+r,t|=0}return Math.abs(t).toString(36)}function w3(e,t,n="read",r,s=!1,i=""){return new Proxy(e,{get(o,l){const c=o[l];let u=n;if((l==="insert"||l==="update"||l==="upsert"||l==="delete")&&(u="write"),l==="then"||l==="catch"||l==="finally"){const d=Promise.resolve(o),h=(async()=>{const f=Date.now();ite(i);const m=ZN(t).catch(()=>null),g=an.getState();try{const b=await Promise.race([m,new Promise(_=>setTimeout(()=>_(null),100))]);u==="read"?zt.recordRequest(b,u,r):await b3(t,u,r,b)}catch(b){if(b.code==="RATE_LIMIT_EXCEEDED")throw b}let v;try{v=await an.execute(()=>x3(async()=>await d))}catch(b){v={data:null,error:b}}const y=Date.now()-f,x=v!=null&&v.error?Gs(v.error).category:void 0,w=await m.catch(()=>null);return Promise.resolve().then(()=>{try{Em.record({operationType:u,endpoint:r,userId:w||void 0,circuitBreakerState:g,success:!(v!=null&&v.error),errorCategory:x,responseTimeMs:y,metadata:v!=null&&v.error?{error:v.error.message}:{}})}catch{}}),v})().catch(f=>{const m=Date.now()-startTime,g=Gs(f);return Em.record({operationType:u,endpoint:r,userId:userId||void 0,circuitBreakerState:circuitState,success:!1,errorCategory:g.category,responseTimeMs:m,metadata:{error:f instanceof Error?f.message:String(f)}}),f.code==="RATE_LIMIT_EXCEEDED"?{data:null,error:{message:f.message,code:"RATE_LIMIT_EXCEEDED",status:429,category:"RATE_LIMIT",retryAfter:f.retryAfter,circuitBreaker:an.getState()}}:f&&typeof f=="object"&&("data"in f||"error"in f)?{data:f.data||null,error:{...f.error||f,message:g.userMessage,category:g.category,circuitBreaker:an.getState()}}:{data:null,error:{...g.originalError,message:g.userMessage,category:g.category,circuitBreaker:an.getState()}}});return(f,m)=>h[l](f,m)}return typeof c=="function"?(...d)=>{const h=c.apply(o,d),f=ste(d),m=f?`${l}(${f})`:`${l}()`,g=i?`${i}|${m}`:m;return w3(h,t,u,r,s,g)}:c}})}function ote(e){const t=e;return{from:n=>{const r=t.from(n);return w3(r,t,"read",n)},rpc:async(n,r,s)=>{const i=Date.now(),o=ZN(t).catch(()=>null),l=an.getState();try{try{const f=await Promise.race([o,new Promise(m=>setTimeout(()=>m(null),100))]);await b3(t,"rpc",n,f,!1)}catch(f){if(f.code==="RATE_LIMIT_EXCEEDED")throw f}const c=await an.execute(()=>x3(async()=>await t.rpc(n,r,s))),u=Date.now()-i,d=c!=null&&c.error?Gs(c.error).category:void 0,h=await o.catch(()=>null);return Promise.resolve().then(()=>{try{Em.record({operationType:"rpc",endpoint:n,userId:h||void 0,circuitBreakerState:l,success:!(c!=null&&c.error),errorCategory:d,responseTimeMs:u,metadata:c!=null&&c.error?{error:c.error.message}:{}})}catch{}}),c}catch(c){const u=Gs(c),d=Date.now()-i,h=await o.catch(()=>null);return Promise.resolve().then(()=>{try{Em.record({operationType:"rpc",endpoint:n,userId:h||void 0,circuitBreakerState:l,success:!1,errorCategory:u.category,responseTimeMs:d,metadata:{error:c instanceof Error?c.message:String(c)}})}catch{}}),{data:null,error:{...u.originalError,message:u.userMessage,category:u.category,circuitBreaker:l}}}},auth:{getSession:async()=>{try{return await an.execute(()=>t.auth.getSession(),5e3)}catch(n){const r=Gs(n);throw new Error(r.userMessage)}},getUser:async()=>{try{return await an.execute(()=>t.auth.getUser(),5e3)}catch(n){const r=Gs(n);throw new Error(r.userMessage)}},signOut:async()=>{try{return await an.execute(()=>t.auth.signOut(),5e3)}catch(n){const r=Gs(n);throw new Error(r.userMessage)}},signInWithPassword:async n=>{try{return await an.execute(()=>t.auth.signInWithPassword(n),1e4)}catch(r){const s=Gs(r);throw new Error(s.userMessage)}},signInWithOtp:async(n,r)=>{try{return await an.execute(()=>t.auth.signInWithOtp({email:n,options:r}),1e4)}catch(s){const i=Gs(s);throw new Error(i.userMessage)}},verifyOtp:async n=>{try{return await an.execute(()=>t.auth.verifyOtp(n),1e4)}catch(r){const s=Gs(r);throw new Error(s.userMessage)}},onAuthStateChange:t.auth.onAuthStateChange.bind(t.auth),resetPasswordForEmail:t.auth.resetPasswordForEmail.bind(t.auth),refreshSession:t.auth.refreshSession.bind(t.auth),updateUser:t.auth.updateUser.bind(t.auth),setSession:t.auth.setSession.bind(t.auth)},storage:t.storage,channel:t.channel.bind(t),removeChannel:t.removeChannel.bind(t),removeAllChannels:t.removeAllChannels.bind(t),getChannels:t.getChannels.bind(t),getCircuitBreaker:()=>an,getCircuitBreakerStats:()=>an.getStats()}}const le=Wr,kt=ote(le);async function en(e){var t;try{const{action:n,resource:r,resourceId:s=null,context:i={},ip:o=null,userAgent:l=null}=e;let c=e.userId??null;if(!c)try{const h=typeof localStorage<"u"?localStorage.getItem("app.currentUserId"):null;h&&(c=h)}catch{}if(!c){const{data:h}=await le.auth.getUser();c=((t=h==null?void 0:h.user)==null?void 0:t.id)??null}let u=e.orgId??null;if(!u&&c&&(authData!=null&&authData.user))try{const{data:h}=await le.from("org_members").select("org_id").eq("user_id",c).limit(1).maybeSingle();u=(h==null?void 0:h.org_id)??null}catch{return}if(!u&&n==="auth.logout")return;if(!u)try{const{data:h}=await le.from("orgs").select("id").limit(1).maybeSingle();u=(h==null?void 0:h.id)??null}catch{return}try{const h=`logAction:${n}:${r}:${c||"anon"}`,f=Date.now(),m=typeof localStorage<"u"?localStorage.getItem(h):null;if(m){const g=Number(m)||0;if(f-g<3e3)return}typeof localStorage<"u"&&localStorage.setItem(h,String(f))}catch{}if(!u)return;const{error:d}=await le.rpc("log_action",{p_action:n,p_resource:r,p_resource_id:s,p_context:{...i,route:typeof window<"u"?window.location.pathname:null},p_ip:o,p_user_agent:l,p_org_id:u,p_user_id:c});d&&console.warn("logAction failed",d)}catch(n){console.warn("logAction threw",n)}}const j3=p.createContext(void 0);function lte({children:e}){var E;const t=Va(),[n,r]=p.useState(null),[s,i]=p.useState(null),[o,l]=p.useState(!0),c=p.useRef(null),[u,d]=p.useState(!1),h=p.useMemo(()=>{try{const I=new URL(Oo).hostname.split(".")[0];return I?`sb-${I}-auth-token`:null}catch{return null}},[]),[f,m]=p.useState(()=>{var F;try{if(localStorage.getItem("otpVerified")==="true")return!0;const P=localStorage.getItem("app.lastAuthEvent");if(P)try{const U=JSON.parse(P),Z=(F=U==null?void 0:U.user)==null?void 0:F.id;if(Z)return localStorage.getItem(`otpVerified:${Z}`)==="true"}catch{}return!1}catch{return!1}}),[g,v]=p.useState(!1),[y,x]=p.useState(!1),[w,b]=p.useState(!1),[_,k]=p.useState(!1),[j,S]=p.useState(0);p.useEffect(()=>{b(!1)},[n==null?void 0:n.id]);const[T,O]=p.useState(!1),A=p.useRef(!1),N=p.useRef(null),L=p.useRef(null);p.useEffect(()=>{L.current=(n==null?void 0:n.id)??null},[n==null?void 0:n.id]);const M=p.useCallback(F=>{var I;m(F);try{const P=(I=s==null?void 0:s.user)!=null&&I.id?`otpVerified:${s.user.id}`:"otpVerified";F?(localStorage.setItem(P,"true"),localStorage.setItem("otpVerified","true")):(localStorage.removeItem(P),localStorage.removeItem("otpVerified"))}catch{}},[(E=s==null?void 0:s.user)==null?void 0:E.id]),B=async F=>{var U,Z;const I=(U=F==null?void 0:F.user)==null?void 0:U.id,P=j+1;if(S(P),!I)return x(!1),!0;if(_||w&&((Z=F==null?void 0:F.user)==null?void 0:Z.id)===(n==null?void 0:n.id))return!y;k(!0);try{const{data:X,error:K}=await le.from("users_profile").select("is_active").eq("user_id",I).maybeSingle();return K?(console.error("Error checking account status:",K),!y):X?X.is_active===!0?(x(!1),b(!0),!0):(t("/account-deactivated",{replace:!0}),!1):!y}catch(X){return console.error("Failed to check account status",X),!y}finally{k(!1)}},$=async F=>{var P,U,Z,X,K;const I=(P=F==null?void 0:F.user)==null?void 0:P.id;if(!I){d(!1);try{const ie=(U=F==null?void 0:F.user)!=null&&U.id?`otpRequired:${F.user.id}`:"otpRequired";localStorage.removeItem(ie)}catch{}return!1}try{const{data:ie,error:H}=await le.from("users_profile").select("is_2fa_email_enabled").eq("user_id",I).maybeSingle();if(H)throw H;if(!ie){d(!0);try{const me=(Z=F==null?void 0:F.user)!=null&&Z.id?`otpRequired:${F.user.id}`:"otpRequired";localStorage.setItem(me,"true")}catch{}return!0}const he=(ie==null?void 0:ie.is_2fa_email_enabled)===!0;d(!!he);try{const me=(X=F==null?void 0:F.user)!=null&&X.id?`otpRequired:${F.user.id}`:"otpRequired";he?localStorage.setItem(me,"true"):localStorage.removeItem(me)}catch{}return!!he}catch(ie){console.warn("Failed to evaluate 2FA profile flag",ie),d(!0);try{const H=(K=F==null?void 0:F.user)!=null&&K.id?`otpRequired:${F.user.id}`:"otpRequired";localStorage.setItem(H,"true")}catch{}return!0}},z=F=>{let I=!1;const P=window.setTimeout(()=>{I||v(!0)},5e3);return F.finally(()=>{I=!0,window.clearTimeout(P),v(!0)})};p.useEffect(()=>{(async()=>{var Z,X,K;l(!0),v(!1);let P=!1;const U=window.setTimeout(()=>{P=!0,l(!1),v(!0)},5e3);try{try{localStorage.removeItem("otpRequired"),localStorage.removeItem("otpVerified")}catch{}try{const ae=Object.keys(localStorage).filter(Ne=>Ne.startsWith("sb-")&&Ne.endsWith("-auth-token"));for(const Ne of ae)try{const de=localStorage.getItem(Ne);if(!de)continue;const Q=JSON.parse(de);if(Q!=null&&Q.access_token&&(Q!=null&&Q.user)){i(Q),r(Q.user);break}}catch{}h?ae.filter(de=>de!==h).forEach(de=>{try{localStorage.removeItem(de)}catch{}}):localStorage.removeItem("sb-yoekcpoppfudmqtvjcby-auth-token")}catch{}const ie=await Promise.race([le.auth.getSession().catch(()=>({data:{session:null}})),new Promise(ae=>{setTimeout(()=>ae({data:{session:null}}),4e3)})]),H=((Z=ie==null?void 0:ie.data)==null?void 0:Z.session)??null;i(H),r((H==null?void 0:H.user)??null);const he=await Promise.race([le.auth.getUser().catch(()=>({data:{user:null}})),new Promise(ae=>{setTimeout(()=>ae({data:{user:null}}),4e3)})]);if(!(((X=he==null?void 0:he.data)==null?void 0:X.user)??null)){i(null),r(null),d(!1),M(!1),v(!0);return}if(H){if(!await Promise.race([B(H),new Promise(Ne=>setTimeout(()=>Ne(!0),3e3))])){i(H),r(H.user),d(!1),M(!1),v(!0),l(!1);return}i(H),r(H.user);try{(K=H.user)!=null&&K.id&&(localStorage.setItem("app.currentUserId",H.user.id),localStorage.setItem("app.currentUserEmail",H.user.email||""))}catch{}P||(window.clearTimeout(U),l(!1)),z($(H).then(Ne=>{d(!!Ne)}));return}else d(!1),M(!1),v(!0)}finally{P||(window.clearTimeout(U),l(!1))}})();const{data:{subscription:I}}=le.auth.onAuthStateChange(async(P,U)=>{var Z,X,K,ie;try{if(P==="SIGNED_IN"){const H=L.current,he=((Z=U==null?void 0:U.user)==null?void 0:Z.id)||null;if(!!H&&!!he&&H===he){i(U),r((U==null?void 0:U.user)??null);return}if(T){i(U),r((U==null?void 0:U.user)??null);return}if(!await Promise.race([B(U),new Promise(Q=>setTimeout(()=>Q(!0),3e3))])){i(U),r((U==null?void 0:U.user)??null),d(!1),M(!1),v(!0),l(!1);return}i(U),r((U==null?void 0:U.user)??null);const Ne=((X=U==null?void 0:U.user)==null?void 0:X.id)||null;if(Ne&&N.current!==Ne){en({action:"auth.login",resource:"auth",userId:Ne,context:{}}).catch(()=>{}),N.current=Ne;try{localStorage.setItem("app.currentUserId",Ne),localStorage.setItem("app.currentUserEmail",((K=U==null?void 0:U.user)==null?void 0:K.email)||"")}catch{}}let de=!1;try{const Q=Ne?`otpVerified:${Ne}`:"otpVerified";de=localStorage.getItem(Q)==="true"||localStorage.getItem("otpVerified")==="true"}catch{}M(!!de);try{const Q=(ie=U==null?void 0:U.user)!=null&&ie.id?`otpRequired:${U.user.id}`:"otpRequired";localStorage.removeItem(Q)}catch{}v(!1),l(!1),z($(U).then(Q=>{var fe;if(Q&&!de){const Be=((fe=U==null?void 0:U.user)==null?void 0:fe.id)||null;Be&&c.current!==Be&&le.functions.invoke("send-2fa-login-email",{headers:U!=null&&U.access_token?{Authorization:`Bearer ${U.access_token}`}:void 0}).then(()=>{c.current=Be}).catch(je=>{console.warn("2FA send function failed",je)})}d(!!Q)}));try{localStorage.setItem("app.lastAuthEvent",JSON.stringify({event:P,at:Date.now(),user:(U==null?void 0:U.user)||null}))}catch{}return}if(P==="PASSWORD_RECOVERY"){try{localStorage.setItem("auth.intent","recovery")}catch{}try{if(window.location.hash){const H=new URL(window.location.href);H.hash="",window.history.replaceState({},document.title,H.toString())}}catch{}window.location.pathname!=="/reset-password"&&t("/reset-password",{replace:!0}),v(!1),z((async()=>{try{const H=await $(U);d(!!H),H&&M(!1)}catch{d(!1)}})());return}if(P==="TOKEN_REFRESHED"||P==="USER_UPDATED")return;if(P==="SIGNED_OUT"){n!=null&&n.id&&en({action:"auth.logout",resource:"auth",userId:n.id,context:{}}).catch(()=>{}),d(!1),M(!1),O(!1),x(!1);try{const H=[];for(let me=0;me<localStorage.length;me++){const ae=localStorage.key(me);ae&&H.push(ae)}H.forEach(me=>{try{localStorage.removeItem(me)}catch{}});const he=[];for(let me=0;me<sessionStorage.length;me++){const ae=sessionStorage.key(me);ae&&he.push(ae)}he.forEach(me=>{try{sessionStorage.removeItem(me)}catch{}})}catch(H){console.warn("Error clearing cache on sign out:",H)}}}catch{}P!=="SIGNED_IN"&&(i(U),r((U==null?void 0:U.user)??null)),v(!0),l(!1)});return()=>I.unsubscribe()},[]),p.useEffect(()=>{const F=async()=>{try{await le.auth.getSession()}catch{}},I=()=>{try{document.visibilityState==="visible"&&F()}catch{}};window.addEventListener("focus",F),document.addEventListener("visibilitychange",I);const P=window.setInterval(()=>{try{document.visibilityState==="visible"&&le.auth.getSession().catch(()=>{})}catch{}},4*60*1e3);return()=>{window.removeEventListener("focus",F),document.removeEventListener("visibilitychange",I);try{clearInterval(P)}catch{}}},[]);const R=p.useCallback(async()=>{try{if(O(!0),A.current=!0,n!=null&&n.id){console.log(`[Auth] Attempting to clear presence for user ${n.id}...`);try{console.log("[Auth] Draining in-flight requests..."),await new Promise(P=>setTimeout(P,1e3));const{data:F,error:I}=await le.rpc("go_offline");I?console.error("[Auth] Failed to clear presence (RPC Error):",I):console.log(`[Auth] Presence cleared successfully via RPC. Result: ${F}`)}catch(F){console.warn("[Auth] Failed to clear last_seen_at on logout (Exception):",F)}}else console.warn("[Auth] No user ID found during sign out, skipping presence clear.");try{const F=[];for(let U=0;U<localStorage.length;U++){const Z=localStorage.key(U);Z&&F.push(Z)}F.forEach(U=>{try{localStorage.removeItem(U)}catch{}});const I=[];for(let U=0;U<sessionStorage.length;U++){const Z=sessionStorage.key(U);Z&&I.push(Z)}I.forEach(U=>{try{sessionStorage.removeItem(U)}catch{}});const P=["app.cached","app.lastAuthEvent","app.currentUserId","app.currentUserEmail","otpVerified","otpRequired","auth.intent","sb-"];Object.keys(localStorage).forEach(U=>{if(P.some(Z=>U.includes(Z)))try{localStorage.removeItem(U)}catch{}})}catch(F){console.warn("Error clearing cache:",F)}await le.auth.signOut()}catch(F){console.error("Error signing out:",F)}finally{O(!1),A.current=!1}},[n]),C=p.useCallback(async()=>{try{const{data:{user:F}}=await le.auth.getUser();r(F)}catch(F){console.error("Error refreshing user:",F)}},[]),D=p.useMemo(()=>({user:n,session:s,loading:o,signOut:R,refreshUser:C,otpRequired:u,otpVerified:f,setOtpVerified:M,otpEvaluated:g,accountDeactivated:y,setAccountDeactivated:x,isSigningOut:T,isSigningOutRef:A}),[n,s,o,R,C,u,f,M,g,y,x,T]);return a.jsx(j3.Provider,{value:D,children:e})}function Ar(){const e=p.useContext(j3);if(e===void 0)throw new Error("useAuth must be used within an AuthProvider");return e}const id={analytics:["read"],ai_profiles:["create","update","delete","read_all","read_own"],ai_sessions:["create","update","delete","read_all","read_own"],channels:["create","update","delete","read_all","read_own"],contacts:["create","update","delete","read_all","read_own"],contact_identities:["create","update","delete","read_all","read_own"],threads:["create","update","delete","read_all","read_channel_owned","read_collaborator"],messages:["create","update","delete","send","read_all","read_collaborator"],ai_agent_files:["create","read","delete"],admin_panel:["read","update"],super_agents:["create","update","delete","read_all","read_own"],users_profile:["create","update","delete","read"],roles:["create","read","update","delete"],audit_logs:["read"],alerts:["read","ack"]},Bw=e=>e==="create"?"create":e==="update"?"update":e==="delete"?"delete":e.startsWith("read")||e.startsWith("view")?"read":"special",cte=e=>["delete","manage_2fa","configure","update_token_limit","manage"].some(n=>e.includes(n)),ute={defaultTtl:5*60*1e3,maxSize:100,strategy:"stale-while-revalidate"},uf="supabase_cache_",YP="1";class dte{constructor(t={}){Kt(this,"cache",new Map);Kt(this,"config");this.config={...ute,...t},this.loadFromStorage(),typeof window<"u"&&setInterval(()=>this.cleanup(),6e4)}get(t){const n=this.cache.get(t);if(!n)return null;const r=Date.now(),s=n.ttl||this.config.defaultTtl;return n.timestamp+s<r?(this.cache.delete(t),this.deleteFromStorage(t),null):n.data}set(t,n,r){const s={data:n,timestamp:Date.now(),ttl:r||this.config.defaultTtl,version:parseInt(YP)};if(this.cache.size>=this.config.maxSize){const i=this.findOldestEntry();i&&(this.cache.delete(i),this.deleteFromStorage(i))}this.cache.set(t,s),this.saveToStorage(t,s)}async execute(t,n,r,s){const i=r||this.config.strategy,o=this.get(t);switch(i){case"cache-first":if(o)return o;try{const l=await n();return this.set(t,l,s),l}catch(l){if(o)return o;throw l}case"network-first":try{const l=await n();return this.set(t,l,s),l}catch(l){if(o)return o;throw l}case"stale-while-revalidate":if(o)return n().then(l=>{this.set(t,l,s)}).catch(()=>{}),o;try{const l=await n();return this.set(t,l,s),l}catch(l){throw l}case"network-only":try{const l=await n();return this.set(t,l,s),l}catch(l){throw l}case"cache-only":if(o)return o;throw new Error("No cached data available");default:return await n()}}invalidate(t){this.cache.delete(t),this.deleteFromStorage(t)}invalidatePattern(t){const n=new RegExp(t);for(const r of this.cache.keys())n.test(r)&&this.invalidate(r)}clear(){this.cache.clear();try{if(typeof localStorage<"u")for(let t=localStorage.length-1;t>=0;t--){const n=localStorage.key(t);n&&n.startsWith(uf)&&localStorage.removeItem(n)}}catch(t){console.warn("Failed to clear cache from storage:",t)}}findOldestEntry(){let t=null,n=1/0;for(const[r,s]of this.cache.entries())s.timestamp<n&&(n=s.timestamp,t=r);return t}cleanup(){const t=Date.now();for(const[n,r]of this.cache.entries()){const s=r.ttl||this.config.defaultTtl;r.timestamp+s<t&&(this.cache.delete(n),this.deleteFromStorage(n))}}saveToStorage(t,n){try{if(typeof localStorage<"u"){const r=`${uf}${t}`;localStorage.setItem(r,JSON.stringify(n))}}catch(r){console.warn("Failed to save cache entry:",r)}}loadFromStorage(){try{if(typeof localStorage<"u"){const t=Date.now();for(let n=0;n<localStorage.length;n++){const r=localStorage.key(n);if(r&&r.startsWith(uf))try{const i=JSON.parse(localStorage.getItem(r)||"{}");if(i.version&&i.version!==parseInt(YP)){localStorage.removeItem(r);continue}const o=i.ttl||this.config.defaultTtl;if(i.timestamp+o<t){localStorage.removeItem(r);continue}const l=r.replace(uf,"");this.cache.set(l,i)}catch{localStorage.removeItem(r)}}}}catch(t){console.warn("Failed to load cache from storage:",t)}}deleteFromStorage(t){try{if(typeof localStorage<"u"){const n=`${uf}${t}`;localStorage.removeItem(n)}}catch{}}getStats(){const t=Date.now(),n=Array.from(this.cache.entries()).map(([r,s])=>({key:r,age:t-s.timestamp,ttl:s.ttl||this.config.defaultTtl}));return{size:this.cache.size,maxSize:this.config.maxSize,entries:n}}}const fo=new dte;class hte{constructor(){Kt(this,"queue",[]);Kt(this,"processing",!1);Kt(this,"maxRetries",3);Kt(this,"storageKey","offline_queue");this.loadFromStorage(),typeof window<"u"&&window.addEventListener("online",()=>{this.processQueue()})}add(t){const n={...t,id:`${Date.now()}-${Math.random().toString(36).substr(2,9)}`,timestamp:Date.now(),retries:0};return this.queue.push(n),this.saveToStorage(),typeof navigator<"u"&&navigator.onLine&&this.processQueue(),n.id}async processQueue(t){if(!(this.processing||this.queue.length===0)&&t){this.processing=!0;try{const n=[...this.queue];this.queue=[];for(const r of n)try{await t(r),this.remove(r.id)}catch{r.retries++,r.retries<this.maxRetries?this.queue.push(r):(console.error("Failed to sync write operation after max retries:",r),this.remove(r.id))}this.saveToStorage()}finally{this.processing=!1}}}remove(t){this.queue=this.queue.filter(n=>n.id!==t),this.saveToStorage()}size(){return this.queue.length}clear(){this.queue=[],this.saveToStorage()}getAll(){return[...this.queue]}saveToStorage(){try{typeof localStorage<"u"&&localStorage.setItem(this.storageKey,JSON.stringify(this.queue))}catch(t){console.warn("Failed to save offline queue:",t)}}loadFromStorage(){try{if(typeof localStorage<"u"){const t=localStorage.getItem(this.storageKey);t&&(this.queue=JSON.parse(t))}}catch(t){console.warn("Failed to load offline queue:",t)}}}new hte;const Tm="app:authz-changed";function XP(){try{fo.clear()}catch{}try{if(typeof localStorage>"u")return;const e=[];for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);n&&e.push(n)}for(const t of e)if(t.startsWith("app.cached"))try{localStorage.removeItem(t)}catch{}}catch{}try{const e=globalThis;e.__agentsCache&&(e.__agentsCache.data=null,e.__agentsCache.ts=0,e.__agentsCache.inFlight=null)}catch{}}function JP(e){try{if(typeof window>"u")return;window.dispatchEvent(new CustomEvent(Tm,{detail:{reason:e}}))}catch{}}const _3=p.createContext(void 0);function fte({children:e}){const{user:t,accountDeactivated:n}=Ar(),[r,s]=p.useState([]),[i,o]=p.useState([]),[l,c]=p.useState(null),[u,d]=p.useState(!0),[h,f]=p.useState(null),m=(M,B)=>{const $=M.map(R=>String((R==null?void 0:R.name)??"").trim().toLowerCase()).filter(Boolean).sort().join(","),z=B.map(R=>`${String((R==null?void 0:R.resource)??"").trim().toLowerCase()}.${String((R==null?void 0:R.action)??"").trim().toLowerCase()}`).filter(R=>R!==".").sort().join(",");return`roles:${$}|perms:${z}`},g=(M,B)=>{try{const $=`app.authzFingerprint:${M}`,z=typeof localStorage<"u"?localStorage.getItem($):null;z&&z!==B&&(XP(),JP("rbac-fingerprint-changed")),typeof localStorage<"u"&&localStorage.setItem($,B)}catch{}},v=async(M,B)=>{try{B!=null&&B.background||d(!0),f(null);const{data:$,error:z}=await le.from("v_current_user_permissions").select("*");if(z)throw z;const R=$||[];o(R);const{data:C,error:D}=await le.from("user_roles").select("role_id").eq("user_id",M);if(D)throw D;if(!C||C.length===0){g(M,m([],R)),s([]),c({user_id:M,roles:[],permissions:R});return}const E=C.map(Z=>Z.role_id),{data:F,error:I}=await le.from("roles").select("*").in("id",E);if(I)throw I;const P=F||[];g(M,m(P,R)),s(P);const U=P.map(Z=>({...Z,permissions:R}));c({user_id:M,roles:U,permissions:R})}catch($){console.error("Error fetching user RBAC:",$),f($ instanceof Error?$.message:"Failed to fetch user permissions")}finally{B!=null&&B.background||d(!1)}},y=async()=>{t!=null&&t.id&&await v(t.id,{background:!0})};p.useEffect(()=>{t!=null&&t.id&&!n?v(t.id):(s([]),o([]),c(null),d(!1))},[t==null?void 0:t.id,n]),p.useEffect(()=>{if(!(t!=null&&t.id)||n)return;const M=t.id,B=le.channel(`rbac-user-roles:${M}`).on("postgres_changes",{event:"*",schema:"public",table:"user_roles",filter:`user_id=eq.${M}`},async()=>{XP(),JP("user_roles-realtime-change");try{await v(M,{background:!0})}catch{}}).subscribe();return()=>{try{le.removeChannel(B)}catch{}}},[t==null?void 0:t.id,n]);const x=M=>{if(!M)return!1;if(r.some(C=>C.name==="master_agent"))return!0;const B=String(M).trim().toLowerCase();if(i.some(C=>(C.name||"").trim().toLowerCase()===B)||i.some(C=>`${C.resource}.${C.action}`.toLowerCase()===B))return!0;const R=B.indexOf(".");if(R>0){const C=B.slice(0,R),D=B.slice(R+1),F={edit:["update"],update:["edit"],remove:["delete"],delete:["remove"],send:["create"],read:["read_all","read_own","read_channel_owned","read_collaborator"],read_all:["read"]}[D]||[];if(F.length>0&&i.some(P=>F.some(U=>`${P.resource}.${P.action}`.toLowerCase()===`${C}.${U}`)))return!0}return!1},w=M=>M.some(B=>x(B)),b=M=>M.every(B=>x(B)),_=M=>r.some(B=>B.name===M),L={userRoles:r,userPermissions:i,userWithRoles:l,hasPermission:x,hasAnyPermission:w,hasAllPermissions:b,hasRole:_,hasAnyRole:M=>M.some(B=>_(B)),hasPermissionDB:async(M,B)=>{try{const{data:$,error:z}=await le.rpc("has_perm",{p_resource:M,p_action:B});return z?(console.error("Error checking permission:",z),!1):$===!0}catch($){return console.error("Error in hasPermissionDB:",$),!1}},can:(M,...B)=>!M||B.length===0?!1:B.every($=>x(`${M}.${$}`)),canRead:M=>{const B=id[M];if(!Array.isArray(B))return!1;const $=B.filter(z=>z==="read"||z.startsWith("read_"));return $.length===0?!1:$.some(z=>x(`${M}.${z}`))},canCreate:M=>x(`${M}.create`),canUpdate:M=>x(`${M}.update`),canDelete:M=>x(`${M}.delete`),loading:u,error:h,refreshRBAC:y};return a.jsx(_3.Provider,{value:L,children:e})}function Nr(){const e=p.useContext(_3);if(e===void 0)throw new Error("useRBAC must be used within an RBACProvider");return e}const k3=p.createContext(void 0);function mte({children:e}){const{user:t,isSigningOut:n,isSigningOutRef:r}=Ar(),[s,i]=p.useState({}),[o,l]=p.useState("online"),c=p.useRef(null),u=p.useRef(null),d=p.useRef(Date.now()),h=5*60*1e3,f=60*1e3;p.useEffect(()=>{if(!t||n||r.current){i({});return}const v=le.channel("room:presence",{config:{presence:{key:t.id}}});return c.current=v,v.on("presence",{event:"sync"},()=>{const y=v.presenceState(),x={};Object.values(y).forEach(w=>{const _=w.sort((k,j)=>k.status==="online"&&j.status!=="online"?-1:k.status!=="online"&&j.status==="online"?1:0)[0];_&&(x[_.user_id]=_)}),i(x)}).on("presence",{event:"join"},({newPresences:y})=>{i(x=>{const w={...x};return y.forEach(b=>{w[b.user_id]=b}),w})}).on("presence",{event:"leave"},({leftPresences:y})=>{i(x=>{const w={...x};return y.forEach(b=>{delete w[b.user_id]}),w})}).subscribe(async y=>{y==="SUBSCRIBED"&&await m("online")}),()=>{v.unsubscribe(),c.current=null}},[t,n]);const m=async v=>{if(!c.current||!t||n||r.current)return;const y={user_id:t.id,status:v,online_at:new Date().toISOString()};await c.current.track(y),l(v),v!=="offline"&&g()},g=async()=>{if(!(!t||n||r.current))try{await le.from("users_profile").update({last_seen_at:new Date().toISOString()}).eq("user_id",t.id)}catch(v){console.error("Failed to update last_seen_at",v)}};return p.useEffect(()=>{if(!t)return;const v=()=>{d.current=Date.now(),o==="idle"&&m("online")},y=()=>{Date.now()-d.current>h&&o==="online"&&m("idle")};window.addEventListener("mousemove",v),window.addEventListener("keydown",v),window.addEventListener("click",v),window.addEventListener("scroll",v),u.current=setInterval(y,1e4);const x=setInterval(g,f);return()=>{window.removeEventListener("mousemove",v),window.removeEventListener("keydown",v),window.removeEventListener("click",v),window.removeEventListener("scroll",v),u.current&&clearInterval(u.current),clearInterval(x)}},[t,o]),a.jsx(k3.Provider,{value:{onlineUsers:s,currentUserStatus:o},children:e})}function S3(){const e=p.useContext(k3);if(e===void 0)throw new Error("usePresence must be used within a PresenceProvider");return e}const N3=p.createContext(void 0),QP="chatflow-theme";function ZP(){return typeof window<"u"&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}function pte({children:e}){const[t,n]=p.useState(()=>{if(typeof window<"u"){const o=localStorage.getItem(QP);if(o&&["light","dark","system"].includes(o))return o}return"system"}),[r,s]=p.useState(()=>t==="system"?ZP():t);p.useEffect(()=>{const o=window.document.documentElement,l=()=>{const d=t==="system"?ZP():t;s(d),o.classList.remove("light","dark"),o.classList.add(d)};l();const c=window.matchMedia("(prefers-color-scheme: dark)"),u=()=>{t==="system"&&l()};return c.addEventListener("change",u),()=>c.removeEventListener("change",u)},[t]);const i=o=>{localStorage.setItem(QP,o),n(o)};return a.jsx(N3.Provider,{value:{theme:t,setTheme:i,resolvedTheme:r},children:e})}function gte(){const e=p.useContext(N3);if(e===void 0)throw new Error("useTheme must be used within a ThemeProvider");return e}const Hd=Ip("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),se=p.forwardRef(({className:e,variant:t,size:n,asChild:r=!1,...s},i)=>{const o=r?bN:"button";return a.jsx(o,{className:Ie(Hd({variant:t,size:n,className:e})),ref:i,...s})});se.displayName="Button";const He=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:Ie("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));He.displayName="Card";const dt=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:Ie("flex flex-col space-y-1.5 p-6",e),...t}));dt.displayName="CardHeader";const ct=p.forwardRef(({className:e,...t},n)=>a.jsx("h3",{ref:n,className:Ie("text-2xl font-semibold leading-none tracking-tight",e),...t}));ct.displayName="CardTitle";const Ts=p.forwardRef(({className:e,...t},n)=>a.jsx("p",{ref:n,className:Ie("text-sm text-muted-foreground",e),...t}));Ts.displayName="CardDescription";const lt=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:Ie("p-6 pt-0",e),...t}));lt.displayName="CardContent";const vte=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:Ie("flex items-center p-6 pt-0",e),...t}));vte.displayName="CardFooter";const it=p.forwardRef(({className:e,type:t,...n},r)=>a.jsx("input",{type:t,className:Ie("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...n}));it.displayName="Input";var yte="Label",C3=p.forwardRef((e,t)=>a.jsx(ot.label,{...e,ref:t,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));C3.displayName=yte;var A3=C3;const xte=Ip("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Qe=p.forwardRef(({className:e,...t},n)=>a.jsx(A3,{ref:n,className:Ie(xte(),e),...t}));Qe.displayName=A3.displayName;var bte=p.createContext(void 0);function Ih(e){const t=p.useContext(bte);return e||t||"ltr"}var zw="rovingFocusGroup.onEntryFocus",wte={bubbles:!1,cancelable:!0},Bp="RovingFocusGroup",[C1,E3,jte]=Pp(Bp),[_te,kb]=Mr(Bp,[jte]),[kte,Ste]=_te(Bp),T3=p.forwardRef((e,t)=>a.jsx(C1.Provider,{scope:e.__scopeRovingFocusGroup,children:a.jsx(C1.Slot,{scope:e.__scopeRovingFocusGroup,children:a.jsx(Nte,{...e,ref:t})})}));T3.displayName=Bp;var Nte=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=e,f=p.useRef(null),m=Ot(t,f),g=Ih(i),[v,y]=Ha({prop:o,defaultProp:l??null,onChange:c,caller:Bp}),[x,w]=p.useState(!1),b=ar(u),_=E3(n),k=p.useRef(!1),[j,S]=p.useState(0);return p.useEffect(()=>{const T=f.current;if(T)return T.addEventListener(zw,b),()=>T.removeEventListener(zw,b)},[b]),a.jsx(kte,{scope:n,orientation:r,dir:g,loop:s,currentTabStopId:v,onItemFocus:p.useCallback(T=>y(T),[y]),onItemShiftTab:p.useCallback(()=>w(!0),[]),onFocusableItemAdd:p.useCallback(()=>S(T=>T+1),[]),onFocusableItemRemove:p.useCallback(()=>S(T=>T-1),[]),children:a.jsx(ot.div,{tabIndex:x||j===0?-1:0,"data-orientation":r,...h,ref:m,style:{outline:"none",...e.style},onMouseDown:Ve(e.onMouseDown,()=>{k.current=!0}),onFocus:Ve(e.onFocus,T=>{const O=!k.current;if(T.target===T.currentTarget&&O&&!x){const A=new CustomEvent(zw,wte);if(T.currentTarget.dispatchEvent(A),!A.defaultPrevented){const N=_().filter(z=>z.focusable),L=N.find(z=>z.active),M=N.find(z=>z.id===v),$=[L,M,...N].filter(Boolean).map(z=>z.ref.current);I3($,d)}}k.current=!1}),onBlur:Ve(e.onBlur,()=>w(!1))})})}),P3="RovingFocusGroupItem",O3=p.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:o,...l}=e,c=pr(),u=i||c,d=Ste(P3,n),h=d.currentTabStopId===u,f=E3(n),{onFocusableItemAdd:m,onFocusableItemRemove:g,currentTabStopId:v}=d;return p.useEffect(()=>{if(r)return m(),()=>g()},[r,m,g]),a.jsx(C1.ItemSlot,{scope:n,id:u,focusable:r,active:s,children:a.jsx(ot.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...l,ref:t,onMouseDown:Ve(e.onMouseDown,y=>{r?d.onItemFocus(u):y.preventDefault()}),onFocus:Ve(e.onFocus,()=>d.onItemFocus(u)),onKeyDown:Ve(e.onKeyDown,y=>{if(y.key==="Tab"&&y.shiftKey){d.onItemShiftTab();return}if(y.target!==y.currentTarget)return;const x=Ete(y,d.orientation,d.dir);if(x!==void 0){if(y.metaKey||y.ctrlKey||y.altKey||y.shiftKey)return;y.preventDefault();let b=f().filter(_=>_.focusable).map(_=>_.ref.current);if(x==="last")b.reverse();else if(x==="prev"||x==="next"){x==="prev"&&b.reverse();const _=b.indexOf(y.currentTarget);b=d.loop?Tte(b,_+1):b.slice(_+1)}setTimeout(()=>I3(b))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:v!=null}):o})})});O3.displayName=P3;var Cte={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Ate(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function Ete(e,t,n){const r=Ate(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Cte[r]}function I3(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function Tte(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var R3=T3,M3=O3,Sb="Tabs",[Pte,vUe]=Mr(Sb,[kb]),D3=kb(),[Ote,eC]=Pte(Sb),L3=p.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...u}=e,d=Ih(l),[h,f]=Ha({prop:r,onChange:s,defaultProp:i??"",caller:Sb});return a.jsx(Ote,{scope:n,baseId:pr(),value:h,onValueChange:f,orientation:o,dir:d,activationMode:c,children:a.jsx(ot.div,{dir:d,"data-orientation":o,...u,ref:t})})});L3.displayName=Sb;var $3="TabsList",F3=p.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,i=eC($3,n),o=D3(n);return a.jsx(R3,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:r,children:a.jsx(ot.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});F3.displayName=$3;var U3="TabsTrigger",B3=p.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=e,o=eC(U3,n),l=D3(n),c=q3(o.baseId,r),u=H3(o.baseId,r),d=r===o.value;return a.jsx(M3,{asChild:!0,...l,focusable:!s,active:d,children:a.jsx(ot.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...i,ref:t,onMouseDown:Ve(e.onMouseDown,h=>{!s&&h.button===0&&h.ctrlKey===!1?o.onValueChange(r):h.preventDefault()}),onKeyDown:Ve(e.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(r)}),onFocus:Ve(e.onFocus,()=>{const h=o.activationMode!=="manual";!d&&!s&&h&&o.onValueChange(r)})})})});B3.displayName=U3;var z3="TabsContent",W3=p.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...o}=e,l=eC(z3,n),c=q3(l.baseId,r),u=H3(l.baseId,r),d=r===l.value,h=p.useRef(d);return p.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),a.jsx(Cr,{present:s||d,children:({present:f})=>a.jsx(ot.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:u,tabIndex:0,...o,ref:t,style:{...e.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});W3.displayName=z3;function q3(e,t){return`${e}-trigger-${t}`}function H3(e,t){return`${e}-content-${t}`}var Ite=L3,K3=F3,V3=B3,G3=W3;const Gc=Ite,Fl=p.forwardRef(({className:e,...t},n)=>a.jsx(K3,{ref:n,className:Ie("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));Fl.displayName=K3.displayName;const _r=p.forwardRef(({className:e,...t},n)=>a.jsx(V3,{ref:n,className:Ie("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));_r.displayName=V3.displayName;const ir=p.forwardRef(({className:e,...t},n)=>a.jsx(G3,{ref:n,className:Ie("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));ir.displayName=G3.displayName;const Rte=Ip("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Pm=p.forwardRef(({className:e,variant:t,...n},r)=>a.jsx("div",{ref:r,role:"alert",className:Ie(Rte({variant:t}),e),...n}));Pm.displayName="Alert";const Mte=p.forwardRef(({className:e,...t},n)=>a.jsx("h5",{ref:n,className:Ie("mb-1 font-medium leading-none tracking-tight",e),...t}));Mte.displayName="AlertTitle";const Om=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:Ie("text-sm [&_p]:leading-relaxed",e),...t}));Om.displayName="AlertDescription";function Dte({sitekey:e,onVerify:t,onExpire:n,className:r}){const s=p.useRef(null),i=p.useRef(null);return p.useEffect(()=>(new Promise(l=>{if(window.hcaptcha)return l();const c=document.createElement("script");c.src="https://js.hcaptcha.com/1/api.js",c.async=!0,c.defer=!0,c.onload=()=>l(),document.head.appendChild(c)}).then(()=>{s.current&&i.current===null&&(i.current=window.hcaptcha.render(s.current,{sitekey:e,callback:l=>t(l),"expired-callback":()=>n&&n()}))}),()=>{try{i.current!==null&&window.hcaptcha&&window.hcaptcha.remove(i.current)}catch{}}),[e]),a.jsx("div",{className:r,children:a.jsx("div",{ref:s})})}const Lte="vite_react_shadcn_ts",$te="0.1.98",Fte="module",Ute={predev:"echo skip changelog copy",dev:"vite",prebuild:"echo skip changelog copy",build:"vite build","build:dev":"vite build --mode development",lint:"eslint .",preview:"vite preview",test:"vitest",sync:"node sync/index.js"},Bte={"@hookform/resolvers":"^3.10.0","@radix-ui/react-accordion":"^1.2.11","@radix-ui/react-alert-dialog":"^1.1.14","@radix-ui/react-aspect-ratio":"^1.1.7","@radix-ui/react-avatar":"^1.1.10","@radix-ui/react-checkbox":"^1.3.2","@radix-ui/react-collapsible":"^1.1.11","@radix-ui/react-context-menu":"^2.2.15","@radix-ui/react-dialog":"^1.1.14","@radix-ui/react-dropdown-menu":"^2.1.15","@radix-ui/react-hover-card":"^1.1.14","@radix-ui/react-label":"^2.1.7","@radix-ui/react-menubar":"^1.1.15","@radix-ui/react-navigation-menu":"^1.2.13","@radix-ui/react-popover":"^1.1.14","@radix-ui/react-progress":"^1.1.7","@radix-ui/react-radio-group":"^1.3.7","@radix-ui/react-scroll-area":"^1.2.9","@radix-ui/react-select":"^2.2.5","@radix-ui/react-separator":"^1.1.7","@radix-ui/react-slider":"^1.3.5","@radix-ui/react-slot":"^1.2.3","@radix-ui/react-switch":"^1.2.5","@radix-ui/react-tabs":"^1.1.12","@radix-ui/react-toast":"^1.2.14","@radix-ui/react-toggle":"^1.1.9","@radix-ui/react-toggle-group":"^1.1.10","@radix-ui/react-tooltip":"^1.2.7","@supabase/supabase-js":"^2.55.0","@tanstack/react-query":"^5.83.0","class-variance-authority":"^0.7.1",clsx:"^2.1.1",cmdk:"^1.1.1","date-fns":"^3.6.0",dotenv:"^16.4.5","embla-carousel-react":"^8.6.0","input-otp":"^1.4.2","lucide-react":"^0.462.0","next-themes":"^0.3.0",react:"^18.3.1","react-day-picker":"^8.10.1","react-dom":"^18.3.1","react-hook-form":"^7.61.1","react-markdown":"^9.1.0","react-resizable-panels":"^2.1.9","react-router-dom":"^6.30.1",recharts:"^2.15.4","remark-breaks":"^4.0.0","remark-gfm":"^4.0.1",sonner:"^1.7.4","tailwind-merge":"^2.6.0","tailwindcss-animate":"^1.0.7",vaul:"^0.9.9",ws:"^8.18.0",zod:"^3.25.76"},zte={"@eslint/js":"^9.32.0","@tailwindcss/typography":"^0.5.16","@types/node":"^22.16.5","@types/react":"^18.3.23","@types/react-dom":"^18.3.7","@vitejs/plugin-react-swc":"^3.11.0",autoprefixer:"^10.4.21",eslint:"^9.32.0","eslint-plugin-react-hooks":"^5.2.0","eslint-plugin-react-refresh":"^0.4.20",globals:"^15.15.0",postcss:"^8.5.6",tailwindcss:"^3.4.17",typescript:"^5.8.3","typescript-eslint":"^8.38.0",vite:"^5.4.19",vitest:"^1.6.0"},Ww={name:Lte,private:!0,version:$te,type:Fte,scripts:Ute,dependencies:Bte,devDependencies:zte},Y3=e=>e.replace(/\s/g,""),e2=e=>Y3(e).toLowerCase();function Wte({onBack:e}){const t=Va(),[n,r]=p.useState("login"),[s,i]=p.useState(!1),[o,l]=p.useState(!1),[c,u]=p.useState(null),[d,h]=p.useState(null),[f,m]=p.useState(null),[g,v]=p.useState(null),y="30583a2e-84ac-496a-8ec2-23043ae06dc0",x=!!y,w=()=>{var A,N;try{(N=(A=window==null?void 0:window.hcaptcha)==null?void 0:A.reset)==null||N.call(A)}catch{}},[b,_]=p.useState(""),[k,j]=p.useState("");p.useState(""),p.useState("");const S=async A=>{var N;if(A.preventDefault(),i(!0),u(null),v(null),!f){v("Please complete the CAPTCHA"),i(!1);return}try{const{data:L,error:M}=await le.auth.signInWithPassword({email:b,password:k,...x&&f?{options:{captchaToken:f}}:{}});if(M)throw M;const B=(N=L.user)==null?void 0:N.id;if(B)try{const{data:$,error:z}=await le.from("users_profile").select("is_active, is_2fa_email_enabled").eq("user_id",B).maybeSingle();if(z)throw console.error("Profile fetch error:",z),z;if(!$){await le.auth.signOut(),u("Your account profile is missing. Please contact your Master Agent."),i(!1);return}if($.is_active===!1){t("/account-deactivated",{replace:!0});return}const R=($==null?void 0:$.is_2fa_email_enabled)===!0;ze.success("Login successful!"),t("/",{replace:!0});return}catch($){console.warn("Profile fetch failed:",$),ze.success("Login successful!")}else ze.success("Login successful!");t("/",{replace:!0})}catch(L){console.error("Login error:",L),u(L instanceof Error?L.message:"Failed to login"),ze.error("Login failed"),w()}finally{i(!1)}},T=async A=>{A.preventDefault(),i(!0),u(null);try{const{error:N}=await le.auth.resetPasswordForEmail(b,{redirectTo:`${window.location.origin}/reset-password`});if(N)throw N;h("Password reset email sent! Please check your inbox."),ze.success("Password reset email sent!")}catch(N){console.error("Password reset error:",N),u(N instanceof Error?N.message:"Failed to send reset email"),ze.error("Failed to send reset email")}finally{i(!1)}},O=()=>{u(null),h(null)};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-slate-950 dark:to-slate-900 p-4",children:a.jsxs(He,{className:"w-full max-w-md",children:[a.jsxs(dt,{className:"space-y-1",children:[e&&a.jsxs(se,{variant:"ghost",size:"sm",onClick:e,className:"absolute top-4 left-4",children:[a.jsx(Rp,{className:"w-4 h-4 mr-2"}),"Back"]}),a.jsxs("div",{className:"text-center",children:[a.jsx(ct,{className:"text-2xl font-bold",children:"Welcome back"}),a.jsx(Ts,{children:"Sign in to continue to Chatflow"})]})]}),a.jsx(lt,{children:a.jsxs(Gc,{value:n,onValueChange:A=>{r(A),O()},children:[a.jsxs(Fl,{className:"grid w-full grid-cols-2",children:[a.jsx(_r,{value:"login",children:"Login"}),a.jsx(_r,{value:"reset",children:"Reset"})]}),c&&a.jsx(Pm,{className:"mt-4 border-red-200 bg-red-50",children:a.jsx(Om,{className:"text-red-800",children:c})}),d&&a.jsx(Pm,{className:"mt-4 border-green-200 bg-green-50",children:a.jsx(Om,{className:"text-green-800",children:d})}),a.jsx(ir,{value:"login",className:"space-y-4 mt-4",children:a.jsxs("form",{onSubmit:S,className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{htmlFor:"login-email",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(vy,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(it,{id:"login-email",type:"email",placeholder:"Enter your email",value:b,onChange:A=>_(e2(A.target.value)),onKeyDown:A=>{A.key===" "&&A.preventDefault()},className:"pl-10",required:!0})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{htmlFor:"login-password",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(xm,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(it,{id:"login-password",type:o?"text":"password",placeholder:"Enter your password",value:k,onChange:A=>j(Y3(A.target.value)),onKeyDown:A=>{A.key===" "&&A.preventDefault()},className:"pl-10 pr-10",required:!0}),a.jsx(se,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>l(!o),children:o?a.jsx(I4,{className:"h-4 w-4"}):a.jsx(CN,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx(Dte,{sitekey:y,onVerify:A=>m(A),onExpire:()=>{m(null)}}),g&&a.jsx("p",{className:"text-xs text-red-600 mt-1",children:g})]}),a.jsx(se,{type:"submit",className:"w-full",disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx(Ht,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign In"}),a.jsx("p",{className:"text-xs text-muted-foreground text-center mt-2",children:a.jsxs(TQ,{to:"/changelog",className:"hover:underline",children:["v",Ww==null?void 0:Ww.version]})})]})}),a.jsx(ir,{value:"reset",className:"space-y-4 mt-4",children:a.jsxs("form",{onSubmit:T,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{htmlFor:"reset-email",children:"Email"}),a.jsxs("div",{className:"relative",children:[a.jsx(vy,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(it,{id:"reset-email",type:"email",placeholder:"Enter your email",value:b,onChange:A=>_(e2(A.target.value)),onKeyDown:A=>{A.key===" "&&A.preventDefault()},className:"pl-10",required:!0})]})]}),a.jsx(se,{type:"submit",className:"w-full",disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx(Ht,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending reset email..."]}):"Send Reset Email"})]})})]})})]})})}function qg({children:e}){const{user:t,loading:n,otpRequired:r,otpVerified:s,otpEvaluated:i}=Ar(),o=Va(),l=$o();if(p.useEffect(()=>{var u;if(!n&&i&&t){const d=l.pathname==="/otp",h=l.pathname==="/reset-password",f=l.pathname==="/invite";let m=!1;try{const g=new URL(window.location.href),v=g.searchParams.get("type"),y=g.searchParams.get("code"),x=window.location.hash||"";m=v==="invite"||y&&!x.includes("access_token=")||x.includes("type=invite")||window.location.pathname==="/invite"}catch{}if(t&&(async()=>{try{const{data:g}=await le.from("users_profile").select("password_set").eq("user_id",t.id).single();if(g&&g.password_set===!1){setTimeout(()=>o("/reset-password",{replace:!0}),0);return}}catch{}})(),m&&!h&&!f){setTimeout(()=>o("/reset-password",{replace:!0}),0);return}if(r&&!s&&!d){let g="2fa";try{new URL(window.location.href).searchParams.get("type")==="recovery"&&(g="recovery"),(u=window.location.hash)!=null&&u.includes("access_token=")&&(g="recovery"),localStorage.getItem("auth.intent")==="recovery"&&(g="recovery")}catch{}setTimeout(()=>o("/otp",{replace:!0,state:{from:l.pathname,intent:g}}),0)}}},[t,n,i,r,s,l.pathname,o]),n)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),a.jsx("span",{children:"Loading..."})]})});if(!t)return a.jsx(Wte,{});const c=l.pathname==="/otp";return t&&r&&!s&&!c?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary"}),a.jsx("span",{children:"Redirecting"})]})}):a.jsx(a.Fragment,{children:e})}function qte(){const{user:e}=Ar(),{hasRole:t}=Nr(),n=$o(),r=Va(),s=p.useRef(null),i=p.useRef(0),o=1e3,l="/tones/mixkit-message-pop-alert-2354.mp3";return p.useEffect(()=>{if(!e)return;s.current||(s.current=new Audio(l),s.current.volume=.5);const c=()=>{var h;if(localStorage.getItem("audioNotifications")==="false")return;const d=Date.now();d-i.current<o||(i.current=d,(h=s.current)==null||h.play().catch(f=>console.error("Audio play failed:",f)))},u=Wr.channel("global-messages-listener").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:"direction=eq.in"},async d=>{var f;const h=d.new;if(h.role==="user")try{const m=t("superadmin"),{data:g,error:v}=await Wr.from("threads").select(`
                                assignee_user_id,
                                collaborator_user_id,
                                contacts (
                                    name
                                )
                            `).eq("id",h.thread_id).single();if(v||!g)return;const y=g.assignee_user_id===e.id,x=g.collaborator_user_id===e.id,w=((f=g.contacts)==null?void 0:f.name)||"Unknown User";(m||y||x)&&c();const b=new URLSearchParams(n.search),_=b.get("thread"),k=b.get("menu"),j=!k||k==="chat";if((n.pathname.startsWith("/chat")||n.pathname==="/")&&j&&(_===h.thread_id||n.pathname.includes(h.thread_id)))return;(y||x)&&ze.info(`New message from ${w}`,{description:h.body?h.body.length>50?h.body.substring(0,50)+"...":h.body:"Sent an attachment",duration:4e3,action:{label:"View",onClick:()=>{r(`/?menu=chat&thread=${h.thread_id}`)}}})}catch(m){console.error("[GlobalMessageListener] Error processing message:",m)}}).subscribe();return()=>{Wr.removeChannel(u)}},[e,t,n]),null}const Hte=Ip("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:opacity-90",secondary:"border-transparent bg-secondary text-secondary-foreground hover:opacity-90",destructive:"border-transparent bg-destructive text-destructive-foreground hover:opacity-90",outline:"text-foreground hover:opacity-90"}},defaultVariants:{variant:"default"}}),At=p.forwardRef(({className:e,variant:t,...n},r)=>a.jsx("div",{ref:r,className:Ie(Hte({variant:t}),e),...n}));At.displayName="Badge";var Kte="Separator",t2="horizontal",Vte=["horizontal","vertical"],X3=p.forwardRef((e,t)=>{const{decorative:n,orientation:r=t2,...s}=e,i=Gte(r)?r:t2,l=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return a.jsx(ot.div,{"data-orientation":i,...l,...s,ref:t})});X3.displayName=Kte;function Gte(e){return Vte.includes(e)}var J3=X3;const Kd=p.forwardRef(({className:e,orientation:t="horizontal",decorative:n=!0,...r},s)=>a.jsx(J3,{ref:s,decorative:n,orientation:t,className:Ie("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...r}));Kd.displayName=J3.displayName;var qw=0;function Nb(){p.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??n2()),document.body.insertAdjacentElement("beforeend",e[1]??n2()),qw++,()=>{qw===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),qw--}},[])}function n2(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var Hw="focusScope.autoFocusOnMount",Kw="focusScope.autoFocusOnUnmount",r2={bubbles:!1,cancelable:!0},Yte="FocusScope",zp=p.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=e,[l,c]=p.useState(null),u=ar(s),d=ar(i),h=p.useRef(null),f=Ot(t,v=>c(v)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let v=function(b){if(m.paused||!l)return;const _=b.target;l.contains(_)?h.current=_:rl(h.current,{select:!0})},y=function(b){if(m.paused||!l)return;const _=b.relatedTarget;_!==null&&(l.contains(_)||rl(h.current,{select:!0}))},x=function(b){if(document.activeElement===document.body)for(const k of b)k.removedNodes.length>0&&rl(l)};document.addEventListener("focusin",v),document.addEventListener("focusout",y);const w=new MutationObserver(x);return l&&w.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",v),document.removeEventListener("focusout",y),w.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){s2.add(m);const v=document.activeElement;if(!l.contains(v)){const x=new CustomEvent(Hw,r2);l.addEventListener(Hw,u),l.dispatchEvent(x),x.defaultPrevented||(Xte(tne(Q3(l)),{select:!0}),document.activeElement===v&&rl(l))}return()=>{l.removeEventListener(Hw,u),setTimeout(()=>{const x=new CustomEvent(Kw,r2);l.addEventListener(Kw,d),l.dispatchEvent(x),x.defaultPrevented||rl(v??document.body,{select:!0}),l.removeEventListener(Kw,d),s2.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(v=>{if(!n&&!r||m.paused)return;const y=v.key==="Tab"&&!v.altKey&&!v.ctrlKey&&!v.metaKey,x=document.activeElement;if(y&&x){const w=v.currentTarget,[b,_]=Jte(w);b&&_?!v.shiftKey&&x===_?(v.preventDefault(),n&&rl(b,{select:!0})):v.shiftKey&&x===b&&(v.preventDefault(),n&&rl(_,{select:!0})):x===w&&v.preventDefault()}},[n,r,m.paused]);return a.jsx(ot.div,{tabIndex:-1,...o,ref:f,onKeyDown:g})});zp.displayName=Yte;function Xte(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(rl(r,{select:t}),document.activeElement!==n)return}function Jte(e){const t=Q3(e),n=a2(t,e),r=a2(t.reverse(),e);return[n,r]}function Q3(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function a2(e,t){for(const n of e)if(!Qte(n,{upTo:t}))return n}function Qte(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Zte(e){return e instanceof HTMLInputElement&&"select"in e}function rl(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Zte(e)&&t&&e.select()}}var s2=ene();function ene(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=i2(e,t),e.unshift(t)},remove(t){var n;e=i2(e,t),(n=e[0])==null||n.resume()}}}function i2(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function tne(e){return e.filter(t=>t.tagName!=="A")}var nne=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},Tu=new WeakMap,Hg=new WeakMap,Kg={},Vw=0,Z3=function(e){return e&&(e.host||Z3(e.parentNode))},rne=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=Z3(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},ane=function(e,t,n,r){var s=rne(t,Array.isArray(e)?e:[e]);Kg[n]||(Kg[n]=new WeakMap);var i=Kg[n],o=[],l=new Set,c=new Set(s),u=function(h){!h||l.has(h)||(l.add(h),u(h.parentNode))};s.forEach(u);var d=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(f){if(l.has(f))d(f);else try{var m=f.getAttribute(r),g=m!==null&&m!=="false",v=(Tu.get(f)||0)+1,y=(i.get(f)||0)+1;Tu.set(f,v),i.set(f,y),o.push(f),v===1&&g&&Hg.set(f,!0),y===1&&f.setAttribute(n,"true"),g||f.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",f,x)}})};return d(t),l.clear(),Vw++,function(){o.forEach(function(h){var f=Tu.get(h)-1,m=i.get(h)-1;Tu.set(h,f),i.set(h,m),f||(Hg.has(h)||h.removeAttribute(r),Hg.delete(h)),m||h.removeAttribute(n)}),Vw--,Vw||(Tu=new WeakMap,Tu=new WeakMap,Hg=new WeakMap,Kg={})}},Cb=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=nne(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),ane(r,s,n,"aria-hidden")):function(){return null}},Ai=function(){return Ai=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Ai.apply(this,arguments)};function e5(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function sne(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var Lv="right-scroll-bar-position",$v="width-before-scroll-bar",ine="with-scroll-bars-hidden",one="--removed-body-scroll-bar-size";function Gw(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function lne(e,t){var n=p.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=t,n.facade}var cne=typeof window<"u"?p.useLayoutEffect:p.useEffect,o2=new WeakMap;function une(e,t){var n=lne(null,function(r){return e.forEach(function(s){return Gw(s,r)})});return cne(function(){var r=o2.get(n);if(r){var s=new Set(r),i=new Set(e),o=n.current;s.forEach(function(l){i.has(l)||Gw(l,null)}),i.forEach(function(l){s.has(l)||Gw(l,o)})}o2.set(n,e)},[e]),n}function dne(e){return e}function hne(e,t){t===void 0&&(t=dne);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var o=t(i,r);return n.push(o),function(){n=n.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(l){return i(l)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var l=n;n=[],l.forEach(i),o=n}var c=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),n={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),n}}}};return s}function fne(e){e===void 0&&(e={});var t=hne(null);return t.options=Ai({async:!0,ssr:!1},e),t}var t5=function(e){var t=e.sideCar,n=e5(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return p.createElement(r,Ai({},n))};t5.isSideCarExport=!0;function mne(e,t){return e.useMedium(t),t5}var n5=fne(),Yw=function(){},Ab=p.forwardRef(function(e,t){var n=p.useRef(null),r=p.useState({onScrollCapture:Yw,onWheelCapture:Yw,onTouchMoveCapture:Yw}),s=r[0],i=r[1],o=e.forwardProps,l=e.children,c=e.className,u=e.removeScrollBar,d=e.enabled,h=e.shards,f=e.sideCar,m=e.noRelative,g=e.noIsolation,v=e.inert,y=e.allowPinchZoom,x=e.as,w=x===void 0?"div":x,b=e.gapMode,_=e5(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=f,j=une([n,t]),S=Ai(Ai({},_),s);return p.createElement(p.Fragment,null,d&&p.createElement(k,{sideCar:n5,removeScrollBar:u,shards:h,noRelative:m,noIsolation:g,inert:v,setCallbacks:i,allowPinchZoom:!!y,lockRef:n,gapMode:b}),o?p.cloneElement(p.Children.only(l),Ai(Ai({},S),{ref:j})):p.createElement(w,Ai({},S,{className:c,ref:j}),l))});Ab.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Ab.classNames={fullWidth:$v,zeroRight:Lv};var pne=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function gne(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=pne();return t&&e.setAttribute("nonce",t),e}function vne(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function yne(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var xne=function(){var e=0,t=null;return{add:function(n){e==0&&(t=gne())&&(vne(t,n),yne(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},bne=function(){var e=xne();return function(t,n){p.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},r5=function(){var e=bne(),t=function(n){var r=n.styles,s=n.dynamic;return e(r,s),null};return t},wne={left:0,top:0,right:0,gap:0},Xw=function(e){return parseInt(e||"",10)||0},jne=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[Xw(n),Xw(r),Xw(s)]},_ne=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return wne;var t=jne(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},kne=r5(),xd="data-scroll-locked",Sne=function(e,t,n,r){var s=e.left,i=e.top,o=e.right,l=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(ine,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(xd,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Lv,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat($v,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Lv," .").concat(Lv,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat($v," .").concat($v,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(xd,`] {
    `).concat(one,": ").concat(l,`px;
  }
`)},l2=function(){var e=parseInt(document.body.getAttribute(xd)||"0",10);return isFinite(e)?e:0},Nne=function(){p.useEffect(function(){return document.body.setAttribute(xd,(l2()+1).toString()),function(){var e=l2()-1;e<=0?document.body.removeAttribute(xd):document.body.setAttribute(xd,e.toString())}},[])},Cne=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=r===void 0?"margin":r;Nne();var i=p.useMemo(function(){return _ne(s)},[s]);return p.createElement(kne,{styles:Sne(i,!t,s,n?"":"!important")})},A1=!1;if(typeof window<"u")try{var Vg=Object.defineProperty({},"passive",{get:function(){return A1=!0,!0}});window.addEventListener("test",Vg,Vg),window.removeEventListener("test",Vg,Vg)}catch{A1=!1}var Pu=A1?{passive:!1}:!1,Ane=function(e){return e.tagName==="TEXTAREA"},a5=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!Ane(e)&&n[t]==="visible")},Ene=function(e){return a5(e,"overflowY")},Tne=function(e){return a5(e,"overflowX")},c2=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=s5(e,r);if(s){var i=i5(e,r),o=i[1],l=i[2];if(o>l)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Pne=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},One=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},s5=function(e,t){return e==="v"?Ene(t):Tne(t)},i5=function(e,t){return e==="v"?Pne(t):One(t)},Ine=function(e,t){return e==="h"&&t==="rtl"?-1:1},Rne=function(e,t,n,r,s){var i=Ine(e,window.getComputedStyle(t).direction),o=i*r,l=n.target,c=t.contains(l),u=!1,d=o>0,h=0,f=0;do{if(!l)break;var m=i5(e,l),g=m[0],v=m[1],y=m[2],x=v-y-i*g;(g||x)&&s5(e,l)&&(h+=x,f+=g);var w=l.parentNode;l=w&&w.nodeType===Node.DOCUMENT_FRAGMENT_NODE?w.host:w}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(d&&(Math.abs(h)<1||!s)||!d&&(Math.abs(f)<1||!s))&&(u=!0),u},Gg=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},u2=function(e){return[e.deltaX,e.deltaY]},d2=function(e){return e&&"current"in e?e.current:e},Mne=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Dne=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Lne=0,Ou=[];function $ne(e){var t=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(Lne++)[0],i=p.useState(r5)[0],o=p.useRef(e);p.useEffect(function(){o.current=e},[e]),p.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var v=sne([e.lockRef.current],(e.shards||[]).map(d2),!0).filter(Boolean);return v.forEach(function(y){return y.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),v.forEach(function(y){return y.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var l=p.useCallback(function(v,y){if("touches"in v&&v.touches.length===2||v.type==="wheel"&&v.ctrlKey)return!o.current.allowPinchZoom;var x=Gg(v),w=n.current,b="deltaX"in v?v.deltaX:w[0]-x[0],_="deltaY"in v?v.deltaY:w[1]-x[1],k,j=v.target,S=Math.abs(b)>Math.abs(_)?"h":"v";if("touches"in v&&S==="h"&&j.type==="range")return!1;var T=c2(S,j);if(!T)return!0;if(T?k=S:(k=S==="v"?"h":"v",T=c2(S,j)),!T)return!1;if(!r.current&&"changedTouches"in v&&(b||_)&&(r.current=k),!k)return!0;var O=r.current||k;return Rne(O,y,v,O==="h"?b:_,!0)},[]),c=p.useCallback(function(v){var y=v;if(!(!Ou.length||Ou[Ou.length-1]!==i)){var x="deltaY"in y?u2(y):Gg(y),w=t.current.filter(function(k){return k.name===y.type&&(k.target===y.target||y.target===k.shadowParent)&&Mne(k.delta,x)})[0];if(w&&w.should){y.cancelable&&y.preventDefault();return}if(!w){var b=(o.current.shards||[]).map(d2).filter(Boolean).filter(function(k){return k.contains(y.target)}),_=b.length>0?l(y,b[0]):!o.current.noIsolation;_&&y.cancelable&&y.preventDefault()}}},[]),u=p.useCallback(function(v,y,x,w){var b={name:v,delta:y,target:x,should:w,shadowParent:Fne(x)};t.current.push(b),setTimeout(function(){t.current=t.current.filter(function(_){return _!==b})},1)},[]),d=p.useCallback(function(v){n.current=Gg(v),r.current=void 0},[]),h=p.useCallback(function(v){u(v.type,u2(v),v.target,l(v,e.lockRef.current))},[]),f=p.useCallback(function(v){u(v.type,Gg(v),v.target,l(v,e.lockRef.current))},[]);p.useEffect(function(){return Ou.push(i),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Pu),document.addEventListener("touchmove",c,Pu),document.addEventListener("touchstart",d,Pu),function(){Ou=Ou.filter(function(v){return v!==i}),document.removeEventListener("wheel",c,Pu),document.removeEventListener("touchmove",c,Pu),document.removeEventListener("touchstart",d,Pu)}},[]);var m=e.removeScrollBar,g=e.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:Dne(s)}):null,m?p.createElement(Cne,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function Fne(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const Une=mne(n5,$ne);var Wp=p.forwardRef(function(e,t){return p.createElement(Ab,Ai({},e,{ref:t,sideCar:Une}))});Wp.classNames=Ab.classNames;var E1=["Enter"," "],Bne=["ArrowDown","PageUp","Home"],o5=["ArrowUp","PageDown","End"],zne=[...Bne,...o5],Wne={ltr:[...E1,"ArrowRight"],rtl:[...E1,"ArrowLeft"]},qne={ltr:["ArrowLeft"],rtl:["ArrowRight"]},qp="Menu",[Im,Hne,Kne]=Pp(qp),[pu,l5]=Mr(qp,[Kne,Kl,kb]),Eb=Kl(),c5=kb(),[Vne,gu]=pu(qp),[Gne,Hp]=pu(qp),u5=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:s,onOpenChange:i,modal:o=!0}=e,l=Eb(t),[c,u]=p.useState(null),d=p.useRef(!1),h=ar(i),f=Ih(s);return p.useEffect(()=>{const m=()=>{d.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>d.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),a.jsx(lb,{...l,children:a.jsx(Vne,{scope:t,open:n,onOpenChange:h,content:c,onContentChange:u,children:a.jsx(Gne,{scope:t,onClose:p.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:o,children:r})})})};u5.displayName=qp;var Yne="MenuAnchor",tC=p.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=Eb(n);return a.jsx(Lp,{...s,...r,ref:t})});tC.displayName=Yne;var nC="MenuPortal",[Xne,d5]=pu(nC,{forceMount:void 0}),h5=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:s}=e,i=gu(nC,t);return a.jsx(Xne,{scope:t,forceMount:n,children:a.jsx(Cr,{present:n||i.open,children:a.jsx(Sh,{asChild:!0,container:s,children:r})})})};h5.displayName=nC;var Ps="MenuContent",[Jne,rC]=pu(Ps),f5=p.forwardRef((e,t)=>{const n=d5(Ps,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=gu(Ps,e.__scopeMenu),o=Hp(Ps,e.__scopeMenu);return a.jsx(Im.Provider,{scope:e.__scopeMenu,children:a.jsx(Cr,{present:r||i.open,children:a.jsx(Im.Slot,{scope:e.__scopeMenu,children:o.modal?a.jsx(Qne,{...s,ref:t}):a.jsx(Zne,{...s,ref:t})})})})}),Qne=p.forwardRef((e,t)=>{const n=gu(Ps,e.__scopeMenu),r=p.useRef(null),s=Ot(t,r);return p.useEffect(()=>{const i=r.current;if(i)return Cb(i)},[]),a.jsx(aC,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Ve(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Zne=p.forwardRef((e,t)=>{const n=gu(Ps,e.__scopeMenu);return a.jsx(aC,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),ere=Dl("MenuContent.ScrollLock"),aC=p.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,disableOutsideScroll:g,...v}=e,y=gu(Ps,n),x=Hp(Ps,n),w=Eb(n),b=c5(n),_=Hne(n),[k,j]=p.useState(null),S=p.useRef(null),T=Ot(t,S,y.onContentChange),O=p.useRef(0),A=p.useRef(""),N=p.useRef(0),L=p.useRef(null),M=p.useRef("right"),B=p.useRef(0),$=g?Wp:p.Fragment,z=g?{as:ere,allowPinchZoom:!0}:void 0,R=D=>{var K,ie;const E=A.current+D,F=_().filter(H=>!H.disabled),I=document.activeElement,P=(K=F.find(H=>H.ref.current===I))==null?void 0:K.textValue,U=F.map(H=>H.textValue),Z=hre(U,E,P),X=(ie=F.find(H=>H.textValue===Z))==null?void 0:ie.ref.current;(function H(he){A.current=he,window.clearTimeout(O.current),he!==""&&(O.current=window.setTimeout(()=>H(""),1e3))})(E),X&&setTimeout(()=>X.focus())};p.useEffect(()=>()=>window.clearTimeout(O.current),[]),Nb();const C=p.useCallback(D=>{var F,I;return M.current===((F=L.current)==null?void 0:F.side)&&mre(D,(I=L.current)==null?void 0:I.area)},[]);return a.jsx(Jne,{scope:n,searchRef:A,onItemEnter:p.useCallback(D=>{C(D)&&D.preventDefault()},[C]),onItemLeave:p.useCallback(D=>{var E;C(D)||((E=S.current)==null||E.focus(),j(null))},[C]),onTriggerLeave:p.useCallback(D=>{C(D)&&D.preventDefault()},[C]),pointerGraceTimerRef:N,onPointerGraceIntentChange:p.useCallback(D=>{L.current=D},[]),children:a.jsx($,{...z,children:a.jsx(zp,{asChild:!0,trapped:s,onMountAutoFocus:Ve(i,D=>{var E;D.preventDefault(),(E=S.current)==null||E.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:a.jsx(du,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,children:a.jsx(R3,{asChild:!0,...b,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:k,onCurrentTabStopIdChange:j,onEntryFocus:Ve(c,D=>{x.isUsingKeyboardRef.current||D.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(cb,{role:"menu","aria-orientation":"vertical","data-state":E5(y.open),"data-radix-menu-content":"",dir:x.dir,...w,...v,ref:T,style:{outline:"none",...v.style},onKeyDown:Ve(v.onKeyDown,D=>{const F=D.target.closest("[data-radix-menu-content]")===D.currentTarget,I=D.ctrlKey||D.altKey||D.metaKey,P=D.key.length===1;F&&(D.key==="Tab"&&D.preventDefault(),!I&&P&&R(D.key));const U=S.current;if(D.target!==U||!zne.includes(D.key))return;D.preventDefault();const X=_().filter(K=>!K.disabled).map(K=>K.ref.current);o5.includes(D.key)&&X.reverse(),ure(X)}),onBlur:Ve(e.onBlur,D=>{D.currentTarget.contains(D.target)||(window.clearTimeout(O.current),A.current="")}),onPointerMove:Ve(e.onPointerMove,Rm(D=>{const E=D.target,F=B.current!==D.clientX;if(D.currentTarget.contains(E)&&F){const I=D.clientX>B.current?"right":"left";M.current=I,B.current=D.clientX}}))})})})})})})});f5.displayName=Ps;var tre="MenuGroup",sC=p.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return a.jsx(ot.div,{role:"group",...r,ref:t})});sC.displayName=tre;var nre="MenuLabel",m5=p.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return a.jsx(ot.div,{...r,ref:t})});m5.displayName=nre;var Ay="MenuItem",h2="menu.itemSelect",Tb=p.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...s}=e,i=p.useRef(null),o=Hp(Ay,e.__scopeMenu),l=rC(Ay,e.__scopeMenu),c=Ot(t,i),u=p.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(h2,{bubbles:!0,cancelable:!0});h.addEventListener(h2,m=>r==null?void 0:r(m),{once:!0}),wN(h,f),f.defaultPrevented?u.current=!1:o.onClose()}};return a.jsx(p5,{...s,ref:c,disabled:n,onClick:Ve(e.onClick,d),onPointerDown:h=>{var f;(f=e.onPointerDown)==null||f.call(e,h),u.current=!0},onPointerUp:Ve(e.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:Ve(e.onKeyDown,h=>{const f=l.searchRef.current!=="";n||f&&h.key===" "||E1.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});Tb.displayName=Ay;var p5=p.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=e,o=rC(Ay,n),l=c5(n),c=p.useRef(null),u=Ot(t,c),[d,h]=p.useState(!1),[f,m]=p.useState("");return p.useEffect(()=>{const g=c.current;g&&m((g.textContent??"").trim())},[i.children]),a.jsx(Im.ItemSlot,{scope:n,disabled:r,textValue:s??f,children:a.jsx(M3,{asChild:!0,...l,focusable:!r,children:a.jsx(ot.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:u,onPointerMove:Ve(e.onPointerMove,Rm(g=>{r?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Ve(e.onPointerLeave,Rm(g=>o.onItemLeave(g))),onFocus:Ve(e.onFocus,()=>h(!0)),onBlur:Ve(e.onBlur,()=>h(!1))})})})}),rre="MenuCheckboxItem",g5=p.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...s}=e;return a.jsx(w5,{scope:e.__scopeMenu,checked:n,children:a.jsx(Tb,{role:"menuitemcheckbox","aria-checked":Ey(n)?"mixed":n,...s,ref:t,"data-state":oC(n),onSelect:Ve(s.onSelect,()=>r==null?void 0:r(Ey(n)?!0:!n),{checkForDefaultPrevented:!1})})})});g5.displayName=rre;var v5="MenuRadioGroup",[are,sre]=pu(v5,{value:void 0,onValueChange:()=>{}}),y5=p.forwardRef((e,t)=>{const{value:n,onValueChange:r,...s}=e,i=ar(r);return a.jsx(are,{scope:e.__scopeMenu,value:n,onValueChange:i,children:a.jsx(sC,{...s,ref:t})})});y5.displayName=v5;var x5="MenuRadioItem",b5=p.forwardRef((e,t)=>{const{value:n,...r}=e,s=sre(x5,e.__scopeMenu),i=n===s.value;return a.jsx(w5,{scope:e.__scopeMenu,checked:i,children:a.jsx(Tb,{role:"menuitemradio","aria-checked":i,...r,ref:t,"data-state":oC(i),onSelect:Ve(r.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,n)},{checkForDefaultPrevented:!1})})})});b5.displayName=x5;var iC="MenuItemIndicator",[w5,ire]=pu(iC,{checked:!1}),j5=p.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...s}=e,i=ire(iC,n);return a.jsx(Cr,{present:r||Ey(i.checked)||i.checked===!0,children:a.jsx(ot.span,{...s,ref:t,"data-state":oC(i.checked)})})});j5.displayName=iC;var ore="MenuSeparator",_5=p.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return a.jsx(ot.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});_5.displayName=ore;var lre="MenuArrow",k5=p.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=Eb(n);return a.jsx(ub,{...s,...r,ref:t})});k5.displayName=lre;var cre="MenuSub",[yUe,S5]=pu(cre),Pf="MenuSubTrigger",N5=p.forwardRef((e,t)=>{const n=gu(Pf,e.__scopeMenu),r=Hp(Pf,e.__scopeMenu),s=S5(Pf,e.__scopeMenu),i=rC(Pf,e.__scopeMenu),o=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,u={__scopeMenu:e.__scopeMenu},d=p.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return p.useEffect(()=>d,[d]),p.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),a.jsx(tC,{asChild:!0,...u,children:a.jsx(p5,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":E5(n.open),...e,ref:Eo(t,s.onTriggerChange),onClick:h=>{var f;(f=e.onClick)==null||f.call(e,h),!(e.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Ve(e.onPointerMove,Rm(h=>{i.onItemEnter(h),!h.defaultPrevented&&!e.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:Ve(e.onPointerLeave,Rm(h=>{var m,g;d();const f=(m=n.content)==null?void 0:m.getBoundingClientRect();if(f){const v=(g=n.content)==null?void 0:g.dataset.side,y=v==="right",x=y?-5:5,w=f[y?"left":"right"],b=f[y?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+x,y:h.clientY},{x:w,y:f.top},{x:b,y:f.top},{x:b,y:f.bottom},{x:w,y:f.bottom}],side:v}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Ve(e.onKeyDown,h=>{var m;const f=i.searchRef.current!=="";e.disabled||f&&h.key===" "||Wne[r.dir].includes(h.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),h.preventDefault())})})})});N5.displayName=Pf;var C5="MenuSubContent",A5=p.forwardRef((e,t)=>{const n=d5(Ps,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=gu(Ps,e.__scopeMenu),o=Hp(Ps,e.__scopeMenu),l=S5(C5,e.__scopeMenu),c=p.useRef(null),u=Ot(t,c);return a.jsx(Im.Provider,{scope:e.__scopeMenu,children:a.jsx(Cr,{present:r||i.open,children:a.jsx(Im.Slot,{scope:e.__scopeMenu,children:a.jsx(aC,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:Ve(e.onFocusOutside,d=>{d.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Ve(e.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:Ve(e.onKeyDown,d=>{var m;const h=d.currentTarget.contains(d.target),f=qne[o.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(m=l.trigger)==null||m.focus(),d.preventDefault())})})})})})});A5.displayName=C5;function E5(e){return e?"open":"closed"}function Ey(e){return e==="indeterminate"}function oC(e){return Ey(e)?"indeterminate":e?"checked":"unchecked"}function ure(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function dre(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function hre(e,t,n){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let o=dre(e,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function fre(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,o=t.length-1;i<t.length;o=i++){const l=t[i],c=t[o],u=l.x,d=l.y,h=c.x,f=c.y;d>r!=f>r&&n<(h-u)*(r-d)/(f-d)+u&&(s=!s)}return s}function mre(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return fre(n,t)}function Rm(e){return t=>t.pointerType==="mouse"?e(t):void 0}var pre=u5,gre=tC,vre=h5,yre=f5,xre=sC,bre=m5,wre=Tb,jre=g5,_re=y5,kre=b5,Sre=j5,Nre=_5,Cre=k5,Are=N5,Ere=A5,Pb="DropdownMenu",[Tre,xUe]=Mr(Pb,[l5]),Na=l5(),[Pre,T5]=Tre(Pb),P5=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:o,modal:l=!0}=e,c=Na(t),u=p.useRef(null),[d,h]=Ha({prop:s,defaultProp:i??!1,onChange:o,caller:Pb});return a.jsx(Pre,{scope:t,triggerId:pr(),triggerRef:u,contentId:pr(),open:d,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(f=>!f),[h]),modal:l,children:a.jsx(pre,{...c,open:d,onOpenChange:h,dir:r,modal:l,children:n})})};P5.displayName=Pb;var O5="DropdownMenuTrigger",I5=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=e,i=T5(O5,n),o=Na(n);return a.jsx(gre,{asChild:!0,...o,children:a.jsx(ot.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:Eo(t,i.triggerRef),onPointerDown:Ve(e.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:Ve(e.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});I5.displayName=O5;var Ore="DropdownMenuPortal",R5=e=>{const{__scopeDropdownMenu:t,...n}=e,r=Na(t);return a.jsx(vre,{...r,...n})};R5.displayName=Ore;var M5="DropdownMenuContent",D5=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=T5(M5,n),i=Na(n),o=p.useRef(!1);return a.jsx(yre,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:t,onCloseAutoFocus:Ve(e.onCloseAutoFocus,l=>{var c;o.current||(c=s.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:Ve(e.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,d=c.button===2||u;(!s.modal||d)&&(o.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});D5.displayName=M5;var Ire="DropdownMenuGroup",Rre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Na(n);return a.jsx(xre,{...s,...r,ref:t})});Rre.displayName=Ire;var Mre="DropdownMenuLabel",L5=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Na(n);return a.jsx(bre,{...s,...r,ref:t})});L5.displayName=Mre;var Dre="DropdownMenuItem",$5=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Na(n);return a.jsx(wre,{...s,...r,ref:t})});$5.displayName=Dre;var Lre="DropdownMenuCheckboxItem",F5=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Na(n);return a.jsx(jre,{...s,...r,ref:t})});F5.displayName=Lre;var $re="DropdownMenuRadioGroup",Fre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Na(n);return a.jsx(_re,{...s,...r,ref:t})});Fre.displayName=$re;var Ure="DropdownMenuRadioItem",U5=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Na(n);return a.jsx(kre,{...s,...r,ref:t})});U5.displayName=Ure;var Bre="DropdownMenuItemIndicator",B5=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Na(n);return a.jsx(Sre,{...s,...r,ref:t})});B5.displayName=Bre;var zre="DropdownMenuSeparator",z5=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Na(n);return a.jsx(Nre,{...s,...r,ref:t})});z5.displayName=zre;var Wre="DropdownMenuArrow",qre=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Na(n);return a.jsx(Cre,{...s,...r,ref:t})});qre.displayName=Wre;var Hre="DropdownMenuSubTrigger",W5=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Na(n);return a.jsx(Are,{...s,...r,ref:t})});W5.displayName=Hre;var Kre="DropdownMenuSubContent",q5=p.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=Na(n);return a.jsx(Ere,{...s,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});q5.displayName=Kre;var Vre=P5,Gre=I5,Yre=R5,H5=D5,K5=L5,V5=$5,G5=F5,Y5=U5,X5=B5,J5=z5,Q5=W5,Z5=q5;const xc=Vre,bc=Gre,Xre=p.forwardRef(({className:e,inset:t,children:n,...r},s)=>a.jsxs(Q5,{ref:s,className:Ie("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",t&&"pl-8",e),...r,children:[n,a.jsx(Mp,{className:"ml-auto h-4 w-4"})]}));Xre.displayName=Q5.displayName;const Jre=p.forwardRef(({className:e,...t},n)=>a.jsx(Z5,{ref:n,className:Ie("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Jre.displayName=Z5.displayName;const ul=p.forwardRef(({className:e,sideOffset:t=4,...n},r)=>a.jsx(Yre,{children:a.jsx(H5,{ref:r,sideOffset:t,className:Ie("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));ul.displayName=H5.displayName;const ma=p.forwardRef(({className:e,inset:t,...n},r)=>a.jsx(V5,{ref:r,className:Ie("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t&&"pl-8",e),...n}));ma.displayName=V5.displayName;const Qre=p.forwardRef(({className:e,children:t,checked:n,...r},s)=>a.jsxs(G5,{ref:s,className:Ie("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),checked:n,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(X5,{children:a.jsx(SN,{className:"h-4 w-4"})})}),t]}));Qre.displayName=G5.displayName;const Zre=p.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(Y5,{ref:r,className:Ie("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(X5,{children:a.jsx(qV,{className:"h-2 w-2 fill-current"})})}),t]}));Zre.displayName=Y5.displayName;const eU=p.forwardRef(({className:e,inset:t,...n},r)=>a.jsx(K5,{ref:r,className:Ie("px-2 py-1.5 text-sm font-semibold",t&&"pl-8",e),...n}));eU.displayName=K5.displayName;const T1=p.forwardRef(({className:e,...t},n)=>a.jsx(J5,{ref:n,className:Ie("-mx-1 my-1 h-px bg-muted",e),...t}));T1.displayName=J5.displayName;var tU={exports:{}},nU={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vd=p;function eae(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var tae=typeof Object.is=="function"?Object.is:eae,nae=Vd.useState,rae=Vd.useEffect,aae=Vd.useLayoutEffect,sae=Vd.useDebugValue;function iae(e,t){var n=t(),r=nae({inst:{value:n,getSnapshot:t}}),s=r[0].inst,i=r[1];return aae(function(){s.value=n,s.getSnapshot=t,Jw(s)&&i({inst:s})},[e,n,t]),rae(function(){return Jw(s)&&i({inst:s}),e(function(){Jw(s)&&i({inst:s})})},[e]),sae(n),n}function Jw(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!tae(e,n)}catch{return!0}}function oae(e,t){return t()}var lae=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?oae:iae;nU.useSyncExternalStore=Vd.useSyncExternalStore!==void 0?Vd.useSyncExternalStore:lae;tU.exports=nU;var cae=tU.exports;function uae(){return cae.useSyncExternalStore(dae,()=>!0,()=>!1)}function dae(){return()=>{}}var lC="Avatar",[hae,bUe]=Mr(lC),[fae,rU]=hae(lC),aU=p.forwardRef((e,t)=>{const{__scopeAvatar:n,...r}=e,[s,i]=p.useState("idle");return a.jsx(fae,{scope:n,imageLoadingStatus:s,onImageLoadingStatusChange:i,children:a.jsx(ot.span,{...r,ref:t})})});aU.displayName=lC;var sU="AvatarImage",iU=p.forwardRef((e,t)=>{const{__scopeAvatar:n,src:r,onLoadingStatusChange:s=()=>{},...i}=e,o=rU(sU,n),l=mae(r,i),c=ar(u=>{s(u),o.onImageLoadingStatusChange(u)});return sr(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?a.jsx(ot.img,{...i,ref:t,src:r}):null});iU.displayName=sU;var oU="AvatarFallback",lU=p.forwardRef((e,t)=>{const{__scopeAvatar:n,delayMs:r,...s}=e,i=rU(oU,n),[o,l]=p.useState(r===void 0);return p.useEffect(()=>{if(r!==void 0){const c=window.setTimeout(()=>l(!0),r);return()=>window.clearTimeout(c)}},[r]),o&&i.imageLoadingStatus!=="loaded"?a.jsx(ot.span,{...s,ref:t}):null});lU.displayName=oU;function f2(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function mae(e,{referrerPolicy:t,crossOrigin:n}){const r=uae(),s=p.useRef(null),i=r?(s.current||(s.current=new window.Image),s.current):null,[o,l]=p.useState(()=>f2(i,e));return sr(()=>{l(f2(i,e))},[i,e]),sr(()=>{const c=h=>()=>{l(h)};if(!i)return;const u=c("loaded"),d=c("error");return i.addEventListener("load",u),i.addEventListener("error",d),t&&(i.referrerPolicy=t),typeof n=="string"&&(i.crossOrigin=n),()=>{i.removeEventListener("load",u),i.removeEventListener("error",d)}},[i,n,t]),o}var cU=aU,uU=iU,dU=lU;const Da=p.forwardRef(({className:e,...t},n)=>a.jsx(cU,{ref:n,className:Ie("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));Da.displayName=cU.displayName;const Yc=p.forwardRef(({className:e,...t},n)=>a.jsx(uU,{ref:n,className:Ie("aspect-square h-full w-full",e),...t}));Yc.displayName=uU.displayName;const La=p.forwardRef(({className:e,...t},n)=>a.jsx(dU,{ref:n,className:Ie("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));La.displayName=dU.displayName;function hU(){const{theme:e,setTheme:t,resolvedTheme:n}=gte();return a.jsxs(xc,{children:[a.jsx(bc,{asChild:!0,children:a.jsxs(se,{variant:"ghost",size:"icon",className:"h-9 w-9",children:[n==="dark"?a.jsx(XT,{className:"h-4 w-4"}):a.jsx(ZT,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Toggle theme"})]})}),a.jsxs(ul,{align:"end",children:[a.jsxs(ma,{onClick:()=>t("light"),className:"gap-2",children:[a.jsx(ZT,{className:"h-4 w-4"}),a.jsx("span",{children:"Light"}),e==="light"&&a.jsx("span",{className:"ml-auto text-xs",children:""})]}),a.jsxs(ma,{onClick:()=>t("dark"),className:"gap-2",children:[a.jsx(XT,{className:"h-4 w-4"}),a.jsx("span",{children:"Dark"}),e==="dark"&&a.jsx("span",{className:"ml-auto text-xs",children:""})]}),a.jsxs(ma,{onClick:()=>t("system"),className:"gap-2",children:[a.jsx(YV,{className:"h-4 w-4"}),a.jsx("span",{children:"System"}),e==="system"&&a.jsx("span",{className:"ml-auto text-xs",children:""})]})]})]})}var Ob="Dialog",[fU,mU]=Mr(Ob),[pae,pi]=fU(Ob),pU=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=e,l=p.useRef(null),c=p.useRef(null),[u,d]=Ha({prop:r,defaultProp:s??!1,onChange:i,caller:Ob});return a.jsx(pae,{scope:t,triggerRef:l,contentRef:c,contentId:pr(),titleId:pr(),descriptionId:pr(),open:u,onOpenChange:d,onOpenToggle:p.useCallback(()=>d(h=>!h),[d]),modal:o,children:n})};pU.displayName=Ob;var gU="DialogTrigger",vU=p.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=pi(gU,n),i=Ot(t,s.triggerRef);return a.jsx(ot.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":dC(s.open),...r,ref:i,onClick:Ve(e.onClick,s.onOpenToggle)})});vU.displayName=gU;var cC="DialogPortal",[gae,yU]=fU(cC,{forceMount:void 0}),xU=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:s}=e,i=pi(cC,t);return a.jsx(gae,{scope:t,forceMount:n,children:p.Children.map(r,o=>a.jsx(Cr,{present:n||i.open,children:a.jsx(Sh,{asChild:!0,container:s,children:o})}))})};xU.displayName=cC;var Ty="DialogOverlay",bU=p.forwardRef((e,t)=>{const n=yU(Ty,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=pi(Ty,e.__scopeDialog);return i.modal?a.jsx(Cr,{present:r||i.open,children:a.jsx(yae,{...s,ref:t})}):null});bU.displayName=Ty;var vae=Dl("DialogOverlay.RemoveScroll"),yae=p.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=pi(Ty,n);return a.jsx(Wp,{as:vae,allowPinchZoom:!0,shards:[s.contentRef],children:a.jsx(ot.div,{"data-state":dC(s.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Xc="DialogContent",wU=p.forwardRef((e,t)=>{const n=yU(Xc,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=pi(Xc,e.__scopeDialog);return a.jsx(Cr,{present:r||i.open,children:i.modal?a.jsx(xae,{...s,ref:t}):a.jsx(bae,{...s,ref:t})})});wU.displayName=Xc;var xae=p.forwardRef((e,t)=>{const n=pi(Xc,e.__scopeDialog),r=p.useRef(null),s=Ot(t,n.contentRef,r);return p.useEffect(()=>{const i=r.current;if(i)return Cb(i)},[]),a.jsx(jU,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ve(e.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Ve(e.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:Ve(e.onFocusOutside,i=>i.preventDefault())})}),bae=p.forwardRef((e,t)=>{const n=pi(Xc,e.__scopeDialog),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(jU,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=e.onInteractOutside)==null||c.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),jU=p.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=e,l=pi(Xc,n),c=p.useRef(null),u=Ot(t,c);return Nb(),a.jsxs(a.Fragment,{children:[a.jsx(zp,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(du,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":dC(l.open),...o,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(jae,{titleId:l.titleId}),a.jsx(kae,{contentRef:c,descriptionId:l.descriptionId})]})]})}),uC="DialogTitle",_U=p.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=pi(uC,n);return a.jsx(ot.h2,{id:s.titleId,...r,ref:t})});_U.displayName=uC;var kU="DialogDescription",SU=p.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=pi(kU,n);return a.jsx(ot.p,{id:s.descriptionId,...r,ref:t})});SU.displayName=kU;var NU="DialogClose",CU=p.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=pi(NU,n);return a.jsx(ot.button,{type:"button",...r,ref:t,onClick:Ve(e.onClick,()=>s.onOpenChange(!1))})});CU.displayName=NU;function dC(e){return e?"open":"closed"}var AU="DialogTitleWarning",[wae,EU]=YK(AU,{contentName:Xc,titleName:uC,docsSlug:"dialog"}),jae=({titleId:e})=>{const t=EU(AU),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return p.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},_ae="DialogDescriptionWarning",kae=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${EU(_ae).contentName}}.`;return p.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},hC=pU,TU=vU,fC=xU,Ib=bU,Rb=wU,mC=_U,pC=SU,gC=CU;const xn=hC,vC=TU,Sae=fC,PU=p.forwardRef(({className:e,...t},n)=>a.jsx(Ib,{ref:n,className:Ie("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));PU.displayName=Ib.displayName;const un=p.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(Sae,{children:[a.jsx(PU,{}),a.jsxs(Rb,{ref:r,className:Ie("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...n,children:[t,a.jsxs(gC,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(Nh,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));un.displayName=Rb.displayName;const dn=({className:e,...t})=>a.jsx("div",{className:Ie("flex flex-col space-y-1.5 text-center sm:text-left",e),...t});dn.displayName="DialogHeader";const Pa=({className:e,...t})=>a.jsx("div",{className:Ie("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Pa.displayName="DialogFooter";const hn=p.forwardRef(({className:e,...t},n)=>a.jsx(mC,{ref:n,className:Ie("text-lg font-semibold leading-none tracking-tight",e),...t}));hn.displayName=mC.displayName;const Hr=p.forwardRef(({className:e,...t},n)=>a.jsx(pC,{ref:n,className:Ie("text-sm text-muted-foreground",e),...t}));Hr.displayName=pC.displayName;function Nae({open:e,onClose:t,isMasterAgent:n,pausedByName:r,pausedAt:s,onOpenAdminPanel:i}){const o=s?new Date(s).toLocaleString():null;return a.jsx(xn,{open:e,onOpenChange:l=>{l||t()},children:a.jsxs(un,{className:"max-w-lg",children:[a.jsxs(dn,{children:[a.jsx(hn,{children:"AI Replies Are Currently Paused"}),a.jsx(Hr,{children:n?a.jsxs("span",{children:["AI responses are paused across every channel. Synka will not send AI replies until you resume them in ",a.jsx("strong",{children:"Admin Panel  AI Controls"}),"."]}):a.jsx("span",{children:"A master agent paused all AI responses across every channel. Synka will not send AI replies until this setting is changed. Only a master agent can resume AI replies."})})]}),a.jsxs("div",{className:"space-y-1 text-xs text-muted-foreground",children:[r?a.jsxs("div",{children:["Paused by: ",r]}):null,o?a.jsxs("div",{children:["At: ",o]}):null]}),a.jsxs(Pa,{className:"gap-2",children:[n?a.jsx(se,{variant:"ghost",onClick:i,children:"Open Admin Panel"}):null,a.jsx(se,{onClick:t,children:"Got it"})]})]})})}const qr=p.forwardRef(({className:e,...t},n)=>a.jsx("textarea",{className:Ie("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));qr.displayName="Textarea";function P1(e,[t,n]){return Math.min(n,Math.max(t,e))}function Cae(e,t){return p.useReducer((n,r)=>t[n][r]??n,e)}var yC="ScrollArea",[OU,wUe]=Mr(yC),[Aae,Ds]=OU(yC),IU=p.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...o}=e,[l,c]=p.useState(null),[u,d]=p.useState(null),[h,f]=p.useState(null),[m,g]=p.useState(null),[v,y]=p.useState(null),[x,w]=p.useState(0),[b,_]=p.useState(0),[k,j]=p.useState(!1),[S,T]=p.useState(!1),O=Ot(t,N=>c(N)),A=Ih(s);return a.jsx(Aae,{scope:n,type:r,dir:A,scrollHideDelay:i,scrollArea:l,viewport:u,onViewportChange:d,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:g,scrollbarXEnabled:k,onScrollbarXEnabledChange:j,scrollbarY:v,onScrollbarYChange:y,scrollbarYEnabled:S,onScrollbarYEnabledChange:T,onCornerWidthChange:w,onCornerHeightChange:_,children:a.jsx(ot.div,{dir:A,...o,ref:O,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":b+"px",...e.style}})})});IU.displayName=yC;var RU="ScrollAreaViewport",MU=p.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=e,o=Ds(RU,n),l=p.useRef(null),c=Ot(t,l,o.onViewportChange);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),a.jsx(ot.div,{"data-radix-scroll-area-viewport":"",...i,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:a.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});MU.displayName=RU;var Gi="ScrollAreaScrollbar",xC=p.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Ds(Gi,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=s,l=e.orientation==="horizontal";return p.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),s.type==="hover"?a.jsx(Eae,{...r,ref:t,forceMount:n}):s.type==="scroll"?a.jsx(Tae,{...r,ref:t,forceMount:n}):s.type==="auto"?a.jsx(DU,{...r,ref:t,forceMount:n}):s.type==="always"?a.jsx(bC,{...r,ref:t}):null});xC.displayName=Gi;var Eae=p.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Ds(Gi,e.__scopeScrollArea),[i,o]=p.useState(!1);return p.useEffect(()=>{const l=s.scrollArea;let c=0;if(l){const u=()=>{window.clearTimeout(c),o(!0)},d=()=>{c=window.setTimeout(()=>o(!1),s.scrollHideDelay)};return l.addEventListener("pointerenter",u),l.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",u),l.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),a.jsx(Cr,{present:n||i,children:a.jsx(DU,{"data-state":i?"visible":"hidden",...r,ref:t})})}),Tae=p.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=Ds(Gi,e.__scopeScrollArea),i=e.orientation==="horizontal",o=Db(()=>c("SCROLL_END"),100),[l,c]=Cae("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,s.scrollHideDelay,c]),p.useEffect(()=>{const u=s.viewport,d=i?"scrollLeft":"scrollTop";if(u){let h=u[d];const f=()=>{const m=u[d];h!==m&&(c("SCROLL"),o()),h=m};return u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[s.viewport,i,c,o]),a.jsx(Cr,{present:n||l!=="hidden",children:a.jsx(bC,{"data-state":l==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Ve(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:Ve(e.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),DU=p.forwardRef((e,t)=>{const n=Ds(Gi,e.__scopeScrollArea),{forceMount:r,...s}=e,[i,o]=p.useState(!1),l=e.orientation==="horizontal",c=Db(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,d=n.viewport.offsetHeight<n.viewport.scrollHeight;o(l?u:d)}},10);return Gd(n.viewport,c),Gd(n.content,c),a.jsx(Cr,{present:r||i,children:a.jsx(bC,{"data-state":i?"visible":"hidden",...s,ref:t})})}),bC=p.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,s=Ds(Gi,e.__scopeScrollArea),i=p.useRef(null),o=p.useRef(0),[l,c]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=BU(l.viewport,l.content),d={...r,sizes:l,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,m){return Dae(f,o.current,l,m)}return n==="horizontal"?a.jsx(Pae,{...d,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollLeft,m=m2(f,l,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollLeft=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollLeft=h(f,s.dir))}}):n==="vertical"?a.jsx(Oae,{...d,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollTop,m=m2(f,l);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollTop=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollTop=h(f))}}):null}),Pae=p.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=Ds(Gi,e.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=Ot(t,c,i.onScrollbarXChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx($U,{"data-orientation":"horizontal",...s,ref:u,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Mb(n)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.x),onDragScroll:d=>e.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+d.deltaX;e.onWheelScroll(f),WU(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Oy(o.paddingLeft),paddingEnd:Oy(o.paddingRight)}})}})}),Oae=p.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=Ds(Gi,e.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=Ot(t,c,i.onScrollbarYChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx($U,{"data-orientation":"vertical",...s,ref:u,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Mb(n)+"px",...e.style},onThumbPointerDown:d=>e.onThumbPointerDown(d.y),onDragScroll:d=>e.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollTop+d.deltaY;e.onWheelScroll(f),WU(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Oy(o.paddingTop),paddingEnd:Oy(o.paddingBottom)}})}})}),[Iae,LU]=OU(Gi),$U=p.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:h,...f}=e,m=Ds(Gi,n),[g,v]=p.useState(null),y=Ot(t,O=>v(O)),x=p.useRef(null),w=p.useRef(""),b=m.viewport,_=r.content-r.viewport,k=ar(d),j=ar(c),S=Db(h,10);function T(O){if(x.current){const A=O.clientX-x.current.left,N=O.clientY-x.current.top;u({x:A,y:N})}}return p.useEffect(()=>{const O=A=>{const N=A.target;(g==null?void 0:g.contains(N))&&k(A,_)};return document.addEventListener("wheel",O,{passive:!1}),()=>document.removeEventListener("wheel",O,{passive:!1})},[b,g,_,k]),p.useEffect(j,[r,j]),Gd(g,S),Gd(m.content,S),a.jsx(Iae,{scope:n,scrollbar:g,hasThumb:s,onThumbChange:ar(i),onThumbPointerUp:ar(o),onThumbPositionChange:j,onThumbPointerDown:ar(l),children:a.jsx(ot.div,{...f,ref:y,style:{position:"absolute",...f.style},onPointerDown:Ve(e.onPointerDown,O=>{O.button===0&&(O.target.setPointerCapture(O.pointerId),x.current=g.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),T(O))}),onPointerMove:Ve(e.onPointerMove,T),onPointerUp:Ve(e.onPointerUp,O=>{const A=O.target;A.hasPointerCapture(O.pointerId)&&A.releasePointerCapture(O.pointerId),document.body.style.webkitUserSelect=w.current,m.viewport&&(m.viewport.style.scrollBehavior=""),x.current=null})})})}),Py="ScrollAreaThumb",FU=p.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=LU(Py,e.__scopeScrollArea);return a.jsx(Cr,{present:n||s.hasThumb,children:a.jsx(Rae,{ref:t,...r})})}),Rae=p.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...s}=e,i=Ds(Py,n),o=LU(Py,n),{onThumbPositionChange:l}=o,c=Ot(t,h=>o.onThumbChange(h)),u=p.useRef(void 0),d=Db(()=>{u.current&&(u.current(),u.current=void 0)},100);return p.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(d(),!u.current){const m=Lae(h,l);u.current=m,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,d,l]),a.jsx(ot.div,{"data-state":o.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Ve(e.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),g=h.clientX-m.left,v=h.clientY-m.top;o.onThumbPointerDown({x:g,y:v})}),onPointerUp:Ve(e.onPointerUp,o.onThumbPointerUp)})});FU.displayName=Py;var wC="ScrollAreaCorner",UU=p.forwardRef((e,t)=>{const n=Ds(wC,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?a.jsx(Mae,{...e,ref:t}):null});UU.displayName=wC;var Mae=p.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,s=Ds(wC,n),[i,o]=p.useState(0),[l,c]=p.useState(0),u=!!(i&&l);return Gd(s.scrollbarX,()=>{var h;const d=((h=s.scrollbarX)==null?void 0:h.offsetHeight)||0;s.onCornerHeightChange(d),c(d)}),Gd(s.scrollbarY,()=>{var h;const d=((h=s.scrollbarY)==null?void 0:h.offsetWidth)||0;s.onCornerWidthChange(d),o(d)}),u?a.jsx(ot.div,{...r,ref:t,style:{width:i,height:l,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function Oy(e){return e?parseInt(e,10):0}function BU(e,t){const n=e/t;return isNaN(n)?0:n}function Mb(e){const t=BU(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function Dae(e,t,n,r="ltr"){const s=Mb(n),i=s/2,o=t||i,l=s-o,c=n.scrollbar.paddingStart+o,u=n.scrollbar.size-n.scrollbar.paddingEnd-l,d=n.content-n.viewport,h=r==="ltr"?[0,d]:[d*-1,0];return zU([c,u],h)(e)}function m2(e,t,n="ltr"){const r=Mb(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-s,o=t.content-t.viewport,l=i-r,c=n==="ltr"?[0,o]:[o*-1,0],u=P1(e,c);return zU([0,o],[0,l])(u)}function zU(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function WU(e,t){return e>0&&e<t}var Lae=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function s(){const i={left:e.scrollLeft,top:e.scrollTop},o=n.left!==i.left,l=n.top!==i.top;(o||l)&&t(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function Db(e,t){const n=ar(e),r=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),p.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Gd(e,t){const n=ar(t);sr(()=>{let r=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(e),()=>{window.cancelAnimationFrame(r),s.unobserve(e)}}},[e,n])}var qU=IU,$ae=MU,Fae=UU;const Lb=p.forwardRef(({className:e,children:t,viewportRef:n,...r},s)=>a.jsxs(qU,{ref:s,className:Ie("relative overflow-hidden",e),...r,children:[a.jsx($ae,{ref:n,className:"h-full w-full rounded-[inherit]",children:t}),a.jsx(HU,{}),a.jsx(Fae,{})]}));Lb.displayName=qU.displayName;const HU=p.forwardRef(({className:e,orientation:t="vertical",...n},r)=>a.jsx(xC,{ref:r,orientation:t,className:Ie("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...n,children:a.jsx(FU,{className:"relative flex-1 rounded-full bg-border"})}));HU.displayName=xC.displayName;function Mt(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}function Ka(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}function ya(e,t){const n=Mt(e);return isNaN(t)?Ka(e,NaN):(t&&n.setDate(n.getDate()+t),n)}function fi(e,t){const n=Mt(e);if(isNaN(t))return Ka(e,NaN);if(!t)return n;const r=n.getDate(),s=Ka(e,n.getTime());s.setMonth(n.getMonth()+t+1,0);const i=s.getDate();return r>=i?s:(n.setFullYear(s.getFullYear(),s.getMonth(),r),n)}const jC=6048e5,Uae=864e5,Yg=43200,p2=1440;let Bae={};function Rh(){return Bae}function qi(e,t){var l,c,u,d;const n=Rh(),r=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??n.weekStartsOn??((d=(u=n.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=Mt(e),i=s.getDay(),o=(i<r?7:0)+i-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function Jc(e){return qi(e,{weekStartsOn:1})}function KU(e){const t=Mt(e),n=t.getFullYear(),r=Ka(e,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const s=Jc(r),i=Ka(e,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const o=Jc(i);return t.getTime()>=s.getTime()?n+1:t.getTime()>=o.getTime()?n:n-1}function Ul(e){const t=Mt(e);return t.setHours(0,0,0,0),t}function Yd(e){const t=Mt(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function Oi(e,t){const n=Ul(e),r=Ul(t),s=+n-Yd(n),i=+r-Yd(r);return Math.round((s-i)/Uae)}function zae(e){const t=KU(e),n=Ka(e,0);return n.setFullYear(t,0,4),n.setHours(0,0,0,0),Jc(n)}function O1(e,t){const n=t*7;return ya(e,n)}function Wae(e,t){return fi(e,t*12)}function qae(e){let t;return e.forEach(function(n){const r=Mt(n);(t===void 0||t<r||isNaN(Number(r)))&&(t=r)}),t||new Date(NaN)}function Hae(e){let t;return e.forEach(n=>{const r=Mt(n);(!t||t>r||isNaN(+r))&&(t=r)}),t||new Date(NaN)}function Fv(e,t){const n=Mt(e),r=Mt(t),s=n.getTime()-r.getTime();return s<0?-1:s>0?1:s}function Kae(e){return Ka(e,Date.now())}function Fa(e,t){const n=Ul(e),r=Ul(t);return+n==+r}function _C(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function Vae(e){if(!_C(e)&&typeof e!="number")return!1;const t=Mt(e);return!isNaN(Number(t))}function Xd(e,t){const n=Mt(e),r=Mt(t),s=n.getFullYear()-r.getFullYear(),i=n.getMonth()-r.getMonth();return s*12+i}function Gae(e,t,n){const r=qi(e,n),s=qi(t,n),i=+r-Yd(r),o=+s-Yd(s);return Math.round((i-o)/jC)}function Yae(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function Xae(e,t){return+Mt(e)-+Mt(t)}function kC(e){const t=Mt(e);return t.setHours(23,59,59,999),t}function $b(e){const t=Mt(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}function Jae(e){const t=Mt(e);return+kC(t)==+$b(t)}function Qae(e,t){const n=Mt(e),r=Mt(t),s=Fv(n,r),i=Math.abs(Xd(n,r));let o;if(i<1)o=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-s*i);let l=Fv(n,r)===-s;Jae(Mt(e))&&i===1&&Fv(e,r)===1&&(l=!1),o=s*(i-Number(l))}return o===0?0:o}function Zae(e,t,n){const r=Xae(e,t)/1e3;return Yae(n==null?void 0:n.roundingMethod)(r)}function qa(e){const t=Mt(e);return t.setDate(1),t.setHours(0,0,0,0),t}function VU(e){const t=Mt(e),n=Ka(e,0);return n.setFullYear(t.getFullYear(),0,1),n.setHours(0,0,0,0),n}function SC(e,t){var l,c,u,d;const n=Rh(),r=(t==null?void 0:t.weekStartsOn)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??n.weekStartsOn??((d=(u=n.locale)==null?void 0:u.options)==null?void 0:d.weekStartsOn)??0,s=Mt(e),i=s.getDay(),o=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}function GU(e){return SC(e,{weekStartsOn:1})}const ese={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},tse=(e,t,n)=>{let r;const s=ese[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function bd(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const nse={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},rse={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},ase={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},sse={date:bd({formats:nse,defaultWidth:"full"}),time:bd({formats:rse,defaultWidth:"full"}),dateTime:bd({formats:ase,defaultWidth:"full"})},ise={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},ose=(e,t,n,r)=>ise[e];function Ei(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const o=e.defaultFormattingWidth||e.defaultWidth,l=n!=null&&n.width?String(n.width):o;s=e.formattingValues[l]||e.formattingValues[o]}else{const o=e.defaultWidth,l=n!=null&&n.width?String(n.width):e.defaultWidth;s=e.values[l]||e.values[o]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const lse={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},cse={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},use={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},dse={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},hse={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},fse={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},mse=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},pse={ordinalNumber:mse,era:Ei({values:lse,defaultWidth:"wide"}),quarter:Ei({values:cse,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ei({values:use,defaultWidth:"wide"}),day:Ei({values:dse,defaultWidth:"wide"}),dayPeriod:Ei({values:hse,defaultWidth:"wide",formattingValues:fse,defaultFormattingWidth:"wide"})};function Ti(e){return(t,n={})=>{const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const o=i[0],l=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(l)?vse(l,h=>h.test(o)):gse(l,h=>h.test(o));let u;u=e.valueCallback?e.valueCallback(c):c,u=n.valueCallback?n.valueCallback(u):u;const d=t.slice(o.length);return{value:u,rest:d}}}function gse(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function vse(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function YU(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const s=r[0],i=t.match(e.parsePattern);if(!i)return null;let o=e.valueCallback?e.valueCallback(i[0]):i[0];o=n.valueCallback?n.valueCallback(o):o;const l=t.slice(s.length);return{value:o,rest:l}}}const yse=/^(\d+)(th|st|nd|rd)?/i,xse=/\d+/i,bse={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},wse={any:[/^b/i,/^(a|c)/i]},jse={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},_se={any:[/1/i,/2/i,/3/i,/4/i]},kse={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Sse={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Nse={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},Cse={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Ase={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},Ese={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Tse={ordinalNumber:YU({matchPattern:yse,parsePattern:xse,valueCallback:e=>parseInt(e,10)}),era:Ti({matchPatterns:bse,defaultMatchWidth:"wide",parsePatterns:wse,defaultParseWidth:"any"}),quarter:Ti({matchPatterns:jse,defaultMatchWidth:"wide",parsePatterns:_se,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ti({matchPatterns:kse,defaultMatchWidth:"wide",parsePatterns:Sse,defaultParseWidth:"any"}),day:Ti({matchPatterns:Nse,defaultMatchWidth:"wide",parsePatterns:Cse,defaultParseWidth:"any"}),dayPeriod:Ti({matchPatterns:Ase,defaultMatchWidth:"any",parsePatterns:Ese,defaultParseWidth:"any"})},NC={code:"en-US",formatDistance:tse,formatLong:sse,formatRelative:ose,localize:pse,match:Tse,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Pse(e){const t=Mt(e);return Oi(t,VU(t))+1}function XU(e){const t=Mt(e),n=+Jc(t)-+zae(t);return Math.round(n/jC)+1}function JU(e,t){var d,h,f,m;const n=Mt(e),r=n.getFullYear(),s=Rh(),i=(t==null?void 0:t.firstWeekContainsDate)??((h=(d=t==null?void 0:t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(f=s.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,o=Ka(e,0);o.setFullYear(r+1,0,i),o.setHours(0,0,0,0);const l=qi(o,t),c=Ka(e,0);c.setFullYear(r,0,i),c.setHours(0,0,0,0);const u=qi(c,t);return n.getTime()>=l.getTime()?r+1:n.getTime()>=u.getTime()?r:r-1}function Ose(e,t){var l,c,u,d;const n=Rh(),r=(t==null?void 0:t.firstWeekContainsDate)??((c=(l=t==null?void 0:t.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??n.firstWeekContainsDate??((d=(u=n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??1,s=JU(e,t),i=Ka(e,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),qi(i,t)}function QU(e,t){const n=Mt(e),r=+qi(n,t)-+Ose(n,t);return Math.round(r/jC)+1}function wn(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const Zo={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return wn(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):wn(n+1,2)},d(e,t){return wn(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return wn(e.getHours()%12||12,t.length)},H(e,t){return wn(e.getHours(),t.length)},m(e,t){return wn(e.getMinutes(),t.length)},s(e,t){return wn(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return wn(s,t.length)}},Iu={am:"am",pm:"pm",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},g2={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return Zo.y(e,t)},Y:function(e,t,n,r){const s=JU(e,r),i=s>0?s:1-s;if(t==="YY"){const o=i%100;return wn(o,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):wn(i,t.length)},R:function(e,t){const n=KU(e);return wn(n,t.length)},u:function(e,t){const n=e.getFullYear();return wn(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return wn(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return wn(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return Zo.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return wn(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const s=QU(e,r);return t==="wo"?n.ordinalNumber(s,{unit:"week"}):wn(s,t.length)},I:function(e,t,n){const r=XU(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):wn(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):Zo.d(e,t)},D:function(e,t,n){const r=Pse(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):wn(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return wn(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return wn(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return wn(s,t.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let s;switch(r===12?s=Iu.noon:r===0?s=Iu.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let s;switch(r>=17?s=Iu.evening:r>=12?s=Iu.afternoon:r>=4?s=Iu.morning:s=Iu.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return Zo.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):Zo.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):wn(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):wn(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):Zo.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):Zo.s(e,t)},S:function(e,t){return Zo.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return y2(r);case"XXXX":case"XX":return fc(r);case"XXXXX":case"XXX":default:return fc(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return y2(r);case"xxxx":case"xx":return fc(r);case"xxxxx":case"xxx":default:return fc(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+v2(r,":");case"OOOO":default:return"GMT"+fc(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+v2(r,":");case"zzzz":default:return"GMT"+fc(r,":")}},t:function(e,t,n){const r=Math.trunc(e.getTime()/1e3);return wn(r,t.length)},T:function(e,t,n){const r=e.getTime();return wn(r,t.length)}};function v2(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+t+wn(i,2)}function y2(e,t){return e%60===0?(e>0?"-":"+")+wn(Math.abs(e)/60,2):fc(e,t)}function fc(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=wn(Math.trunc(r/60),2),i=wn(r%60,2);return n+s+t+i}const x2=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},ZU=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},Ise=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return x2(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",x2(r,t)).replace("{{time}}",ZU(s,t))},Rse={p:ZU,P:Ise},Mse=/^D+$/,Dse=/^Y+$/,Lse=["D","DD","YY","YYYY"];function $se(e){return Mse.test(e)}function Fse(e){return Dse.test(e)}function Use(e,t,n){const r=Bse(e,t,n);if(console.warn(r),Lse.includes(e))throw new RangeError(r)}function Bse(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const zse=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,Wse=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,qse=/^'([^]*?)'?$/,Hse=/''/g,Kse=/[a-zA-Z]/;function Io(e,t,n){var d,h,f,m,g,v,y,x;const r=Rh(),s=(n==null?void 0:n.locale)??r.locale??NC,i=(n==null?void 0:n.firstWeekContainsDate)??((h=(d=n==null?void 0:n.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??r.firstWeekContainsDate??((m=(f=r.locale)==null?void 0:f.options)==null?void 0:m.firstWeekContainsDate)??1,o=(n==null?void 0:n.weekStartsOn)??((v=(g=n==null?void 0:n.locale)==null?void 0:g.options)==null?void 0:v.weekStartsOn)??r.weekStartsOn??((x=(y=r.locale)==null?void 0:y.options)==null?void 0:x.weekStartsOn)??0,l=Mt(e);if(!Vae(l))throw new RangeError("Invalid time value");let c=t.match(Wse).map(w=>{const b=w[0];if(b==="p"||b==="P"){const _=Rse[b];return _(w,s.formatLong)}return w}).join("").match(zse).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const b=w[0];if(b==="'")return{isToken:!1,value:Vse(w)};if(g2[b])return{isToken:!0,value:w};if(b.match(Kse))throw new RangeError("Format string contains an unescaped latin alphabet character `"+b+"`");return{isToken:!1,value:w}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const u={firstWeekContainsDate:i,weekStartsOn:o,locale:s};return c.map(w=>{if(!w.isToken)return w.value;const b=w.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&Fse(b)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&$se(b))&&Use(b,t,String(e));const _=g2[b[0]];return _(l,b,s.localize,u)}).join("")}function Vse(e){const t=e.match(qse);return t?t[1].replace(Hse,"'"):e}function Gse(e,t,n){const r=Rh(),s=(n==null?void 0:n.locale)??r.locale??NC,i=2520,o=Fv(e,t);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:o});let c,u;o>0?(c=Mt(t),u=Mt(e)):(c=Mt(e),u=Mt(t));const d=Zae(u,c),h=(Yd(u)-Yd(c))/1e3,f=Math.round((d-h)/60);let m;if(f<2)return n!=null&&n.includeSeconds?d<5?s.formatDistance("lessThanXSeconds",5,l):d<10?s.formatDistance("lessThanXSeconds",10,l):d<20?s.formatDistance("lessThanXSeconds",20,l):d<40?s.formatDistance("halfAMinute",0,l):d<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):f===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",f,l);if(f<45)return s.formatDistance("xMinutes",f,l);if(f<90)return s.formatDistance("aboutXHours",1,l);if(f<p2){const g=Math.round(f/60);return s.formatDistance("aboutXHours",g,l)}else{if(f<i)return s.formatDistance("xDays",1,l);if(f<Yg){const g=Math.round(f/p2);return s.formatDistance("xDays",g,l)}else if(f<Yg*2)return m=Math.round(f/Yg),s.formatDistance("aboutXMonths",m,l)}if(m=Qae(u,c),m<12){const g=Math.round(f/Yg);return s.formatDistance("xMonths",g,l)}else{const g=m%12,v=Math.trunc(m/12);return g<3?s.formatDistance("aboutXYears",v,l):g<9?s.formatDistance("overXYears",v,l):s.formatDistance("almostXYears",v+1,l)}}function Yse(e,t){return Gse(e,Kae(e),t)}function Xse(e){const t=Mt(e),n=t.getFullYear(),r=t.getMonth(),s=Ka(e,0);return s.setFullYear(n,r+1,0),s.setHours(0,0,0,0),s.getDate()}function Jse(e){return Math.trunc(+Mt(e)/1e3)}function Qse(e){const t=Mt(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(0,0,0,0),t}function Zse(e,t){return Gae(Qse(e),qa(e),t)+1}function I1(e,t){const n=Mt(e),r=Mt(t);return n.getTime()>r.getTime()}function eB(e,t){const n=Mt(e),r=Mt(t);return+n<+r}function CC(e,t){const n=Mt(e),r=Mt(t);return n.getFullYear()===r.getFullYear()&&n.getMonth()===r.getMonth()}function eie(e,t){const n=Mt(e),r=Mt(t);return n.getFullYear()===r.getFullYear()}function Qw(e,t){return ya(e,-t)}function Zw(e,t){const n=Mt(e),r=n.getFullYear(),s=n.getDate(),i=Ka(e,0);i.setFullYear(r,t,15),i.setHours(0,0,0,0);const o=Xse(i);return n.setMonth(t,Math.min(s,o)),n}function b2(e,t){const n=Mt(e);return isNaN(+n)?Ka(e,NaN):(n.setFullYear(t),n)}const tie={lessThanXSeconds:{one:"kurang dari 1 detik",other:"kurang dari {{count}} detik"},xSeconds:{one:"1 detik",other:"{{count}} detik"},halfAMinute:"setengah menit",lessThanXMinutes:{one:"kurang dari 1 menit",other:"kurang dari {{count}} menit"},xMinutes:{one:"1 menit",other:"{{count}} menit"},aboutXHours:{one:"sekitar 1 jam",other:"sekitar {{count}} jam"},xHours:{one:"1 jam",other:"{{count}} jam"},xDays:{one:"1 hari",other:"{{count}} hari"},aboutXWeeks:{one:"sekitar 1 minggu",other:"sekitar {{count}} minggu"},xWeeks:{one:"1 minggu",other:"{{count}} minggu"},aboutXMonths:{one:"sekitar 1 bulan",other:"sekitar {{count}} bulan"},xMonths:{one:"1 bulan",other:"{{count}} bulan"},aboutXYears:{one:"sekitar 1 tahun",other:"sekitar {{count}} tahun"},xYears:{one:"1 tahun",other:"{{count}} tahun"},overXYears:{one:"lebih dari 1 tahun",other:"lebih dari {{count}} tahun"},almostXYears:{one:"hampir 1 tahun",other:"hampir {{count}} tahun"}},nie=(e,t,n)=>{let r;const s=tie[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"dalam waktu "+r:r+" yang lalu":r},rie={full:"EEEE, d MMMM yyyy",long:"d MMMM yyyy",medium:"d MMM yyyy",short:"d/M/yyyy"},aie={full:"HH.mm.ss",long:"HH.mm.ss",medium:"HH.mm",short:"HH.mm"},sie={full:"{{date}} 'pukul' {{time}}",long:"{{date}} 'pukul' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},iie={date:bd({formats:rie,defaultWidth:"full"}),time:bd({formats:aie,defaultWidth:"full"}),dateTime:bd({formats:sie,defaultWidth:"full"})},oie={lastWeek:"eeee 'lalu pukul' p",yesterday:"'Kemarin pukul' p",today:"'Hari ini pukul' p",tomorrow:"'Besok pukul' p",nextWeek:"eeee 'pukul' p",other:"P"},lie=(e,t,n,r)=>oie[e],cie={narrow:["SM","M"],abbreviated:["SM","M"],wide:["Sebelum Masehi","Masehi"]},uie={narrow:["1","2","3","4"],abbreviated:["K1","K2","K3","K4"],wide:["Kuartal ke-1","Kuartal ke-2","Kuartal ke-3","Kuartal ke-4"]},die={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agt","Sep","Okt","Nov","Des"],wide:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"]},hie={narrow:["M","S","S","R","K","J","S"],short:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],abbreviated:["Min","Sen","Sel","Rab","Kam","Jum","Sab"],wide:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"]},fie={narrow:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},abbreviated:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},wide:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"}},mie={narrow:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},abbreviated:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"},wide:{am:"AM",pm:"PM",midnight:"tengah malam",noon:"tengah hari",morning:"pagi",afternoon:"siang",evening:"sore",night:"malam"}},pie=(e,t)=>"ke-"+Number(e),gie={ordinalNumber:pie,era:Ei({values:cie,defaultWidth:"wide"}),quarter:Ei({values:uie,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Ei({values:die,defaultWidth:"wide"}),day:Ei({values:hie,defaultWidth:"wide"}),dayPeriod:Ei({values:fie,defaultWidth:"wide",formattingValues:mie,defaultFormattingWidth:"wide"})},vie=/^ke-(\d+)?/i,yie=/\d+/i,xie={narrow:/^(sm|m)/i,abbreviated:/^(s\.?\s?m\.?|s\.?\s?e\.?\s?u\.?|m\.?|e\.?\s?u\.?)/i,wide:/^(sebelum masehi|sebelum era umum|masehi|era umum)/i},bie={any:[/^s/i,/^(m|e)/i]},wie={narrow:/^[1234]/i,abbreviated:/^K-?\s[1234]/i,wide:/^Kuartal ke-?\s?[1234]/i},jie={any:[/1/i,/2/i,/3/i,/4/i]},_ie={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|mei|jun|jul|agt|sep|okt|nov|des)/i,wide:/^(januari|februari|maret|april|mei|juni|juli|agustus|september|oktober|november|desember)/i},kie={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^ma/i,/^ap/i,/^me/i,/^jun/i,/^jul/i,/^ag/i,/^s/i,/^o/i,/^n/i,/^d/i]},Sie={narrow:/^[srkjm]/i,short:/^(min|sen|sel|rab|kam|jum|sab)/i,abbreviated:/^(min|sen|sel|rab|kam|jum|sab)/i,wide:/^(minggu|senin|selasa|rabu|kamis|jumat|sabtu)/i},Nie={narrow:[/^m/i,/^s/i,/^s/i,/^r/i,/^k/i,/^j/i,/^s/i],any:[/^m/i,/^sen/i,/^sel/i,/^r/i,/^k/i,/^j/i,/^sa/i]},Cie={narrow:/^(a|p|tengah m|tengah h|(di(\swaktu)?) (pagi|siang|sore|malam))/i,any:/^([ap]\.?\s?m\.?|tengah malam|tengah hari|(di(\swaktu)?) (pagi|siang|sore|malam))/i},Aie={any:{am:/^a/i,pm:/^pm/i,midnight:/^tengah m/i,noon:/^tengah h/i,morning:/pagi/i,afternoon:/siang/i,evening:/sore/i,night:/malam/i}},Eie={ordinalNumber:YU({matchPattern:vie,parsePattern:yie,valueCallback:e=>parseInt(e,10)}),era:Ti({matchPatterns:xie,defaultMatchWidth:"wide",parsePatterns:bie,defaultParseWidth:"any"}),quarter:Ti({matchPatterns:wie,defaultMatchWidth:"wide",parsePatterns:jie,defaultParseWidth:"any",valueCallback:e=>e+1}),month:Ti({matchPatterns:_ie,defaultMatchWidth:"wide",parsePatterns:kie,defaultParseWidth:"any"}),day:Ti({matchPatterns:Sie,defaultMatchWidth:"wide",parsePatterns:Nie,defaultParseWidth:"any"}),dayPeriod:Ti({matchPatterns:Cie,defaultMatchWidth:"any",parsePatterns:Aie,defaultParseWidth:"any"})},Tie={code:"id",formatDistance:nie,formatLong:iie,formatRelative:lie,localize:gie,match:Eie,options:{weekStartsOn:1,firstWeekContainsDate:1}};var Tt=function(){return Tt=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},Tt.apply(this,arguments)};function Pie(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function tB(e,t,n){for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}function Kp(e){return e.mode==="multiple"}function Vp(e){return e.mode==="range"}function Fb(e){return e.mode==="single"}var Oie={root:"rdp",multiple_months:"rdp-multiple_months",with_weeknumber:"rdp-with_weeknumber",vhidden:"rdp-vhidden",button_reset:"rdp-button_reset",button:"rdp-button",caption:"rdp-caption",caption_start:"rdp-caption_start",caption_end:"rdp-caption_end",caption_between:"rdp-caption_between",caption_label:"rdp-caption_label",caption_dropdowns:"rdp-caption_dropdowns",dropdown:"rdp-dropdown",dropdown_month:"rdp-dropdown_month",dropdown_year:"rdp-dropdown_year",dropdown_icon:"rdp-dropdown_icon",months:"rdp-months",month:"rdp-month",table:"rdp-table",tbody:"rdp-tbody",tfoot:"rdp-tfoot",head:"rdp-head",head_row:"rdp-head_row",head_cell:"rdp-head_cell",nav:"rdp-nav",nav_button:"rdp-nav_button",nav_button_previous:"rdp-nav_button_previous",nav_button_next:"rdp-nav_button_next",nav_icon:"rdp-nav_icon",row:"rdp-row",weeknumber:"rdp-weeknumber",cell:"rdp-cell",day:"rdp-day",day_today:"rdp-day_today",day_outside:"rdp-day_outside",day_selected:"rdp-day_selected",day_disabled:"rdp-day_disabled",day_hidden:"rdp-day_hidden",day_range_start:"rdp-day_range_start",day_range_end:"rdp-day_range_end",day_range_middle:"rdp-day_range_middle"};function Iie(e,t){return Io(e,"LLLL y",t)}function Rie(e,t){return Io(e,"d",t)}function Mie(e,t){return Io(e,"LLLL",t)}function Die(e){return"".concat(e)}function Lie(e,t){return Io(e,"cccccc",t)}function $ie(e,t){return Io(e,"yyyy",t)}var Fie=Object.freeze({__proto__:null,formatCaption:Iie,formatDay:Rie,formatMonthCaption:Mie,formatWeekNumber:Die,formatWeekdayName:Lie,formatYearCaption:$ie}),Uie=function(e,t,n){return Io(e,"do MMMM (EEEE)",n)},Bie=function(){return"Month: "},zie=function(){return"Go to next month"},Wie=function(){return"Go to previous month"},qie=function(e,t){return Io(e,"cccc",t)},Hie=function(e){return"Week n. ".concat(e)},Kie=function(){return"Year: "},Vie=Object.freeze({__proto__:null,labelDay:Uie,labelMonthDropdown:Bie,labelNext:zie,labelPrevious:Wie,labelWeekNumber:Hie,labelWeekday:qie,labelYearDropdown:Kie});function Gie(){var e="buttons",t=Oie,n=NC,r={},s={},i=1,o={},l=new Date;return{captionLayout:e,classNames:t,formatters:Fie,labels:Vie,locale:n,modifiersClassNames:r,modifiers:s,numberOfMonths:i,styles:o,today:l,mode:"default"}}function Yie(e){var t=e.fromYear,n=e.toYear,r=e.fromMonth,s=e.toMonth,i=e.fromDate,o=e.toDate;return r?i=qa(r):t&&(i=new Date(t,0,1)),s?o=$b(s):n&&(o=new Date(n,11,31)),{fromDate:i?Ul(i):void 0,toDate:o?Ul(o):void 0}}var nB=p.createContext(void 0);function Xie(e){var t,n=e.initialProps,r=Gie(),s=Yie(n),i=s.fromDate,o=s.toDate,l=(t=n.captionLayout)!==null&&t!==void 0?t:r.captionLayout;l!=="buttons"&&(!i||!o)&&(l="buttons");var c;(Fb(n)||Kp(n)||Vp(n))&&(c=n.onSelect);var u=Tt(Tt(Tt({},r),n),{captionLayout:l,classNames:Tt(Tt({},r.classNames),n.classNames),components:Tt({},n.components),formatters:Tt(Tt({},r.formatters),n.formatters),fromDate:i,labels:Tt(Tt({},r.labels),n.labels),mode:n.mode||r.mode,modifiers:Tt(Tt({},r.modifiers),n.modifiers),modifiersClassNames:Tt(Tt({},r.modifiersClassNames),n.modifiersClassNames),onSelect:c,styles:Tt(Tt({},r.styles),n.styles),toDate:o});return a.jsx(nB.Provider,{value:u,children:e.children})}function Dn(){var e=p.useContext(nB);if(!e)throw new Error("useDayPicker must be used within a DayPickerProvider.");return e}function rB(e){var t=Dn(),n=t.locale,r=t.classNames,s=t.styles,i=t.formatters.formatCaption;return a.jsx("div",{className:r.caption_label,style:s.caption_label,"aria-live":"polite",role:"presentation",id:e.id,children:i(e.displayMonth,{locale:n})})}function Jie(e){return a.jsx("svg",Tt({width:"8px",height:"8px",viewBox:"0 0 120 120","data-testid":"iconDropdown"},e,{children:a.jsx("path",{d:"M4.22182541,48.2218254 C8.44222828,44.0014225 15.2388494,43.9273804 19.5496459,47.9996989 L19.7781746,48.2218254 L60,88.443 L100.221825,48.2218254 C104.442228,44.0014225 111.238849,43.9273804 115.549646,47.9996989 L115.778175,48.2218254 C119.998577,52.4422283 120.07262,59.2388494 116.000301,63.5496459 L115.778175,63.7781746 L67.7781746,111.778175 C63.5577717,115.998577 56.7611506,116.07262 52.4503541,112.000301 L52.2218254,111.778175 L4.22182541,63.7781746 C-0.0739418023,59.4824074 -0.0739418023,52.5175926 4.22182541,48.2218254 Z",fill:"currentColor",fillRule:"nonzero"})}))}function aB(e){var t,n,r=e.onChange,s=e.value,i=e.children,o=e.caption,l=e.className,c=e.style,u=Dn(),d=(n=(t=u.components)===null||t===void 0?void 0:t.IconDropdown)!==null&&n!==void 0?n:Jie;return a.jsxs("div",{className:l,style:c,children:[a.jsx("span",{className:u.classNames.vhidden,children:e["aria-label"]}),a.jsx("select",{name:e.name,"aria-label":e["aria-label"],className:u.classNames.dropdown,style:u.styles.dropdown,value:s,onChange:r,children:i}),a.jsxs("div",{className:u.classNames.caption_label,style:u.styles.caption_label,"aria-hidden":"true",children:[o,a.jsx(d,{className:u.classNames.dropdown_icon,style:u.styles.dropdown_icon})]})]})}function Qie(e){var t,n=Dn(),r=n.fromDate,s=n.toDate,i=n.styles,o=n.locale,l=n.formatters.formatMonthCaption,c=n.classNames,u=n.components,d=n.labels.labelMonthDropdown;if(!r)return a.jsx(a.Fragment,{});if(!s)return a.jsx(a.Fragment,{});var h=[];if(eie(r,s))for(var f=qa(r),m=r.getMonth();m<=s.getMonth();m++)h.push(Zw(f,m));else for(var f=qa(new Date),m=0;m<=11;m++)h.push(Zw(f,m));var g=function(y){var x=Number(y.target.value),w=Zw(qa(e.displayMonth),x);e.onChange(w)},v=(t=u==null?void 0:u.Dropdown)!==null&&t!==void 0?t:aB;return a.jsx(v,{name:"months","aria-label":d(),className:c.dropdown_month,style:i.dropdown_month,onChange:g,value:e.displayMonth.getMonth(),caption:l(e.displayMonth,{locale:o}),children:h.map(function(y){return a.jsx("option",{value:y.getMonth(),children:l(y,{locale:o})},y.getMonth())})})}function Zie(e){var t,n=e.displayMonth,r=Dn(),s=r.fromDate,i=r.toDate,o=r.locale,l=r.styles,c=r.classNames,u=r.components,d=r.formatters.formatYearCaption,h=r.labels.labelYearDropdown,f=[];if(!s)return a.jsx(a.Fragment,{});if(!i)return a.jsx(a.Fragment,{});for(var m=s.getFullYear(),g=i.getFullYear(),v=m;v<=g;v++)f.push(b2(VU(new Date),v));var y=function(w){var b=b2(qa(n),Number(w.target.value));e.onChange(b)},x=(t=u==null?void 0:u.Dropdown)!==null&&t!==void 0?t:aB;return a.jsx(x,{name:"years","aria-label":h(),className:c.dropdown_year,style:l.dropdown_year,onChange:y,value:n.getFullYear(),caption:d(n,{locale:o}),children:f.map(function(w){return a.jsx("option",{value:w.getFullYear(),children:d(w,{locale:o})},w.getFullYear())})})}function eoe(e,t){var n=p.useState(e),r=n[0],s=n[1],i=t===void 0?r:t;return[i,s]}function toe(e){var t=e.month,n=e.defaultMonth,r=e.today,s=t||n||r||new Date,i=e.toDate,o=e.fromDate,l=e.numberOfMonths,c=l===void 0?1:l;if(i&&Xd(i,s)<0){var u=-1*(c-1);s=fi(i,u)}return o&&Xd(s,o)<0&&(s=o),qa(s)}function noe(){var e=Dn(),t=toe(e),n=eoe(t,e.month),r=n[0],s=n[1],i=function(o){var l;if(!e.disableNavigation){var c=qa(o);s(c),(l=e.onMonthChange)===null||l===void 0||l.call(e,c)}};return[r,i]}function roe(e,t){for(var n=t.reverseMonths,r=t.numberOfMonths,s=qa(e),i=qa(fi(s,r)),o=Xd(i,s),l=[],c=0;c<o;c++){var u=fi(s,c);l.push(u)}return n&&(l=l.reverse()),l}function aoe(e,t){if(!t.disableNavigation){var n=t.toDate,r=t.pagedNavigation,s=t.numberOfMonths,i=s===void 0?1:s,o=r?i:1,l=qa(e);if(!n)return fi(l,o);var c=Xd(n,e);if(!(c<i))return fi(l,o)}}function soe(e,t){if(!t.disableNavigation){var n=t.fromDate,r=t.pagedNavigation,s=t.numberOfMonths,i=s===void 0?1:s,o=r?i:1,l=qa(e);if(!n)return fi(l,-o);var c=Xd(l,n);if(!(c<=0))return fi(l,-o)}}var sB=p.createContext(void 0);function ioe(e){var t=Dn(),n=noe(),r=n[0],s=n[1],i=roe(r,t),o=aoe(r,t),l=soe(r,t),c=function(h){return i.some(function(f){return CC(h,f)})},u=function(h,f){c(h)||(f&&eB(h,f)?s(fi(h,1+t.numberOfMonths*-1)):s(h))},d={currentMonth:r,displayMonths:i,goToMonth:s,goToDate:u,previousMonth:l,nextMonth:o,isDateDisplayed:c};return a.jsx(sB.Provider,{value:d,children:e.children})}function Gp(){var e=p.useContext(sB);if(!e)throw new Error("useNavigation must be used within a NavigationProvider");return e}function w2(e){var t,n=Dn(),r=n.classNames,s=n.styles,i=n.components,o=Gp().goToMonth,l=function(d){o(fi(d,e.displayIndex?-e.displayIndex:0))},c=(t=i==null?void 0:i.CaptionLabel)!==null&&t!==void 0?t:rB,u=a.jsx(c,{id:e.id,displayMonth:e.displayMonth});return a.jsxs("div",{className:r.caption_dropdowns,style:s.caption_dropdowns,children:[a.jsx("div",{className:r.vhidden,children:u}),a.jsx(Qie,{onChange:l,displayMonth:e.displayMonth}),a.jsx(Zie,{onChange:l,displayMonth:e.displayMonth})]})}function ooe(e){return a.jsx("svg",Tt({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:a.jsx("path",{d:"M69.490332,3.34314575 C72.6145263,0.218951416 77.6798462,0.218951416 80.8040405,3.34314575 C83.8617626,6.40086786 83.9268205,11.3179931 80.9992143,14.4548388 L80.8040405,14.6568542 L35.461,60 L80.8040405,105.343146 C83.8617626,108.400868 83.9268205,113.317993 80.9992143,116.454839 L80.8040405,116.656854 C77.7463184,119.714576 72.8291931,119.779634 69.6923475,116.852028 L69.490332,116.656854 L18.490332,65.6568542 C15.4326099,62.5991321 15.367552,57.6820069 18.2951583,54.5451612 L18.490332,54.3431458 L69.490332,3.34314575 Z",fill:"currentColor",fillRule:"nonzero"})}))}function loe(e){return a.jsx("svg",Tt({width:"16px",height:"16px",viewBox:"0 0 120 120"},e,{children:a.jsx("path",{d:"M49.8040405,3.34314575 C46.6798462,0.218951416 41.6145263,0.218951416 38.490332,3.34314575 C35.4326099,6.40086786 35.367552,11.3179931 38.2951583,14.4548388 L38.490332,14.6568542 L83.8333725,60 L38.490332,105.343146 C35.4326099,108.400868 35.367552,113.317993 38.2951583,116.454839 L38.490332,116.656854 C41.5480541,119.714576 46.4651794,119.779634 49.602025,116.852028 L49.8040405,116.656854 L100.804041,65.6568542 C103.861763,62.5991321 103.926821,57.6820069 100.999214,54.5451612 L100.804041,54.3431458 L49.8040405,3.34314575 Z",fill:"currentColor"})}))}var Iy=p.forwardRef(function(e,t){var n=Dn(),r=n.classNames,s=n.styles,i=[r.button_reset,r.button];e.className&&i.push(e.className);var o=i.join(" "),l=Tt(Tt({},s.button_reset),s.button);return e.style&&Object.assign(l,e.style),a.jsx("button",Tt({},e,{ref:t,type:"button",className:o,style:l}))});function coe(e){var t,n,r=Dn(),s=r.dir,i=r.locale,o=r.classNames,l=r.styles,c=r.labels,u=c.labelPrevious,d=c.labelNext,h=r.components;if(!e.nextMonth&&!e.previousMonth)return a.jsx(a.Fragment,{});var f=u(e.previousMonth,{locale:i}),m=[o.nav_button,o.nav_button_previous].join(" "),g=d(e.nextMonth,{locale:i}),v=[o.nav_button,o.nav_button_next].join(" "),y=(t=h==null?void 0:h.IconRight)!==null&&t!==void 0?t:loe,x=(n=h==null?void 0:h.IconLeft)!==null&&n!==void 0?n:ooe;return a.jsxs("div",{className:o.nav,style:l.nav,children:[!e.hidePrevious&&a.jsx(Iy,{name:"previous-month","aria-label":f,className:m,style:l.nav_button_previous,disabled:!e.previousMonth,onClick:e.onPreviousClick,children:s==="rtl"?a.jsx(y,{className:o.nav_icon,style:l.nav_icon}):a.jsx(x,{className:o.nav_icon,style:l.nav_icon})}),!e.hideNext&&a.jsx(Iy,{name:"next-month","aria-label":g,className:v,style:l.nav_button_next,disabled:!e.nextMonth,onClick:e.onNextClick,children:s==="rtl"?a.jsx(x,{className:o.nav_icon,style:l.nav_icon}):a.jsx(y,{className:o.nav_icon,style:l.nav_icon})})]})}function j2(e){var t=Dn().numberOfMonths,n=Gp(),r=n.previousMonth,s=n.nextMonth,i=n.goToMonth,o=n.displayMonths,l=o.findIndex(function(g){return CC(e.displayMonth,g)}),c=l===0,u=l===o.length-1,d=t>1&&(c||!u),h=t>1&&(u||!c),f=function(){r&&i(r)},m=function(){s&&i(s)};return a.jsx(coe,{displayMonth:e.displayMonth,hideNext:d,hidePrevious:h,nextMonth:s,previousMonth:r,onPreviousClick:f,onNextClick:m})}function uoe(e){var t,n=Dn(),r=n.classNames,s=n.disableNavigation,i=n.styles,o=n.captionLayout,l=n.components,c=(t=l==null?void 0:l.CaptionLabel)!==null&&t!==void 0?t:rB,u;return s?u=a.jsx(c,{id:e.id,displayMonth:e.displayMonth}):o==="dropdown"?u=a.jsx(w2,{displayMonth:e.displayMonth,id:e.id}):o==="dropdown-buttons"?u=a.jsxs(a.Fragment,{children:[a.jsx(w2,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id}),a.jsx(j2,{displayMonth:e.displayMonth,displayIndex:e.displayIndex,id:e.id})]}):u=a.jsxs(a.Fragment,{children:[a.jsx(c,{id:e.id,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),a.jsx(j2,{displayMonth:e.displayMonth,id:e.id})]}),a.jsx("div",{className:r.caption,style:i.caption,children:u})}function doe(e){var t=Dn(),n=t.footer,r=t.styles,s=t.classNames.tfoot;return n?a.jsx("tfoot",{className:s,style:r.tfoot,children:a.jsx("tr",{children:a.jsx("td",{colSpan:8,children:n})})}):a.jsx(a.Fragment,{})}function hoe(e,t,n){for(var r=n?Jc(new Date):qi(new Date,{locale:e,weekStartsOn:t}),s=[],i=0;i<7;i++){var o=ya(r,i);s.push(o)}return s}function foe(){var e=Dn(),t=e.classNames,n=e.styles,r=e.showWeekNumber,s=e.locale,i=e.weekStartsOn,o=e.ISOWeek,l=e.formatters.formatWeekdayName,c=e.labels.labelWeekday,u=hoe(s,i,o);return a.jsxs("tr",{style:n.head_row,className:t.head_row,children:[r&&a.jsx("td",{style:n.head_cell,className:t.head_cell}),u.map(function(d,h){return a.jsx("th",{scope:"col",className:t.head_cell,style:n.head_cell,"aria-label":c(d,{locale:s}),children:l(d,{locale:s})},h)})]})}function moe(){var e,t=Dn(),n=t.classNames,r=t.styles,s=t.components,i=(e=s==null?void 0:s.HeadRow)!==null&&e!==void 0?e:foe;return a.jsx("thead",{style:r.head,className:n.head,children:a.jsx(i,{})})}function poe(e){var t=Dn(),n=t.locale,r=t.formatters.formatDay;return a.jsx(a.Fragment,{children:r(e.date,{locale:n})})}var AC=p.createContext(void 0);function goe(e){if(!Kp(e.initialProps)){var t={selected:void 0,modifiers:{disabled:[]}};return a.jsx(AC.Provider,{value:t,children:e.children})}return a.jsx(voe,{initialProps:e.initialProps,children:e.children})}function voe(e){var t=e.initialProps,n=e.children,r=t.selected,s=t.min,i=t.max,o=function(u,d,h){var f,m;(f=t.onDayClick)===null||f===void 0||f.call(t,u,d,h);var g=!!(d.selected&&s&&(r==null?void 0:r.length)===s);if(!g){var v=!!(!d.selected&&i&&(r==null?void 0:r.length)===i);if(!v){var y=r?tB([],r):[];if(d.selected){var x=y.findIndex(function(w){return Fa(u,w)});y.splice(x,1)}else y.push(u);(m=t.onSelect)===null||m===void 0||m.call(t,y,u,d,h)}}},l={disabled:[]};r&&l.disabled.push(function(u){var d=i&&r.length>i-1,h=r.some(function(f){return Fa(f,u)});return!!(d&&!h)});var c={selected:r,onDayClick:o,modifiers:l};return a.jsx(AC.Provider,{value:c,children:n})}function EC(){var e=p.useContext(AC);if(!e)throw new Error("useSelectMultiple must be used within a SelectMultipleProvider");return e}function yoe(e,t){var n=t||{},r=n.from,s=n.to;return r&&s?Fa(s,e)&&Fa(r,e)?void 0:Fa(s,e)?{from:s,to:void 0}:Fa(r,e)?void 0:I1(r,e)?{from:e,to:s}:{from:r,to:e}:s?I1(e,s)?{from:s,to:e}:{from:e,to:s}:r?eB(e,r)?{from:e,to:r}:{from:r,to:e}:{from:e,to:void 0}}var TC=p.createContext(void 0);function xoe(e){if(!Vp(e.initialProps)){var t={selected:void 0,modifiers:{range_start:[],range_end:[],range_middle:[],disabled:[]}};return a.jsx(TC.Provider,{value:t,children:e.children})}return a.jsx(boe,{initialProps:e.initialProps,children:e.children})}function boe(e){var t=e.initialProps,n=e.children,r=t.selected,s=r||{},i=s.from,o=s.to,l=t.min,c=t.max,u=function(m,g,v){var y,x;(y=t.onDayClick)===null||y===void 0||y.call(t,m,g,v);var w=yoe(m,r);(x=t.onSelect)===null||x===void 0||x.call(t,w,m,g,v)},d={range_start:[],range_end:[],range_middle:[],disabled:[]};if(i?(d.range_start=[i],o?(d.range_end=[o],Fa(i,o)||(d.range_middle=[{after:i,before:o}])):d.range_end=[i]):o&&(d.range_start=[o],d.range_end=[o]),l&&(i&&!o&&d.disabled.push({after:Qw(i,l-1),before:ya(i,l-1)}),i&&o&&d.disabled.push({after:i,before:ya(i,l-1)}),!i&&o&&d.disabled.push({after:Qw(o,l-1),before:ya(o,l-1)})),c){if(i&&!o&&(d.disabled.push({before:ya(i,-c+1)}),d.disabled.push({after:ya(i,c-1)})),i&&o){var h=Oi(o,i)+1,f=c-h;d.disabled.push({before:Qw(i,f)}),d.disabled.push({after:ya(o,f)})}!i&&o&&(d.disabled.push({before:ya(o,-c+1)}),d.disabled.push({after:ya(o,c-1)}))}return a.jsx(TC.Provider,{value:{selected:r,onDayClick:u,modifiers:d},children:n})}function PC(){var e=p.useContext(TC);if(!e)throw new Error("useSelectRange must be used within a SelectRangeProvider");return e}function Uv(e){return Array.isArray(e)?tB([],e):e!==void 0?[e]:[]}function woe(e){var t={};return Object.entries(e).forEach(function(n){var r=n[0],s=n[1];t[r]=Uv(s)}),t}var mi;(function(e){e.Outside="outside",e.Disabled="disabled",e.Selected="selected",e.Hidden="hidden",e.Today="today",e.RangeStart="range_start",e.RangeEnd="range_end",e.RangeMiddle="range_middle"})(mi||(mi={}));var joe=mi.Selected,Zi=mi.Disabled,_oe=mi.Hidden,koe=mi.Today,ej=mi.RangeEnd,tj=mi.RangeMiddle,nj=mi.RangeStart,Soe=mi.Outside;function Noe(e,t,n){var r,s=(r={},r[joe]=Uv(e.selected),r[Zi]=Uv(e.disabled),r[_oe]=Uv(e.hidden),r[koe]=[e.today],r[ej]=[],r[tj]=[],r[nj]=[],r[Soe]=[],r);return e.fromDate&&s[Zi].push({before:e.fromDate}),e.toDate&&s[Zi].push({after:e.toDate}),Kp(e)?s[Zi]=s[Zi].concat(t.modifiers[Zi]):Vp(e)&&(s[Zi]=s[Zi].concat(n.modifiers[Zi]),s[nj]=n.modifiers[nj],s[tj]=n.modifiers[tj],s[ej]=n.modifiers[ej]),s}var iB=p.createContext(void 0);function Coe(e){var t=Dn(),n=EC(),r=PC(),s=Noe(t,n,r),i=woe(t.modifiers),o=Tt(Tt({},s),i);return a.jsx(iB.Provider,{value:o,children:e.children})}function oB(){var e=p.useContext(iB);if(!e)throw new Error("useModifiers must be used within a ModifiersProvider");return e}function Aoe(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Eoe(e){return!!(e&&typeof e=="object"&&"from"in e)}function Toe(e){return!!(e&&typeof e=="object"&&"after"in e)}function Poe(e){return!!(e&&typeof e=="object"&&"before"in e)}function Ooe(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Ioe(e,t){var n,r=t.from,s=t.to;if(r&&s){var i=Oi(s,r)<0;i&&(n=[s,r],r=n[0],s=n[1]);var o=Oi(e,r)>=0&&Oi(s,e)>=0;return o}return s?Fa(s,e):r?Fa(r,e):!1}function Roe(e){return _C(e)}function Moe(e){return Array.isArray(e)&&e.every(_C)}function Doe(e,t){return t.some(function(n){if(typeof n=="boolean")return n;if(Roe(n))return Fa(e,n);if(Moe(n))return n.includes(e);if(Eoe(n))return Ioe(e,n);if(Ooe(n))return n.dayOfWeek.includes(e.getDay());if(Aoe(n)){var r=Oi(n.before,e),s=Oi(n.after,e),i=r>0,o=s<0,l=I1(n.before,n.after);return l?o&&i:i||o}return Toe(n)?Oi(e,n.after)>0:Poe(n)?Oi(n.before,e)>0:typeof n=="function"?n(e):!1})}function OC(e,t,n){var r=Object.keys(t).reduce(function(i,o){var l=t[o];return Doe(e,l)&&i.push(o),i},[]),s={};return r.forEach(function(i){return s[i]=!0}),n&&!CC(e,n)&&(s.outside=!0),s}function Loe(e,t){for(var n=qa(e[0]),r=$b(e[e.length-1]),s,i,o=n;o<=r;){var l=OC(o,t),c=!l.disabled&&!l.hidden;if(!c){o=ya(o,1);continue}if(l.selected)return o;l.today&&!i&&(i=o),s||(s=o),o=ya(o,1)}return i||s}var $oe=365;function lB(e,t){var n=t.moveBy,r=t.direction,s=t.context,i=t.modifiers,o=t.retry,l=o===void 0?{count:0,lastFocused:e}:o,c=s.weekStartsOn,u=s.fromDate,d=s.toDate,h=s.locale,f={day:ya,week:O1,month:fi,year:Wae,startOfWeek:function(y){return s.ISOWeek?Jc(y):qi(y,{locale:h,weekStartsOn:c})},endOfWeek:function(y){return s.ISOWeek?GU(y):SC(y,{locale:h,weekStartsOn:c})}},m=f[n](e,r==="after"?1:-1);r==="before"&&u?m=qae([u,m]):r==="after"&&d&&(m=Hae([d,m]));var g=!0;if(i){var v=OC(m,i);g=!v.disabled&&!v.hidden}return g?m:l.count>$oe?l.lastFocused:lB(m,{moveBy:n,direction:r,context:s,modifiers:i,retry:Tt(Tt({},l),{count:l.count+1})})}var cB=p.createContext(void 0);function Foe(e){var t=Gp(),n=oB(),r=p.useState(),s=r[0],i=r[1],o=p.useState(),l=o[0],c=o[1],u=Loe(t.displayMonths,n),d=s??(l&&t.isDateDisplayed(l))?l:u,h=function(){c(s),i(void 0)},f=function(y){i(y)},m=Dn(),g=function(y,x){if(s){var w=lB(s,{moveBy:y,direction:x,context:m,modifiers:n});Fa(s,w)||(t.goToDate(w,s),f(w))}},v={focusedDay:s,focusTarget:d,blur:h,focus:f,focusDayAfter:function(){return g("day","after")},focusDayBefore:function(){return g("day","before")},focusWeekAfter:function(){return g("week","after")},focusWeekBefore:function(){return g("week","before")},focusMonthBefore:function(){return g("month","before")},focusMonthAfter:function(){return g("month","after")},focusYearBefore:function(){return g("year","before")},focusYearAfter:function(){return g("year","after")},focusStartOfWeek:function(){return g("startOfWeek","before")},focusEndOfWeek:function(){return g("endOfWeek","after")}};return a.jsx(cB.Provider,{value:v,children:e.children})}function IC(){var e=p.useContext(cB);if(!e)throw new Error("useFocusContext must be used within a FocusProvider");return e}function Uoe(e,t){var n=oB(),r=OC(e,n,t);return r}var RC=p.createContext(void 0);function Boe(e){if(!Fb(e.initialProps)){var t={selected:void 0};return a.jsx(RC.Provider,{value:t,children:e.children})}return a.jsx(zoe,{initialProps:e.initialProps,children:e.children})}function zoe(e){var t=e.initialProps,n=e.children,r=function(i,o,l){var c,u,d;if((c=t.onDayClick)===null||c===void 0||c.call(t,i,o,l),o.selected&&!t.required){(u=t.onSelect)===null||u===void 0||u.call(t,void 0,i,o,l);return}(d=t.onSelect)===null||d===void 0||d.call(t,i,i,o,l)},s={selected:t.selected,onDayClick:r};return a.jsx(RC.Provider,{value:s,children:n})}function uB(){var e=p.useContext(RC);if(!e)throw new Error("useSelectSingle must be used within a SelectSingleProvider");return e}function Woe(e,t){var n=Dn(),r=uB(),s=EC(),i=PC(),o=IC(),l=o.focusDayAfter,c=o.focusDayBefore,u=o.focusWeekAfter,d=o.focusWeekBefore,h=o.blur,f=o.focus,m=o.focusMonthBefore,g=o.focusMonthAfter,v=o.focusYearBefore,y=o.focusYearAfter,x=o.focusStartOfWeek,w=o.focusEndOfWeek,b=function(R){var C,D,E,F;Fb(n)?(C=r.onDayClick)===null||C===void 0||C.call(r,e,t,R):Kp(n)?(D=s.onDayClick)===null||D===void 0||D.call(s,e,t,R):Vp(n)?(E=i.onDayClick)===null||E===void 0||E.call(i,e,t,R):(F=n.onDayClick)===null||F===void 0||F.call(n,e,t,R)},_=function(R){var C;f(e),(C=n.onDayFocus)===null||C===void 0||C.call(n,e,t,R)},k=function(R){var C;h(),(C=n.onDayBlur)===null||C===void 0||C.call(n,e,t,R)},j=function(R){var C;(C=n.onDayMouseEnter)===null||C===void 0||C.call(n,e,t,R)},S=function(R){var C;(C=n.onDayMouseLeave)===null||C===void 0||C.call(n,e,t,R)},T=function(R){var C;(C=n.onDayPointerEnter)===null||C===void 0||C.call(n,e,t,R)},O=function(R){var C;(C=n.onDayPointerLeave)===null||C===void 0||C.call(n,e,t,R)},A=function(R){var C;(C=n.onDayTouchCancel)===null||C===void 0||C.call(n,e,t,R)},N=function(R){var C;(C=n.onDayTouchEnd)===null||C===void 0||C.call(n,e,t,R)},L=function(R){var C;(C=n.onDayTouchMove)===null||C===void 0||C.call(n,e,t,R)},M=function(R){var C;(C=n.onDayTouchStart)===null||C===void 0||C.call(n,e,t,R)},B=function(R){var C;(C=n.onDayKeyUp)===null||C===void 0||C.call(n,e,t,R)},$=function(R){var C;switch(R.key){case"ArrowLeft":R.preventDefault(),R.stopPropagation(),n.dir==="rtl"?l():c();break;case"ArrowRight":R.preventDefault(),R.stopPropagation(),n.dir==="rtl"?c():l();break;case"ArrowDown":R.preventDefault(),R.stopPropagation(),u();break;case"ArrowUp":R.preventDefault(),R.stopPropagation(),d();break;case"PageUp":R.preventDefault(),R.stopPropagation(),R.shiftKey?v():m();break;case"PageDown":R.preventDefault(),R.stopPropagation(),R.shiftKey?y():g();break;case"Home":R.preventDefault(),R.stopPropagation(),x();break;case"End":R.preventDefault(),R.stopPropagation(),w();break}(C=n.onDayKeyDown)===null||C===void 0||C.call(n,e,t,R)},z={onClick:b,onFocus:_,onBlur:k,onKeyDown:$,onKeyUp:B,onMouseEnter:j,onMouseLeave:S,onPointerEnter:T,onPointerLeave:O,onTouchCancel:A,onTouchEnd:N,onTouchMove:L,onTouchStart:M};return z}function qoe(){var e=Dn(),t=uB(),n=EC(),r=PC(),s=Fb(e)?t.selected:Kp(e)?n.selected:Vp(e)?r.selected:void 0;return s}function Hoe(e){return Object.values(mi).includes(e)}function Koe(e,t){var n=[e.classNames.day];return Object.keys(t).forEach(function(r){var s=e.modifiersClassNames[r];if(s)n.push(s);else if(Hoe(r)){var i=e.classNames["day_".concat(r)];i&&n.push(i)}}),n}function Voe(e,t){var n=Tt({},e.styles.day);return Object.keys(t).forEach(function(r){var s;n=Tt(Tt({},n),(s=e.modifiersStyles)===null||s===void 0?void 0:s[r])}),n}function Goe(e,t,n){var r,s,i,o=Dn(),l=IC(),c=Uoe(e,t),u=Woe(e,c),d=qoe(),h=!!(o.onDayClick||o.mode!=="default");p.useEffect(function(){var j;c.outside||l.focusedDay&&h&&Fa(l.focusedDay,e)&&((j=n.current)===null||j===void 0||j.focus())},[l.focusedDay,e,n,h,c.outside]);var f=Koe(o,c).join(" "),m=Voe(o,c),g=!!(c.outside&&!o.showOutsideDays||c.hidden),v=(i=(s=o.components)===null||s===void 0?void 0:s.DayContent)!==null&&i!==void 0?i:poe,y=a.jsx(v,{date:e,displayMonth:t,activeModifiers:c}),x={style:m,className:f,children:y,role:"gridcell"},w=l.focusTarget&&Fa(l.focusTarget,e)&&!c.outside,b=l.focusedDay&&Fa(l.focusedDay,e),_=Tt(Tt(Tt({},x),(r={disabled:c.disabled,role:"gridcell"},r["aria-selected"]=c.selected,r.tabIndex=b||w?0:-1,r)),u),k={isButton:h,isHidden:g,activeModifiers:c,selectedDays:d,buttonProps:_,divProps:x};return k}function Yoe(e){var t=p.useRef(null),n=Goe(e.date,e.displayMonth,t);return n.isHidden?a.jsx("div",{role:"gridcell"}):n.isButton?a.jsx(Iy,Tt({name:"day",ref:t},n.buttonProps)):a.jsx("div",Tt({},n.divProps))}function Xoe(e){var t=e.number,n=e.dates,r=Dn(),s=r.onWeekNumberClick,i=r.styles,o=r.classNames,l=r.locale,c=r.labels.labelWeekNumber,u=r.formatters.formatWeekNumber,d=u(Number(t),{locale:l});if(!s)return a.jsx("span",{className:o.weeknumber,style:i.weeknumber,children:d});var h=c(Number(t),{locale:l}),f=function(m){s(t,n,m)};return a.jsx(Iy,{name:"week-number","aria-label":h,className:o.weeknumber,style:i.weeknumber,onClick:f,children:d})}function Joe(e){var t,n,r=Dn(),s=r.styles,i=r.classNames,o=r.showWeekNumber,l=r.components,c=(t=l==null?void 0:l.Day)!==null&&t!==void 0?t:Yoe,u=(n=l==null?void 0:l.WeekNumber)!==null&&n!==void 0?n:Xoe,d;return o&&(d=a.jsx("td",{className:i.cell,style:s.cell,children:a.jsx(u,{number:e.weekNumber,dates:e.dates})})),a.jsxs("tr",{className:i.row,style:s.row,children:[d,e.dates.map(function(h){return a.jsx("td",{className:i.cell,style:s.cell,role:"presentation",children:a.jsx(c,{displayMonth:e.displayMonth,date:h})},Jse(h))})]})}function _2(e,t,n){for(var r=n!=null&&n.ISOWeek?GU(t):SC(t,n),s=n!=null&&n.ISOWeek?Jc(e):qi(e,n),i=Oi(r,s),o=[],l=0;l<=i;l++)o.push(ya(s,l));var c=o.reduce(function(u,d){var h=n!=null&&n.ISOWeek?XU(d):QU(d,n),f=u.find(function(m){return m.weekNumber===h});return f?(f.dates.push(d),u):(u.push({weekNumber:h,dates:[d]}),u)},[]);return c}function Qoe(e,t){var n=_2(qa(e),$b(e),t);if(t!=null&&t.useFixedWeeks){var r=Zse(e,t);if(r<6){var s=n[n.length-1],i=s.dates[s.dates.length-1],o=O1(i,6-r),l=_2(O1(i,1),o,t);n.push.apply(n,l)}}return n}function Zoe(e){var t,n,r,s=Dn(),i=s.locale,o=s.classNames,l=s.styles,c=s.hideHead,u=s.fixedWeeks,d=s.components,h=s.weekStartsOn,f=s.firstWeekContainsDate,m=s.ISOWeek,g=Qoe(e.displayMonth,{useFixedWeeks:!!u,ISOWeek:m,locale:i,weekStartsOn:h,firstWeekContainsDate:f}),v=(t=d==null?void 0:d.Head)!==null&&t!==void 0?t:moe,y=(n=d==null?void 0:d.Row)!==null&&n!==void 0?n:Joe,x=(r=d==null?void 0:d.Footer)!==null&&r!==void 0?r:doe;return a.jsxs("table",{id:e.id,className:o.table,style:l.table,role:"grid","aria-labelledby":e["aria-labelledby"],children:[!c&&a.jsx(v,{}),a.jsx("tbody",{className:o.tbody,style:l.tbody,children:g.map(function(w){return a.jsx(y,{displayMonth:e.displayMonth,dates:w.dates,weekNumber:w.weekNumber},w.weekNumber)})}),a.jsx(x,{displayMonth:e.displayMonth})]})}function ele(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}var tle=ele()?p.useLayoutEffect:p.useEffect,rj=!1,nle=0;function k2(){return"react-day-picker-".concat(++nle)}function rle(e){var t,n=e??(rj?k2():null),r=p.useState(n),s=r[0],i=r[1];return tle(function(){s===null&&i(k2())},[]),p.useEffect(function(){rj===!1&&(rj=!0)},[]),(t=e??s)!==null&&t!==void 0?t:void 0}function ale(e){var t,n,r=Dn(),s=r.dir,i=r.classNames,o=r.styles,l=r.components,c=Gp().displayMonths,u=rle(r.id?"".concat(r.id,"-").concat(e.displayIndex):void 0),d=r.id?"".concat(r.id,"-grid-").concat(e.displayIndex):void 0,h=[i.month],f=o.month,m=e.displayIndex===0,g=e.displayIndex===c.length-1,v=!m&&!g;s==="rtl"&&(t=[m,g],g=t[0],m=t[1]),m&&(h.push(i.caption_start),f=Tt(Tt({},f),o.caption_start)),g&&(h.push(i.caption_end),f=Tt(Tt({},f),o.caption_end)),v&&(h.push(i.caption_between),f=Tt(Tt({},f),o.caption_between));var y=(n=l==null?void 0:l.Caption)!==null&&n!==void 0?n:uoe;return a.jsxs("div",{className:h.join(" "),style:f,children:[a.jsx(y,{id:u,displayMonth:e.displayMonth,displayIndex:e.displayIndex}),a.jsx(Zoe,{id:d,"aria-labelledby":u,displayMonth:e.displayMonth})]},e.displayIndex)}function sle(e){var t=Dn(),n=t.classNames,r=t.styles;return a.jsx("div",{className:n.months,style:r.months,children:e.children})}function ile(e){var t,n,r=e.initialProps,s=Dn(),i=IC(),o=Gp(),l=p.useState(!1),c=l[0],u=l[1];p.useEffect(function(){s.initialFocus&&i.focusTarget&&(c||(i.focus(i.focusTarget),u(!0)))},[s.initialFocus,c,i.focus,i.focusTarget,i]);var d=[s.classNames.root,s.className];s.numberOfMonths>1&&d.push(s.classNames.multiple_months),s.showWeekNumber&&d.push(s.classNames.with_weeknumber);var h=Tt(Tt({},s.styles.root),s.style),f=Object.keys(r).filter(function(g){return g.startsWith("data-")}).reduce(function(g,v){var y;return Tt(Tt({},g),(y={},y[v]=r[v],y))},{}),m=(n=(t=r.components)===null||t===void 0?void 0:t.Months)!==null&&n!==void 0?n:sle;return a.jsx("div",Tt({className:d.join(" "),style:h,dir:s.dir,id:s.id,nonce:r.nonce,title:r.title,lang:r.lang},f,{children:a.jsx(m,{children:o.displayMonths.map(function(g,v){return a.jsx(ale,{displayIndex:v,displayMonth:g},v)})})}))}function ole(e){var t=e.children,n=Pie(e,["children"]);return a.jsx(Xie,{initialProps:n,children:a.jsx(ioe,{children:a.jsx(Boe,{initialProps:n,children:a.jsx(goe,{initialProps:n,children:a.jsx(xoe,{initialProps:n,children:a.jsx(Coe,{children:a.jsx(Foe,{children:t})})})})})})})}function lle(e){return a.jsx(ole,Tt({},e,{children:a.jsx(ile,{initialProps:e})}))}function Mm({className:e,classNames:t,showOutsideDays:n=!0,...r}){return a.jsx(lle,{showOutsideDays:n,className:Ie("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:Ie(Hd({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:Ie(Hd({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:({...s})=>a.jsx(NN,{className:"h-4 w-4"}),IconRight:({...s})=>a.jsx(Mp,{className:"h-4 w-4"})},...r})}Mm.displayName="Calendar";var Ub="Popover",[dB,jUe]=Mr(Ub,[Kl]),Yp=Kl(),[cle,Yl]=dB(Ub),hB=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!1}=e,l=Yp(t),c=p.useRef(null),[u,d]=p.useState(!1),[h,f]=Ha({prop:r,defaultProp:s??!1,onChange:i,caller:Ub});return a.jsx(lb,{...l,children:a.jsx(cle,{scope:t,contentId:pr(),triggerRef:c,open:h,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(m=>!m),[f]),hasCustomAnchor:u,onCustomAnchorAdd:p.useCallback(()=>d(!0),[]),onCustomAnchorRemove:p.useCallback(()=>d(!1),[]),modal:o,children:n})})};hB.displayName=Ub;var fB="PopoverAnchor",ule=p.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Yl(fB,n),i=Yp(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=s;return p.useEffect(()=>(o(),()=>l()),[o,l]),a.jsx(Lp,{...i,...r,ref:t})});ule.displayName=fB;var mB="PopoverTrigger",pB=p.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Yl(mB,n),i=Yp(n),o=Ot(t,s.triggerRef),l=a.jsx(ot.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":bB(s.open),...r,ref:o,onClick:Ve(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?l:a.jsx(Lp,{asChild:!0,...i,children:l})});pB.displayName=mB;var MC="PopoverPortal",[dle,hle]=dB(MC,{forceMount:void 0}),gB=e=>{const{__scopePopover:t,forceMount:n,children:r,container:s}=e,i=Yl(MC,t);return a.jsx(dle,{scope:t,forceMount:n,children:a.jsx(Cr,{present:n||i.open,children:a.jsx(Sh,{asChild:!0,container:s,children:r})})})};gB.displayName=MC;var Jd="PopoverContent",vB=p.forwardRef((e,t)=>{const n=hle(Jd,e.__scopePopover),{forceMount:r=n.forceMount,...s}=e,i=Yl(Jd,e.__scopePopover);return a.jsx(Cr,{present:r||i.open,children:i.modal?a.jsx(mle,{...s,ref:t}):a.jsx(ple,{...s,ref:t})})});vB.displayName=Jd;var fle=Dl("PopoverContent.RemoveScroll"),mle=p.forwardRef((e,t)=>{const n=Yl(Jd,e.__scopePopover),r=p.useRef(null),s=Ot(t,r),i=p.useRef(!1);return p.useEffect(()=>{const o=r.current;if(o)return Cb(o)},[]),a.jsx(Wp,{as:fle,allowPinchZoom:!0,children:a.jsx(yB,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Ve(e.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=n.triggerRef.current)==null||l.focus()}),onPointerDownOutside:Ve(e.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:Ve(e.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),ple=p.forwardRef((e,t)=>{const n=Yl(Jd,e.__scopePopover),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(yB,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=e.onCloseAutoFocus)==null||o.call(e,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=e.onInteractOutside)==null||c.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),yB=p.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:d,...h}=e,f=Yl(Jd,n),m=Yp(n);return Nb(),a.jsx(zp,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(du,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>f.onOpenChange(!1),children:a.jsx(cb,{"data-state":bB(f.open),role:"dialog",id:f.contentId,...m,...h,ref:t,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),xB="PopoverClose",gle=p.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Yl(xB,n);return a.jsx(ot.button,{type:"button",...r,ref:t,onClick:Ve(e.onClick,()=>s.onOpenChange(!1))})});gle.displayName=xB;var vle="PopoverArrow",yle=p.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=Yp(n);return a.jsx(ub,{...s,...r,ref:t})});yle.displayName=vle;function bB(e){return e?"open":"closed"}var xle=hB,ble=pB,wle=gB,wB=vB;const Ii=xle,Ri=ble,ni=p.forwardRef(({className:e,align:t="center",sideOffset:n=4,...r},s)=>a.jsx(wle,{children:a.jsx(wB,{ref:s,align:t,sideOffset:n,className:Ie("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...r})}));ni.displayName=wB.displayName;function DC(e){const t=p.useRef({value:e,previous:e});return p.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var jle=[" ","Enter","ArrowUp","ArrowDown"],_le=[" ","Enter"],Qc="Select",[Bb,zb,kle]=Pp(Qc),[Mh,_Ue]=Mr(Qc,[kle,Kl]),Wb=Kl(),[Sle,Xl]=Mh(Qc),[Nle,Cle]=Mh(Qc),jB=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:s,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:h,disabled:f,required:m,form:g}=e,v=Wb(t),[y,x]=p.useState(null),[w,b]=p.useState(null),[_,k]=p.useState(!1),j=Ih(u),[S,T]=Ha({prop:r,defaultProp:s??!1,onChange:i,caller:Qc}),[O,A]=Ha({prop:o,defaultProp:l,onChange:c,caller:Qc}),N=p.useRef(null),L=y?g||!!y.closest("form"):!0,[M,B]=p.useState(new Set),$=Array.from(M).map(z=>z.props.value).join(";");return a.jsx(lb,{...v,children:a.jsxs(Sle,{required:m,scope:t,trigger:y,onTriggerChange:x,valueNode:w,onValueNodeChange:b,valueNodeHasChildren:_,onValueNodeHasChildrenChange:k,contentId:pr(),value:O,onValueChange:A,open:S,onOpenChange:T,dir:j,triggerPointerDownPosRef:N,disabled:f,children:[a.jsx(Bb.Provider,{scope:t,children:a.jsx(Nle,{scope:e.__scopeSelect,onNativeOptionAdd:p.useCallback(z=>{B(R=>new Set(R).add(z))},[]),onNativeOptionRemove:p.useCallback(z=>{B(R=>{const C=new Set(R);return C.delete(z),C})},[]),children:n})}),L?a.jsxs(KB,{"aria-hidden":!0,required:m,tabIndex:-1,name:d,autoComplete:h,value:O,onChange:z=>A(z.target.value),disabled:f,form:g,children:[O===void 0?a.jsx("option",{value:""}):null,Array.from(M)]},$):null]})})};jB.displayName=Qc;var _B="SelectTrigger",kB=p.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...s}=e,i=Wb(n),o=Xl(_B,n),l=o.disabled||r,c=Ot(t,o.onTriggerChange),u=zb(n),d=p.useRef("touch"),[h,f,m]=GB(v=>{const y=u().filter(b=>!b.disabled),x=y.find(b=>b.value===o.value),w=YB(y,v,x);w!==void 0&&o.onValueChange(w.value)}),g=v=>{l||(o.onOpenChange(!0),m()),v&&(o.triggerPointerDownPosRef.current={x:Math.round(v.pageX),y:Math.round(v.pageY)})};return a.jsx(Lp,{asChild:!0,...i,children:a.jsx(ot.button,{type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":VB(o.value)?"":void 0,...s,ref:c,onClick:Ve(s.onClick,v=>{v.currentTarget.focus(),d.current!=="mouse"&&g(v)}),onPointerDown:Ve(s.onPointerDown,v=>{d.current=v.pointerType;const y=v.target;y.hasPointerCapture(v.pointerId)&&y.releasePointerCapture(v.pointerId),v.button===0&&v.ctrlKey===!1&&v.pointerType==="mouse"&&(g(v),v.preventDefault())}),onKeyDown:Ve(s.onKeyDown,v=>{const y=h.current!=="";!(v.ctrlKey||v.altKey||v.metaKey)&&v.key.length===1&&f(v.key),!(y&&v.key===" ")&&jle.includes(v.key)&&(g(),v.preventDefault())})})})});kB.displayName=_B;var SB="SelectValue",NB=p.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:o="",...l}=e,c=Xl(SB,n),{onValueNodeHasChildrenChange:u}=c,d=i!==void 0,h=Ot(t,c.onValueNodeChange);return sr(()=>{u(d)},[u,d]),a.jsx(ot.span,{...l,ref:h,style:{pointerEvents:"none"},children:VB(c.value)?a.jsx(a.Fragment,{children:o}):i})});NB.displayName=SB;var Ale="SelectIcon",CB=p.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...s}=e;return a.jsx(ot.span,{"aria-hidden":!0,...s,ref:t,children:r||""})});CB.displayName=Ale;var Ele="SelectPortal",AB=e=>a.jsx(Sh,{asChild:!0,...e});AB.displayName=Ele;var Zc="SelectContent",EB=p.forwardRef((e,t)=>{const n=Xl(Zc,e.__scopeSelect),[r,s]=p.useState();if(sr(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?cu.createPortal(a.jsx(TB,{scope:e.__scopeSelect,children:a.jsx(Bb.Slot,{scope:e.__scopeSelect,children:a.jsx("div",{children:e.children})})}),i):null}return a.jsx(PB,{...e,ref:t})});EB.displayName=Zc;var Hs=10,[TB,Jl]=Mh(Zc),Tle="SelectContentImpl",Ple=Dl("SelectContent.RemoveScroll"),PB=p.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:v,avoidCollisions:y,...x}=e,w=Xl(Zc,n),[b,_]=p.useState(null),[k,j]=p.useState(null),S=Ot(t,K=>_(K)),[T,O]=p.useState(null),[A,N]=p.useState(null),L=zb(n),[M,B]=p.useState(!1),$=p.useRef(!1);p.useEffect(()=>{if(b)return Cb(b)},[b]),Nb();const z=p.useCallback(K=>{const[ie,...H]=L().map(ae=>ae.ref.current),[he]=H.slice(-1),me=document.activeElement;for(const ae of K)if(ae===me||(ae==null||ae.scrollIntoView({block:"nearest"}),ae===ie&&k&&(k.scrollTop=0),ae===he&&k&&(k.scrollTop=k.scrollHeight),ae==null||ae.focus(),document.activeElement!==me))return},[L,k]),R=p.useCallback(()=>z([T,b]),[z,T,b]);p.useEffect(()=>{M&&R()},[M,R]);const{onOpenChange:C,triggerPointerDownPosRef:D}=w;p.useEffect(()=>{if(b){let K={x:0,y:0};const ie=he=>{var me,ae;K={x:Math.abs(Math.round(he.pageX)-(((me=D.current)==null?void 0:me.x)??0)),y:Math.abs(Math.round(he.pageY)-(((ae=D.current)==null?void 0:ae.y)??0))}},H=he=>{K.x<=10&&K.y<=10?he.preventDefault():b.contains(he.target)||C(!1),document.removeEventListener("pointermove",ie),D.current=null};return D.current!==null&&(document.addEventListener("pointermove",ie),document.addEventListener("pointerup",H,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",ie),document.removeEventListener("pointerup",H,{capture:!0})}}},[b,C,D]),p.useEffect(()=>{const K=()=>C(!1);return window.addEventListener("blur",K),window.addEventListener("resize",K),()=>{window.removeEventListener("blur",K),window.removeEventListener("resize",K)}},[C]);const[E,F]=GB(K=>{const ie=L().filter(me=>!me.disabled),H=ie.find(me=>me.ref.current===document.activeElement),he=YB(ie,K,H);he&&setTimeout(()=>he.ref.current.focus())}),I=p.useCallback((K,ie,H)=>{const he=!$.current&&!H;(w.value!==void 0&&w.value===ie||he)&&(O(K),he&&($.current=!0))},[w.value]),P=p.useCallback(()=>b==null?void 0:b.focus(),[b]),U=p.useCallback((K,ie,H)=>{const he=!$.current&&!H;(w.value!==void 0&&w.value===ie||he)&&N(K)},[w.value]),Z=r==="popper"?R1:OB,X=Z===R1?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:v,avoidCollisions:y}:{};return a.jsx(TB,{scope:n,content:b,viewport:k,onViewportChange:j,itemRefCallback:I,selectedItem:T,onItemLeave:P,itemTextRefCallback:U,focusSelectedItem:R,selectedItemText:A,position:r,isPositioned:M,searchRef:E,children:a.jsx(Wp,{as:Ple,allowPinchZoom:!0,children:a.jsx(zp,{asChild:!0,trapped:w.open,onMountAutoFocus:K=>{K.preventDefault()},onUnmountAutoFocus:Ve(s,K=>{var ie;(ie=w.trigger)==null||ie.focus({preventScroll:!0}),K.preventDefault()}),children:a.jsx(du,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:K=>K.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:a.jsx(Z,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:K=>K.preventDefault(),...x,...X,onPlaced:()=>B(!0),ref:S,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Ve(x.onKeyDown,K=>{const ie=K.ctrlKey||K.altKey||K.metaKey;if(K.key==="Tab"&&K.preventDefault(),!ie&&K.key.length===1&&F(K.key),["ArrowUp","ArrowDown","Home","End"].includes(K.key)){let he=L().filter(me=>!me.disabled).map(me=>me.ref.current);if(["ArrowUp","End"].includes(K.key)&&(he=he.slice().reverse()),["ArrowUp","ArrowDown"].includes(K.key)){const me=K.target,ae=he.indexOf(me);he=he.slice(ae+1)}setTimeout(()=>z(he)),K.preventDefault()}})})})})})})});PB.displayName=Tle;var Ole="SelectItemAlignedPosition",OB=p.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...s}=e,i=Xl(Zc,n),o=Jl(Zc,n),[l,c]=p.useState(null),[u,d]=p.useState(null),h=Ot(t,S=>d(S)),f=zb(n),m=p.useRef(!1),g=p.useRef(!0),{viewport:v,selectedItem:y,selectedItemText:x,focusSelectedItem:w}=o,b=p.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&u&&v&&y&&x){const S=i.trigger.getBoundingClientRect(),T=u.getBoundingClientRect(),O=i.valueNode.getBoundingClientRect(),A=x.getBoundingClientRect();if(i.dir!=="rtl"){const me=A.left-T.left,ae=O.left-me,Ne=S.left-ae,de=S.width+Ne,Q=Math.max(de,T.width),fe=window.innerWidth-Hs,Be=P1(ae,[Hs,Math.max(Hs,fe-Q)]);l.style.minWidth=de+"px",l.style.left=Be+"px"}else{const me=T.right-A.right,ae=window.innerWidth-O.right-me,Ne=window.innerWidth-S.right-ae,de=S.width+Ne,Q=Math.max(de,T.width),fe=window.innerWidth-Hs,Be=P1(ae,[Hs,Math.max(Hs,fe-Q)]);l.style.minWidth=de+"px",l.style.right=Be+"px"}const N=f(),L=window.innerHeight-Hs*2,M=v.scrollHeight,B=window.getComputedStyle(u),$=parseInt(B.borderTopWidth,10),z=parseInt(B.paddingTop,10),R=parseInt(B.borderBottomWidth,10),C=parseInt(B.paddingBottom,10),D=$+z+M+C+R,E=Math.min(y.offsetHeight*5,D),F=window.getComputedStyle(v),I=parseInt(F.paddingTop,10),P=parseInt(F.paddingBottom,10),U=S.top+S.height/2-Hs,Z=L-U,X=y.offsetHeight/2,K=y.offsetTop+X,ie=$+z+K,H=D-ie;if(ie<=U){const me=N.length>0&&y===N[N.length-1].ref.current;l.style.bottom="0px";const ae=u.clientHeight-v.offsetTop-v.offsetHeight,Ne=Math.max(Z,X+(me?P:0)+ae+R),de=ie+Ne;l.style.height=de+"px"}else{const me=N.length>0&&y===N[0].ref.current;l.style.top="0px";const Ne=Math.max(U,$+v.offsetTop+(me?I:0)+X)+H;l.style.height=Ne+"px",v.scrollTop=ie-U+v.offsetTop}l.style.margin=`${Hs}px 0`,l.style.minHeight=E+"px",l.style.maxHeight=L+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[f,i.trigger,i.valueNode,l,u,v,y,x,i.dir,r]);sr(()=>b(),[b]);const[_,k]=p.useState();sr(()=>{u&&k(window.getComputedStyle(u).zIndex)},[u]);const j=p.useCallback(S=>{S&&g.current===!0&&(b(),w==null||w(),g.current=!1)},[b,w]);return a.jsx(Rle,{scope:n,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:j,children:a.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:_},children:a.jsx(ot.div,{...s,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});OB.displayName=Ole;var Ile="SelectPopperPosition",R1=p.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=Hs,...i}=e,o=Wb(n);return a.jsx(cb,{...o,...i,ref:t,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});R1.displayName=Ile;var[Rle,LC]=Mh(Zc,{}),M1="SelectViewport",IB=p.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...s}=e,i=Jl(M1,n),o=LC(M1,n),l=Ot(t,i.onViewportChange),c=p.useRef(0);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),a.jsx(Bb.Slot,{scope:n,children:a.jsx(ot.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Ve(s.onScroll,u=>{const d=u.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:f}=o;if(f!=null&&f.current&&h){const m=Math.abs(c.current-d.scrollTop);if(m>0){const g=window.innerHeight-Hs*2,v=parseFloat(h.style.minHeight),y=parseFloat(h.style.height),x=Math.max(v,y);if(x<g){const w=x+m,b=Math.min(g,w),_=w-b;h.style.height=b+"px",h.style.bottom==="0px"&&(d.scrollTop=_>0?_:0,h.style.justifyContent="flex-end")}}}c.current=d.scrollTop})})})]})});IB.displayName=M1;var RB="SelectGroup",[Mle,Dle]=Mh(RB),Lle=p.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=pr();return a.jsx(Mle,{scope:n,id:s,children:a.jsx(ot.div,{role:"group","aria-labelledby":s,...r,ref:t})})});Lle.displayName=RB;var MB="SelectLabel",DB=p.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=Dle(MB,n);return a.jsx(ot.div,{id:s.id,...r,ref:t})});DB.displayName=MB;var Ry="SelectItem",[$le,LB]=Mh(Ry),$B=p.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...o}=e,l=Xl(Ry,n),c=Jl(Ry,n),u=l.value===r,[d,h]=p.useState(i??""),[f,m]=p.useState(!1),g=Ot(t,w=>{var b;return(b=c.itemRefCallback)==null?void 0:b.call(c,w,r,s)}),v=pr(),y=p.useRef("touch"),x=()=>{s||(l.onValueChange(r),l.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return a.jsx($le,{scope:n,value:r,disabled:s,textId:v,isSelected:u,onItemTextChange:p.useCallback(w=>{h(b=>b||((w==null?void 0:w.textContent)??"").trim())},[]),children:a.jsx(Bb.ItemSlot,{scope:n,value:r,disabled:s,textValue:d,children:a.jsx(ot.div,{role:"option","aria-labelledby":v,"data-highlighted":f?"":void 0,"aria-selected":u&&f,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...o,ref:g,onFocus:Ve(o.onFocus,()=>m(!0)),onBlur:Ve(o.onBlur,()=>m(!1)),onClick:Ve(o.onClick,()=>{y.current!=="mouse"&&x()}),onPointerUp:Ve(o.onPointerUp,()=>{y.current==="mouse"&&x()}),onPointerDown:Ve(o.onPointerDown,w=>{y.current=w.pointerType}),onPointerMove:Ve(o.onPointerMove,w=>{var b;y.current=w.pointerType,s?(b=c.onItemLeave)==null||b.call(c):y.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Ve(o.onPointerLeave,w=>{var b;w.currentTarget===document.activeElement&&((b=c.onItemLeave)==null||b.call(c))}),onKeyDown:Ve(o.onKeyDown,w=>{var _;((_=c.searchRef)==null?void 0:_.current)!==""&&w.key===" "||(_le.includes(w.key)&&x(),w.key===" "&&w.preventDefault())})})})})});$B.displayName=Ry;var Of="SelectItemText",FB=p.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,...i}=e,o=Xl(Of,n),l=Jl(Of,n),c=LB(Of,n),u=Cle(Of,n),[d,h]=p.useState(null),f=Ot(t,x=>h(x),c.onItemTextChange,x=>{var w;return(w=l.itemTextRefCallback)==null?void 0:w.call(l,x,c.value,c.disabled)}),m=d==null?void 0:d.textContent,g=p.useMemo(()=>a.jsx("option",{value:c.value,disabled:c.disabled,children:m},c.value),[c.disabled,c.value,m]),{onNativeOptionAdd:v,onNativeOptionRemove:y}=u;return sr(()=>(v(g),()=>y(g)),[v,y,g]),a.jsxs(a.Fragment,{children:[a.jsx(ot.span,{id:c.textId,...i,ref:f}),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?cu.createPortal(i.children,o.valueNode):null]})});FB.displayName=Of;var UB="SelectItemIndicator",BB=p.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return LB(UB,n).isSelected?a.jsx(ot.span,{"aria-hidden":!0,...r,ref:t}):null});BB.displayName=UB;var D1="SelectScrollUpButton",zB=p.forwardRef((e,t)=>{const n=Jl(D1,e.__scopeSelect),r=LC(D1,e.__scopeSelect),[s,i]=p.useState(!1),o=Ot(t,r.onScrollButtonChange);return sr(()=>{if(n.viewport&&n.isPositioned){let l=function(){const u=c.scrollTop>0;i(u)};const c=n.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[n.viewport,n.isPositioned]),s?a.jsx(qB,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});zB.displayName=D1;var L1="SelectScrollDownButton",WB=p.forwardRef((e,t)=>{const n=Jl(L1,e.__scopeSelect),r=LC(L1,e.__scopeSelect),[s,i]=p.useState(!1),o=Ot(t,r.onScrollButtonChange);return sr(()=>{if(n.viewport&&n.isPositioned){let l=function(){const u=c.scrollHeight-c.clientHeight,d=Math.ceil(c.scrollTop)<u;i(d)};const c=n.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[n.viewport,n.isPositioned]),s?a.jsx(qB,{...e,ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});WB.displayName=L1;var qB=p.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=e,i=Jl("SelectScrollButton",n),o=p.useRef(null),l=zb(n),c=p.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),sr(()=>{var d;const u=l().find(h=>h.ref.current===document.activeElement);(d=u==null?void 0:u.ref.current)==null||d.scrollIntoView({block:"nearest"})},[l]),a.jsx(ot.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Ve(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:Ve(s.onPointerMove,()=>{var u;(u=i.onItemLeave)==null||u.call(i),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:Ve(s.onPointerLeave,()=>{c()})})}),Fle="SelectSeparator",HB=p.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return a.jsx(ot.div,{"aria-hidden":!0,...r,ref:t})});HB.displayName=Fle;var $1="SelectArrow",Ule=p.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=Wb(n),i=Xl($1,n),o=Jl($1,n);return i.open&&o.position==="popper"?a.jsx(ub,{...s,...r,ref:t}):null});Ule.displayName=$1;var Ble="SelectBubbleInput",KB=p.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const s=p.useRef(null),i=Ot(r,s),o=DC(t);return p.useEffect(()=>{const l=s.current;if(!l)return;const c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==t&&d){const h=new Event("change",{bubbles:!0});d.call(l,t),l.dispatchEvent(h)}},[o,t]),a.jsx(ot.select,{...n,style:{...i4,...n.style},ref:i,defaultValue:t})});KB.displayName=Ble;function VB(e){return e===""||e===void 0}function GB(e){const t=ar(e),n=p.useRef(""),r=p.useRef(0),s=p.useCallback(o=>{const l=n.current+o;t(l),function c(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(l)},[t]),i=p.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function YB(e,t,n){const s=t.length>1&&Array.from(t).every(u=>u===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let o=zle(e,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function zle(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var Wle=jB,XB=kB,qle=NB,Hle=CB,Kle=AB,JB=EB,Vle=IB,QB=DB,ZB=$B,Gle=FB,Yle=BB,e6=zB,t6=WB,n6=HB;const tn=Wle,Gt=qle,Jt=p.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(XB,{ref:r,className:Ie("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...n,children:[t,a.jsx(Hle,{asChild:!0,children:a.jsx(Ma,{className:"h-4 w-4 opacity-50"})})]}));Jt.displayName=XB.displayName;const r6=p.forwardRef(({className:e,...t},n)=>a.jsx(e6,{ref:n,className:Ie("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(T4,{className:"h-4 w-4"})}));r6.displayName=e6.displayName;const a6=p.forwardRef(({className:e,...t},n)=>a.jsx(t6,{ref:n,className:Ie("flex cursor-default items-center justify-center py-1",e),...t,children:a.jsx(Ma,{className:"h-4 w-4"})}));a6.displayName=t6.displayName;const Qt=p.forwardRef(({className:e,children:t,position:n="popper",...r},s)=>a.jsx(Kle,{children:a.jsxs(JB,{ref:s,className:Ie("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[a.jsx(r6,{}),a.jsx(Vle,{className:Ie("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),a.jsx(a6,{})]})}));Qt.displayName=JB.displayName;const Xle=p.forwardRef(({className:e,...t},n)=>a.jsx(QB,{ref:n,className:Ie("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));Xle.displayName=QB.displayName;const st=p.forwardRef(({className:e,children:t,...n},r)=>a.jsxs(ZB,{ref:r,className:Ie("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(Yle,{children:a.jsx(SN,{className:"h-4 w-4"})})}),a.jsx(Gle,{children:t})]}));st.displayName=ZB.displayName;const Jle=p.forwardRef(({className:e,...t},n)=>a.jsx(n6,{ref:n,className:Ie("-mx-1 my-1 h-px bg-muted",e),...t}));Jle.displayName=n6.displayName;var S2=1,Qle=.9,Zle=.8,ece=.17,aj=.1,sj=.999,tce=.9999,nce=.99,rce=/[\\\/_+.#"@\[\(\{&]/,ace=/[\\\/_+.#"@\[\(\{&]/g,sce=/[\s-]/,s6=/[\s-]/g;function F1(e,t,n,r,s,i,o){if(i===t.length)return s===e.length?S2:nce;var l=`${s},${i}`;if(o[l]!==void 0)return o[l];for(var c=r.charAt(i),u=n.indexOf(c,s),d=0,h,f,m,g;u>=0;)h=F1(e,t,n,r,u+1,i+1,o),h>d&&(u===s?h*=S2:rce.test(e.charAt(u-1))?(h*=Zle,m=e.slice(s,u-1).match(ace),m&&s>0&&(h*=Math.pow(sj,m.length))):sce.test(e.charAt(u-1))?(h*=Qle,g=e.slice(s,u-1).match(s6),g&&s>0&&(h*=Math.pow(sj,g.length))):(h*=ece,s>0&&(h*=Math.pow(sj,u-s))),e.charAt(u)!==t.charAt(i)&&(h*=tce)),(h<aj&&n.charAt(u-1)===r.charAt(i+1)||r.charAt(i+1)===r.charAt(i)&&n.charAt(u-1)!==r.charAt(i))&&(f=F1(e,t,n,r,u+1,i+2,o),f*aj>h&&(h=f*aj)),h>d&&(d=h),u=n.indexOf(c,u+1);return o[l]=d,d}function N2(e){return e.toLowerCase().replace(s6," ")}function ice(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,F1(e,t,N2(e),N2(t),0,0,{})}var df='[cmdk-group=""]',ij='[cmdk-group-items=""]',oce='[cmdk-group-heading=""]',i6='[cmdk-item=""]',C2=`${i6}:not([aria-disabled="true"])`,U1="cmdk-item-select",qu="data-value",lce=(e,t,n)=>ice(e,t,n),o6=p.createContext(void 0),Xp=()=>p.useContext(o6),l6=p.createContext(void 0),$C=()=>p.useContext(l6),c6=p.createContext(void 0),u6=p.forwardRef((e,t)=>{let n=Hu(()=>{var I,P;return{search:"",value:(P=(I=e.value)!=null?I:e.defaultValue)!=null?P:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=Hu(()=>new Set),s=Hu(()=>new Map),i=Hu(()=>new Map),o=Hu(()=>new Set),l=d6(e),{label:c,children:u,value:d,onValueChange:h,filter:f,shouldFilter:m,loop:g,disablePointerSelection:v=!1,vimBindings:y=!0,...x}=e,w=pr(),b=pr(),_=pr(),k=p.useRef(null),j=xce();eu(()=>{if(d!==void 0){let I=d.trim();n.current.value=I,S.emit()}},[d]),eu(()=>{j(6,M)},[]);let S=p.useMemo(()=>({subscribe:I=>(o.current.add(I),()=>o.current.delete(I)),snapshot:()=>n.current,setState:(I,P,U)=>{var Z,X,K,ie;if(!Object.is(n.current[I],P)){if(n.current[I]=P,I==="search")L(),A(),j(1,N);else if(I==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let H=document.getElementById(_);H?H.focus():(Z=document.getElementById(w))==null||Z.focus()}if(j(7,()=>{var H;n.current.selectedItemId=(H=B())==null?void 0:H.id,S.emit()}),U||j(5,M),((X=l.current)==null?void 0:X.value)!==void 0){let H=P??"";(ie=(K=l.current).onValueChange)==null||ie.call(K,H);return}}S.emit()}},emit:()=>{o.current.forEach(I=>I())}}),[]),T=p.useMemo(()=>({value:(I,P,U)=>{var Z;P!==((Z=i.current.get(I))==null?void 0:Z.value)&&(i.current.set(I,{value:P,keywords:U}),n.current.filtered.items.set(I,O(P,U)),j(2,()=>{A(),S.emit()}))},item:(I,P)=>(r.current.add(I),P&&(s.current.has(P)?s.current.get(P).add(I):s.current.set(P,new Set([I]))),j(3,()=>{L(),A(),n.current.value||N(),S.emit()}),()=>{i.current.delete(I),r.current.delete(I),n.current.filtered.items.delete(I);let U=B();j(4,()=>{L(),(U==null?void 0:U.getAttribute("id"))===I&&N(),S.emit()})}),group:I=>(s.current.has(I)||s.current.set(I,new Set),()=>{i.current.delete(I),s.current.delete(I)}),filter:()=>l.current.shouldFilter,label:c||e["aria-label"],getDisablePointerSelection:()=>l.current.disablePointerSelection,listId:w,inputId:_,labelId:b,listInnerRef:k}),[]);function O(I,P){var U,Z;let X=(Z=(U=l.current)==null?void 0:U.filter)!=null?Z:lce;return I?X(I,n.current.search,P):0}function A(){if(!n.current.search||l.current.shouldFilter===!1)return;let I=n.current.filtered.items,P=[];n.current.filtered.groups.forEach(Z=>{let X=s.current.get(Z),K=0;X.forEach(ie=>{let H=I.get(ie);K=Math.max(H,K)}),P.push([Z,K])});let U=k.current;$().sort((Z,X)=>{var K,ie;let H=Z.getAttribute("id"),he=X.getAttribute("id");return((K=I.get(he))!=null?K:0)-((ie=I.get(H))!=null?ie:0)}).forEach(Z=>{let X=Z.closest(ij);X?X.appendChild(Z.parentElement===X?Z:Z.closest(`${ij} > *`)):U.appendChild(Z.parentElement===U?Z:Z.closest(`${ij} > *`))}),P.sort((Z,X)=>X[1]-Z[1]).forEach(Z=>{var X;let K=(X=k.current)==null?void 0:X.querySelector(`${df}[${qu}="${encodeURIComponent(Z[0])}"]`);K==null||K.parentElement.appendChild(K)})}function N(){let I=$().find(U=>U.getAttribute("aria-disabled")!=="true"),P=I==null?void 0:I.getAttribute(qu);S.setState("value",P||void 0)}function L(){var I,P,U,Z;if(!n.current.search||l.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let X=0;for(let K of r.current){let ie=(P=(I=i.current.get(K))==null?void 0:I.value)!=null?P:"",H=(Z=(U=i.current.get(K))==null?void 0:U.keywords)!=null?Z:[],he=O(ie,H);n.current.filtered.items.set(K,he),he>0&&X++}for(let[K,ie]of s.current)for(let H of ie)if(n.current.filtered.items.get(H)>0){n.current.filtered.groups.add(K);break}n.current.filtered.count=X}function M(){var I,P,U;let Z=B();Z&&(((I=Z.parentElement)==null?void 0:I.firstChild)===Z&&((U=(P=Z.closest(df))==null?void 0:P.querySelector(oce))==null||U.scrollIntoView({block:"nearest"})),Z.scrollIntoView({block:"nearest"}))}function B(){var I;return(I=k.current)==null?void 0:I.querySelector(`${i6}[aria-selected="true"]`)}function $(){var I;return Array.from(((I=k.current)==null?void 0:I.querySelectorAll(C2))||[])}function z(I){let P=$()[I];P&&S.setState("value",P.getAttribute(qu))}function R(I){var P;let U=B(),Z=$(),X=Z.findIndex(ie=>ie===U),K=Z[X+I];(P=l.current)!=null&&P.loop&&(K=X+I<0?Z[Z.length-1]:X+I===Z.length?Z[0]:Z[X+I]),K&&S.setState("value",K.getAttribute(qu))}function C(I){let P=B(),U=P==null?void 0:P.closest(df),Z;for(;U&&!Z;)U=I>0?vce(U,df):yce(U,df),Z=U==null?void 0:U.querySelector(C2);Z?S.setState("value",Z.getAttribute(qu)):R(I)}let D=()=>z($().length-1),E=I=>{I.preventDefault(),I.metaKey?D():I.altKey?C(1):R(1)},F=I=>{I.preventDefault(),I.metaKey?z(0):I.altKey?C(-1):R(-1)};return p.createElement(ot.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:I=>{var P;(P=x.onKeyDown)==null||P.call(x,I);let U=I.nativeEvent.isComposing||I.keyCode===229;if(!(I.defaultPrevented||U))switch(I.key){case"n":case"j":{y&&I.ctrlKey&&E(I);break}case"ArrowDown":{E(I);break}case"p":case"k":{y&&I.ctrlKey&&F(I);break}case"ArrowUp":{F(I);break}case"Home":{I.preventDefault(),z(0);break}case"End":{I.preventDefault(),D();break}case"Enter":{I.preventDefault();let Z=B();if(Z){let X=new Event(U1);Z.dispatchEvent(X)}}}}},p.createElement("label",{"cmdk-label":"",htmlFor:T.inputId,id:T.labelId,style:wce},c),qb(e,I=>p.createElement(l6.Provider,{value:S},p.createElement(o6.Provider,{value:T},I))))}),cce=p.forwardRef((e,t)=>{var n,r;let s=pr(),i=p.useRef(null),o=p.useContext(c6),l=Xp(),c=d6(e),u=(r=(n=c.current)==null?void 0:n.forceMount)!=null?r:o==null?void 0:o.forceMount;eu(()=>{if(!u)return l.item(s,o==null?void 0:o.id)},[u]);let d=h6(s,i,[e.value,e.children,i],e.keywords),h=$C(),f=Bl(j=>j.value&&j.value===d.current),m=Bl(j=>u||l.filter()===!1?!0:j.search?j.filtered.items.get(s)>0:!0);p.useEffect(()=>{let j=i.current;if(!(!j||e.disabled))return j.addEventListener(U1,g),()=>j.removeEventListener(U1,g)},[m,e.onSelect,e.disabled]);function g(){var j,S;v(),(S=(j=c.current).onSelect)==null||S.call(j,d.current)}function v(){h.setState("value",d.current,!0)}if(!m)return null;let{disabled:y,value:x,onSelect:w,forceMount:b,keywords:_,...k}=e;return p.createElement(ot.div,{ref:Eo(i,t),...k,id:s,"cmdk-item":"",role:"option","aria-disabled":!!y,"aria-selected":!!f,"data-disabled":!!y,"data-selected":!!f,onPointerMove:y||l.getDisablePointerSelection()?void 0:v,onClick:y?void 0:g},e.children)}),uce=p.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:s,...i}=e,o=pr(),l=p.useRef(null),c=p.useRef(null),u=pr(),d=Xp(),h=Bl(m=>s||d.filter()===!1?!0:m.search?m.filtered.groups.has(o):!0);eu(()=>d.group(o),[]),h6(o,l,[e.value,e.heading,c]);let f=p.useMemo(()=>({id:o,forceMount:s}),[s]);return p.createElement(ot.div,{ref:Eo(l,t),...i,"cmdk-group":"",role:"presentation",hidden:h?void 0:!0},n&&p.createElement("div",{ref:c,"cmdk-group-heading":"","aria-hidden":!0,id:u},n),qb(e,m=>p.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?u:void 0},p.createElement(c6.Provider,{value:f},m))))}),dce=p.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,s=p.useRef(null),i=Bl(o=>!o.search);return!n&&!i?null:p.createElement(ot.div,{ref:Eo(s,t),...r,"cmdk-separator":"",role:"separator"})}),hce=p.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,s=e.value!=null,i=$C(),o=Bl(u=>u.search),l=Bl(u=>u.selectedItemId),c=Xp();return p.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),p.createElement(ot.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":c.listId,"aria-labelledby":c.labelId,"aria-activedescendant":l,id:c.inputId,type:"text",value:s?e.value:o,onChange:u=>{s||i.setState("search",u.target.value),n==null||n(u.target.value)}})}),fce=p.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...s}=e,i=p.useRef(null),o=p.useRef(null),l=Bl(u=>u.selectedItemId),c=Xp();return p.useEffect(()=>{if(o.current&&i.current){let u=o.current,d=i.current,h,f=new ResizeObserver(()=>{h=requestAnimationFrame(()=>{let m=u.offsetHeight;d.style.setProperty("--cmdk-list-height",m.toFixed(1)+"px")})});return f.observe(u),()=>{cancelAnimationFrame(h),f.unobserve(u)}}},[]),p.createElement(ot.div,{ref:Eo(i,t),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":l,"aria-label":r,id:c.listId},qb(e,u=>p.createElement("div",{ref:Eo(o,c.listInnerRef),"cmdk-list-sizer":""},u)))}),mce=p.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:s,contentClassName:i,container:o,...l}=e;return p.createElement(hC,{open:n,onOpenChange:r},p.createElement(fC,{container:o},p.createElement(Ib,{"cmdk-overlay":"",className:s}),p.createElement(Rb,{"aria-label":e.label,"cmdk-dialog":"",className:i},p.createElement(u6,{ref:t,...l}))))}),pce=p.forwardRef((e,t)=>Bl(n=>n.filtered.count===0)?p.createElement(ot.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),gce=p.forwardRef((e,t)=>{let{progress:n,children:r,label:s="Loading...",...i}=e;return p.createElement(ot.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},qb(e,o=>p.createElement("div",{"aria-hidden":!0},o)))}),Ga=Object.assign(u6,{List:fce,Item:cce,Input:hce,Group:uce,Separator:dce,Dialog:mce,Empty:pce,Loading:gce});function vce(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function yce(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function d6(e){let t=p.useRef(e);return eu(()=>{t.current=e}),t}var eu=typeof window>"u"?p.useEffect:p.useLayoutEffect;function Hu(e){let t=p.useRef();return t.current===void 0&&(t.current=e()),t}function Bl(e){let t=$C(),n=()=>e(t.snapshot());return p.useSyncExternalStore(t.subscribe,n,n)}function h6(e,t,n,r=[]){let s=p.useRef(),i=Xp();return eu(()=>{var o;let l=(()=>{var u;for(let d of n){if(typeof d=="string")return d.trim();if(typeof d=="object"&&"current"in d)return d.current?(u=d.current.textContent)==null?void 0:u.trim():s.current}})(),c=r.map(u=>u.trim());i.value(e,l,c),(o=t.current)==null||o.setAttribute(qu,l),s.current=l}),s}var xce=()=>{let[e,t]=p.useState(),n=Hu(()=>new Map);return eu(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,s)=>{n.current.set(r,s),t({})}};function bce(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function qb({asChild:e,children:t},n){return e&&p.isValidElement(t)?p.cloneElement(bce(t),{ref:t.ref},n(t.props.children)):n(t)}var wce={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Dm=p.forwardRef(({className:e,...t},n)=>a.jsx(Ga,{ref:n,className:Ie("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",e),...t}));Dm.displayName=Ga.displayName;const Lm=p.forwardRef(({className:e,...t},n)=>a.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[a.jsx(oi,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),a.jsx(Ga.Input,{ref:n,className:Ie("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",e),...t})]}));Lm.displayName=Ga.Input.displayName;const f6=p.forwardRef(({className:e,...t},n)=>a.jsx(Ga.List,{ref:n,className:Ie("max-h-[300px] overflow-y-auto overflow-x-hidden",e),...t}));f6.displayName=Ga.List.displayName;const $m=p.forwardRef((e,t)=>a.jsx(Ga.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));$m.displayName=Ga.Empty.displayName;const Fm=p.forwardRef(({className:e,...t},n)=>a.jsx(Ga.Group,{ref:n,className:Ie("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",e),...t}));Fm.displayName=Ga.Group.displayName;const jce=p.forwardRef(({className:e,...t},n)=>a.jsx(Ga.Separator,{ref:n,className:Ie("-mx-1 h-px bg-border",e),...t}));jce.displayName=Ga.Separator.displayName;const Um=p.forwardRef(({className:e,...t},n)=>a.jsx(Ga.Item,{ref:n,className:Ie("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",e),...t}));Um.displayName=Ga.Item.displayName;let oj=!1,lj=null;function Qd(){return oj?Promise.resolve():(lj||(lj=le.auth.getSession().then(()=>{oj=!0}).catch(()=>{oj=!0})),lj)}const Ql=()=>{const[e,t]=p.useState([]),[n,r]=p.useState(!0),[s,i]=p.useState(null);let o=!1;const l=b=>{o=b},c=()=>{try{const b=localStorage.getItem("app.cachedAgents");if(!b)return!1;const _=JSON.parse(b);if(Array.isArray(_))return t(_),!0}catch{}return!1},u=b=>{const _=(b==null?void 0:b.filter(k=>k!=null))||[];return _.includes("master_agent")?"master_agent":_.includes("super_agent")?"super_agent":_.includes("agent")?"agent":null},d=6e4;globalThis.__agentsCache||(globalThis.__agentsCache={data:null,ts:0,inFlight:null});const h=globalThis.__agentsCache,f=b=>(b||[]).map(_=>{var S;const k=((S=_.roles)==null?void 0:S.filter(T=>T!=null))||[],j=u(_.roles||[]);return{user_id:_.id,email:_.email,display_name:_.display_name,avatar_url:_.avatar_url,timezone:_.timezone,created_at:_.created_at,roles:k,primaryRole:j,status:"Active",super_agent_id:null,last_seen_at:null}}),m=async()=>(h.inFlight||(h.inFlight=(async()=>{await Qd();const{data:b,error:_}=await le.from("v_users").select("*").order("created_at",{ascending:!1});if(_)throw _;let k=f(b||[]);try{const{data:j}=await le.from("super_agent_members").select("agent_user_id, super_agent_id");if(j&&Array.isArray(j)){const T={};j.forEach(O=>{T[O.agent_user_id]=O.super_agent_id}),k=k.map(O=>O.primaryRole==="agent"?{...O,super_agent_id:T[O.user_id]||null}:O)}const{data:S}=await le.from("users_profile").select("user_id, last_seen_at");if(S){const T={};S.forEach(O=>{T[O.user_id]=O.last_seen_at}),k=k.map(O=>({...O,last_seen_at:T[O.user_id]||null}))}}catch{}h.data=k,h.ts=Date.now(),h.inFlight=null;try{localStorage.setItem("app.cachedAgents",JSON.stringify(k))}catch{}return k})().catch(b=>{throw h.inFlight=null,b})),h.inFlight),g=async()=>{if(h.data&&Date.now()-h.ts<d&&h.data){try{const{data:_}=await le.from("users_profile").select("user_id, last_seen_at");if(_){const k={};_.forEach(j=>{k[j.user_id]=j.last_seen_at}),h.data=h.data.map(j=>({...j,last_seen_at:k[j.user_id]||null}))}}catch(_){console.warn("Background presence refresh failed",_)}return h.data}return await m()},v=async b=>{try{r(!0),i(null),b!=null&&b.force&&(h.ts=0);const _=await g();t(_)}catch(_){console.error("Error fetching human agents:",_),i("Failed to fetch human agents"),t([])}finally{r(!1)}},y=async b=>{var _,k;try{i(null);const j=b.email.trim().toLowerCase();if(b.role==="agent"&&!b.super_agent_id)throw new Error("Agents must be assigned to a super agent before they can be created.");const{data:S,error:T}=await le.from("v_human_agents").select("user_id, confirmation_status").ilike("email",j).maybeSingle();if(T)throw T;if(S){const L=(()=>{switch(S.confirmation_status){case"accepted":return"assigned to an active member";case"waiting":return"pending for an existing invite";case"expired":return"associated with an expired invite";default:return"in use"}})();throw new Error(`The email ${j} is already ${L}. Choose a different email or manage the existing user instead.`)}const{data:O,error:A}=await le.functions.invoke("admin-create-user",{headers:{"x-client-origin":typeof window<"u"?window.location.origin:""},body:{email:j,full_name:b.full_name,role:b.role,super_agent_id:b.super_agent_id??null,org_id:b.org_id??null}});if(A)throw A;try{const L=(O==null?void 0:O.id)||(O==null?void 0:O.user_id)||((_=O==null?void 0:O.user)==null?void 0:_.id)||null;L&&await le.from("users_profile").update({is_2fa_email_enabled:o}).eq("user_id",L)}catch{}await v({force:!0});try{await en({action:"user.create",resource:"user",resourceId:(O==null?void 0:O.id)||null,context:b})}catch{}return{id:(O==null?void 0:O.id)||(O==null?void 0:O.user_id)||((k=O==null?void 0:O.user)==null?void 0:k.id)||null}}catch(j){throw console.error("Error creating agent:",j),i(j instanceof Error?j.message:"Failed to create agent"),j}},x=async(b,_)=>{try{i(null);const{data:k,error:j}=await le.from("roles").select("id").eq("name",_).single();if(j)throw j;const{error:S}=await le.from("user_roles").delete().eq("user_id",b);if(S)throw S;const{error:T}=await le.from("user_roles").insert([{user_id:b,role_id:k.id}]);if(T)throw T;await v({force:!0});try{await en({action:"user.update_role",resource:"user",resourceId:b,context:{role:_}})}catch{}}catch(k){throw console.error("Error updating agent role:",k),i(k instanceof Error?k.message:"Failed to update agent role"),k}},w=async b=>{try{i(null);const{data:_,error:k}=await le.from("v_human_agents").select("role_name").eq("user_id",b).maybeSingle();if(k)throw k;if(_!=null&&_.role_name&&String(_.role_name).toLowerCase().includes("master"))throw new Error("Master agent tidak dapat dihapus.");const{error:j}=await le.functions.invoke("admin-delete-user",{body:{user_id:b}});if(j)throw j;await v({force:!0});try{await en({action:"user.delete",resource:"user",resourceId:b})}catch{}}catch(_){throw console.error("Error deleting agent:",_),i(_ instanceof Error?_.message:"Failed to delete agent"),_}};return p.useEffect(()=>{c()&&r(!1),v()},[]),{agents:e,teams:[],loading:n,error:s,fetchAgents:v,fetchTeams:()=>Promise.resolve(),createAgent:y,updateAgentStatus:()=>Promise.resolve(),updateAgentRole:x,deleteAgent:w,createTeam:()=>Promise.resolve(),addAgentToTeam:()=>Promise.resolve(),removeAgentFromTeam:()=>Promise.resolve(),setEnable2FAFlagForCreate:l}},_ce=({value:e,onFilterChange:t})=>{var k,j,S,T;const[n,r]=p.useState(!1),[s,i]=p.useState(),[o,l]=p.useState(),[c,u]=p.useState(!1),[d,h]=p.useState(!1),[f,m]=p.useState([]),[g,v]=p.useState({dateRange:{},label:[],agent:"",status:"",resolvedBy:"",platformId:"",channelType:"all"}),{agents:y}=Ql();p.useEffect(()=>{e&&(v(O=>({...O,...e,dateRange:e.dateRange??O.dateRange})),e.dateRange&&(i(e.dateRange.from),l(e.dateRange.to)))},[n,e==null?void 0:e.agent,e==null?void 0:e.status,e==null?void 0:e.resolvedBy,e==null?void 0:e.platformId,e==null?void 0:e.channelType,(k=e==null?void 0:e.dateRange)!=null&&k.from?e.dateRange.from.getTime():0,(j=e==null?void 0:e.dateRange)!=null&&j.to?e.dateRange.to.getTime():0]),p.useEffect(()=>{let O=!0;return(async()=>{try{const{data:N,error:L}=await kt.from("channels").select("id, display_name, provider, type").order("created_at",{ascending:!1});if(!O)return;if(L)throw L;m(N||[])}catch{if(!O)return;m([])}})(),()=>{O=!1}},[]);const x=(O,A)=>{const N={...g,[O]:A};v(N)},w=O=>{v(A=>({...A,channelType:O,platformId:""}))},b=()=>{const O={...g,dateRange:{from:s,to:o}};t(O),r(!1)},_=()=>{const O={dateRange:{},label:[],agent:"",status:"",resolvedBy:"",platformId:"",channelType:"all"};v(O),i(void 0),l(void 0),t(O)};return a.jsxs(xn,{open:n,onOpenChange:r,children:[a.jsx(vC,{asChild:!0,children:a.jsx(se,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0",children:a.jsx(M4,{className:"h-4 w-4"})})}),a.jsxs(un,{className:"sm:max-w-[800px] max-h-[80vh] overflow-y-auto",children:[a.jsx(dn,{children:a.jsx(hn,{children:"Filter"})}),a.jsxs("div",{className:"grid gap-6 py-4",children:[a.jsx("div",{className:"grid grid-cols-1 gap-4",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Date Range"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(Ii,{children:[a.jsx(Ri,{asChild:!0,children:a.jsxs(se,{variant:"outline",className:Ie("w-full justify-start text-left font-normal",!s&&"text-muted-foreground"),children:[a.jsx(Hc,{className:"mr-2 h-4 w-4"}),s?Io(s,"dd-MM-yyyy"):"DD-MM-YYYY"]})}),a.jsx(ni,{className:"w-auto p-0",align:"start",children:a.jsx(Mm,{mode:"single",selected:s,onSelect:i,initialFocus:!0,className:"pointer-events-auto"})})]}),a.jsx("span",{className:"self-center text-muted-foreground",children:"-"}),a.jsxs(Ii,{children:[a.jsx(Ri,{asChild:!0,children:a.jsxs(se,{variant:"outline",className:Ie("w-full justify-start text-left font-normal",!o&&"text-muted-foreground"),children:[a.jsx(Hc,{className:"mr-2 h-4 w-4"}),o?Io(o,"dd-MM-yyyy"):"DD-MM-YYYY"]})}),a.jsx(ni,{className:"w-auto p-0",align:"start",children:a.jsx(Mm,{mode:"single",selected:o,onSelect:l,initialFocus:!0,className:"pointer-events-auto"})})]})]})]})}),a.jsx("div",{className:"grid grid-cols-1 gap-4",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Resolved By"}),a.jsxs(Ii,{open:d,onOpenChange:h,children:[a.jsx(Ri,{asChild:!0,children:a.jsx(se,{variant:"outline",role:"combobox",className:"w-full justify-between",children:((S=y.find(O=>O.user_id===g.resolvedBy))==null?void 0:S.display_name)||"Choose Agent"})}),a.jsx(ni,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",sideOffset:4,children:a.jsxs(Dm,{children:[a.jsx(Lm,{placeholder:"Search Resolved By Agent"}),a.jsx($m,{children:"No agent found."}),a.jsx(Fm,{children:y.map(O=>a.jsx(Um,{onSelect:()=>{x("resolvedBy",O.user_id),h(!1)},children:a.jsx("span",{className:"ml-2",children:O.display_name||"Unknown"})},O.user_id))})]})})]})]})}),a.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Agent"}),a.jsxs(Ii,{open:c,onOpenChange:u,children:[a.jsx(Ri,{asChild:!0,children:a.jsx(se,{variant:"outline",role:"combobox",className:"w-full justify-between",children:((T=y.find(O=>O.user_id===g.agent))==null?void 0:T.display_name)||"Choose Agent"})}),a.jsx(ni,{className:"w-[--radix-popover-trigger-width] p-0",align:"start",sideOffset:4,children:a.jsxs(Dm,{children:[a.jsx(Lm,{placeholder:"Search Handled By Agent"}),a.jsx($m,{children:"No agent found."}),a.jsx(Fm,{children:y.map(O=>a.jsx(Um,{onSelect:()=>{x("agent",O.user_id),u(!1)},children:a.jsx("span",{className:"ml-2",children:O.display_name||"Unknown"})},O.user_id))})]})})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Channel Type"}),a.jsxs(tn,{value:g.channelType,onValueChange:w,children:[a.jsx(Jt,{children:a.jsx(Gt,{placeholder:"All Channels"})}),a.jsxs(Qt,{children:[a.jsx(st,{value:"all",children:"All Channels"}),a.jsx(st,{value:"whatsapp",children:"WhatsApp"}),a.jsx(st,{value:"telegram",children:"Telegram"}),a.jsx(st,{value:"web",children:"Live Chat"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Platform"}),a.jsxs(tn,{value:g.platformId,onValueChange:O=>x("platformId",O),disabled:!g.channelType||g.channelType==="all",children:[a.jsx(Jt,{children:a.jsx(Gt,{placeholder:g.channelType&&g.channelType!=="all"?"Choose Platform":"Select channel type first"})}),a.jsxs(Qt,{children:[a.jsx(st,{value:"all",children:"All Platforms"}),(()=>{const O=g.channelType&&g.channelType!=="all"?f.filter(A=>String(A.provider||"").toLowerCase()===String(g.channelType).toLowerCase()):[];return!g.channelType||g.channelType==="all"?null:O.length===0?a.jsx(st,{value:"__none",disabled:!0,children:"No platforms found for this channel type"}):O.map(A=>a.jsx(st,{value:A.id,children:A.display_name??"Unknown"},A.id))})()]})]})]})]}),a.jsx("div",{className:"grid grid-cols-2 gap-4",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),a.jsxs(tn,{value:g.status,onValueChange:O=>x("status",O),children:[a.jsx(Jt,{children:a.jsx(Gt,{placeholder:"All Statuses"})}),a.jsxs(Qt,{children:[a.jsx(st,{value:"all",children:"All Statuses"}),a.jsx(st,{value:"open",children:"Open"}),a.jsx(st,{value:"pending",children:"Pending"}),a.jsx(st,{value:"closed",children:"Closed"})]})]})]})})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx(se,{variant:"outline",onClick:_,children:"Reset"}),a.jsx(se,{onClick:b,children:"Apply"})]})]})]})},kce={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_HCAPTCHA_SITEKEY:"30583a2e-84ac-496a-8ec2-23043ae06dc0",VITE_SUPABASE_PROJECT_ID:"bkynymyhbfrhvwxqqttk",VITE_SUPABASE_PUBLISHABLE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJreW55bXloYmZyaHZ3eHFxdHRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5Mzk1NzIsImV4cCI6MjA3OTUxNTU3Mn0.4ELI9s6908SdW2jd1BM_ht8pTIyLAwPpsqGiGNCdcC0",VITE_SUPABASE_URL:"https://bkynymyhbfrhvwxqqttk.supabase.co",VITE_WEBHOOK_BASE_URL:"https://primary-production-376c.up.railway.app/webhook"},wo=kce??{},Ru=((wo==null?void 0:wo.VITE_WEBHOOK_BASE_URL)||"https://primary-production-376c.up.railway.app/webhook").replace(/\/$/,""),Sce=(wo==null?void 0:wo.VITE_WEBHOOK_PROXY_SLUG)||"proxy-n8n",A2=wo==null?void 0:wo.VITE_WEBHOOK_PROXY_BASE_URL,Nce=A2?A2.replace(/\/$/,""):`${Oo}/functions/v1/${Sce}`.replace(/\/$/,""),cj=Nce,Ur="route:",E2=e=>e.startsWith("/")?e:`/${e}`,Bv=e=>e.startsWith(Ur),uj=e=>Bv(e)?e.slice(Ur.length):null,Cce=e=>{try{const t=new URL(e),n=t.hostname.endsWith(".supabase.co"),s=(t.pathname||"").includes("/functions/");return n&&!s}catch{return!1}},Nn={BASE_URL:Ru,LEGACY_BASE_URL:Ru,PROXY_BASE_URL:cj,ROUTE_PREFIX:Ur,ENDPOINTS:{WHATSAPP:{GET_LOGIN_QR:`${Ur}session.get_login_qr`,GET_SESSIONS:"/get_sessions",LOGOUT_SESSION:`${Ur}session.logout`,CREATE_PLATFORM:"/whatsapp/create-platform",CREATE_SESSION:`${Ur}session.create`,DISCONNECT_SESSION:`${Ur}session.logout`,DELETE_SESSION:`${Ur}session.delete`},TELEGRAM:{CREATE_PLATFORM:`${Ur}telegram.create_platform`,SEND_MESSAGE:`${Ur}telegram.send_message`,DELETE_WEBHOOK:`${Ur}telegram.delete_webhook`,VERIFY_TOKEN:`${Oo}/functions/v1/telegram-verify-token`},AI_AGENT:{CHAT_SETTINGS:`${Ur}chat.settings`,CHAT_TEST:`${Ur}chat.test`},KNOWLEDGE:{FILE_UPLOAD:"/knowledge/file-upload-dev",FILE_DELETE:`${Ur}knowledge.file_delete`},MESSAGE:{DEFAULT:"/send-message",SEND_MESSAGE:"/send-message",WHATSAPP_SEND_MESSAGE:`${Ur}whatsapp.send_message`,TELEGRAM_SEND_MESSAGE:`${Ur}telegram.send_message`,WEB_SEND_MESSAGE:`${Ur}web.send_message`}},buildUrl:(e,t={})=>{if(!e)throw new Error("Endpoint must be provided");if(e.startsWith("http"))return e;if(Bv(e)){const n=uj(e);if(!n)throw new Error("Invalid proxy route key");return`${!!t.forceLegacy&&!Cce(Ru)?Ru:cj}/${n}`}return`${Ru}${E2(e)}`},buildTestUrl:e=>{if(Bv(e)){const n=uj(e);if(!n)throw new Error("Invalid proxy route key");return`${cj}/${n}`}return`${Ru.replace("/webhook","/webhook-test")}${E2(e)}`},isProxyEndpoint:Bv,extractRouteKey:uj},m6={telegram:Nn.ENDPOINTS.MESSAGE.TELEGRAM_SEND_MESSAGE,whatsapp:Nn.ENDPOINTS.MESSAGE.WHATSAPP_SEND_MESSAGE,web:Nn.ENDPOINTS.MESSAGE.WEB_SEND_MESSAGE},p6=e=>{const t=(e||"").toLowerCase();return t==="wa"||t==="waha"||t==="whatsapp_cloud"?"whatsapp":t==="tg"||t==="tele"?"telegram":t},Xg=e=>{const t=p6(e),n=m6[t]||Nn.ENDPOINTS.MESSAGE.DEFAULT;Nn.ENDPOINTS.MESSAGE.SEND_MESSAGE=n},Ace=e=>{const t=p6(e);return m6[t]||Nn.ENDPOINTS.MESSAGE.DEFAULT},Ece={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_HCAPTCHA_SITEKEY:"30583a2e-84ac-496a-8ec2-23043ae06dc0",VITE_SUPABASE_PROJECT_ID:"bkynymyhbfrhvwxqqttk",VITE_SUPABASE_PUBLISHABLE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJreW55bXloYmZyaHZ3eHFxdHRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5Mzk1NzIsImV4cCI6MjA3OTUxNTU3Mn0.4ELI9s6908SdW2jd1BM_ht8pTIyLAwPpsqGiGNCdcC0",VITE_SUPABASE_URL:"https://bkynymyhbfrhvwxqqttk.supabase.co",VITE_WEBHOOK_BASE_URL:"https://primary-production-376c.up.railway.app/webhook"},Tce=()=>{const e=Ece??{};return(e==null?void 0:e.VITE_SUPABASE_ANON_KEY)??null};async function Ns(e,t={},n={}){const{forceLegacy:r=!1,skipAuth:s=!1}=n,i=Nn.buildUrl(e,{forceLegacy:r}),o=i.startsWith(Nn.PROXY_BASE_URL),l=r&&!o,c=new Headers(t.headers),u=i.startsWith(Oo)&&i.includes("/functions/v1/"),d=!l&&Nn.isProxyEndpoint(e)||u||o;if(d&&!s&&!c.has("Authorization"))try{const{data:{session:f}}=await le.auth.getSession(),m=f==null?void 0:f.access_token;m&&c.set("Authorization",`Bearer ${m}`)}catch{}const h=Tce();return h&&(d||o||u||i.startsWith(Oo))&&!c.has("apikey")&&c.set("apikey",h),fetch(i,{...t,headers:c})}const Pce=()=>{const[e,t]=p.useState([]),[n,r]=p.useState([]),[s,i]=p.useState(!1),[o,l]=p.useState(null),[c,u]=p.useState(null),d=p.useRef({}),h=p.useRef([]),f=p.useRef(null);p.useEffect(()=>{h.current=e},[e]),p.useEffect(()=>{le.auth.getUser().then(({data:D})=>{var E;f.current=((E=D.user)==null?void 0:E.id)||null});const{data:{subscription:C}}=le.auth.onAuthStateChange((D,E)=>{var F;f.current=((F=E==null?void 0:E.user)==null?void 0:F.id)||null});return()=>C.unsubscribe()},[]);const[m,g]=p.useState({}),v=p.useRef(null),y=(C=400)=>{try{v.current&&(clearTimeout(v.current),v.current=null)}catch{}v.current=window.setTimeout(()=>{document.visibilityState==="visible"&&(s||b(void 0,{silent:!0}))},C)},x=C=>{const D=((C==null?void 0:C.status)||"").toLowerCase();return{assigned:!(D==="closed")&&(D==="pending"||D==="assigned"),assignee_user_id:(C==null?void 0:C.assignee_user_id)??null,handled_by_super_agent:!1}},w=(C,D)=>{t(E=>{const I=E.map(P=>{var U;if(P.id===C){const Z=((U=P.channel)==null?void 0:U.super_agent_id)??P.super_agent_id??null,X=x({ai_access_enabled:P.ai_access_enabled,assigned_at:P.assigned_at,assignee_user_id:P.assignee_user_id,channel_super_agent_id:Z,status:P.status,ai_handoff_at:P.ai_handoff_at??null}),K=X.assignee_user_id?X.assignee_user_id===Z?P.super_agent_name||P.assignee_name||"":P.assignee_name||"":"";return{...P,last_message_preview:((D==null?void 0:D.body)||"").toString().replace(/\s+/g," ").trim()||"",last_message_direction:(D==null?void 0:D.direction)??null,last_message_role:(D==null?void 0:D.role)??null,last_msg_at:(D==null?void 0:D.created_at)||P.last_msg_at,unreplied:(D==null?void 0:D.direction)==="in"||(D==null?void 0:D.role)==="user",assigned:X.assigned,assignee_user_id:X.assignee_user_id,assignee_name:K,status:P.status}}return P}).sort((P,U)=>{const Z=new Date(P.last_msg_at??P.created_at??0).getTime();return new Date(U.last_msg_at??U.created_at??0).getTime()-Z});return console.log("Re-sorted conversations after message update"),I})},b=async(C,D={})=>{try{D.silent||i(!0),l(null),await Qd();const E=C??d.current;C&&(d.current=C,g(C));let F=kt.from("threads").select(`
          *,
          contacts(name, phone, email),
          channels!inner(display_name, type, provider, external_id, logo_url, profile_photo_url, super_agent_id),
          messages(id, body, role, direction, created_at, seq)
        `).order("last_msg_at",{ascending:!1}).order("created_at",{foreignTable:"messages",ascending:!1}).limit(1,{foreignTable:"messages"});const{dateRange:I,status:P,agent:U,resolvedBy:Z,inbox:X,channelType:K,platformId:ie}=E;P&&P!=="all"&&P!==""&&(F=F.eq("status",P)),U&&U!=="all"&&U!==""&&(F=F.eq("assignee_user_id",U)),Z&&Z!=="all"&&Z!==""&&(F=F.eq("resolved_by_user_id",Z)),X&&X!=="all"&&X!==""&&(F=F.eq("channels.provider",X)),K&&K!=="all"&&K!==""&&(F=F.eq("channels.provider",K)),ie&&ie!=="all"&&ie!==""&&(F=F.eq("channel_id",ie));const H=new Promise((je,Ce)=>{const Ze=setTimeout(()=>{clearTimeout(Ze),Ce(new Error("timeout"))},8e3)}),{data:he,error:me}=await Promise.race([F,H]);if(me)throw me;const ae=Array.from(new Set((he||[]).flatMap(je=>{var Ce;return[je.assigned_by_user_id,je.assignee_user_id,je.resolved_by_user_id,(Ce=je.channels)==null?void 0:Ce.super_agent_id]}).filter(Boolean)));let Ne={},de={};if(ae.length>0){const{data:je,error:Ce}=await kt.from("users_profile").select("user_id, display_name, last_seen_at").in("user_id",ae);if(Ce)throw Ce;Ne=Object.fromEntries((je||[]).map(Ze=>[Ze.user_id,Ze.display_name||""])),de=Object.fromEntries((je||[]).map(Ze=>[Ze.user_id,Ze.last_seen_at||null]))}let fe=(he||[]).map(je=>{var qe,Se,nt,vt,xt,wt,ht,_t,Wt,pe,Oe,W,q,Y,ne;const Ce=Array.isArray(je.messages)&&je.messages.length>0?je.messages[0]:null,Ze=((Ce==null?void 0:Ce.body)||"").toString().replace(/\s+/g," ").trim(),rt=(Ce==null?void 0:Ce.direction)??null,Je=(Ce==null?void 0:Ce.role)??null,te=rt==="in"||Je==="user",We=((qe=je.channels)==null?void 0:qe.super_agent_id)||null,Ue=x({ai_access_enabled:je.ai_access_enabled,assigned_at:je.assigned_at,assignee_user_id:je.assignee_user_id,channel_super_agent_id:We,status:je.status,ai_handoff_at:je.ai_handoff_at}),ue=We&&Ne[We]||"",xe=Ue.assignee_user_id?Ue.assignee_user_id===We?ue:Ne[Ue.assignee_user_id]||"":"",ce=je.status||"open";return{...je,contact_name:((Se=je.contacts)==null?void 0:Se.name)||"Unknown Contact",contact_phone:((nt=je.contacts)==null?void 0:nt.phone)||"",contact_email:((vt=je.contacts)==null?void 0:vt.email)||"",channel_name:((xt=je.channels)==null?void 0:xt.display_name)||"Unknown Channel",channel_type:((wt=je.channels)==null?void 0:wt.type)||"web",channel_provider:((ht=je.channels)==null?void 0:ht.provider)||void 0,channel:{provider:(_t=je.channels)==null?void 0:_t.provider,type:(Wt=je.channels)==null?void 0:Wt.type,display_name:(pe=je.channels)==null?void 0:pe.display_name,external_id:(Oe=je.channels)==null?void 0:Oe.external_id,logo_url:((W=je.channels)==null?void 0:W.logo_url)||null,profile_photo_url:((q=je.channels)==null?void 0:q.profile_photo_url)||null,super_agent_id:We},channel_logo_url:((Y=je.channels)==null?void 0:Y.logo_url)||((ne=je.channels)==null?void 0:ne.profile_photo_url)||null,last_message_preview:Ze||"",last_message_direction:rt,last_message_role:Je,last_msg_at:(Ce==null?void 0:Ce.created_at)||je.last_msg_at,message_count:0,assigned:Ue.assigned,assigned_by_name:je.assigned_by_user_id&&Ne[je.assigned_by_user_id]||"",assignee_name:xe,assignee_user_id:Ue.assignee_user_id,resolved_by_name:je.resolved_by_user_id&&Ne[je.resolved_by_user_id]||"",ai_access_enabled:je.ai_access_enabled??!1,super_agent_id:We,super_agent_name:ue,assignee_last_seen_at:Ue.assignee_user_id&&de[Ue.assignee_user_id]||null,super_agent_last_seen_at:We&&de[We]||null,status:ce,unreplied:te}});if(I!=null&&I.from){const je=Ul(I.from).getTime();fe=fe.filter(Ce=>new Date(Ce.last_msg_at).getTime()>=je)}if(I!=null&&I.to){const je=kC(I.to).getTime();fe=fe.filter(Ce=>new Date(Ce.last_msg_at).getTime()<=je)}X&&X!=="all"&&X!==""&&(fe=fe.filter(je=>{var Ce;return String(je.channel_provider||((Ce=je.channel)==null?void 0:Ce.provider)||"").toLowerCase()===String(X).toLowerCase()})),K&&K!=="all"&&K!==""&&(fe=fe.filter(je=>{var Ce;return String(je.channel_provider||((Ce=je.channel)==null?void 0:Ce.provider)||"").toLowerCase()===String(K).toLowerCase()})),ie&&ie!=="all"&&ie!==""&&(fe=fe.filter(je=>String(je.channel_id||"")===String(ie)));const Be=fe.sort((je,Ce)=>{const Ze=new Date(je.last_msg_at??je.created_at??0).getTime();return new Date(Ce.last_msg_at??Ce.created_at??0).getTime()-Ze});t(Be)}catch(E){console.error("Error fetching conversations:",E),l(E instanceof Error?E.message:"Failed to fetch conversations")}finally{i(!1)}},_=C=>{C!=null&&C.id&&t(D=>{const E=D.findIndex(Z=>Z.id===C.id);if(E===-1)return D;const F=D[E],I=x({ai_access_enabled:C.ai_access_enabled??F.ai_access_enabled,assigned_at:C.assigned_at??F.assigned_at,status:C.status??F.status,ai_handoff_at:C.ai_handoff_at??F.ai_handoff_at??null}),P={...F,status:C.status??F.status,assignee_user_id:C.assignee_user_id??F.assignee_user_id,collaborator_user_id:C.collaborator_user_id??F.collaborator_user_id,assigned_at:C.assigned_at??F.assigned_at,resolved_at:C.resolved_at??F.resolved_at,resolved_by_user_id:C.resolved_by_user_id??F.resolved_by_user_id,ai_access_enabled:C.ai_access_enabled??F.ai_access_enabled,last_msg_at:C.last_msg_at??F.last_msg_at,assigned:I.assigned,account_id:C.account_id??F.account_id??null},U=[...D];return U[E]=P,U.sort((Z,X)=>{const K=new Date(Z.last_msg_at??Z.created_at??0).getTime();return new Date(X.last_msg_at??X.created_at??0).getTime()-K}),U})},k=p.useCallback(async C=>{var D;try{l(null);const{data:E,error:F}=await le.from("messages").select(`
          id,
          thread_id,
          direction,
          role,
          type,
          body,
          payload,
          actor_kind,
          actor_id,
          seq,
          in_reply_to,
          edited_at,
          edit_reason,
          created_at
        `).eq("thread_id",C).order("seq",{ascending:!0});if(F)throw F;const{data:I}=await le.from("threads").select(`
          contacts(name, phone, email)
        `).eq("id",C).maybeSingle(),P=((D=I==null?void 0:I.contacts)==null?void 0:D.name)||"Unknown Contact",U=(E||[]).map(Z=>{var X;return{...Z,contact_name:P,contact_avatar:((X=P[0])==null?void 0:X.toUpperCase())||"U"}});r(U),u(C)}catch(E){console.error("Error fetching messages:",E),l(E instanceof Error?E.message:"Failed to fetch messages")}},[]),j=async(C,D,E="assistant",F)=>{var I,P,U,Z;try{l(null);const{data:X,error:K}=await le.from("threads").select("channel_id, contact_id, channels(provider)").eq("id",C).single();if(K)throw K;const ie=(((I=X==null?void 0:X.channels)==null?void 0:I.provider)||"").toLowerCase(),H=["telegram","whatsapp"].includes(ie),he=ie==="web",{data:me}=await le.auth.getUser(),ae=((P=me==null?void 0:me.user)==null?void 0:P.id)||null,Ne=!!F,de=D.trim().length>0,Q=[],fe=[],Be={thread_id:C,direction:"out",role:E,payload:{},actor_kind:"agent",actor_id:ae,created_at:new Date().toISOString()};if(Ne){const rt=`tmp_${Math.random().toString(36).slice(2)}`,Je={...Be,type:F.type,body:F.url};if(Q.push(Je),fe.push({...Je,id:rt,seq:0,in_reply_to:null,edited_at:null,edit_reason:null,contact_name:"",contact_avatar:"A",_status:"pending"}),de){const te=`tmp_${Math.random().toString(36).slice(2)}`,We={...Be,type:"text",body:D,created_at:new Date(Date.now()+1).toISOString()};Q.push(We),fe.push({...We,id:te,seq:0,in_reply_to:null,edited_at:null,edit_reason:null,contact_name:"",contact_avatar:"A",_status:"pending"})}}else{const rt=`tmp_${Math.random().toString(36).slice(2)}`,Je={...Be,type:"text",body:D};Q.push(Je),fe.push({...Je,id:rt,seq:0,in_reply_to:null,edited_at:null,edit_reason:null,contact_name:"",contact_avatar:"A",_status:"pending"})}r(rt=>[...rt,...fe]);let je=null;if(!H){const{data:rt,error:Je}=await le.from("messages").insert(Q.map(({thread_id:te,direction:We,role:Ue,type:ue,body:xe,payload:ce,actor_kind:qe,actor_id:Se})=>({thread_id:te,direction:We,role:Ue,type:ue,body:xe,payload:ce,actor_kind:qe,actor_id:Se}))).select();if(Je)throw Je;je=rt==null?void 0:rt[0]}const{data:Ce,error:Ze}=await le.from("contacts").select("phone, external_id").eq("id",X.contact_id).single();Ze&&console.warn("Error fetching contact details:",Ze);try{const rt=e.find(te=>te.id===C),Je=((U=rt==null?void 0:rt.channel)==null?void 0:U.provider)||((Z=X==null?void 0:X.channels)==null?void 0:Z.provider);if(Je&&Je.toLowerCase()!=="web"){const te=Ace(Je),We={thread_id:C,channel_id:X.channel_id,actor_id:ae,contact_phone:(Ce==null?void 0:Ce.phone)||null,external_id:(Ce==null?void 0:Ce.external_id)||null,text:D,type:F?F.type:"text",direction:"out",role:E,file_url:(F==null?void 0:F.url)||null},Ue=await Ns(te,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(We)});Ue.ok||console.warn("Webhook call failed:",Ue.status,Ue.statusText)}}catch(rt){console.error("Error calling webhook:",rt)}if(H){const rt=new Set(fe.map(Je=>Je.id));r(Je=>Je.map(te=>rt.has(te.id)?{...te,_status:"sent"}:te))}else await k(C);w(C,{body:D,direction:"out",role:E,created_at:new Date().toISOString()});try{await en({action:"message.send",resource:"message",resourceId:(je==null?void 0:je.id)??null,context:{thread_id:C,role:E}})}catch{}return je}catch(X){throw console.error("Error sending message:",X),l(X instanceof Error?X.message:"Failed to send message"),r(K=>{const ie=[...K];for(let H=ie.length-1;H>=0;H--)if(ie[H]._status==="pending"){ie[H]._status="error";break}return ie}),X}},S=async(C,D)=>{var E;try{l(null);const F={org_id:((E=(await le.auth.getUser()).data.user)==null?void 0:E.id)||"00000000-0000-0000-0000-000000000001",contact_id:C,channel_id:D,status:"open",assignee_user_id:null},{data:I,error:P}=await le.from("threads").insert([F]).select().single();if(P)throw P;await b(void 0,{silent:!0});try{await en({action:"thread.create",resource:"thread",resourceId:(I==null?void 0:I.id)??null,context:{contact_id:C,channel_id:D}})}catch{}return I}catch(F){throw console.error("Error creating conversation:",F),l(F instanceof Error?F.message:"Failed to create conversation"),F}},T=async(C,D,E)=>{var F,I,P;try{l(null);const{data:U}=await le.auth.getUser(),Z=((F=U==null?void 0:U.user)==null?void 0:F.id)||null,X="pending";if((E==null?void 0:E.setAssignee)??!0){const{error:ie}=await le.rpc("takeover_thread",{p_thread_id:C});ie&&console.warn("takeover_thread RPC failed; will attempt direct update",ie);try{const{data:H}=await le.from("threads").select("assignee_user_id, status").eq("id",C).single(),he=!!(H!=null&&H.assignee_user_id);if((((H==null?void 0:H.status)||"").toLowerCase()!==X||!he)&&Z){const ae={assigned_at:new Date().toISOString(),handover_reason:"other:manual_takeover",ai_access_enabled:!1,status:X};he||(ae.assignee_user_id=Z,ae.assigned_by_user_id=Z);const{error:Ne}=await le.from("threads").update(ae).eq("id",C);Ne&&console.warn("Fallback assignment/status update failed",Ne)}}catch(H){console.warn("Failed verifying assignment state",H)}}else{const ie=new Date().toISOString(),{error:H}=await le.from("threads").update({collaborator_user_id:Z,status:X,ai_access_enabled:!1,ai_handoff_at:ie}).eq("id",C);if(H)throw H}try{await kt.from("threads").update({ai_access_enabled:!1}).eq("id",C)}catch{}try{const{data:ie}=await le.auth.getUser(),H=((I=ie==null?void 0:ie.user)==null?void 0:I.id)||null;let he=null;if(H){const{data:me}=await le.from("users_profile").select("display_name").eq("user_id",H).single();he=(me==null?void 0:me.display_name)||null}await kt.from("messages").insert([{thread_id:C,direction:null,role:"system",type:"event",body:`Conversation taken over by ${he||((P=ie==null?void 0:ie.user)==null?void 0:P.email)||"agent"}.`,payload:{event:"takeover",user_id:H}}])}catch(ie){console.warn("Failed to insert takeover event message",ie)}await b(void 0,{silent:!0}),await k(C);try{await en({action:"thread.assign",resource:"thread",resourceId:C,context:{assignee_user_id:D}})}catch{}}catch(U){throw console.error("Error assigning thread:",U),l(U instanceof Error?U.message:"Failed to assign thread"),U}},O=async C=>{try{l(null);const{error:D}=await le.from("threads").update({collaborator_user_id:null,status:"open",ai_access_enabled:!0,ai_handoff_at:null}).eq("id",C);if(D)throw D;await b(void 0,{silent:!0}),await k(C)}catch(D){throw console.error("Error clearing collaborator:",D),l(D instanceof Error?D.message:"Failed to clear collaborator"),D}},A=async(C,D)=>{var E,F;try{l(null);const{data:I}=await le.auth.getUser(),P=((E=I==null?void 0:I.user)==null?void 0:E.id)||null,U=new Date().toISOString(),X={assignee_user_id:D,handover_reason:D?"other:manual_assign":"other:manual_unassign",ai_access_enabled:!D,ai_handoff_at:D?U:null,status:D?"pending":"open"};D?(X.assigned_by_user_id=P,X.assigned_at=U):(X.assigned_by_user_id=null,X.assigned_at=null);const{error:K}=await le.from("threads").update(X).eq("id",C);if(K)throw K;try{const ie=[P,D].filter(Boolean);let H={};if(ie.length>0){const{data:Ne}=await le.from("users_profile").select("user_id, display_name").in("user_id",ie);H=Object.fromEntries((Ne||[]).map(de=>[String(de.user_id),String(de.display_name||"")]))}const he=P&&(H[P]||((F=I==null?void 0:I.user)==null?void 0:F.email))||"agent",me=D?H[D]||"agent":"",ae={thread_id:C,direction:null,role:"system",type:"event",body:"",payload:{}};D?(ae.body=`Conversation assigned to ${me} by ${he}.`,ae.payload={event:"assign",assigned_to:D,assigned_by:P}):(ae.body=`Conversation unassigned by ${he}.`,ae.payload={event:"unassign",assigned_by:P}),await kt.from("messages").insert([ae])}catch(ie){console.warn("Failed to insert assign event message",ie)}await b(void 0,{silent:!0}),await k(C);try{await en({action:"thread.assign",resource:"thread",resourceId:C,context:{assignee_user_id:D}})}catch{}}catch(I){throw console.error("Error assigning thread to user:",I),l(I instanceof Error?I.message:"Failed to assign thread"),I}},N=async C=>{var F,I,P;const{error:D,data:E}=await kt.rpc("takeover_thread",{p_thread_id:C});if(D){console.warn("takeover_thread RPC failed, falling back to direct update",D);const{data:U}=await le.auth.getUser(),Z=((F=U==null?void 0:U.user)==null?void 0:F.id)||null;if(!Z)throw D;const X=new Date().toISOString(),{error:K}=await kt.from("threads").update({collaborator_user_id:Z,status:"pending",assigned_at:X,ai_access_enabled:!1}).eq("id",C);if(K)throw K}try{const{data:U}=await le.auth.getUser(),Z=((I=U==null?void 0:U.user)==null?void 0:I.id)||null;let X=null;if(Z){const{data:K}=await le.from("users_profile").select("display_name").eq("user_id",Z).single();X=(K==null?void 0:K.display_name)||null}await kt.from("messages").insert([{thread_id:C,direction:null,role:"system",type:"event",body:`Conversation taken over by ${X||((P=U==null?void 0:U.user)==null?void 0:P.email)||"agent"}.`,payload:{event:"takeover",user_id:Z}}])}catch(U){console.warn("Failed to insert takeover event message",U)}return await b(void 0,{silent:!0}),await k(C),E},L=async C=>{var F,I;const{data:D,error:E}=await kt.rpc("unassign_thread",{p_thread_id:C});if(E)throw E;try{const{data:P}=await le.auth.getUser(),U=((F=P==null?void 0:P.user)==null?void 0:F.id)||null;let Z=null;if(U){const{data:X}=await le.from("users_profile").select("display_name").eq("user_id",U).single();Z=(X==null?void 0:X.display_name)||null}await kt.from("messages").insert([{thread_id:C,direction:null,role:"system",type:"event",body:`Conversation moved to Unassigned by ${Z||((I=P==null?void 0:P.user)==null?void 0:I.email)||"agent"}.`,payload:{event:"unassign",user_id:U}}])}catch(P){console.warn("Failed to insert unassign event message",P)}return await b(void 0,{silent:!0}),await k(C),D},M=async(C,D)=>{try{l(null);const{error:E}=await le.from("threads").update({collaborator_user_id:D}).eq("id",C);if(E)throw E;t(F=>F.map(I=>I.id===C?{...I,collaborator_user_id:D}:I));try{await en({action:D?"thread.set_collaborator":"thread.clear_collaborator",resource:"thread",resourceId:C,context:{collaborator_user_id:D}})}catch{}}catch(E){throw console.error("Error updating thread collaborator:",E),l(E instanceof Error?E.message:"Failed to update collaborator"),E}},B=async(C,D)=>{try{l(null);const{error:E}=await le.from("thread_labels").insert([{thread_id:C,label_id:D}]);if(E)throw E;try{await en({action:"thread.add_label",resource:"thread",resourceId:C,context:{label_id:D}})}catch{}}catch(E){throw console.error("Error adding thread label:",E),l(E instanceof Error?E.message:"Failed to add thread label"),E}},$=async(C,D)=>{try{l(null);const{error:E}=await le.from("thread_labels").delete().eq("thread_id",C).eq("label_id",D);if(E)throw E;try{await en({action:"thread.remove_label",resource:"thread",resourceId:C,context:{label_id:D}})}catch{}}catch(E){throw console.error("Error removing thread label:",E),l(E instanceof Error?E.message:"Failed to remove thread label"),E}},z=async C=>{try{l(null);const{error:D}=await le.from("threads").delete().eq("id",C);if(D)throw D;fo.invalidatePattern("^query:threads"),t(E=>E.filter(I=>I.id!==C)),c===C&&(u(null),r([]));try{await en({action:"thread.delete",resource:"thread",resourceId:C})}catch{}await b(void 0,{silent:!0})}catch(D){throw console.error("Error deleting thread:",D),l(D instanceof Error?D.message:"Failed to delete conversation"),D}};p.useEffect(()=>{y(10)},[]),p.useEffect(()=>{const C=()=>{try{t([]),r([]),u(null),l(null)}catch{}try{y(50)}catch{}};try{window.addEventListener(Tm,C)}catch{}return()=>{try{window.removeEventListener(Tm,C)}catch{}}},[]);const R=async()=>{try{const{data:C,error:D}=await kt.rpc("check_and_auto_resolve_threads");if(D){console.error("Auto-resolve check failed:",D);return}C&&C.length>0&&b(void 0,{silent:!0})}catch(C){console.error("Auto-resolve check error:",C)}};return p.useEffect(()=>{const C=setInterval(()=>{document.visibilityState==="visible"&&R()},3e4);return()=>clearInterval(C)},[]),p.useEffect(()=>{const C=le.channel("threads-realtime").on("postgres_changes",{event:"UPDATE",schema:"public",table:"threads"},D=>{_(D.new),document.visibilityState==="visible"&&y(400)}).on("postgres_changes",{event:"INSERT",schema:"public",table:"threads"},D=>{document.visibilityState==="visible"&&y(300)}).on("postgres_changes",{event:"DELETE",schema:"public",table:"threads"},()=>{document.visibilityState==="visible"&&y(300)}).subscribe();return()=>{try{le.removeChannel(C)}catch{}}},[]),p.useEffect(()=>{const C=le.channel("messages-realtime-for-convlist").on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},D=>{const E=D.new;E&&E.direction==="in"&&document.visibilityState==="visible"?(w(E.thread_id,E),y(100),R()):E&&(E.role==="system"||E.type==="event")&&document.visibilityState==="visible"||E&&E.direction==="out"&&(E.role==="agent"||E.role==="assistant")&&document.visibilityState==="visible"?(w(E.thread_id,E),y(200)):E&&E.role==="agent"&&E.direction==="out"&&document.visibilityState==="visible"&&R()}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"messages"},()=>{document.visibilityState==="visible"&&y(500)}).on("postgres_changes",{event:"DELETE",schema:"public",table:"messages"},()=>{document.visibilityState==="visible"&&y(300)}).subscribe();return()=>{try{le.removeChannel(C)}catch{}try{v.current&&(clearTimeout(v.current),v.current=null)}catch{}}},[]),p.useEffect(()=>{if(!c)return;const C=setInterval(()=>{k(c)},3e4),D=le.channel(`messages-${c}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages",filter:`thread_id=eq.${c}`},E=>{const F=E.new;F&&F.direction,r(I=>{var ie,H,he,me;if(I.some(ae=>ae.id===(F==null?void 0:F.id)))return I;const U=((ie=I[0])==null?void 0:ie.contact_name)||"",Z=((H=I[0])==null?void 0:H.contact_avatar)||(((me=(he=U==null?void 0:U[0])==null?void 0:he.toUpperCase)==null?void 0:me.call(he))??"U"),X={...F||{},contact_name:U,contact_avatar:Z},K=[...I,X];return K.sort((ae,Ne)=>(ae.seq??0)-(Ne.seq??0)),K})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"messages",filter:`thread_id=eq.${c}`},E=>{const F=E.new;r(I=>{const P=I.findIndex(X=>X.id===(F==null?void 0:F.id));if(P<0)return I;const U={...I[P],...F||{}},Z=[...I];return Z[P]=U,Z.sort((X,K)=>(X.seq??0)-(K.seq??0)),Z})}).on("postgres_changes",{event:"DELETE",schema:"public",table:"messages",filter:`thread_id=eq.${c}`},E=>{const F=E.old||E.new,I=F==null?void 0:F.id;I&&r(P=>P.filter(U=>U.id!==I))}).subscribe(E=>{E==="CHANNEL_ERROR"&&(console.error("Error subscribing to messages for thread:",c),setTimeout(()=>{k(c)},1e3))});return()=>{clearInterval(C);try{le.removeChannel(D)}catch{}}},[c]),p.useEffect(()=>{if(!c)return;const C=le.channel(`thread-detail-${c}`).on("postgres_changes",{event:"*",schema:"public",table:"threads",filter:`id=eq.${c}`},()=>{document.visibilityState==="visible"&&(y(150),k(c))}).subscribe();return()=>{try{le.removeChannel(C)}catch{}}},[c,k]),{conversations:e,messages:n,loading:s,error:o,selectedThreadId:c,fetchConversations:b,fetchMessages:k,sendMessage:j,refreshMessages:()=>{c&&k(c)},enableAudioNotifications:()=>{localStorage.setItem("audioNotifications","true")},disableAudioNotifications:()=>{localStorage.setItem("audioNotifications","false")},testAudioNotification:()=>{console.log("Audio test not implemented in hook")},createConversation:S,assignThread:T,assignThreadToUser:A,takeoverThread:N,unassignThread:L,clearCollaborator:O,setThreadCollaborator:M,addThreadLabel:B,removeThreadLabel:$,deleteThread:z,checkAutoResolve:R,activeFilters:m}},FC=()=>{const[e,t]=p.useState([]),[n,r]=p.useState(!0),[s,i]=p.useState(null),[o,l]=p.useState(0),c=p.useRef({page:1,limit:100,searchQuery:void 0,filters:void 0}),u=async(g=1,v=100,y,x)=>{var w,b,_,k;try{c.current={page:g,limit:v,searchQuery:y,filters:x},r(!0),i(null);const j=!!(x!=null&&x.chatStatus||(w=x==null?void 0:x.dateRange)!=null&&w.from||(b=x==null?void 0:x.dateRange)!=null&&b.to||(x==null?void 0:x.handledBy)==="assigned");let S=kt.from("contacts").select(`
          id, org_id, name, email, phone, locale, notes, created_at,
          threads${j?"!inner":""}(
            id, status, created_at, assignee_user_id,
            channels(display_name, provider, type)
          )
          `,{count:"exact"}).order("created_at",{ascending:!1});if(y&&(S=S.or(`name.ilike.%${y}%,phone.ilike.%${y}%,email.ilike.%${y}%`)),x&&(x.chatStatus&&(S=S.eq("threads.status",x.chatStatus)),x.handledBy==="assigned"&&(S=S.not("threads.assignee_user_id","is",null)),(_=x.dateRange)!=null&&_.from&&(S=S.gte("threads.created_at",x.dateRange.from)),(k=x.dateRange)!=null&&k.to)){const B=x.dateRange.to.length>10?x.dateRange.to:`${x.dateRange.to}T23:59:59.999Z`;S=S.lte("threads.created_at",B)}const T=(g-1)*v,O=T+v-1;S=S.range(T,O),S=S.order("created_at",{foreignTable:"threads",ascending:!1}).limit(1,{foreignTable:"threads"});const{data:A,error:N,count:L}=await S;if(N)throw N;let M=(A||[]).map(B=>{var C,D,E;const $=(B.threads||[])[0]||null,z=((C=$==null?void 0:$.channels)==null?void 0:C.display_name)||"",R=$!=null&&$.created_at?new Date($.created_at).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1}).replace(",",""):"";return{id:B.id,org_id:B.org_id,name:B.name,email:B.email,phone:B.phone,locale:B.locale,notes:B.notes,created_at:B.created_at,labelNames:"",inbox:z,channelProvider:((D=$==null?void 0:$.channels)==null?void 0:D.provider)||null,channelType:((E=$==null?void 0:$.channels)==null?void 0:E.type)||null,chatStatus:($==null?void 0:$.status)||"",chatCreatedAt:R,chatCreatedAtISO:($==null?void 0:$.created_at)||null,handledBy:$!=null&&$.assignee_user_id?"assigned":"unassigned"}});x&&(M=M.filter(B=>{var $,z;if(x.chatStatus&&B.chatStatus!==x.chatStatus||x.handledBy&&B.handledBy!==x.handledBy)return!1;if(($=x.dateRange)!=null&&$.from||(z=x.dateRange)!=null&&z.to){const R=new Date(B.created_at),C=x.dateRange.from?new Date(x.dateRange.from):null,D=x.dateRange.to?new Date(x.dateRange.to):null;if(C&&R<C||D&&R>D)return!1}return!0})),t(M),l(L||0)}catch(j){console.error("Error fetching contacts:",j),i(j instanceof Error?j.message:"Failed to fetch contacts")}finally{r(!1)}},d=async g=>{try{i(null);const{data:v,error:y}=await kt.from("contacts").insert([{...g,org_id:"00000000-0000-0000-0000-000000000001"}]).select().single();if(y)throw y;await u();try{await en({action:"contact.create",resource:"contact",resourceId:(v==null?void 0:v.id)??null,context:g})}catch{}return v}catch(v){throw console.error("Error creating contact:",v),i(v instanceof Error?v.message:"Failed to create contact"),v}},h=async(g,v)=>{try{i(null);const{error:y}=await kt.from("contacts").update(v).eq("id",g);if(y)throw y;await u();try{await en({action:"contact.update",resource:"contact",resourceId:g,context:v})}catch{}}catch(y){throw console.error("Error updating contact:",y),i(y instanceof Error?y.message:"Failed to update contact"),y}},f=async g=>{try{i(null);const{error:v}=await le.from("contacts").delete().eq("id",g);if(v)throw v;fo.invalidatePattern("^query:contacts"),await u();try{await en({action:"contact.delete",resource:"contact",resourceId:g})}catch{}}catch(v){throw console.error("Error deleting contact:",v),i(v instanceof Error?v.message:"Failed to delete contact"),v}},m=async g=>{try{i(null);const{error:v}=await le.from("contacts").delete().in("id",g);if(v)throw v;fo.invalidatePattern("^query:contacts"),await u();try{await en({action:"contact.bulk_delete",resource:"contact",context:{ids:g}})}catch{}}catch(v){throw console.error("Error deleting contacts:",v),i(v instanceof Error?v.message:"Failed to delete contacts"),v}};return p.useEffect(()=>{u()},[]),p.useEffect(()=>{const g=()=>{try{t([]),l(0),i(null),r(!0)}catch{}try{const{page:v,limit:y,searchQuery:x,filters:w}=c.current;u(v,y,x,w)}catch{}};try{window.addEventListener(Tm,g)}catch{}return()=>{try{window.removeEventListener(Tm,g)}catch{}}},[]),{contacts:e,loading:n,error:s,totalCount:o,fetchContacts:u,createContact:d,updateContact:h,deleteContact:f,deleteMultipleContacts:m}};var g6="AlertDialog",[Oce,kUe]=Mr(g6,[mU]),Fo=mU(),v6=e=>{const{__scopeAlertDialog:t,...n}=e,r=Fo(t);return a.jsx(hC,{...r,...n,modal:!0})};v6.displayName=g6;var Ice="AlertDialogTrigger",y6=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Fo(n);return a.jsx(TU,{...s,...r,ref:t})});y6.displayName=Ice;var Rce="AlertDialogPortal",x6=e=>{const{__scopeAlertDialog:t,...n}=e,r=Fo(t);return a.jsx(fC,{...r,...n})};x6.displayName=Rce;var Mce="AlertDialogOverlay",b6=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Fo(n);return a.jsx(Ib,{...s,...r,ref:t})});b6.displayName=Mce;var wd="AlertDialogContent",[Dce,Lce]=Oce(wd),$ce=n4("AlertDialogContent"),w6=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,children:r,...s}=e,i=Fo(n),o=p.useRef(null),l=Ot(t,o),c=p.useRef(null);return a.jsx(wae,{contentName:wd,titleName:j6,docsSlug:"alert-dialog",children:a.jsx(Dce,{scope:n,cancelRef:c,children:a.jsxs(Rb,{role:"alertdialog",...i,...s,ref:l,onOpenAutoFocus:Ve(s.onOpenAutoFocus,u=>{var d;u.preventDefault(),(d=c.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[a.jsx($ce,{children:r}),a.jsx(Uce,{contentRef:o})]})})})});w6.displayName=wd;var j6="AlertDialogTitle",_6=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Fo(n);return a.jsx(mC,{...s,...r,ref:t})});_6.displayName=j6;var k6="AlertDialogDescription",S6=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Fo(n);return a.jsx(pC,{...s,...r,ref:t})});S6.displayName=k6;var Fce="AlertDialogAction",N6=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,s=Fo(n);return a.jsx(gC,{...s,...r,ref:t})});N6.displayName=Fce;var C6="AlertDialogCancel",A6=p.forwardRef((e,t)=>{const{__scopeAlertDialog:n,...r}=e,{cancelRef:s}=Lce(C6,n),i=Fo(n),o=Ot(t,s);return a.jsx(gC,{...i,...r,ref:o})});A6.displayName=C6;var Uce=({contentRef:e})=>{const t=`\`${wd}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${wd}\` by passing a \`${k6}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${wd}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{var r;document.getElementById((r=e.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(t)},[t,e]),null},Bce=v6,zce=y6,Wce=x6,E6=b6,T6=w6,P6=N6,O6=A6,I6=_6,R6=S6;const Hb=Bce,qce=zce,Hce=Wce,M6=p.forwardRef(({className:e,...t},n)=>a.jsx(E6,{className:Ie("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t,ref:n}));M6.displayName=E6.displayName;const Jp=p.forwardRef(({className:e,...t},n)=>a.jsxs(Hce,{children:[a.jsx(M6,{}),a.jsx(T6,{ref:n,className:Ie("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t})]}));Jp.displayName=T6.displayName;const Qp=({className:e,...t})=>a.jsx("div",{className:Ie("flex flex-col space-y-2 text-center sm:text-left",e),...t});Qp.displayName="AlertDialogHeader";const Zp=({className:e,...t})=>a.jsx("div",{className:Ie("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...t});Zp.displayName="AlertDialogFooter";const eg=p.forwardRef(({className:e,...t},n)=>a.jsx(I6,{ref:n,className:Ie("text-lg font-semibold",e),...t}));eg.displayName=I6.displayName;const tg=p.forwardRef(({className:e,...t},n)=>a.jsx(R6,{ref:n,className:Ie("text-sm text-muted-foreground",e),...t}));tg.displayName=R6.displayName;const ng=p.forwardRef(({className:e,...t},n)=>a.jsx(P6,{ref:n,className:Ie(Hd(),e),...t}));ng.displayName=P6.displayName;const rg=p.forwardRef(({className:e,...t},n)=>a.jsx(O6,{ref:n,className:Ie(Hd({variant:"outline"}),"mt-2 sm:mt-0",e),...t}));rg.displayName=O6.displayName;function Kce(e,t){const n={};return(e[e.length-1]===""?[...e,""]:e).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const Vce=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Gce=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,Yce={};function T2(e,t){return(Yce.jsx?Gce:Vce).test(e)}const Xce=/[ \t\n\f\r]/g;function Jce(e){return typeof e=="object"?e.type==="text"?P2(e.value):!1:P2(e)}function P2(e){return e.replace(Xce,"")===""}class ag{constructor(t,n,r){this.normal=n,this.property=t,r&&(this.space=r)}}ag.prototype.normal={};ag.prototype.property={};ag.prototype.space=void 0;function D6(e,t){const n={},r={};for(const s of e)Object.assign(n,s.property),Object.assign(r,s.normal);return new ag(n,r,t)}function B1(e){return e.toLowerCase()}class Ya{constructor(t,n){this.attribute=n,this.property=t}}Ya.prototype.attribute="";Ya.prototype.booleanish=!1;Ya.prototype.boolean=!1;Ya.prototype.commaOrSpaceSeparated=!1;Ya.prototype.commaSeparated=!1;Ya.prototype.defined=!1;Ya.prototype.mustUseProperty=!1;Ya.prototype.number=!1;Ya.prototype.overloadedBoolean=!1;Ya.prototype.property="";Ya.prototype.spaceSeparated=!1;Ya.prototype.space=void 0;let Qce=0;const Bt=vu(),dr=vu(),z1=vu(),Ye=vu(),In=vu(),jd=vu(),es=vu();function vu(){return 2**++Qce}const W1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Bt,booleanish:dr,commaOrSpaceSeparated:es,commaSeparated:jd,number:Ye,overloadedBoolean:z1,spaceSeparated:In},Symbol.toStringTag,{value:"Module"})),dj=Object.keys(W1);class UC extends Ya{constructor(t,n,r,s){let i=-1;if(super(t,n),O2(this,"space",s),typeof r=="number")for(;++i<dj.length;){const o=dj[i];O2(this,dj[i],(r&W1[o])===W1[o])}}}UC.prototype.defined=!0;function O2(e,t,n){n&&(e[t]=n)}function Dh(e){const t={},n={};for(const[r,s]of Object.entries(e.properties)){const i=new UC(r,e.transform(e.attributes||{},r),s,e.space);e.mustUseProperty&&e.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),t[r]=i,n[B1(r)]=r,n[B1(i.attribute)]=r}return new ag(t,n,e.space)}const L6=Dh({properties:{ariaActiveDescendant:null,ariaAtomic:dr,ariaAutoComplete:null,ariaBusy:dr,ariaChecked:dr,ariaColCount:Ye,ariaColIndex:Ye,ariaColSpan:Ye,ariaControls:In,ariaCurrent:null,ariaDescribedBy:In,ariaDetails:null,ariaDisabled:dr,ariaDropEffect:In,ariaErrorMessage:null,ariaExpanded:dr,ariaFlowTo:In,ariaGrabbed:dr,ariaHasPopup:null,ariaHidden:dr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:In,ariaLevel:Ye,ariaLive:null,ariaModal:dr,ariaMultiLine:dr,ariaMultiSelectable:dr,ariaOrientation:null,ariaOwns:In,ariaPlaceholder:null,ariaPosInSet:Ye,ariaPressed:dr,ariaReadOnly:dr,ariaRelevant:null,ariaRequired:dr,ariaRoleDescription:In,ariaRowCount:Ye,ariaRowIndex:Ye,ariaRowSpan:Ye,ariaSelected:dr,ariaSetSize:Ye,ariaSort:null,ariaValueMax:Ye,ariaValueMin:Ye,ariaValueNow:Ye,ariaValueText:null,role:null},transform(e,t){return t==="role"?t:"aria-"+t.slice(4).toLowerCase()}});function $6(e,t){return t in e?e[t]:t}function F6(e,t){return $6(e,t.toLowerCase())}const Zce=Dh({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:jd,acceptCharset:In,accessKey:In,action:null,allow:null,allowFullScreen:Bt,allowPaymentRequest:Bt,allowUserMedia:Bt,alt:null,as:null,async:Bt,autoCapitalize:null,autoComplete:In,autoFocus:Bt,autoPlay:Bt,blocking:In,capture:null,charSet:null,checked:Bt,cite:null,className:In,cols:Ye,colSpan:null,content:null,contentEditable:dr,controls:Bt,controlsList:In,coords:Ye|jd,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Bt,defer:Bt,dir:null,dirName:null,disabled:Bt,download:z1,draggable:dr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Bt,formTarget:null,headers:In,height:Ye,hidden:z1,high:Ye,href:null,hrefLang:null,htmlFor:In,httpEquiv:In,id:null,imageSizes:null,imageSrcSet:null,inert:Bt,inputMode:null,integrity:null,is:null,isMap:Bt,itemId:null,itemProp:In,itemRef:In,itemScope:Bt,itemType:In,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Bt,low:Ye,manifest:null,max:null,maxLength:Ye,media:null,method:null,min:null,minLength:Ye,multiple:Bt,muted:Bt,name:null,nonce:null,noModule:Bt,noValidate:Bt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Bt,optimum:Ye,pattern:null,ping:In,placeholder:null,playsInline:Bt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Bt,referrerPolicy:null,rel:In,required:Bt,reversed:Bt,rows:Ye,rowSpan:Ye,sandbox:In,scope:null,scoped:Bt,seamless:Bt,selected:Bt,shadowRootClonable:Bt,shadowRootDelegatesFocus:Bt,shadowRootMode:null,shape:null,size:Ye,sizes:null,slot:null,span:Ye,spellCheck:dr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Ye,step:null,style:null,tabIndex:Ye,target:null,title:null,translate:null,type:null,typeMustMatch:Bt,useMap:null,value:dr,width:Ye,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:In,axis:null,background:null,bgColor:null,border:Ye,borderColor:null,bottomMargin:Ye,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Bt,declare:Bt,event:null,face:null,frame:null,frameBorder:null,hSpace:Ye,leftMargin:Ye,link:null,longDesc:null,lowSrc:null,marginHeight:Ye,marginWidth:Ye,noResize:Bt,noHref:Bt,noShade:Bt,noWrap:Bt,object:null,profile:null,prompt:null,rev:null,rightMargin:Ye,rules:null,scheme:null,scrolling:dr,standby:null,summary:null,text:null,topMargin:Ye,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Ye,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Bt,disableRemotePlayback:Bt,prefix:null,property:null,results:Ye,security:null,unselectable:null},space:"html",transform:F6}),eue=Dh({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:es,accentHeight:Ye,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Ye,amplitude:Ye,arabicForm:null,ascent:Ye,attributeName:null,attributeType:null,azimuth:Ye,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Ye,by:null,calcMode:null,capHeight:Ye,className:In,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Ye,diffuseConstant:Ye,direction:null,display:null,dur:null,divisor:Ye,dominantBaseline:null,download:Bt,dx:null,dy:null,edgeMode:null,editable:null,elevation:Ye,enableBackground:null,end:null,event:null,exponent:Ye,externalResourcesRequired:null,fill:null,fillOpacity:Ye,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:jd,g2:jd,glyphName:jd,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Ye,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Ye,horizOriginX:Ye,horizOriginY:Ye,id:null,ideographic:Ye,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Ye,k:Ye,k1:Ye,k2:Ye,k3:Ye,k4:Ye,kernelMatrix:es,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Ye,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Ye,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Ye,overlineThickness:Ye,paintOrder:null,panose1:null,path:null,pathLength:Ye,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:In,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Ye,pointsAtY:Ye,pointsAtZ:Ye,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:es,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:es,rev:es,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:es,requiredFeatures:es,requiredFonts:es,requiredFormats:es,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Ye,specularExponent:Ye,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Ye,strikethroughThickness:Ye,string:null,stroke:null,strokeDashArray:es,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Ye,strokeOpacity:Ye,strokeWidth:null,style:null,surfaceScale:Ye,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:es,tabIndex:Ye,tableValues:null,target:null,targetX:Ye,targetY:Ye,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:es,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Ye,underlineThickness:Ye,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Ye,values:null,vAlphabetic:Ye,vMathematical:Ye,vectorEffect:null,vHanging:Ye,vIdeographic:Ye,version:null,vertAdvY:Ye,vertOriginX:Ye,vertOriginY:Ye,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Ye,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:$6}),U6=Dh({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(e,t){return"xlink:"+t.slice(5).toLowerCase()}}),B6=Dh({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:F6}),z6=Dh({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(e,t){return"xml:"+t.slice(3).toLowerCase()}}),tue={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},nue=/[A-Z]/g,I2=/-[a-z]/g,rue=/^data[-\w.:]+$/i;function aue(e,t){const n=B1(t);let r=t,s=Ya;if(n in e.normal)return e.property[e.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&rue.test(t)){if(t.charAt(4)==="-"){const i=t.slice(5).replace(I2,iue);r="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=t.slice(4);if(!I2.test(i)){let o=i.replace(nue,sue);o.charAt(0)!=="-"&&(o="-"+o),t="data"+o}}s=UC}return new s(r,t)}function sue(e){return"-"+e.toLowerCase()}function iue(e){return e.charAt(1).toUpperCase()}const oue=D6([L6,Zce,U6,B6,z6],"html"),BC=D6([L6,eue,U6,B6,z6],"svg");function lue(e){return e.join(" ").trim()}var zC={},R2=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,cue=/\n/g,uue=/^\s*/,due=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,hue=/^:\s*/,fue=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,mue=/^[;\s]*/,pue=/^\s+|\s+$/g,gue=`
`,M2="/",D2="*",wc="",vue="comment",yue="declaration",xue=function(e,t){if(typeof e!="string")throw new TypeError("First argument must be a string");if(!e)return[];t=t||{};var n=1,r=1;function s(g){var v=g.match(cue);v&&(n+=v.length);var y=g.lastIndexOf(gue);r=~y?g.length-y:r+g.length}function i(){var g={line:n,column:r};return function(v){return v.position=new o(g),u(),v}}function o(g){this.start=g,this.end={line:n,column:r},this.source=t.source}o.prototype.content=e;function l(g){var v=new Error(t.source+":"+n+":"+r+": "+g);if(v.reason=g,v.filename=t.source,v.line=n,v.column=r,v.source=e,!t.silent)throw v}function c(g){var v=g.exec(e);if(v){var y=v[0];return s(y),e=e.slice(y.length),v}}function u(){c(uue)}function d(g){var v;for(g=g||[];v=h();)v!==!1&&g.push(v);return g}function h(){var g=i();if(!(M2!=e.charAt(0)||D2!=e.charAt(1))){for(var v=2;wc!=e.charAt(v)&&(D2!=e.charAt(v)||M2!=e.charAt(v+1));)++v;if(v+=2,wc===e.charAt(v-1))return l("End of comment missing");var y=e.slice(2,v-2);return r+=2,s(y),e=e.slice(v),r+=2,g({type:vue,comment:y})}}function f(){var g=i(),v=c(due);if(v){if(h(),!c(hue))return l("property missing ':'");var y=c(fue),x=g({type:yue,property:L2(v[0].replace(R2,wc)),value:y?L2(y[0].replace(R2,wc)):wc});return c(mue),x}}function m(){var g=[];d(g);for(var v;v=f();)v!==!1&&(g.push(v),d(g));return g}return u(),m()};function L2(e){return e?e.replace(pue,wc):wc}var bue=mr&&mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(zC,"__esModule",{value:!0});zC.default=jue;var wue=bue(xue);function jue(e,t){var n=null;if(!e||typeof e!="string")return n;var r=(0,wue.default)(e),s=typeof t=="function";return r.forEach(function(i){if(i.type==="declaration"){var o=i.property,l=i.value;s?t(o,l,i):l&&(n=n||{},n[o]=l)}}),n}var Kb={};Object.defineProperty(Kb,"__esModule",{value:!0});Kb.camelCase=void 0;var _ue=/^--[a-zA-Z0-9_-]+$/,kue=/-([a-z])/g,Sue=/^[^-]+$/,Nue=/^-(webkit|moz|ms|o|khtml)-/,Cue=/^-(ms)-/,Aue=function(e){return!e||Sue.test(e)||_ue.test(e)},Eue=function(e,t){return t.toUpperCase()},$2=function(e,t){return"".concat(t,"-")},Tue=function(e,t){return t===void 0&&(t={}),Aue(e)?e:(e=e.toLowerCase(),t.reactCompat?e=e.replace(Cue,$2):e=e.replace(Nue,$2),e.replace(kue,Eue))};Kb.camelCase=Tue;var Pue=mr&&mr.__importDefault||function(e){return e&&e.__esModule?e:{default:e}},Oue=Pue(zC),Iue=Kb;function q1(e,t){var n={};return!e||typeof e!="string"||(0,Oue.default)(e,function(r,s){r&&s&&(n[(0,Iue.camelCase)(r,t)]=s)}),n}q1.default=q1;var Rue=q1;const Mue=bn(Rue),W6=q6("end"),WC=q6("start");function q6(e){return t;function t(n){const r=n&&n.position&&n.position[e]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function Due(e){const t=WC(e),n=W6(e);if(t&&n)return{start:t,end:n}}function Yf(e){return!e||typeof e!="object"?"":"position"in e||"type"in e?F2(e.position):"start"in e||"end"in e?F2(e):"line"in e||"column"in e?H1(e):""}function H1(e){return U2(e&&e.line)+":"+U2(e&&e.column)}function F2(e){return H1(e&&e.start)+"-"+H1(e&&e.end)}function U2(e){return e&&typeof e=="number"?e:1}class ca extends Error{constructor(t,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let s="",i={},o=!1;if(n&&("line"in n&&"column"in n?i={place:n}:"start"in n&&"end"in n?i={place:n}:"type"in n?i={ancestors:[n],place:n.position}:i={...n}),typeof t=="string"?s=t:!i.cause&&t&&(o=!0,s=t.message,i.cause=t),!i.ruleId&&!i.source&&typeof r=="string"){const c=r.indexOf(":");c===-1?i.ruleId=r:(i.source=r.slice(0,c),i.ruleId=r.slice(c+1))}if(!i.place&&i.ancestors&&i.ancestors){const c=i.ancestors[i.ancestors.length-1];c&&(i.place=c.position)}const l=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file="",this.message=s,this.line=l?l.line:void 0,this.name=Yf(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=o&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual=void 0,this.expected=void 0,this.note=void 0,this.url=void 0}}ca.prototype.file="";ca.prototype.name="";ca.prototype.reason="";ca.prototype.message="";ca.prototype.stack="";ca.prototype.column=void 0;ca.prototype.line=void 0;ca.prototype.ancestors=void 0;ca.prototype.cause=void 0;ca.prototype.fatal=void 0;ca.prototype.place=void 0;ca.prototype.ruleId=void 0;ca.prototype.source=void 0;const qC={}.hasOwnProperty,Lue=new Map,$ue=/[A-Z]/g,Fue=new Set(["table","tbody","thead","tfoot","tr"]),Uue=new Set(["td","th"]),H6="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function Bue(e,t){if(!t||t.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=t.filePath||void 0;let r;if(t.development){if(typeof t.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=Yue(n,t.jsxDEV)}else{if(typeof t.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof t.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=Gue(n,t.jsx,t.jsxs)}const s={Fragment:t.Fragment,ancestors:[],components:t.components||{},create:r,elementAttributeNameCase:t.elementAttributeNameCase||"react",evaluater:t.createEvaluater?t.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:t.ignoreInvalidStyle||!1,passKeys:t.passKeys!==!1,passNode:t.passNode||!1,schema:t.space==="svg"?BC:oue,stylePropertyNameCase:t.stylePropertyNameCase||"dom",tableCellAlignToStyle:t.tableCellAlignToStyle!==!1},i=K6(s,e,void 0);return i&&typeof i!="string"?i:s.create(e,s.Fragment,{children:i||void 0},void 0)}function K6(e,t,n){if(t.type==="element")return zue(e,t,n);if(t.type==="mdxFlowExpression"||t.type==="mdxTextExpression")return Wue(e,t);if(t.type==="mdxJsxFlowElement"||t.type==="mdxJsxTextElement")return Hue(e,t,n);if(t.type==="mdxjsEsm")return que(e,t);if(t.type==="root")return Kue(e,t,n);if(t.type==="text")return Vue(e,t)}function zue(e,t,n){const r=e.schema;let s=r;t.tagName.toLowerCase()==="svg"&&r.space==="html"&&(s=BC,e.schema=s),e.ancestors.push(t);const i=G6(e,t.tagName,!1),o=Xue(e,t);let l=KC(e,t);return Fue.has(t.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!Jce(c):!0})),V6(e,o,i,t),HC(o,l),e.ancestors.pop(),e.schema=r,e.create(t,i,o,n)}function Wue(e,t){if(t.data&&t.data.estree&&e.evaluater){const r=t.data.estree.body[0];return r.type,e.evaluater.evaluateExpression(r.expression)}Bm(e,t.position)}function que(e,t){if(t.data&&t.data.estree&&e.evaluater)return e.evaluater.evaluateProgram(t.data.estree);Bm(e,t.position)}function Hue(e,t,n){const r=e.schema;let s=r;t.name==="svg"&&r.space==="html"&&(s=BC,e.schema=s),e.ancestors.push(t);const i=t.name===null?e.Fragment:G6(e,t.name,!0),o=Jue(e,t),l=KC(e,t);return V6(e,o,i,t),HC(o,l),e.ancestors.pop(),e.schema=r,e.create(t,i,o,n)}function Kue(e,t,n){const r={};return HC(r,KC(e,t)),e.create(t,e.Fragment,r,n)}function Vue(e,t){return t.value}function V6(e,t,n,r){typeof n!="string"&&n!==e.Fragment&&e.passNode&&(t.node=r)}function HC(e,t){if(t.length>0){const n=t.length>1?t:t[0];n&&(e.children=n)}}function Gue(e,t,n){return r;function r(s,i,o,l){const u=Array.isArray(o.children)?n:t;return l?u(i,o,l):u(i,o)}}function Yue(e,t){return n;function n(r,s,i,o){const l=Array.isArray(i.children),c=WC(r);return t(s,i,o,l,{columnNumber:c?c.column-1:void 0,fileName:e,lineNumber:c?c.line:void 0},void 0)}}function Xue(e,t){const n={};let r,s;for(s in t.properties)if(s!=="children"&&qC.call(t.properties,s)){const i=Que(e,s,t.properties[s]);if(i){const[o,l]=i;e.tableCellAlignToStyle&&o==="align"&&typeof l=="string"&&Uue.has(t.tagName)?r=l:n[o]=l}}if(r){const i=n.style||(n.style={});i[e.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function Jue(e,t){const n={};for(const r of t.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&e.evaluater){const i=r.data.estree.body[0];i.type;const o=i.expression;o.type;const l=o.properties[0];l.type,Object.assign(n,e.evaluater.evaluateExpression(l.argument))}else Bm(e,t.position);else{const s=r.name;let i;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&e.evaluater){const l=r.value.data.estree.body[0];l.type,i=e.evaluater.evaluateExpression(l.expression)}else Bm(e,t.position);else i=r.value===null?!0:r.value;n[s]=i}return n}function KC(e,t){const n=[];let r=-1;const s=e.passKeys?new Map:Lue;for(;++r<t.children.length;){const i=t.children[r];let o;if(e.passKeys){const c=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(c){const u=s.get(c)||0;o=c+"-"+u,s.set(c,u+1)}}const l=K6(e,i,o);l!==void 0&&n.push(l)}return n}function Que(e,t,n){const r=aue(e.schema,t);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?Kce(n):lue(n)),r.property==="style"){let s=typeof n=="object"?n:Zue(e,String(n));return e.stylePropertyNameCase==="css"&&(s=ede(s)),["style",s]}return[e.elementAttributeNameCase==="react"&&r.space?tue[r.property]||r.property:r.attribute,n]}}function Zue(e,t){try{return Mue(t,{reactCompat:!0})}catch(n){if(e.ignoreInvalidStyle)return{};const r=n,s=new ca("Cannot parse `style` attribute",{ancestors:e.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw s.file=e.filePath||void 0,s.url=H6+"#cannot-parse-style-attribute",s}}function G6(e,t,n){let r;if(!n)r={type:"Literal",value:t};else if(t.includes(".")){const s=t.split(".");let i=-1,o;for(;++i<s.length;){const l=T2(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};o=o?{type:"MemberExpression",object:o,property:l,computed:!!(i&&l.type==="Literal"),optional:!1}:l}r=o}else r=T2(t)&&!/^[a-z]/.test(t)?{type:"Identifier",name:t}:{type:"Literal",value:t};if(r.type==="Literal"){const s=r.value;return qC.call(e.components,s)?e.components[s]:s}if(e.evaluater)return e.evaluater.evaluateExpression(r);Bm(e)}function Bm(e,t){const n=new ca("Cannot handle MDX estrees without `createEvaluater`",{ancestors:e.ancestors,place:t,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=e.filePath||void 0,n.url=H6+"#cannot-handle-mdx-estrees-without-createevaluater",n}function ede(e){const t={};let n;for(n in e)qC.call(e,n)&&(t[tde(n)]=e[n]);return t}function tde(e){let t=e.replace($ue,nde);return t.slice(0,3)==="ms-"&&(t="-"+t),t}function nde(e){return"-"+e.toLowerCase()}const hj={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},rde={};function VC(e,t){const n=rde,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,s=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return Y6(e,r,s)}function Y6(e,t,n){if(ade(e)){if("value"in e)return e.type==="html"&&!n?"":e.value;if(t&&"alt"in e&&e.alt)return e.alt;if("children"in e)return B2(e.children,t,n)}return Array.isArray(e)?B2(e,t,n):""}function B2(e,t,n){const r=[];let s=-1;for(;++s<e.length;)r[s]=Y6(e[s],t,n);return r.join("")}function ade(e){return!!(e&&typeof e=="object")}const z2=document.createElement("i");function GC(e){const t="&"+e+";";z2.innerHTML=t;const n=z2.textContent;return n.charCodeAt(n.length-1)===59&&e!=="semi"||n===t?!1:n}function cs(e,t,n,r){const s=e.length;let i=0,o;if(t<0?t=-t>s?0:s+t:t=t>s?s:t,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(t,n),e.splice(...o);else for(n&&e.splice(t,n);i<r.length;)o=r.slice(i,i+1e4),o.unshift(t,0),e.splice(...o),i+=1e4,t+=1e4}function ks(e,t){return e.length>0?(cs(e,e.length,0,t),e):t}const W2={}.hasOwnProperty;function X6(e){const t={};let n=-1;for(;++n<e.length;)sde(t,e[n]);return t}function sde(e,t){let n;for(n in t){const s=(W2.call(e,n)?e[n]:void 0)||(e[n]={}),i=t[n];let o;if(i)for(o in i){W2.call(s,o)||(s[o]=[]);const l=i[o];ide(s[o],Array.isArray(l)?l:l?[l]:[])}}}function ide(e,t){let n=-1;const r=[];for(;++n<t.length;)(t[n].add==="after"?e:r).push(t[n]);cs(e,0,0,r)}function J6(e,t){const n=Number.parseInt(e,t);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":String.fromCodePoint(n)}function li(e){return e.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const wa=Zl(/[A-Za-z]/),oa=Zl(/[\dA-Za-z]/),ode=Zl(/[#-'*+\--9=?A-Z^-~]/);function My(e){return e!==null&&(e<32||e===127)}const K1=Zl(/\d/),lde=Zl(/[\dA-Fa-f]/),cde=Zl(/[!-/:-@[-`{-~]/);function St(e){return e!==null&&e<-2}function An(e){return e!==null&&(e<0||e===32)}function Yt(e){return e===-2||e===-1||e===32}const Vb=Zl(new RegExp("\\p{P}|\\p{S}","u")),tu=Zl(/\s/);function Zl(e){return t;function t(n){return n!==null&&n>-1&&e.test(String.fromCharCode(n))}}function Lh(e){const t=[];let n=-1,r=0,s=0;for(;++n<e.length;){const i=e.charCodeAt(n);let o="";if(i===37&&oa(e.charCodeAt(n+1))&&oa(e.charCodeAt(n+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(o=String.fromCharCode(i));else if(i>55295&&i<57344){const l=e.charCodeAt(n+1);i<56320&&l>56319&&l<57344?(o=String.fromCharCode(i,l),s=1):o=""}else o=String.fromCharCode(i);o&&(t.push(e.slice(r,n),encodeURIComponent(o)),r=n+s+1,o=""),s&&(n+=s,s=0)}return t.join("")+e.slice(r)}function rn(e,t,n,r){const s=r?r-1:Number.POSITIVE_INFINITY;let i=0;return o;function o(c){return Yt(c)?(e.enter(n),l(c)):t(c)}function l(c){return Yt(c)&&i++<s?(e.consume(c),l):(e.exit(n),t(c))}}const ude={tokenize:dde};function dde(e){const t=e.attempt(this.parser.constructs.contentInitial,r,s);let n;return t;function r(l){if(l===null){e.consume(l);return}return e.enter("lineEnding"),e.consume(l),e.exit("lineEnding"),rn(e,t,"linePrefix")}function s(l){return e.enter("paragraph"),i(l)}function i(l){const c=e.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,o(l)}function o(l){if(l===null){e.exit("chunkText"),e.exit("paragraph"),e.consume(l);return}return St(l)?(e.consume(l),e.exit("chunkText"),i):(e.consume(l),o)}}const hde={tokenize:fde},q2={tokenize:mde};function fde(e){const t=this,n=[];let r=0,s,i,o;return l;function l(b){if(r<n.length){const _=n[r];return t.containerState=_[1],e.attempt(_[0].continuation,c,u)(b)}return u(b)}function c(b){if(r++,t.containerState._closeFlow){t.containerState._closeFlow=void 0,s&&w();const _=t.events.length;let k=_,j;for(;k--;)if(t.events[k][0]==="exit"&&t.events[k][1].type==="chunkFlow"){j=t.events[k][1].end;break}x(r);let S=_;for(;S<t.events.length;)t.events[S][1].end={...j},S++;return cs(t.events,k+1,0,t.events.slice(_)),t.events.length=S,u(b)}return l(b)}function u(b){if(r===n.length){if(!s)return f(b);if(s.currentConstruct&&s.currentConstruct.concrete)return g(b);t.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return t.containerState={},e.check(q2,d,h)(b)}function d(b){return s&&w(),x(r),f(b)}function h(b){return t.parser.lazy[t.now().line]=r!==n.length,o=t.now().offset,g(b)}function f(b){return t.containerState={},e.attempt(q2,m,g)(b)}function m(b){return r++,n.push([t.currentConstruct,t.containerState]),f(b)}function g(b){if(b===null){s&&w(),x(0),e.consume(b);return}return s=s||t.parser.flow(t.now()),e.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),v(b)}function v(b){if(b===null){y(e.exit("chunkFlow"),!0),x(0),e.consume(b);return}return St(b)?(e.consume(b),y(e.exit("chunkFlow")),r=0,t.interrupt=void 0,l):(e.consume(b),v)}function y(b,_){const k=t.sliceStream(b);if(_&&k.push(null),b.previous=i,i&&(i.next=b),i=b,s.defineSkip(b.start),s.write(k),t.parser.lazy[b.start.line]){let j=s.events.length;for(;j--;)if(s.events[j][1].start.offset<o&&(!s.events[j][1].end||s.events[j][1].end.offset>o))return;const S=t.events.length;let T=S,O,A;for(;T--;)if(t.events[T][0]==="exit"&&t.events[T][1].type==="chunkFlow"){if(O){A=t.events[T][1].end;break}O=!0}for(x(r),j=S;j<t.events.length;)t.events[j][1].end={...A},j++;cs(t.events,T+1,0,t.events.slice(S)),t.events.length=j}}function x(b){let _=n.length;for(;_-- >b;){const k=n[_];t.containerState=k[1],k[0].exit.call(t,e)}n.length=b}function w(){s.write([null]),i=void 0,s=void 0,t.containerState._closeFlow=void 0}}function mde(e,t,n){return rn(e,e.attempt(this.parser.constructs.document,t,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function Zd(e){if(e===null||An(e)||tu(e))return 1;if(Vb(e))return 2}function Gb(e,t,n){const r=[];let s=-1;for(;++s<e.length;){const i=e[s].resolveAll;i&&!r.includes(i)&&(t=i(t,n),r.push(i))}return t}const V1={name:"attention",resolveAll:pde,tokenize:gde};function pde(e,t){let n=-1,r,s,i,o,l,c,u,d;for(;++n<e.length;)if(e[n][0]==="enter"&&e[n][1].type==="attentionSequence"&&e[n][1]._close){for(r=n;r--;)if(e[r][0]==="exit"&&e[r][1].type==="attentionSequence"&&e[r][1]._open&&t.sliceSerialize(e[r][1]).charCodeAt(0)===t.sliceSerialize(e[n][1]).charCodeAt(0)){if((e[r][1]._close||e[n][1]._open)&&(e[n][1].end.offset-e[n][1].start.offset)%3&&!((e[r][1].end.offset-e[r][1].start.offset+e[n][1].end.offset-e[n][1].start.offset)%3))continue;c=e[r][1].end.offset-e[r][1].start.offset>1&&e[n][1].end.offset-e[n][1].start.offset>1?2:1;const h={...e[r][1].end},f={...e[n][1].start};H2(h,-c),H2(f,c),o={type:c>1?"strongSequence":"emphasisSequence",start:h,end:{...e[r][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...e[n][1].start},end:f},i={type:c>1?"strongText":"emphasisText",start:{...e[r][1].end},end:{...e[n][1].start}},s={type:c>1?"strong":"emphasis",start:{...o.start},end:{...l.end}},e[r][1].end={...o.start},e[n][1].start={...l.end},u=[],e[r][1].end.offset-e[r][1].start.offset&&(u=ks(u,[["enter",e[r][1],t],["exit",e[r][1],t]])),u=ks(u,[["enter",s,t],["enter",o,t],["exit",o,t],["enter",i,t]]),u=ks(u,Gb(t.parser.constructs.insideSpan.null,e.slice(r+1,n),t)),u=ks(u,[["exit",i,t],["enter",l,t],["exit",l,t],["exit",s,t]]),e[n][1].end.offset-e[n][1].start.offset?(d=2,u=ks(u,[["enter",e[n][1],t],["exit",e[n][1],t]])):d=0,cs(e,r-1,n-r+3,u),n=r+u.length-d-2;break}}for(n=-1;++n<e.length;)e[n][1].type==="attentionSequence"&&(e[n][1].type="data");return e}function gde(e,t){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,s=Zd(r);let i;return o;function o(c){return i=c,e.enter("attentionSequence"),l(c)}function l(c){if(c===i)return e.consume(c),l;const u=e.exit("attentionSequence"),d=Zd(c),h=!d||d===2&&s||n.includes(c),f=!s||s===2&&d||n.includes(r);return u._open=!!(i===42?h:h&&(s||!f)),u._close=!!(i===42?f:f&&(d||!h)),t(c)}}function H2(e,t){e.column+=t,e.offset+=t,e._bufferIndex+=t}const vde={name:"autolink",tokenize:yde};function yde(e,t,n){let r=0;return s;function s(m){return e.enter("autolink"),e.enter("autolinkMarker"),e.consume(m),e.exit("autolinkMarker"),e.enter("autolinkProtocol"),i}function i(m){return wa(m)?(e.consume(m),o):m===64?n(m):u(m)}function o(m){return m===43||m===45||m===46||oa(m)?(r=1,l(m)):u(m)}function l(m){return m===58?(e.consume(m),r=0,c):(m===43||m===45||m===46||oa(m))&&r++<32?(e.consume(m),l):(r=0,u(m))}function c(m){return m===62?(e.exit("autolinkProtocol"),e.enter("autolinkMarker"),e.consume(m),e.exit("autolinkMarker"),e.exit("autolink"),t):m===null||m===32||m===60||My(m)?n(m):(e.consume(m),c)}function u(m){return m===64?(e.consume(m),d):ode(m)?(e.consume(m),u):n(m)}function d(m){return oa(m)?h(m):n(m)}function h(m){return m===46?(e.consume(m),r=0,d):m===62?(e.exit("autolinkProtocol").type="autolinkEmail",e.enter("autolinkMarker"),e.consume(m),e.exit("autolinkMarker"),e.exit("autolink"),t):f(m)}function f(m){if((m===45||oa(m))&&r++<63){const g=m===45?f:h;return e.consume(m),g}return n(m)}}const sg={partial:!0,tokenize:xde};function xde(e,t,n){return r;function r(i){return Yt(i)?rn(e,s,"linePrefix")(i):s(i)}function s(i){return i===null||St(i)?t(i):n(i)}}const Q6={continuation:{tokenize:wde},exit:jde,name:"blockQuote",tokenize:bde};function bde(e,t,n){const r=this;return s;function s(o){if(o===62){const l=r.containerState;return l.open||(e.enter("blockQuote",{_container:!0}),l.open=!0),e.enter("blockQuotePrefix"),e.enter("blockQuoteMarker"),e.consume(o),e.exit("blockQuoteMarker"),i}return n(o)}function i(o){return Yt(o)?(e.enter("blockQuotePrefixWhitespace"),e.consume(o),e.exit("blockQuotePrefixWhitespace"),e.exit("blockQuotePrefix"),t):(e.exit("blockQuotePrefix"),t(o))}}function wde(e,t,n){const r=this;return s;function s(o){return Yt(o)?rn(e,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):i(o)}function i(o){return e.attempt(Q6,t,n)(o)}}function jde(e){e.exit("blockQuote")}const Z6={name:"characterEscape",tokenize:_de};function _de(e,t,n){return r;function r(i){return e.enter("characterEscape"),e.enter("escapeMarker"),e.consume(i),e.exit("escapeMarker"),s}function s(i){return cde(i)?(e.enter("characterEscapeValue"),e.consume(i),e.exit("characterEscapeValue"),e.exit("characterEscape"),t):n(i)}}const ez={name:"characterReference",tokenize:kde};function kde(e,t,n){const r=this;let s=0,i,o;return l;function l(h){return e.enter("characterReference"),e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),c}function c(h){return h===35?(e.enter("characterReferenceMarkerNumeric"),e.consume(h),e.exit("characterReferenceMarkerNumeric"),u):(e.enter("characterReferenceValue"),i=31,o=oa,d(h))}function u(h){return h===88||h===120?(e.enter("characterReferenceMarkerHexadecimal"),e.consume(h),e.exit("characterReferenceMarkerHexadecimal"),e.enter("characterReferenceValue"),i=6,o=lde,d):(e.enter("characterReferenceValue"),i=7,o=K1,d(h))}function d(h){if(h===59&&s){const f=e.exit("characterReferenceValue");return o===oa&&!GC(r.sliceSerialize(f))?n(h):(e.enter("characterReferenceMarker"),e.consume(h),e.exit("characterReferenceMarker"),e.exit("characterReference"),t)}return o(h)&&s++<i?(e.consume(h),d):n(h)}}const K2={partial:!0,tokenize:Nde},V2={concrete:!0,name:"codeFenced",tokenize:Sde};function Sde(e,t,n){const r=this,s={partial:!0,tokenize:k};let i=0,o=0,l;return c;function c(j){return u(j)}function u(j){const S=r.events[r.events.length-1];return i=S&&S[1].type==="linePrefix"?S[2].sliceSerialize(S[1],!0).length:0,l=j,e.enter("codeFenced"),e.enter("codeFencedFence"),e.enter("codeFencedFenceSequence"),d(j)}function d(j){return j===l?(o++,e.consume(j),d):o<3?n(j):(e.exit("codeFencedFenceSequence"),Yt(j)?rn(e,h,"whitespace")(j):h(j))}function h(j){return j===null||St(j)?(e.exit("codeFencedFence"),r.interrupt?t(j):e.check(K2,v,_)(j)):(e.enter("codeFencedFenceInfo"),e.enter("chunkString",{contentType:"string"}),f(j))}function f(j){return j===null||St(j)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),h(j)):Yt(j)?(e.exit("chunkString"),e.exit("codeFencedFenceInfo"),rn(e,m,"whitespace")(j)):j===96&&j===l?n(j):(e.consume(j),f)}function m(j){return j===null||St(j)?h(j):(e.enter("codeFencedFenceMeta"),e.enter("chunkString",{contentType:"string"}),g(j))}function g(j){return j===null||St(j)?(e.exit("chunkString"),e.exit("codeFencedFenceMeta"),h(j)):j===96&&j===l?n(j):(e.consume(j),g)}function v(j){return e.attempt(s,_,y)(j)}function y(j){return e.enter("lineEnding"),e.consume(j),e.exit("lineEnding"),x}function x(j){return i>0&&Yt(j)?rn(e,w,"linePrefix",i+1)(j):w(j)}function w(j){return j===null||St(j)?e.check(K2,v,_)(j):(e.enter("codeFlowValue"),b(j))}function b(j){return j===null||St(j)?(e.exit("codeFlowValue"),w(j)):(e.consume(j),b)}function _(j){return e.exit("codeFenced"),t(j)}function k(j,S,T){let O=0;return A;function A($){return j.enter("lineEnding"),j.consume($),j.exit("lineEnding"),N}function N($){return j.enter("codeFencedFence"),Yt($)?rn(j,L,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)($):L($)}function L($){return $===l?(j.enter("codeFencedFenceSequence"),M($)):T($)}function M($){return $===l?(O++,j.consume($),M):O>=o?(j.exit("codeFencedFenceSequence"),Yt($)?rn(j,B,"whitespace")($):B($)):T($)}function B($){return $===null||St($)?(j.exit("codeFencedFence"),S($)):T($)}}}function Nde(e,t,n){const r=this;return s;function s(o){return o===null?n(o):(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),i)}function i(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}const fj={name:"codeIndented",tokenize:Ade},Cde={partial:!0,tokenize:Ede};function Ade(e,t,n){const r=this;return s;function s(u){return e.enter("codeIndented"),rn(e,i,"linePrefix",5)(u)}function i(u){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?o(u):n(u)}function o(u){return u===null?c(u):St(u)?e.attempt(Cde,o,c)(u):(e.enter("codeFlowValue"),l(u))}function l(u){return u===null||St(u)?(e.exit("codeFlowValue"),o(u)):(e.consume(u),l)}function c(u){return e.exit("codeIndented"),t(u)}}function Ede(e,t,n){const r=this;return s;function s(o){return r.parser.lazy[r.now().line]?n(o):St(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),s):rn(e,i,"linePrefix",5)(o)}function i(o){const l=r.events[r.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(o):St(o)?s(o):n(o)}}const Tde={name:"codeText",previous:Ode,resolve:Pde,tokenize:Ide};function Pde(e){let t=e.length-4,n=3,r,s;if((e[n][1].type==="lineEnding"||e[n][1].type==="space")&&(e[t][1].type==="lineEnding"||e[t][1].type==="space")){for(r=n;++r<t;)if(e[r][1].type==="codeTextData"){e[n][1].type="codeTextPadding",e[t][1].type="codeTextPadding",n+=2,t-=2;break}}for(r=n-1,t++;++r<=t;)s===void 0?r!==t&&e[r][1].type!=="lineEnding"&&(s=r):(r===t||e[r][1].type==="lineEnding")&&(e[s][1].type="codeTextData",r!==s+2&&(e[s][1].end=e[r-1][1].end,e.splice(s+2,r-s-2),t-=r-s-2,r=s+2),s=void 0);return e}function Ode(e){return e!==96||this.events[this.events.length-1][1].type==="characterEscape"}function Ide(e,t,n){let r=0,s,i;return o;function o(h){return e.enter("codeText"),e.enter("codeTextSequence"),l(h)}function l(h){return h===96?(e.consume(h),r++,l):(e.exit("codeTextSequence"),c(h))}function c(h){return h===null?n(h):h===32?(e.enter("space"),e.consume(h),e.exit("space"),c):h===96?(i=e.enter("codeTextSequence"),s=0,d(h)):St(h)?(e.enter("lineEnding"),e.consume(h),e.exit("lineEnding"),c):(e.enter("codeTextData"),u(h))}function u(h){return h===null||h===32||h===96||St(h)?(e.exit("codeTextData"),c(h)):(e.consume(h),u)}function d(h){return h===96?(e.consume(h),s++,d):s===r?(e.exit("codeTextSequence"),e.exit("codeText"),t(h)):(i.type="codeTextData",u(h))}}class Rde{constructor(t){this.left=t?[...t]:[],this.right=[]}get(t){if(t<0||t>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+t+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return t<this.left.length?this.left[t]:this.right[this.right.length-t+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(t,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(t,r):t>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-t+this.left.length).reverse():this.left.slice(t).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(t,n,r){const s=n||0;this.setCursor(Math.trunc(t));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return r&&hf(this.left,r),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(t){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(t)}pushMany(t){this.setCursor(Number.POSITIVE_INFINITY),hf(this.left,t)}unshift(t){this.setCursor(0),this.right.push(t)}unshiftMany(t){this.setCursor(0),hf(this.right,t.reverse())}setCursor(t){if(!(t===this.left.length||t>this.left.length&&this.right.length===0||t<0&&this.left.length===0))if(t<this.left.length){const n=this.left.splice(t,Number.POSITIVE_INFINITY);hf(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-t,Number.POSITIVE_INFINITY);hf(this.left,n.reverse())}}}function hf(e,t){let n=0;if(t.length<1e4)e.push(...t);else for(;n<t.length;)e.push(...t.slice(n,n+1e4)),n+=1e4}function tz(e){const t={};let n=-1,r,s,i,o,l,c,u;const d=new Rde(e);for(;++n<d.length;){for(;n in t;)n=t[n];if(r=d.get(n),n&&r[1].type==="chunkFlow"&&d.get(n-1)[1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,i=0,i<c.length&&c[i][1].type==="lineEndingBlank"&&(i+=2),i<c.length&&c[i][1].type==="content"))for(;++i<c.length&&c[i][1].type!=="content";)c[i][1].type==="chunkText"&&(c[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(t,Mde(d,n)),n=t[n],u=!0);else if(r[1]._container){for(i=n,s=void 0;i--;)if(o=d.get(i),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),o[1].type="lineEnding",s=i);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;s&&(r[1].end={...d.get(s)[1].start},l=d.slice(s,n),l.unshift(r),d.splice(s,n-s+1,l))}}return cs(e,0,Number.POSITIVE_INFINITY,d.slice(0)),!u}function Mde(e,t){const n=e.get(t)[1],r=e.get(t)[2];let s=t-1;const i=[];let o=n._tokenizer;o||(o=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const l=o.events,c=[],u={};let d,h,f=-1,m=n,g=0,v=0;const y=[v];for(;m;){for(;e.get(++s)[1]!==m;);i.push(s),m._tokenizer||(d=r.sliceStream(m),m.next||d.push(null),h&&o.defineSkip(m.start),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(d),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),h=m,m=m.next}for(m=n;++f<l.length;)l[f][0]==="exit"&&l[f-1][0]==="enter"&&l[f][1].type===l[f-1][1].type&&l[f][1].start.line!==l[f][1].end.line&&(v=f+1,y.push(v),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(o.events=[],m?(m._tokenizer=void 0,m.previous=void 0):y.pop(),f=y.length;f--;){const x=l.slice(y[f],y[f+1]),w=i.pop();c.push([w,w+x.length-1]),e.splice(w,2,x)}for(c.reverse(),f=-1;++f<c.length;)u[g+c[f][0]]=g+c[f][1],g+=c[f][1]-c[f][0]-1;return u}const Dde={resolve:$de,tokenize:Fde},Lde={partial:!0,tokenize:Ude};function $de(e){return tz(e),e}function Fde(e,t){let n;return r;function r(l){return e.enter("content"),n=e.enter("chunkContent",{contentType:"content"}),s(l)}function s(l){return l===null?i(l):St(l)?e.check(Lde,o,i)(l):(e.consume(l),s)}function i(l){return e.exit("chunkContent"),e.exit("content"),t(l)}function o(l){return e.consume(l),e.exit("chunkContent"),n.next=e.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,s}}function Ude(e,t,n){const r=this;return s;function s(o){return e.exit("chunkContent"),e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),rn(e,i,"linePrefix")}function i(o){if(o===null||St(o))return n(o);const l=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?t(o):e.interrupt(r.parser.constructs.flow,n,t)(o)}}function nz(e,t,n,r,s,i,o,l,c){const u=c||Number.POSITIVE_INFINITY;let d=0;return h;function h(x){return x===60?(e.enter(r),e.enter(s),e.enter(i),e.consume(x),e.exit(i),f):x===null||x===32||x===41||My(x)?n(x):(e.enter(r),e.enter(o),e.enter(l),e.enter("chunkString",{contentType:"string"}),v(x))}function f(x){return x===62?(e.enter(i),e.consume(x),e.exit(i),e.exit(s),e.exit(r),t):(e.enter(l),e.enter("chunkString",{contentType:"string"}),m(x))}function m(x){return x===62?(e.exit("chunkString"),e.exit(l),f(x)):x===null||x===60||St(x)?n(x):(e.consume(x),x===92?g:m)}function g(x){return x===60||x===62||x===92?(e.consume(x),m):m(x)}function v(x){return!d&&(x===null||x===41||An(x))?(e.exit("chunkString"),e.exit(l),e.exit(o),e.exit(r),t(x)):d<u&&x===40?(e.consume(x),d++,v):x===41?(e.consume(x),d--,v):x===null||x===32||x===40||My(x)?n(x):(e.consume(x),x===92?y:v)}function y(x){return x===40||x===41||x===92?(e.consume(x),v):v(x)}}function rz(e,t,n,r,s,i){const o=this;let l=0,c;return u;function u(m){return e.enter(r),e.enter(s),e.consume(m),e.exit(s),e.enter(i),d}function d(m){return l>999||m===null||m===91||m===93&&!c||m===94&&!l&&"_hiddenFootnoteSupport"in o.parser.constructs?n(m):m===93?(e.exit(i),e.enter(s),e.consume(m),e.exit(s),e.exit(r),t):St(m)?(e.enter("lineEnding"),e.consume(m),e.exit("lineEnding"),d):(e.enter("chunkString",{contentType:"string"}),h(m))}function h(m){return m===null||m===91||m===93||St(m)||l++>999?(e.exit("chunkString"),d(m)):(e.consume(m),c||(c=!Yt(m)),m===92?f:h)}function f(m){return m===91||m===92||m===93?(e.consume(m),l++,h):h(m)}}function az(e,t,n,r,s,i){let o;return l;function l(f){return f===34||f===39||f===40?(e.enter(r),e.enter(s),e.consume(f),e.exit(s),o=f===40?41:f,c):n(f)}function c(f){return f===o?(e.enter(s),e.consume(f),e.exit(s),e.exit(r),t):(e.enter(i),u(f))}function u(f){return f===o?(e.exit(i),c(o)):f===null?n(f):St(f)?(e.enter("lineEnding"),e.consume(f),e.exit("lineEnding"),rn(e,u,"linePrefix")):(e.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===o||f===null||St(f)?(e.exit("chunkString"),u(f)):(e.consume(f),f===92?h:d)}function h(f){return f===o||f===92?(e.consume(f),d):d(f)}}function Xf(e,t){let n;return r;function r(s){return St(s)?(e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),n=!0,r):Yt(s)?rn(e,r,n?"linePrefix":"lineSuffix")(s):t(s)}}const Bde={name:"definition",tokenize:Wde},zde={partial:!0,tokenize:qde};function Wde(e,t,n){const r=this;let s;return i;function i(m){return e.enter("definition"),o(m)}function o(m){return rz.call(r,e,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function l(m){return s=li(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),m===58?(e.enter("definitionMarker"),e.consume(m),e.exit("definitionMarker"),c):n(m)}function c(m){return An(m)?Xf(e,u)(m):u(m)}function u(m){return nz(e,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function d(m){return e.attempt(zde,h,h)(m)}function h(m){return Yt(m)?rn(e,f,"whitespace")(m):f(m)}function f(m){return m===null||St(m)?(e.exit("definition"),r.parser.defined.push(s),t(m)):n(m)}}function qde(e,t,n){return r;function r(l){return An(l)?Xf(e,s)(l):n(l)}function s(l){return az(e,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function i(l){return Yt(l)?rn(e,o,"whitespace")(l):o(l)}function o(l){return l===null||St(l)?t(l):n(l)}}const Hde={name:"hardBreakEscape",tokenize:Kde};function Kde(e,t,n){return r;function r(i){return e.enter("hardBreakEscape"),e.consume(i),s}function s(i){return St(i)?(e.exit("hardBreakEscape"),t(i)):n(i)}}const Vde={name:"headingAtx",resolve:Gde,tokenize:Yde};function Gde(e,t){let n=e.length-2,r=3,s,i;return e[r][1].type==="whitespace"&&(r+=2),n-2>r&&e[n][1].type==="whitespace"&&(n-=2),e[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&e[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(s={type:"atxHeadingText",start:e[r][1].start,end:e[n][1].end},i={type:"chunkText",start:e[r][1].start,end:e[n][1].end,contentType:"text"},cs(e,r,n-r+1,[["enter",s,t],["enter",i,t],["exit",i,t],["exit",s,t]])),e}function Yde(e,t,n){let r=0;return s;function s(d){return e.enter("atxHeading"),i(d)}function i(d){return e.enter("atxHeadingSequence"),o(d)}function o(d){return d===35&&r++<6?(e.consume(d),o):d===null||An(d)?(e.exit("atxHeadingSequence"),l(d)):n(d)}function l(d){return d===35?(e.enter("atxHeadingSequence"),c(d)):d===null||St(d)?(e.exit("atxHeading"),t(d)):Yt(d)?rn(e,l,"whitespace")(d):(e.enter("atxHeadingText"),u(d))}function c(d){return d===35?(e.consume(d),c):(e.exit("atxHeadingSequence"),l(d))}function u(d){return d===null||d===35||An(d)?(e.exit("atxHeadingText"),l(d)):(e.consume(d),u)}}const Xde=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],G2=["pre","script","style","textarea"],Jde={concrete:!0,name:"htmlFlow",resolveTo:ehe,tokenize:the},Qde={partial:!0,tokenize:rhe},Zde={partial:!0,tokenize:nhe};function ehe(e){let t=e.length;for(;t--&&!(e[t][0]==="enter"&&e[t][1].type==="htmlFlow"););return t>1&&e[t-2][1].type==="linePrefix"&&(e[t][1].start=e[t-2][1].start,e[t+1][1].start=e[t-2][1].start,e.splice(t-2,2)),e}function the(e,t,n){const r=this;let s,i,o,l,c;return u;function u(P){return d(P)}function d(P){return e.enter("htmlFlow"),e.enter("htmlFlowData"),e.consume(P),h}function h(P){return P===33?(e.consume(P),f):P===47?(e.consume(P),i=!0,v):P===63?(e.consume(P),s=3,r.interrupt?t:E):wa(P)?(e.consume(P),o=String.fromCharCode(P),y):n(P)}function f(P){return P===45?(e.consume(P),s=2,m):P===91?(e.consume(P),s=5,l=0,g):wa(P)?(e.consume(P),s=4,r.interrupt?t:E):n(P)}function m(P){return P===45?(e.consume(P),r.interrupt?t:E):n(P)}function g(P){const U="CDATA[";return P===U.charCodeAt(l++)?(e.consume(P),l===U.length?r.interrupt?t:L:g):n(P)}function v(P){return wa(P)?(e.consume(P),o=String.fromCharCode(P),y):n(P)}function y(P){if(P===null||P===47||P===62||An(P)){const U=P===47,Z=o.toLowerCase();return!U&&!i&&G2.includes(Z)?(s=1,r.interrupt?t(P):L(P)):Xde.includes(o.toLowerCase())?(s=6,U?(e.consume(P),x):r.interrupt?t(P):L(P)):(s=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(P):i?w(P):b(P))}return P===45||oa(P)?(e.consume(P),o+=String.fromCharCode(P),y):n(P)}function x(P){return P===62?(e.consume(P),r.interrupt?t:L):n(P)}function w(P){return Yt(P)?(e.consume(P),w):A(P)}function b(P){return P===47?(e.consume(P),A):P===58||P===95||wa(P)?(e.consume(P),_):Yt(P)?(e.consume(P),b):A(P)}function _(P){return P===45||P===46||P===58||P===95||oa(P)?(e.consume(P),_):k(P)}function k(P){return P===61?(e.consume(P),j):Yt(P)?(e.consume(P),k):b(P)}function j(P){return P===null||P===60||P===61||P===62||P===96?n(P):P===34||P===39?(e.consume(P),c=P,S):Yt(P)?(e.consume(P),j):T(P)}function S(P){return P===c?(e.consume(P),c=null,O):P===null||St(P)?n(P):(e.consume(P),S)}function T(P){return P===null||P===34||P===39||P===47||P===60||P===61||P===62||P===96||An(P)?k(P):(e.consume(P),T)}function O(P){return P===47||P===62||Yt(P)?b(P):n(P)}function A(P){return P===62?(e.consume(P),N):n(P)}function N(P){return P===null||St(P)?L(P):Yt(P)?(e.consume(P),N):n(P)}function L(P){return P===45&&s===2?(e.consume(P),z):P===60&&s===1?(e.consume(P),R):P===62&&s===4?(e.consume(P),F):P===63&&s===3?(e.consume(P),E):P===93&&s===5?(e.consume(P),D):St(P)&&(s===6||s===7)?(e.exit("htmlFlowData"),e.check(Qde,I,M)(P)):P===null||St(P)?(e.exit("htmlFlowData"),M(P)):(e.consume(P),L)}function M(P){return e.check(Zde,B,I)(P)}function B(P){return e.enter("lineEnding"),e.consume(P),e.exit("lineEnding"),$}function $(P){return P===null||St(P)?M(P):(e.enter("htmlFlowData"),L(P))}function z(P){return P===45?(e.consume(P),E):L(P)}function R(P){return P===47?(e.consume(P),o="",C):L(P)}function C(P){if(P===62){const U=o.toLowerCase();return G2.includes(U)?(e.consume(P),F):L(P)}return wa(P)&&o.length<8?(e.consume(P),o+=String.fromCharCode(P),C):L(P)}function D(P){return P===93?(e.consume(P),E):L(P)}function E(P){return P===62?(e.consume(P),F):P===45&&s===2?(e.consume(P),E):L(P)}function F(P){return P===null||St(P)?(e.exit("htmlFlowData"),I(P)):(e.consume(P),F)}function I(P){return e.exit("htmlFlow"),t(P)}}function nhe(e,t,n){const r=this;return s;function s(o){return St(o)?(e.enter("lineEnding"),e.consume(o),e.exit("lineEnding"),i):n(o)}function i(o){return r.parser.lazy[r.now().line]?n(o):t(o)}}function rhe(e,t,n){return r;function r(s){return e.enter("lineEnding"),e.consume(s),e.exit("lineEnding"),e.attempt(sg,t,n)}}const ahe={name:"htmlText",tokenize:she};function she(e,t,n){const r=this;let s,i,o;return l;function l(E){return e.enter("htmlText"),e.enter("htmlTextData"),e.consume(E),c}function c(E){return E===33?(e.consume(E),u):E===47?(e.consume(E),k):E===63?(e.consume(E),b):wa(E)?(e.consume(E),T):n(E)}function u(E){return E===45?(e.consume(E),d):E===91?(e.consume(E),i=0,g):wa(E)?(e.consume(E),w):n(E)}function d(E){return E===45?(e.consume(E),m):n(E)}function h(E){return E===null?n(E):E===45?(e.consume(E),f):St(E)?(o=h,R(E)):(e.consume(E),h)}function f(E){return E===45?(e.consume(E),m):h(E)}function m(E){return E===62?z(E):E===45?f(E):h(E)}function g(E){const F="CDATA[";return E===F.charCodeAt(i++)?(e.consume(E),i===F.length?v:g):n(E)}function v(E){return E===null?n(E):E===93?(e.consume(E),y):St(E)?(o=v,R(E)):(e.consume(E),v)}function y(E){return E===93?(e.consume(E),x):v(E)}function x(E){return E===62?z(E):E===93?(e.consume(E),x):v(E)}function w(E){return E===null||E===62?z(E):St(E)?(o=w,R(E)):(e.consume(E),w)}function b(E){return E===null?n(E):E===63?(e.consume(E),_):St(E)?(o=b,R(E)):(e.consume(E),b)}function _(E){return E===62?z(E):b(E)}function k(E){return wa(E)?(e.consume(E),j):n(E)}function j(E){return E===45||oa(E)?(e.consume(E),j):S(E)}function S(E){return St(E)?(o=S,R(E)):Yt(E)?(e.consume(E),S):z(E)}function T(E){return E===45||oa(E)?(e.consume(E),T):E===47||E===62||An(E)?O(E):n(E)}function O(E){return E===47?(e.consume(E),z):E===58||E===95||wa(E)?(e.consume(E),A):St(E)?(o=O,R(E)):Yt(E)?(e.consume(E),O):z(E)}function A(E){return E===45||E===46||E===58||E===95||oa(E)?(e.consume(E),A):N(E)}function N(E){return E===61?(e.consume(E),L):St(E)?(o=N,R(E)):Yt(E)?(e.consume(E),N):O(E)}function L(E){return E===null||E===60||E===61||E===62||E===96?n(E):E===34||E===39?(e.consume(E),s=E,M):St(E)?(o=L,R(E)):Yt(E)?(e.consume(E),L):(e.consume(E),B)}function M(E){return E===s?(e.consume(E),s=void 0,$):E===null?n(E):St(E)?(o=M,R(E)):(e.consume(E),M)}function B(E){return E===null||E===34||E===39||E===60||E===61||E===96?n(E):E===47||E===62||An(E)?O(E):(e.consume(E),B)}function $(E){return E===47||E===62||An(E)?O(E):n(E)}function z(E){return E===62?(e.consume(E),e.exit("htmlTextData"),e.exit("htmlText"),t):n(E)}function R(E){return e.exit("htmlTextData"),e.enter("lineEnding"),e.consume(E),e.exit("lineEnding"),C}function C(E){return Yt(E)?rn(e,D,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(E):D(E)}function D(E){return e.enter("htmlTextData"),o(E)}}const YC={name:"labelEnd",resolveAll:che,resolveTo:uhe,tokenize:dhe},ihe={tokenize:hhe},ohe={tokenize:fhe},lhe={tokenize:mhe};function che(e){let t=-1;const n=[];for(;++t<e.length;){const r=e[t][1];if(n.push(e[t]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const s=r.type==="labelImage"?4:2;r.type="data",t+=s}}return e.length!==n.length&&cs(e,0,e.length,n),e}function uhe(e,t){let n=e.length,r=0,s,i,o,l;for(;n--;)if(s=e[n][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;e[n][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(o){if(e[n][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=n,s.type!=="labelLink")){r=2;break}}else s.type==="labelEnd"&&(o=n);const c={type:e[i][1].type==="labelLink"?"link":"image",start:{...e[i][1].start},end:{...e[e.length-1][1].end}},u={type:"label",start:{...e[i][1].start},end:{...e[o][1].end}},d={type:"labelText",start:{...e[i+r+2][1].end},end:{...e[o-2][1].start}};return l=[["enter",c,t],["enter",u,t]],l=ks(l,e.slice(i+1,i+r+3)),l=ks(l,[["enter",d,t]]),l=ks(l,Gb(t.parser.constructs.insideSpan.null,e.slice(i+r+4,o-3),t)),l=ks(l,[["exit",d,t],e[o-2],e[o-1],["exit",u,t]]),l=ks(l,e.slice(o+1)),l=ks(l,[["exit",c,t]]),cs(e,i,e.length,l),e}function dhe(e,t,n){const r=this;let s=r.events.length,i,o;for(;s--;)if((r.events[s][1].type==="labelImage"||r.events[s][1].type==="labelLink")&&!r.events[s][1]._balanced){i=r.events[s][1];break}return l;function l(f){return i?i._inactive?h(f):(o=r.parser.defined.includes(li(r.sliceSerialize({start:i.end,end:r.now()}))),e.enter("labelEnd"),e.enter("labelMarker"),e.consume(f),e.exit("labelMarker"),e.exit("labelEnd"),c):n(f)}function c(f){return f===40?e.attempt(ihe,d,o?d:h)(f):f===91?e.attempt(ohe,d,o?u:h)(f):o?d(f):h(f)}function u(f){return e.attempt(lhe,d,h)(f)}function d(f){return t(f)}function h(f){return i._balanced=!0,n(f)}}function hhe(e,t,n){return r;function r(h){return e.enter("resource"),e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),s}function s(h){return An(h)?Xf(e,i)(h):i(h)}function i(h){return h===41?d(h):nz(e,o,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function o(h){return An(h)?Xf(e,c)(h):d(h)}function l(h){return n(h)}function c(h){return h===34||h===39||h===40?az(e,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):d(h)}function u(h){return An(h)?Xf(e,d)(h):d(h)}function d(h){return h===41?(e.enter("resourceMarker"),e.consume(h),e.exit("resourceMarker"),e.exit("resource"),t):n(h)}}function fhe(e,t,n){const r=this;return s;function s(l){return rz.call(r,e,i,o,"reference","referenceMarker","referenceString")(l)}function i(l){return r.parser.defined.includes(li(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?t(l):n(l)}function o(l){return n(l)}}function mhe(e,t,n){return r;function r(i){return e.enter("reference"),e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),s}function s(i){return i===93?(e.enter("referenceMarker"),e.consume(i),e.exit("referenceMarker"),e.exit("reference"),t):n(i)}}const phe={name:"labelStartImage",resolveAll:YC.resolveAll,tokenize:ghe};function ghe(e,t,n){const r=this;return s;function s(l){return e.enter("labelImage"),e.enter("labelImageMarker"),e.consume(l),e.exit("labelImageMarker"),i}function i(l){return l===91?(e.enter("labelMarker"),e.consume(l),e.exit("labelMarker"),e.exit("labelImage"),o):n(l)}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(l):t(l)}}const vhe={name:"labelStartLink",resolveAll:YC.resolveAll,tokenize:yhe};function yhe(e,t,n){const r=this;return s;function s(o){return e.enter("labelLink"),e.enter("labelMarker"),e.consume(o),e.exit("labelMarker"),e.exit("labelLink"),i}function i(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):t(o)}}const mj={name:"lineEnding",tokenize:xhe};function xhe(e,t){return n;function n(r){return e.enter("lineEnding"),e.consume(r),e.exit("lineEnding"),rn(e,t,"linePrefix")}}const zv={name:"thematicBreak",tokenize:bhe};function bhe(e,t,n){let r=0,s;return i;function i(u){return e.enter("thematicBreak"),o(u)}function o(u){return s=u,l(u)}function l(u){return u===s?(e.enter("thematicBreakSequence"),c(u)):r>=3&&(u===null||St(u))?(e.exit("thematicBreak"),t(u)):n(u)}function c(u){return u===s?(e.consume(u),r++,c):(e.exit("thematicBreakSequence"),Yt(u)?rn(e,l,"whitespace")(u):l(u))}}const Ea={continuation:{tokenize:khe},exit:Nhe,name:"list",tokenize:_he},whe={partial:!0,tokenize:Che},jhe={partial:!0,tokenize:She};function _he(e,t,n){const r=this,s=r.events[r.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,o=0;return l;function l(m){const g=r.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!r.containerState.marker||m===r.containerState.marker:K1(m)){if(r.containerState.type||(r.containerState.type=g,e.enter(g,{_container:!0})),g==="listUnordered")return e.enter("listItemPrefix"),m===42||m===45?e.check(zv,n,u)(m):u(m);if(!r.interrupt||m===49)return e.enter("listItemPrefix"),e.enter("listItemValue"),c(m)}return n(m)}function c(m){return K1(m)&&++o<10?(e.consume(m),c):(!r.interrupt||o<2)&&(r.containerState.marker?m===r.containerState.marker:m===41||m===46)?(e.exit("listItemValue"),u(m)):n(m)}function u(m){return e.enter("listItemMarker"),e.consume(m),e.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||m,e.check(sg,r.interrupt?n:d,e.attempt(whe,f,h))}function d(m){return r.containerState.initialBlankLine=!0,i++,f(m)}function h(m){return Yt(m)?(e.enter("listItemPrefixWhitespace"),e.consume(m),e.exit("listItemPrefixWhitespace"),f):n(m)}function f(m){return r.containerState.size=i+r.sliceSerialize(e.exit("listItemPrefix"),!0).length,t(m)}}function khe(e,t,n){const r=this;return r.containerState._closeFlow=void 0,e.check(sg,s,i);function s(l){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,rn(e,t,"listItemIndent",r.containerState.size+1)(l)}function i(l){return r.containerState.furtherBlankLines||!Yt(l)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(l)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,e.attempt(jhe,t,o)(l))}function o(l){return r.containerState._closeFlow=!0,r.interrupt=void 0,rn(e,e.attempt(Ea,t,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function She(e,t,n){const r=this;return rn(e,s,"listItemIndent",r.containerState.size+1);function s(i){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?t(i):n(i)}}function Nhe(e){e.exit(this.containerState.type)}function Che(e,t,n){const r=this;return rn(e,s,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:5);function s(i){const o=r.events[r.events.length-1];return!Yt(i)&&o&&o[1].type==="listItemPrefixWhitespace"?t(i):n(i)}}const Y2={name:"setextUnderline",resolveTo:Ahe,tokenize:Ehe};function Ahe(e,t){let n=e.length,r,s,i;for(;n--;)if(e[n][0]==="enter"){if(e[n][1].type==="content"){r=n;break}e[n][1].type==="paragraph"&&(s=n)}else e[n][1].type==="content"&&e.splice(n,1),!i&&e[n][1].type==="definition"&&(i=n);const o={type:"setextHeading",start:{...e[r][1].start},end:{...e[e.length-1][1].end}};return e[s][1].type="setextHeadingText",i?(e.splice(s,0,["enter",o,t]),e.splice(i+1,0,["exit",e[r][1],t]),e[r][1].end={...e[i][1].end}):e[r][1]=o,e.push(["exit",o,t]),e}function Ehe(e,t,n){const r=this;let s;return i;function i(u){let d=r.events.length,h;for(;d--;)if(r.events[d][1].type!=="lineEnding"&&r.events[d][1].type!=="linePrefix"&&r.events[d][1].type!=="content"){h=r.events[d][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||h)?(e.enter("setextHeadingLine"),s=u,o(u)):n(u)}function o(u){return e.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===s?(e.consume(u),l):(e.exit("setextHeadingLineSequence"),Yt(u)?rn(e,c,"lineSuffix")(u):c(u))}function c(u){return u===null||St(u)?(e.exit("setextHeadingLine"),t(u)):n(u)}}const The={tokenize:Phe};function Phe(e){const t=this,n=e.attempt(sg,r,e.attempt(this.parser.constructs.flowInitial,s,rn(e,e.attempt(this.parser.constructs.flow,s,e.attempt(Dde,s)),"linePrefix")));return n;function r(i){if(i===null){e.consume(i);return}return e.enter("lineEndingBlank"),e.consume(i),e.exit("lineEndingBlank"),t.currentConstruct=void 0,n}function s(i){if(i===null){e.consume(i);return}return e.enter("lineEnding"),e.consume(i),e.exit("lineEnding"),t.currentConstruct=void 0,n}}const Ohe={resolveAll:iz()},Ihe=sz("string"),Rhe=sz("text");function sz(e){return{resolveAll:iz(e==="text"?Mhe:void 0),tokenize:t};function t(n){const r=this,s=this.parser.constructs[e],i=n.attempt(s,o,l);return o;function o(d){return u(d)?i(d):l(d)}function l(d){if(d===null){n.consume(d);return}return n.enter("data"),n.consume(d),c}function c(d){return u(d)?(n.exit("data"),i(d)):(n.consume(d),c)}function u(d){if(d===null)return!0;const h=s[d];let f=-1;if(h)for(;++f<h.length;){const m=h[f];if(!m.previous||m.previous.call(r,r.previous))return!0}return!1}}}function iz(e){return t;function t(n,r){let s=-1,i;for(;++s<=n.length;)i===void 0?n[s]&&n[s][1].type==="data"&&(i=s,s++):(!n[s]||n[s][1].type!=="data")&&(s!==i+2&&(n[i][1].end=n[s-1][1].end,n.splice(i+2,s-i-2),s=i+2),i=void 0);return e?e(n,r):n}}function Mhe(e,t){let n=0;for(;++n<=e.length;)if((n===e.length||e[n][1].type==="lineEnding")&&e[n-1][1].type==="data"){const r=e[n-1][1],s=t.sliceStream(r);let i=s.length,o=-1,l=0,c;for(;i--;){const u=s[i];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)l++,o--;if(o)break;o=-1}else if(u===-2)c=!0,l++;else if(u!==-1){i++;break}}if(t._contentTypeTextTrailing&&n===e.length&&(l=0),l){const u={type:n===e.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?o:r.start._bufferIndex+o,_index:r.start._index+i,line:r.end.line,column:r.end.column-l,offset:r.end.offset-l},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(e.splice(n,0,["enter",u,t],["exit",u,t]),n+=2)}n++}return e}const Dhe={42:Ea,43:Ea,45:Ea,48:Ea,49:Ea,50:Ea,51:Ea,52:Ea,53:Ea,54:Ea,55:Ea,56:Ea,57:Ea,62:Q6},Lhe={91:Bde},$he={[-2]:fj,[-1]:fj,32:fj},Fhe={35:Vde,42:zv,45:[Y2,zv],60:Jde,61:Y2,95:zv,96:V2,126:V2},Uhe={38:ez,92:Z6},Bhe={[-5]:mj,[-4]:mj,[-3]:mj,33:phe,38:ez,42:V1,60:[vde,ahe],91:vhe,92:[Hde,Z6],93:YC,95:V1,96:Tde},zhe={null:[V1,Ohe]},Whe={null:[42,95]},qhe={null:[]},Hhe=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:Whe,contentInitial:Lhe,disable:qhe,document:Dhe,flow:Fhe,flowInitial:$he,insideSpan:zhe,string:Uhe,text:Bhe},Symbol.toStringTag,{value:"Module"}));function Khe(e,t,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const s={},i=[];let o=[],l=[];const c={attempt:S(k),check:S(j),consume:w,enter:b,exit:_,interrupt:S(j,{interrupt:!0})},u={code:null,containerState:{},defineSkip:v,events:[],now:g,parser:e,previous:null,sliceSerialize:f,sliceStream:m,write:h};let d=t.tokenize.call(u,c);return t.resolveAll&&i.push(t),u;function h(N){return o=ks(o,N),y(),o[o.length-1]!==null?[]:(T(t,0),u.events=Gb(i,u.events,u),u.events)}function f(N,L){return Ghe(m(N),L)}function m(N){return Vhe(o,N)}function g(){const{_bufferIndex:N,_index:L,line:M,column:B,offset:$}=r;return{_bufferIndex:N,_index:L,line:M,column:B,offset:$}}function v(N){s[N.line]=N.column,A()}function y(){let N;for(;r._index<o.length;){const L=o[r._index];if(typeof L=="string")for(N=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===N&&r._bufferIndex<L.length;)x(L.charCodeAt(r._bufferIndex));else x(L)}}function x(N){d=d(N)}function w(N){St(N)?(r.line++,r.column=1,r.offset+=N===-3?2:1,A()):N!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=N}function b(N,L){const M=L||{};return M.type=N,M.start=g(),u.events.push(["enter",M,u]),l.push(M),M}function _(N){const L=l.pop();return L.end=g(),u.events.push(["exit",L,u]),L}function k(N,L){T(N,L.from)}function j(N,L){L.restore()}function S(N,L){return M;function M(B,$,z){let R,C,D,E;return Array.isArray(B)?I(B):"tokenize"in B?I([B]):F(B);function F(X){return K;function K(ie){const H=ie!==null&&X[ie],he=ie!==null&&X.null,me=[...Array.isArray(H)?H:H?[H]:[],...Array.isArray(he)?he:he?[he]:[]];return I(me)(ie)}}function I(X){return R=X,C=0,X.length===0?z:P(X[C])}function P(X){return K;function K(ie){return E=O(),D=X,X.partial||(u.currentConstruct=X),X.name&&u.parser.constructs.disable.null.includes(X.name)?Z():X.tokenize.call(L?Object.assign(Object.create(u),L):u,c,U,Z)(ie)}}function U(X){return N(D,E),$}function Z(X){return E.restore(),++C<R.length?P(R[C]):z}}}function T(N,L){N.resolveAll&&!i.includes(N)&&i.push(N),N.resolve&&cs(u.events,L,u.events.length-L,N.resolve(u.events.slice(L),u)),N.resolveTo&&(u.events=N.resolveTo(u.events,u))}function O(){const N=g(),L=u.previous,M=u.currentConstruct,B=u.events.length,$=Array.from(l);return{from:B,restore:z};function z(){r=N,u.previous=L,u.currentConstruct=M,u.events.length=B,l=$,A()}}function A(){r.line in s&&r.column<2&&(r.column=s[r.line],r.offset+=s[r.line]-1)}}function Vhe(e,t){const n=t.start._index,r=t.start._bufferIndex,s=t.end._index,i=t.end._bufferIndex;let o;if(n===s)o=[e[n].slice(r,i)];else{if(o=e.slice(n,s),r>-1){const l=o[0];typeof l=="string"?o[0]=l.slice(r):o.shift()}i>0&&o.push(e[s].slice(0,i))}return o}function Ghe(e,t){let n=-1;const r=[];let s;for(;++n<e.length;){const i=e[n];let o;if(typeof i=="string")o=i;else switch(i){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=t?" ":"	";break}case-1:{if(!t&&s)continue;o=" ";break}default:o=String.fromCharCode(i)}s=i===-2,r.push(o)}return r.join("")}function Yhe(e){const r={constructs:X6([Hhe,...(e||{}).extensions||[]]),content:s(ude),defined:[],document:s(hde),flow:s(The),lazy:{},string:s(Ihe),text:s(Rhe)};return r;function s(i){return o;function o(l){return Khe(r,i,l)}}}function Xhe(e){for(;!tz(e););return e}const X2=/[\0\t\n\r]/g;function Jhe(){let e=1,t="",n=!0,r;return s;function s(i,o,l){const c=[];let u,d,h,f,m;for(i=t+(typeof i=="string"?i.toString():new TextDecoder(o||void 0).decode(i)),h=0,t="",n&&(i.charCodeAt(0)===65279&&h++,n=void 0);h<i.length;){if(X2.lastIndex=h,u=X2.exec(i),f=u&&u.index!==void 0?u.index:i.length,m=i.charCodeAt(f),!u){t=i.slice(h);break}if(m===10&&h===f&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),h<f&&(c.push(i.slice(h,f)),e+=f-h),m){case 0:{c.push(65533),e++;break}case 9:{for(d=Math.ceil(e/4)*4,c.push(-2);e++<d;)c.push(-1);break}case 10:{c.push(-4),e=1;break}default:r=!0,e=1}h=f+1}return l&&(r&&c.push(-5),t&&c.push(t),c.push(null)),c}}const Qhe=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function Zhe(e){return e.replace(Qhe,efe)}function efe(e,t,n){if(t)return t;if(n.charCodeAt(0)===35){const s=n.charCodeAt(1),i=s===120||s===88;return J6(n.slice(i?2:1),i?16:10)}return GC(n)||e}const oz={}.hasOwnProperty;function tfe(e,t,n){return typeof t!="string"&&(n=t,t=void 0),nfe(n)(Xhe(Yhe(n).document().write(Jhe()(e,t,!0))))}function nfe(e){const t={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(Ce),autolinkProtocol:O,autolinkEmail:O,atxHeading:i(Q),blockQuote:i(he),characterEscape:O,characterReference:O,codeFenced:i(me),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:i(me,o),codeText:i(ae,o),codeTextData:O,data:O,codeFlowValue:O,definition:i(Ne),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:i(de),hardBreakEscape:i(fe),hardBreakTrailing:i(fe),htmlFlow:i(Be,o),htmlFlowData:O,htmlText:i(Be,o),htmlTextData:O,image:i(je),label:o,link:i(Ce),listItem:i(rt),listItemValue:f,listOrdered:i(Ze,h),listUnordered:i(Ze),paragraph:i(Je),reference:P,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:i(Q),strong:i(te),thematicBreak:i(Ue)},exit:{atxHeading:c(),atxHeadingSequence:k,autolink:c(),autolinkEmail:H,autolinkProtocol:ie,blockQuote:c(),characterEscapeValue:A,characterReferenceMarkerHexadecimal:Z,characterReferenceMarkerNumeric:Z,characterReferenceValue:X,characterReference:K,codeFenced:c(y),codeFencedFence:v,codeFencedFenceInfo:m,codeFencedFenceMeta:g,codeFlowValue:A,codeIndented:c(x),codeText:c($),codeTextData:A,data:A,definition:c(),definitionDestinationString:_,definitionLabelString:w,definitionTitleString:b,emphasis:c(),hardBreakEscape:c(L),hardBreakTrailing:c(L),htmlFlow:c(M),htmlFlowData:A,htmlText:c(B),htmlTextData:A,image:c(R),label:D,labelText:C,lineEnding:N,link:c(z),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:U,resourceDestinationString:E,resourceTitleString:F,resource:I,setextHeading:c(T),setextHeadingLineSequence:S,setextHeadingText:j,strong:c(),thematicBreak:c()}};lz(t,(e||{}).mdastExtensions||[]);const n={};return r;function r(ue){let xe={type:"root",children:[]};const ce={stack:[xe],tokenStack:[],config:t,enter:l,exit:u,buffer:o,resume:d,data:n},qe=[];let Se=-1;for(;++Se<ue.length;)if(ue[Se][1].type==="listOrdered"||ue[Se][1].type==="listUnordered")if(ue[Se][0]==="enter")qe.push(Se);else{const nt=qe.pop();Se=s(ue,nt,Se)}for(Se=-1;++Se<ue.length;){const nt=t[ue[Se][0]];oz.call(nt,ue[Se][1].type)&&nt[ue[Se][1].type].call(Object.assign({sliceSerialize:ue[Se][2].sliceSerialize},ce),ue[Se][1])}if(ce.tokenStack.length>0){const nt=ce.tokenStack[ce.tokenStack.length-1];(nt[1]||J2).call(ce,void 0,nt[0])}for(xe.position={start:el(ue.length>0?ue[0][1].start:{line:1,column:1,offset:0}),end:el(ue.length>0?ue[ue.length-2][1].end:{line:1,column:1,offset:0})},Se=-1;++Se<t.transforms.length;)xe=t.transforms[Se](xe)||xe;return xe}function s(ue,xe,ce){let qe=xe-1,Se=-1,nt=!1,vt,xt,wt,ht;for(;++qe<=ce;){const _t=ue[qe];switch(_t[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{_t[0]==="enter"?Se++:Se--,ht=void 0;break}case"lineEndingBlank":{_t[0]==="enter"&&(vt&&!ht&&!Se&&!wt&&(wt=qe),ht=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:ht=void 0}if(!Se&&_t[0]==="enter"&&_t[1].type==="listItemPrefix"||Se===-1&&_t[0]==="exit"&&(_t[1].type==="listUnordered"||_t[1].type==="listOrdered")){if(vt){let Wt=qe;for(xt=void 0;Wt--;){const pe=ue[Wt];if(pe[1].type==="lineEnding"||pe[1].type==="lineEndingBlank"){if(pe[0]==="exit")continue;xt&&(ue[xt][1].type="lineEndingBlank",nt=!0),pe[1].type="lineEnding",xt=Wt}else if(!(pe[1].type==="linePrefix"||pe[1].type==="blockQuotePrefix"||pe[1].type==="blockQuotePrefixWhitespace"||pe[1].type==="blockQuoteMarker"||pe[1].type==="listItemIndent"))break}wt&&(!xt||wt<xt)&&(vt._spread=!0),vt.end=Object.assign({},xt?ue[xt][1].start:_t[1].end),ue.splice(xt||qe,0,["exit",vt,_t[2]]),qe++,ce++}if(_t[1].type==="listItemPrefix"){const Wt={type:"listItem",_spread:!1,start:Object.assign({},_t[1].start),end:void 0};vt=Wt,ue.splice(qe,0,["enter",Wt,_t[2]]),qe++,ce++,wt=void 0,ht=!0}}}return ue[xe][1]._spread=nt,ce}function i(ue,xe){return ce;function ce(qe){l.call(this,ue(qe),qe),xe&&xe.call(this,qe)}}function o(){this.stack.push({type:"fragment",children:[]})}function l(ue,xe,ce){this.stack[this.stack.length-1].children.push(ue),this.stack.push(ue),this.tokenStack.push([xe,ce||void 0]),ue.position={start:el(xe.start),end:void 0}}function c(ue){return xe;function xe(ce){ue&&ue.call(this,ce),u.call(this,ce)}}function u(ue,xe){const ce=this.stack.pop(),qe=this.tokenStack.pop();if(qe)qe[0].type!==ue.type&&(xe?xe.call(this,ue,qe[0]):(qe[1]||J2).call(this,ue,qe[0]));else throw new Error("Cannot close `"+ue.type+"` ("+Yf({start:ue.start,end:ue.end})+"): its not open");ce.position.end=el(ue.end)}function d(){return VC(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function f(ue){if(this.data.expectingFirstListItemValue){const xe=this.stack[this.stack.length-2];xe.start=Number.parseInt(this.sliceSerialize(ue),10),this.data.expectingFirstListItemValue=void 0}}function m(){const ue=this.resume(),xe=this.stack[this.stack.length-1];xe.lang=ue}function g(){const ue=this.resume(),xe=this.stack[this.stack.length-1];xe.meta=ue}function v(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function y(){const ue=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ue.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function x(){const ue=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ue.replace(/(\r?\n|\r)$/g,"")}function w(ue){const xe=this.resume(),ce=this.stack[this.stack.length-1];ce.label=xe,ce.identifier=li(this.sliceSerialize(ue)).toLowerCase()}function b(){const ue=this.resume(),xe=this.stack[this.stack.length-1];xe.title=ue}function _(){const ue=this.resume(),xe=this.stack[this.stack.length-1];xe.url=ue}function k(ue){const xe=this.stack[this.stack.length-1];if(!xe.depth){const ce=this.sliceSerialize(ue).length;xe.depth=ce}}function j(){this.data.setextHeadingSlurpLineEnding=!0}function S(ue){const xe=this.stack[this.stack.length-1];xe.depth=this.sliceSerialize(ue).codePointAt(0)===61?1:2}function T(){this.data.setextHeadingSlurpLineEnding=void 0}function O(ue){const ce=this.stack[this.stack.length-1].children;let qe=ce[ce.length-1];(!qe||qe.type!=="text")&&(qe=We(),qe.position={start:el(ue.start),end:void 0},ce.push(qe)),this.stack.push(qe)}function A(ue){const xe=this.stack.pop();xe.value+=this.sliceSerialize(ue),xe.position.end=el(ue.end)}function N(ue){const xe=this.stack[this.stack.length-1];if(this.data.atHardBreak){const ce=xe.children[xe.children.length-1];ce.position.end=el(ue.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&t.canContainEols.includes(xe.type)&&(O.call(this,ue),A.call(this,ue))}function L(){this.data.atHardBreak=!0}function M(){const ue=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ue}function B(){const ue=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ue}function $(){const ue=this.resume(),xe=this.stack[this.stack.length-1];xe.value=ue}function z(){const ue=this.stack[this.stack.length-1];if(this.data.inReference){const xe=this.data.referenceType||"shortcut";ue.type+="Reference",ue.referenceType=xe,delete ue.url,delete ue.title}else delete ue.identifier,delete ue.label;this.data.referenceType=void 0}function R(){const ue=this.stack[this.stack.length-1];if(this.data.inReference){const xe=this.data.referenceType||"shortcut";ue.type+="Reference",ue.referenceType=xe,delete ue.url,delete ue.title}else delete ue.identifier,delete ue.label;this.data.referenceType=void 0}function C(ue){const xe=this.sliceSerialize(ue),ce=this.stack[this.stack.length-2];ce.label=Zhe(xe),ce.identifier=li(xe).toLowerCase()}function D(){const ue=this.stack[this.stack.length-1],xe=this.resume(),ce=this.stack[this.stack.length-1];if(this.data.inReference=!0,ce.type==="link"){const qe=ue.children;ce.children=qe}else ce.alt=xe}function E(){const ue=this.resume(),xe=this.stack[this.stack.length-1];xe.url=ue}function F(){const ue=this.resume(),xe=this.stack[this.stack.length-1];xe.title=ue}function I(){this.data.inReference=void 0}function P(){this.data.referenceType="collapsed"}function U(ue){const xe=this.resume(),ce=this.stack[this.stack.length-1];ce.label=xe,ce.identifier=li(this.sliceSerialize(ue)).toLowerCase(),this.data.referenceType="full"}function Z(ue){this.data.characterReferenceType=ue.type}function X(ue){const xe=this.sliceSerialize(ue),ce=this.data.characterReferenceType;let qe;ce?(qe=J6(xe,ce==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):qe=GC(xe);const Se=this.stack[this.stack.length-1];Se.value+=qe}function K(ue){const xe=this.stack.pop();xe.position.end=el(ue.end)}function ie(ue){A.call(this,ue);const xe=this.stack[this.stack.length-1];xe.url=this.sliceSerialize(ue)}function H(ue){A.call(this,ue);const xe=this.stack[this.stack.length-1];xe.url="mailto:"+this.sliceSerialize(ue)}function he(){return{type:"blockquote",children:[]}}function me(){return{type:"code",lang:null,meta:null,value:""}}function ae(){return{type:"inlineCode",value:""}}function Ne(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function de(){return{type:"emphasis",children:[]}}function Q(){return{type:"heading",depth:0,children:[]}}function fe(){return{type:"break"}}function Be(){return{type:"html",value:""}}function je(){return{type:"image",title:null,url:"",alt:null}}function Ce(){return{type:"link",title:null,url:"",children:[]}}function Ze(ue){return{type:"list",ordered:ue.type==="listOrdered",start:null,spread:ue._spread,children:[]}}function rt(ue){return{type:"listItem",spread:ue._spread,checked:null,children:[]}}function Je(){return{type:"paragraph",children:[]}}function te(){return{type:"strong",children:[]}}function We(){return{type:"text",value:""}}function Ue(){return{type:"thematicBreak"}}}function el(e){return{line:e.line,column:e.column,offset:e.offset}}function lz(e,t){let n=-1;for(;++n<t.length;){const r=t[n];Array.isArray(r)?lz(e,r):rfe(e,r)}}function rfe(e,t){let n;for(n in t)if(oz.call(t,n))switch(n){case"canContainEols":{const r=t[n];r&&e[n].push(...r);break}case"transforms":{const r=t[n];r&&e[n].push(...r);break}case"enter":case"exit":{const r=t[n];r&&Object.assign(e[n],r);break}}}function J2(e,t){throw e?new Error("Cannot close `"+e.type+"` ("+Yf({start:e.start,end:e.end})+"): a different token (`"+t.type+"`, "+Yf({start:t.start,end:t.end})+") is open"):new Error("Cannot close document, a token (`"+t.type+"`, "+Yf({start:t.start,end:t.end})+") is still open")}function afe(e){const t=this;t.parser=n;function n(r){return tfe(r,{...t.data("settings"),...e,extensions:t.data("micromarkExtensions")||[],mdastExtensions:t.data("fromMarkdownExtensions")||[]})}}function sfe(e,t){const n={type:"element",tagName:"blockquote",properties:{},children:e.wrap(e.all(t),!0)};return e.patch(t,n),e.applyData(t,n)}function ife(e,t){const n={type:"element",tagName:"br",properties:{},children:[]};return e.patch(t,n),[e.applyData(t,n),{type:"text",value:`
`}]}function ofe(e,t){const n=t.value?t.value+`
`:"",r={};t.lang&&(r.className=["language-"+t.lang]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return t.meta&&(s.data={meta:t.meta}),e.patch(t,s),s=e.applyData(t,s),s={type:"element",tagName:"pre",properties:{},children:[s]},e.patch(t,s),s}function lfe(e,t){const n={type:"element",tagName:"del",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function cfe(e,t){const n={type:"element",tagName:"em",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function ufe(e,t){const n=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",r=String(t.identifier).toUpperCase(),s=Lh(r.toLowerCase()),i=e.footnoteOrder.indexOf(r);let o,l=e.footnoteCounts.get(r);l===void 0?(l=0,e.footnoteOrder.push(r),o=e.footnoteOrder.length):o=i+1,l+=1,e.footnoteCounts.set(r,l);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+s,id:n+"fnref-"+s+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};e.patch(t,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return e.patch(t,u),e.applyData(t,u)}function dfe(e,t){const n={type:"element",tagName:"h"+t.depth,properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function hfe(e,t){if(e.options.allowDangerousHtml){const n={type:"raw",value:t.value};return e.patch(t,n),e.applyData(t,n)}}function cz(e,t){const n=t.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(t.label||t.identifier)+"]"),t.type==="imageReference")return[{type:"text",value:"!["+t.alt+r}];const s=e.all(t),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const o=s[s.length-1];return o&&o.type==="text"?o.value+=r:s.push({type:"text",value:r}),s}function ffe(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return cz(e,t);const s={src:Lh(r.url||""),alt:t.alt};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"img",properties:s,children:[]};return e.patch(t,i),e.applyData(t,i)}function mfe(e,t){const n={src:Lh(t.url)};t.alt!==null&&t.alt!==void 0&&(n.alt=t.alt),t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"img",properties:n,children:[]};return e.patch(t,r),e.applyData(t,r)}function pfe(e,t){const n={type:"text",value:t.value.replace(/\r?\n|\r/g," ")};e.patch(t,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return e.patch(t,r),e.applyData(t,r)}function gfe(e,t){const n=String(t.identifier).toUpperCase(),r=e.definitionById.get(n);if(!r)return cz(e,t);const s={href:Lh(r.url||"")};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"a",properties:s,children:e.all(t)};return e.patch(t,i),e.applyData(t,i)}function vfe(e,t){const n={href:Lh(t.url)};t.title!==null&&t.title!==void 0&&(n.title=t.title);const r={type:"element",tagName:"a",properties:n,children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function yfe(e,t,n){const r=e.all(t),s=n?xfe(n):uz(t),i={},o=[];if(typeof t.checked=="boolean"){const d=r[0];let h;d&&d.type==="element"&&d.tagName==="p"?h=d:(h={type:"element",tagName:"p",properties:{},children:[]},r.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:t.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let l=-1;for(;++l<r.length;){const d=r[l];(s||l!==0||d.type!=="element"||d.tagName!=="p")&&o.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?o.push(...d.children):o.push(d)}const c=r[r.length-1];c&&(s||c.type!=="element"||c.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:i,children:o};return e.patch(t,u),e.applyData(t,u)}function xfe(e){let t=!1;if(e.type==="list"){t=e.spread||!1;const n=e.children;let r=-1;for(;!t&&++r<n.length;)t=uz(n[r])}return t}function uz(e){const t=e.spread;return t??e.children.length>1}function bfe(e,t){const n={},r=e.all(t);let s=-1;for(typeof t.start=="number"&&t.start!==1&&(n.start=t.start);++s<r.length;){const o=r[s];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const i={type:"element",tagName:t.ordered?"ol":"ul",properties:n,children:e.wrap(r,!0)};return e.patch(t,i),e.applyData(t,i)}function wfe(e,t){const n={type:"element",tagName:"p",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function jfe(e,t){const n={type:"root",children:e.wrap(e.all(t))};return e.patch(t,n),e.applyData(t,n)}function _fe(e,t){const n={type:"element",tagName:"strong",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}function kfe(e,t){const n=e.all(t),r=n.shift(),s=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:e.wrap([r],!0)};e.patch(t.children[0],o),s.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:e.wrap(n,!0)},l=WC(t.children[1]),c=W6(t.children[t.children.length-1]);l&&c&&(o.position={start:l,end:c}),s.push(o)}const i={type:"element",tagName:"table",properties:{},children:e.wrap(s,!0)};return e.patch(t,i),e.applyData(t,i)}function Sfe(e,t,n){const r=n?n.children:void 0,i=(r?r.indexOf(t):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,l=o?o.length:t.children.length;let c=-1;const u=[];for(;++c<l;){const h=t.children[c],f={},m=o?o[c]:void 0;m&&(f.align=m);let g={type:"element",tagName:i,properties:f,children:[]};h&&(g.children=e.all(h),e.patch(h,g),g=e.applyData(h,g)),u.push(g)}const d={type:"element",tagName:"tr",properties:{},children:e.wrap(u,!0)};return e.patch(t,d),e.applyData(t,d)}function Nfe(e,t){const n={type:"element",tagName:"td",properties:{},children:e.all(t)};return e.patch(t,n),e.applyData(t,n)}const Q2=9,Z2=32;function Cfe(e){const t=String(e),n=/\r?\n|\r/g;let r=n.exec(t),s=0;const i=[];for(;r;)i.push(eO(t.slice(s,r.index),s>0,!0),r[0]),s=r.index+r[0].length,r=n.exec(t);return i.push(eO(t.slice(s),s>0,!1)),i.join("")}function eO(e,t,n){let r=0,s=e.length;if(t){let i=e.codePointAt(r);for(;i===Q2||i===Z2;)r++,i=e.codePointAt(r)}if(n){let i=e.codePointAt(s-1);for(;i===Q2||i===Z2;)s--,i=e.codePointAt(s-1)}return s>r?e.slice(r,s):""}function Afe(e,t){const n={type:"text",value:Cfe(String(t.value))};return e.patch(t,n),e.applyData(t,n)}function Efe(e,t){const n={type:"element",tagName:"hr",properties:{},children:[]};return e.patch(t,n),e.applyData(t,n)}const Tfe={blockquote:sfe,break:ife,code:ofe,delete:lfe,emphasis:cfe,footnoteReference:ufe,heading:dfe,html:hfe,imageReference:ffe,image:mfe,inlineCode:pfe,linkReference:gfe,link:vfe,listItem:yfe,list:bfe,paragraph:wfe,root:jfe,strong:_fe,table:kfe,tableCell:Nfe,tableRow:Sfe,text:Afe,thematicBreak:Efe,toml:Jg,yaml:Jg,definition:Jg,footnoteDefinition:Jg};function Jg(){}const dz=-1,Yb=0,Jf=1,Dy=2,XC=3,JC=4,QC=5,ZC=6,hz=7,fz=8,tO=typeof self=="object"?self:globalThis,Pfe=(e,t)=>{const n=(s,i)=>(e.set(i,s),s),r=s=>{if(e.has(s))return e.get(s);const[i,o]=t[s];switch(i){case Yb:case dz:return n(o,s);case Jf:{const l=n([],s);for(const c of o)l.push(r(c));return l}case Dy:{const l=n({},s);for(const[c,u]of o)l[r(c)]=r(u);return l}case XC:return n(new Date(o),s);case JC:{const{source:l,flags:c}=o;return n(new RegExp(l,c),s)}case QC:{const l=n(new Map,s);for(const[c,u]of o)l.set(r(c),r(u));return l}case ZC:{const l=n(new Set,s);for(const c of o)l.add(r(c));return l}case hz:{const{name:l,message:c}=o;return n(new tO[l](c),s)}case fz:return n(BigInt(o),s);case"BigInt":return n(Object(BigInt(o)),s);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return n(new DataView(l),o)}}return n(new tO[i](o),s)};return r},nO=e=>Pfe(new Map,e)(0),Mu="",{toString:Ofe}={},{keys:Ife}=Object,ff=e=>{const t=typeof e;if(t!=="object"||!e)return[Yb,t];const n=Ofe.call(e).slice(8,-1);switch(n){case"Array":return[Jf,Mu];case"Object":return[Dy,Mu];case"Date":return[XC,Mu];case"RegExp":return[JC,Mu];case"Map":return[QC,Mu];case"Set":return[ZC,Mu];case"DataView":return[Jf,n]}return n.includes("Array")?[Jf,n]:n.includes("Error")?[hz,n]:[Dy,n]},Qg=([e,t])=>e===Yb&&(t==="function"||t==="symbol"),Rfe=(e,t,n,r)=>{const s=(o,l)=>{const c=r.push(o)-1;return n.set(l,c),c},i=o=>{if(n.has(o))return n.get(o);let[l,c]=ff(o);switch(l){case Yb:{let d=o;switch(c){case"bigint":l=fz,d=o.toString();break;case"function":case"symbol":if(e)throw new TypeError("unable to serialize "+c);d=null;break;case"undefined":return s([dz],o)}return s([l,d],o)}case Jf:{if(c){let f=o;return c==="DataView"?f=new Uint8Array(o.buffer):c==="ArrayBuffer"&&(f=new Uint8Array(o)),s([c,[...f]],o)}const d=[],h=s([l,d],o);for(const f of o)d.push(i(f));return h}case Dy:{if(c)switch(c){case"BigInt":return s([c,o.toString()],o);case"Boolean":case"Number":case"String":return s([c,o.valueOf()],o)}if(t&&"toJSON"in o)return i(o.toJSON());const d=[],h=s([l,d],o);for(const f of Ife(o))(e||!Qg(ff(o[f])))&&d.push([i(f),i(o[f])]);return h}case XC:return s([l,o.toISOString()],o);case JC:{const{source:d,flags:h}=o;return s([l,{source:d,flags:h}],o)}case QC:{const d=[],h=s([l,d],o);for(const[f,m]of o)(e||!(Qg(ff(f))||Qg(ff(m))))&&d.push([i(f),i(m)]);return h}case ZC:{const d=[],h=s([l,d],o);for(const f of o)(e||!Qg(ff(f)))&&d.push(i(f));return h}}const{message:u}=o;return s([l,{name:c,message:u}],o)};return i},rO=(e,{json:t,lossy:n}={})=>{const r=[];return Rfe(!(t||n),!!t,new Map,r)(e),r},Ly=typeof structuredClone=="function"?(e,t)=>t&&("json"in t||"lossy"in t)?nO(rO(e,t)):structuredClone(e):(e,t)=>nO(rO(e,t));function Mfe(e,t){const n=[{type:"text",value:""}];return t>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(t)}]}),n}function Dfe(e,t){return"Back to reference "+(e+1)+(t>1?"-"+t:"")}function Lfe(e){const t=typeof e.options.clobberPrefix=="string"?e.options.clobberPrefix:"user-content-",n=e.options.footnoteBackContent||Mfe,r=e.options.footnoteBackLabel||Dfe,s=e.options.footnoteLabel||"Footnotes",i=e.options.footnoteLabelTagName||"h2",o=e.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<e.footnoteOrder.length;){const u=e.footnoteById.get(e.footnoteOrder[c]);if(!u)continue;const d=e.all(u),h=String(u.identifier).toUpperCase(),f=Lh(h.toLowerCase());let m=0;const g=[],v=e.footnoteCounts.get(h);for(;v!==void 0&&++m<=v;){g.length>0&&g.push({type:"text",value:" "});let w=typeof n=="string"?n:n(c,m);typeof w=="string"&&(w={type:"text",value:w}),g.push({type:"element",tagName:"a",properties:{href:"#"+t+"fnref-"+f+(m>1?"-"+m:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(c,m),className:["data-footnote-backref"]},children:Array.isArray(w)?w:[w]})}const y=d[d.length-1];if(y&&y.type==="element"&&y.tagName==="p"){const w=y.children[y.children.length-1];w&&w.type==="text"?w.value+=" ":y.children.push({type:"text",value:" "}),y.children.push(...g)}else d.push(...g);const x={type:"element",tagName:"li",properties:{id:t+"fn-"+f},children:e.wrap(d,!0)};e.patch(u,x),l.push(x)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...Ly(o),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:e.wrap(l,!0)},{type:"text",value:`
`}]}}const Xb=function(e){if(e==null)return Bfe;if(typeof e=="function")return Jb(e);if(typeof e=="object")return Array.isArray(e)?$fe(e):Ffe(e);if(typeof e=="string")return Ufe(e);throw new Error("Expected function, string, or object as test")};function $fe(e){const t=[];let n=-1;for(;++n<e.length;)t[n]=Xb(e[n]);return Jb(r);function r(...s){let i=-1;for(;++i<t.length;)if(t[i].apply(this,s))return!0;return!1}}function Ffe(e){const t=e;return Jb(n);function n(r){const s=r;let i;for(i in e)if(s[i]!==t[i])return!1;return!0}}function Ufe(e){return Jb(t);function t(n){return n&&n.type===e}}function Jb(e){return t;function t(n,r,s){return!!(zfe(n)&&e.call(this,n,typeof r=="number"?r:void 0,s||void 0))}}function Bfe(){return!0}function zfe(e){return e!==null&&typeof e=="object"&&"type"in e}const mz=[],Wfe=!0,G1=!1,qfe="skip";function pz(e,t,n,r){let s;typeof t=="function"&&typeof n!="function"?(r=n,n=t):s=t;const i=Xb(s),o=r?-1:1;l(e,void 0,[])();function l(c,u,d){const h=c&&typeof c=="object"?c:{};if(typeof h.type=="string"){const m=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(c.type+(m?"<"+m+">":""))+")"})}return f;function f(){let m=mz,g,v,y;if((!t||i(c,u,d[d.length-1]||void 0))&&(m=Hfe(n(c,d)),m[0]===G1))return m;if("children"in c&&c.children){const x=c;if(x.children&&m[0]!==qfe)for(v=(r?x.children.length:-1)+o,y=d.concat(x);v>-1&&v<x.children.length;){const w=x.children[v];if(g=l(w,v,y)(),g[0]===G1)return g;v=typeof g[1]=="number"?g[1]:v+o}}return m}}}function Hfe(e){return Array.isArray(e)?e:typeof e=="number"?[Wfe,e]:e==null?mz:[e]}function eA(e,t,n,r){let s,i,o;typeof t=="function"&&typeof n!="function"?(i=void 0,o=t,s=n):(i=t,o=n,s=r),pz(e,i,l,s);function l(c,u){const d=u[u.length-1],h=d?d.children.indexOf(c):void 0;return o(c,h,d)}}const Y1={}.hasOwnProperty,Kfe={};function Vfe(e,t){const n=t||Kfe,r=new Map,s=new Map,i=new Map,o={...Tfe,...n.handlers},l={all:u,applyData:Yfe,definitionById:r,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:o,one:c,options:n,patch:Gfe,wrap:Jfe};return eA(e,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const h=d.type==="definition"?r:s,f=String(d.identifier).toUpperCase();h.has(f)||h.set(f,d)}}),l;function c(d,h){const f=d.type,m=l.handlers[f];if(Y1.call(l.handlers,f)&&m)return m(l,d,h);if(l.options.passThrough&&l.options.passThrough.includes(f)){if("children"in d){const{children:v,...y}=d,x=Ly(y);return x.children=l.all(d),x}return Ly(d)}return(l.options.unknownHandler||Xfe)(l,d,h)}function u(d){const h=[];if("children"in d){const f=d.children;let m=-1;for(;++m<f.length;){const g=l.one(f[m],d);if(g){if(m&&f[m-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=aO(g.value)),!Array.isArray(g)&&g.type==="element")){const v=g.children[0];v&&v.type==="text"&&(v.value=aO(v.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function Gfe(e,t){e.position&&(t.position=Due(e))}function Yfe(e,t){let n=t;if(e&&e.data){const r=e.data.hName,s=e.data.hChildren,i=e.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&i&&Object.assign(n.properties,Ly(i)),"children"in n&&n.children&&s!==null&&s!==void 0&&(n.children=s)}return n}function Xfe(e,t){const n=t.data||{},r="value"in t&&!(Y1.call(n,"hProperties")||Y1.call(n,"hChildren"))?{type:"text",value:t.value}:{type:"element",tagName:"div",properties:{},children:e.all(t)};return e.patch(t,r),e.applyData(t,r)}function Jfe(e,t){const n=[];let r=-1;for(t&&n.push({type:"text",value:`
`});++r<e.length;)r&&n.push({type:"text",value:`
`}),n.push(e[r]);return t&&e.length>0&&n.push({type:"text",value:`
`}),n}function aO(e){let t=0,n=e.charCodeAt(t);for(;n===9||n===32;)t++,n=e.charCodeAt(t);return e.slice(t)}function sO(e,t){const n=Vfe(e,t),r=n.one(e,void 0),s=Lfe(n),i=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function Qfe(e,t){return e&&"run"in e?async function(n,r){const s=sO(n,{file:r,...t});await e.run(s,r)}:function(n,r){return sO(n,{file:r,...e||t})}}function iO(e){if(e)throw e}var Wv=Object.prototype.hasOwnProperty,gz=Object.prototype.toString,oO=Object.defineProperty,lO=Object.getOwnPropertyDescriptor,cO=function(t){return typeof Array.isArray=="function"?Array.isArray(t):gz.call(t)==="[object Array]"},uO=function(t){if(!t||gz.call(t)!=="[object Object]")return!1;var n=Wv.call(t,"constructor"),r=t.constructor&&t.constructor.prototype&&Wv.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!r)return!1;var s;for(s in t);return typeof s>"u"||Wv.call(t,s)},dO=function(t,n){oO&&n.name==="__proto__"?oO(t,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):t[n.name]=n.newValue},hO=function(t,n){if(n==="__proto__")if(Wv.call(t,n)){if(lO)return lO(t,n).value}else return;return t[n]},Zfe=function e(){var t,n,r,s,i,o,l=arguments[0],c=1,u=arguments.length,d=!1;for(typeof l=="boolean"&&(d=l,l=arguments[1]||{},c=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});c<u;++c)if(t=arguments[c],t!=null)for(n in t)r=hO(l,n),s=hO(t,n),l!==s&&(d&&s&&(uO(s)||(i=cO(s)))?(i?(i=!1,o=r&&cO(r)?r:[]):o=r&&uO(r)?r:{},dO(l,{name:n,newValue:e(d,o,s)})):typeof s<"u"&&dO(l,{name:n,newValue:s}));return l};const pj=bn(Zfe);function X1(e){if(typeof e!="object"||e===null)return!1;const t=Object.getPrototypeOf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)}function eme(){const e=[],t={run:n,use:r};return t;function n(...s){let i=-1;const o=s.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);l(null,...s);function l(c,...u){const d=e[++i];let h=-1;if(c){o(c);return}for(;++h<s.length;)(u[h]===null||u[h]===void 0)&&(u[h]=s[h]);s=u,d?tme(d,l)(...u):o(null,...u)}}function r(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return e.push(s),t}}function tme(e,t){let n;return r;function r(...o){const l=e.length>o.length;let c;l&&o.push(s);try{c=e.apply(this,o)}catch(u){const d=u;if(l&&n)throw d;return s(d)}l||(c&&c.then&&typeof c.then=="function"?c.then(i,s):c instanceof Error?s(c):i(c))}function s(o,...l){n||(n=!0,t(o,...l))}function i(o){s(null,o)}}const _i={basename:nme,dirname:rme,extname:ame,join:sme,sep:"/"};function nme(e,t){if(t!==void 0&&typeof t!="string")throw new TypeError('"ext" argument must be a string');ig(e);let n=0,r=-1,s=e.length,i;if(t===void 0||t.length===0||t.length>e.length){for(;s--;)if(e.codePointAt(s)===47){if(i){n=s+1;break}}else r<0&&(i=!0,r=s+1);return r<0?"":e.slice(n,r)}if(t===e)return"";let o=-1,l=t.length-1;for(;s--;)if(e.codePointAt(s)===47){if(i){n=s+1;break}}else o<0&&(i=!0,o=s+1),l>-1&&(e.codePointAt(s)===t.codePointAt(l--)?l<0&&(r=s):(l=-1,r=o));return n===r?r=o:r<0&&(r=e.length),e.slice(n,r)}function rme(e){if(ig(e),e.length===0)return".";let t=-1,n=e.length,r;for(;--n;)if(e.codePointAt(n)===47){if(r){t=n;break}}else r||(r=!0);return t<0?e.codePointAt(0)===47?"/":".":t===1&&e.codePointAt(0)===47?"//":e.slice(0,t)}function ame(e){ig(e);let t=e.length,n=-1,r=0,s=-1,i=0,o;for(;t--;){const l=e.codePointAt(t);if(l===47){if(o){r=t+1;break}continue}n<0&&(o=!0,n=t+1),l===46?s<0?s=t:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||n<0||i===0||i===1&&s===n-1&&s===r+1?"":e.slice(s,n)}function sme(...e){let t=-1,n;for(;++t<e.length;)ig(e[t]),e[t]&&(n=n===void 0?e[t]:n+"/"+e[t]);return n===void 0?".":ime(n)}function ime(e){ig(e);const t=e.codePointAt(0)===47;let n=ome(e,!t);return n.length===0&&!t&&(n="."),n.length>0&&e.codePointAt(e.length-1)===47&&(n+="/"),t?"/"+n:n}function ome(e,t){let n="",r=0,s=-1,i=0,o=-1,l,c;for(;++o<=e.length;){if(o<e.length)l=e.codePointAt(o);else{if(l===47)break;l=47}if(l===47){if(!(s===o-1||i===1))if(s!==o-1&&i===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}}else if(n.length>0){n="",r=0,s=o,i=0;continue}}t&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),r=o-s-1;s=o,i=0}else l===46&&i>-1?i++:i=-1}return n}function ig(e){if(typeof e!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(e))}const lme={cwd:cme};function cme(){return"/"}function J1(e){return!!(e!==null&&typeof e=="object"&&"href"in e&&e.href&&"protocol"in e&&e.protocol&&e.auth===void 0)}function ume(e){if(typeof e=="string")e=new URL(e);else if(!J1(e)){const t=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+e+"`");throw t.code="ERR_INVALID_ARG_TYPE",t}if(e.protocol!=="file:"){const t=new TypeError("The URL must be of scheme file");throw t.code="ERR_INVALID_URL_SCHEME",t}return dme(e)}function dme(e){if(e.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const t=e.pathname;let n=-1;for(;++n<t.length;)if(t.codePointAt(n)===37&&t.codePointAt(n+1)===50){const r=t.codePointAt(n+2);if(r===70||r===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(t)}const gj=["history","path","basename","stem","extname","dirname"];class vz{constructor(t){let n;t?J1(t)?n={path:t}:typeof t=="string"||hme(t)?n={value:t}:n=t:n={},this.cwd="cwd"in n?"":lme.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<gj.length;){const i=gj[r];i in n&&n[i]!==void 0&&n[i]!==null&&(this[i]=i==="history"?[...n[i]]:n[i])}let s;for(s in n)gj.includes(s)||(this[s]=n[s])}get basename(){return typeof this.path=="string"?_i.basename(this.path):void 0}set basename(t){yj(t,"basename"),vj(t,"basename"),this.path=_i.join(this.dirname||"",t)}get dirname(){return typeof this.path=="string"?_i.dirname(this.path):void 0}set dirname(t){fO(this.basename,"dirname"),this.path=_i.join(t||"",this.basename)}get extname(){return typeof this.path=="string"?_i.extname(this.path):void 0}set extname(t){if(vj(t,"extname"),fO(this.dirname,"extname"),t){if(t.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(t.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=_i.join(this.dirname,this.stem+(t||""))}get path(){return this.history[this.history.length-1]}set path(t){J1(t)&&(t=ume(t)),yj(t,"path"),this.path!==t&&this.history.push(t)}get stem(){return typeof this.path=="string"?_i.basename(this.path,this.extname):void 0}set stem(t){yj(t,"stem"),vj(t,"stem"),this.path=_i.join(this.dirname||"",t+(this.extname||""))}fail(t,n,r){const s=this.message(t,n,r);throw s.fatal=!0,s}info(t,n,r){const s=this.message(t,n,r);return s.fatal=void 0,s}message(t,n,r){const s=new ca(t,n,r);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(t){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(t||void 0).decode(this.value)}}function vj(e,t){if(e&&e.includes(_i.sep))throw new Error("`"+t+"` cannot be a path: did not expect `"+_i.sep+"`")}function yj(e,t){if(!e)throw new Error("`"+t+"` cannot be empty")}function fO(e,t){if(!e)throw new Error("Setting `"+t+"` requires `path` to be set too")}function hme(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const fme=function(e){const r=this.constructor.prototype,s=r[e],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,r),i},mme={}.hasOwnProperty;class tA extends fme{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=eme()}copy(){const t=new tA;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];t.use(...r)}return t.data(pj(!0,{},this.namespace)),t}data(t,n){return typeof t=="string"?arguments.length===2?(wj("data",this.frozen),this.namespace[t]=n,this):mme.call(this.namespace,t)&&this.namespace[t]||void 0:t?(wj("data",this.frozen),this.namespace=t,this):this.namespace}freeze(){if(this.frozen)return this;const t=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const s=n.call(t,...r);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(t){this.freeze();const n=Zg(t),r=this.parser||this.Parser;return xj("parse",r),r(String(n),n)}process(t,n){const r=this;return this.freeze(),xj("process",this.parser||this.Parser),bj("process",this.compiler||this.Compiler),n?s(void 0,n):new Promise(s);function s(i,o){const l=Zg(t),c=r.parse(l);r.run(c,l,function(d,h,f){if(d||!h||!f)return u(d);const m=h,g=r.stringify(m,f);vme(g)?f.value=g:f.result=g,u(d,f)});function u(d,h){d||!h?o(d):i?i(h):n(void 0,h)}}}processSync(t){let n=!1,r;return this.freeze(),xj("processSync",this.parser||this.Parser),bj("processSync",this.compiler||this.Compiler),this.process(t,s),pO("processSync","process",n),r;function s(i,o){n=!0,iO(i),r=o}}run(t,n,r){mO(t),this.freeze();const s=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?i(void 0,r):new Promise(i);function i(o,l){const c=Zg(n);s.run(t,c,u);function u(d,h,f){const m=h||t;d?l(d):o?o(m):r(void 0,m,f)}}}runSync(t,n){let r=!1,s;return this.run(t,n,i),pO("runSync","run",r),s;function i(o,l){iO(o),s=l,r=!0}}stringify(t,n){this.freeze();const r=Zg(n),s=this.compiler||this.Compiler;return bj("stringify",s),mO(t),s(t,r)}use(t,...n){const r=this.attachers,s=this.namespace;if(wj("use",this.frozen),t!=null)if(typeof t=="function")c(t,n);else if(typeof t=="object")Array.isArray(t)?l(t):o(t);else throw new TypeError("Expected usable value, not `"+t+"`");return this;function i(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[d,...h]=u;c(d,h)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(u.plugins),u.settings&&(s.settings=pj(!0,s.settings,u.settings))}function l(u){let d=-1;if(u!=null)if(Array.isArray(u))for(;++d<u.length;){const h=u[d];i(h)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,d){let h=-1,f=-1;for(;++h<r.length;)if(r[h][0]===u){f=h;break}if(f===-1)r.push([u,...d]);else if(d.length>0){let[m,...g]=d;const v=r[f][1];X1(v)&&X1(m)&&(m=pj(!0,v,m)),r[f]=[u,m,...g]}}}}const pme=new tA().freeze();function xj(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `parser`")}function bj(e,t){if(typeof t!="function")throw new TypeError("Cannot `"+e+"` without `compiler`")}function wj(e,t){if(t)throw new Error("Cannot call `"+e+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function mO(e){if(!X1(e)||typeof e.type!="string")throw new TypeError("Expected node, got `"+e+"`")}function pO(e,t,n){if(!n)throw new Error("`"+e+"` finished async. Use `"+t+"` instead")}function Zg(e){return gme(e)?e:new vz(e)}function gme(e){return!!(e&&typeof e=="object"&&"message"in e&&"messages"in e)}function vme(e){return typeof e=="string"||yme(e)}function yme(e){return!!(e&&typeof e=="object"&&"byteLength"in e&&"byteOffset"in e)}const xme="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",gO=[],vO={allowDangerousHtml:!0},bme=/^(https?|ircs?|mailto|xmpp)$/i,wme=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function $y(e){const t=jme(e),n=_me(e);return kme(t.runSync(t.parse(n),n),e)}function jme(e){const t=e.rehypePlugins||gO,n=e.remarkPlugins||gO,r=e.remarkRehypeOptions?{...e.remarkRehypeOptions,...vO}:vO;return pme().use(afe).use(n).use(Qfe,r).use(t)}function _me(e){const t=e.children||"",n=new vz;return typeof t=="string"&&(n.value=t),n}function kme(e,t){const n=t.allowedElements,r=t.allowElement,s=t.components,i=t.disallowedElements,o=t.skipHtml,l=t.unwrapDisallowed,c=t.urlTransform||Sme;for(const d of wme)Object.hasOwn(t,d.from)&&(""+d.from+(d.to?"use `"+d.to+"` instead":"remove it")+xme+d.id,void 0);return t.className&&(e={type:"element",tagName:"div",properties:{className:t.className},children:e.type==="root"?e.children:[e]}),eA(e,u),Bue(e,{Fragment:a.Fragment,components:s,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function u(d,h,f){if(d.type==="raw"&&f&&typeof h=="number")return o?f.children.splice(h,1):f.children[h]={type:"text",value:d.value},h;if(d.type==="element"){let m;for(m in hj)if(Object.hasOwn(hj,m)&&Object.hasOwn(d.properties,m)){const g=d.properties[m],v=hj[m];(v===null||v.includes(d.tagName))&&(d.properties[m]=c(String(g||""),m,d))}}if(d.type==="element"){let m=n?!n.includes(d.tagName):i?i.includes(d.tagName):!1;if(!m&&r&&typeof h=="number"&&(m=!r(d,h,f)),m&&f&&typeof h=="number")return l&&d.children?f.children.splice(h,1,...d.children):f.children.splice(h,1),h}}}function Sme(e){const t=e.indexOf(":"),n=e.indexOf("?"),r=e.indexOf("#"),s=e.indexOf("/");return t===-1||s!==-1&&t>s||n!==-1&&t>n||r!==-1&&t>r||bme.test(e.slice(0,t))?e:""}function yO(e,t){const n=String(e);if(typeof t!="string")throw new TypeError("Expected character");let r=0,s=n.indexOf(t);for(;s!==-1;)r++,s=n.indexOf(t,s+t.length);return r}function Nme(e){if(typeof e!="string")throw new TypeError("Expected a string");return e.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function yz(e,t,n){const s=Xb((n||{}).ignore||[]),i=Cme(t);let o=-1;for(;++o<i.length;)pz(e,"text",l);function l(u,d){let h=-1,f;for(;++h<d.length;){const m=d[h],g=f?f.children:void 0;if(s(m,g?g.indexOf(m):void 0,f))return;f=m}if(f)return c(u,d)}function c(u,d){const h=d[d.length-1],f=i[o][0],m=i[o][1];let g=0;const y=h.children.indexOf(u);let x=!1,w=[];f.lastIndex=0;let b=f.exec(u.value);for(;b;){const _=b.index,k={index:b.index,input:b.input,stack:[...d,u]};let j=m(...b,k);if(typeof j=="string"&&(j=j.length>0?{type:"text",value:j}:void 0),j===!1?f.lastIndex=_+1:(g!==_&&w.push({type:"text",value:u.value.slice(g,_)}),Array.isArray(j)?w.push(...j):j&&w.push(j),g=_+b[0].length,x=!0),!f.global)break;b=f.exec(u.value)}return x?(g<u.value.length&&w.push({type:"text",value:u.value.slice(g)}),h.children.splice(y,1,...w)):w=[u],y+w.length}}function Cme(e){const t=[];if(!Array.isArray(e))throw new TypeError("Expected find and replace tuple or list of tuples");const n=!e[0]||Array.isArray(e[0])?e:[e];let r=-1;for(;++r<n.length;){const s=n[r];t.push([Ame(s[0]),Eme(s[1])])}return t}function Ame(e){return typeof e=="string"?new RegExp(Nme(e),"g"):e}function Eme(e){return typeof e=="function"?e:function(){return e}}const jj="phrasing",_j=["autolink","link","image","label"];function Tme(){return{transforms:[Lme],enter:{literalAutolink:Ome,literalAutolinkEmail:kj,literalAutolinkHttp:kj,literalAutolinkWww:kj},exit:{literalAutolink:Dme,literalAutolinkEmail:Mme,literalAutolinkHttp:Ime,literalAutolinkWww:Rme}}}function Pme(){return{unsafe:[{character:"@",before:"[+\\-.\\w]",after:"[\\-.\\w]",inConstruct:jj,notInConstruct:_j},{character:".",before:"[Ww]",after:"[\\-.\\w]",inConstruct:jj,notInConstruct:_j},{character:":",before:"[ps]",after:"\\/",inConstruct:jj,notInConstruct:_j}]}}function Ome(e){this.enter({type:"link",title:null,url:"",children:[]},e)}function kj(e){this.config.enter.autolinkProtocol.call(this,e)}function Ime(e){this.config.exit.autolinkProtocol.call(this,e)}function Rme(e){this.config.exit.data.call(this,e);const t=this.stack[this.stack.length-1];t.type,t.url="http://"+this.sliceSerialize(e)}function Mme(e){this.config.exit.autolinkEmail.call(this,e)}function Dme(e){this.exit(e)}function Lme(e){yz(e,[[/(https?:\/\/|www(?=\.))([-.\w]+)([^ \t\r\n]*)/gi,$me],[new RegExp("(?<=^|\\s|\\p{P}|\\p{S})([-.\\w+]+)@([-\\w]+(?:\\.[-\\w]+)+)","gu"),Fme]],{ignore:["link","linkReference"]})}function $me(e,t,n,r,s){let i="";if(!xz(s)||(/^w/i.test(t)&&(n=t+n,t="",i="http://"),!Ume(n)))return!1;const o=Bme(n+r);if(!o[0])return!1;const l={type:"link",title:null,url:i+t+o[0],children:[{type:"text",value:t+o[0]}]};return o[1]?[l,{type:"text",value:o[1]}]:l}function Fme(e,t,n,r){return!xz(r,!0)||/[-\d_]$/.test(n)?!1:{type:"link",title:null,url:"mailto:"+t+"@"+n,children:[{type:"text",value:t+"@"+n}]}}function Ume(e){const t=e.split(".");return!(t.length<2||t[t.length-1]&&(/_/.test(t[t.length-1])||!/[a-zA-Z\d]/.test(t[t.length-1]))||t[t.length-2]&&(/_/.test(t[t.length-2])||!/[a-zA-Z\d]/.test(t[t.length-2])))}function Bme(e){const t=/[!"&'),.:;<>?\]}]+$/.exec(e);if(!t)return[e,void 0];e=e.slice(0,t.index);let n=t[0],r=n.indexOf(")");const s=yO(e,"(");let i=yO(e,")");for(;r!==-1&&s>i;)e+=n.slice(0,r+1),n=n.slice(r+1),r=n.indexOf(")"),i++;return[e,n]}function xz(e,t){const n=e.input.charCodeAt(e.index-1);return(e.index===0||tu(n)||Vb(n))&&(!t||n!==47)}bz.peek=Xme;function zme(){this.buffer()}function Wme(e){this.enter({type:"footnoteReference",identifier:"",label:""},e)}function qme(){this.buffer()}function Hme(e){this.enter({type:"footnoteDefinition",identifier:"",label:"",children:[]},e)}function Kme(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=li(this.sliceSerialize(e)).toLowerCase(),n.label=t}function Vme(e){this.exit(e)}function Gme(e){const t=this.resume(),n=this.stack[this.stack.length-1];n.type,n.identifier=li(this.sliceSerialize(e)).toLowerCase(),n.label=t}function Yme(e){this.exit(e)}function Xme(){return"["}function bz(e,t,n,r){const s=n.createTracker(r);let i=s.move("[^");const o=n.enter("footnoteReference"),l=n.enter("reference");return i+=s.move(n.safe(n.associationId(e),{after:"]",before:i})),l(),o(),i+=s.move("]"),i}function Jme(){return{enter:{gfmFootnoteCallString:zme,gfmFootnoteCall:Wme,gfmFootnoteDefinitionLabelString:qme,gfmFootnoteDefinition:Hme},exit:{gfmFootnoteCallString:Kme,gfmFootnoteCall:Vme,gfmFootnoteDefinitionLabelString:Gme,gfmFootnoteDefinition:Yme}}}function Qme(e){let t=!1;return e&&e.firstLineBlank&&(t=!0),{handlers:{footnoteDefinition:n,footnoteReference:bz},unsafe:[{character:"[",inConstruct:["label","phrasing","reference"]}]};function n(r,s,i,o){const l=i.createTracker(o);let c=l.move("[^");const u=i.enter("footnoteDefinition"),d=i.enter("label");return c+=l.move(i.safe(i.associationId(r),{before:c,after:"]"})),d(),c+=l.move("]:"),r.children&&r.children.length>0&&(l.shift(4),c+=l.move((t?`
`:" ")+i.indentLines(i.containerFlow(r,l.current()),t?wz:Zme))),u(),c}}function Zme(e,t,n){return t===0?e:wz(e,t,n)}function wz(e,t,n){return(n?"":"    ")+e}const epe=["autolink","destinationLiteral","destinationRaw","reference","titleQuote","titleApostrophe"];jz.peek=spe;function tpe(){return{canContainEols:["delete"],enter:{strikethrough:rpe},exit:{strikethrough:ape}}}function npe(){return{unsafe:[{character:"~",inConstruct:"phrasing",notInConstruct:epe}],handlers:{delete:jz}}}function rpe(e){this.enter({type:"delete",children:[]},e)}function ape(e){this.exit(e)}function jz(e,t,n,r){const s=n.createTracker(r),i=n.enter("strikethrough");let o=s.move("~~");return o+=n.containerPhrasing(e,{...s.current(),before:o,after:"~"}),o+=s.move("~~"),i(),o}function spe(){return"~"}function ipe(e){return e.length}function ope(e,t){const n=t||{},r=(n.align||[]).concat(),s=n.stringLength||ipe,i=[],o=[],l=[],c=[];let u=0,d=-1;for(;++d<e.length;){const v=[],y=[];let x=-1;for(e[d].length>u&&(u=e[d].length);++x<e[d].length;){const w=lpe(e[d][x]);if(n.alignDelimiters!==!1){const b=s(w);y[x]=b,(c[x]===void 0||b>c[x])&&(c[x]=b)}v.push(w)}o[d]=v,l[d]=y}let h=-1;if(typeof r=="object"&&"length"in r)for(;++h<u;)i[h]=xO(r[h]);else{const v=xO(r);for(;++h<u;)i[h]=v}h=-1;const f=[],m=[];for(;++h<u;){const v=i[h];let y="",x="";v===99?(y=":",x=":"):v===108?y=":":v===114&&(x=":");let w=n.alignDelimiters===!1?1:Math.max(1,c[h]-y.length-x.length);const b=y+"-".repeat(w)+x;n.alignDelimiters!==!1&&(w=y.length+w+x.length,w>c[h]&&(c[h]=w),m[h]=w),f[h]=b}o.splice(1,0,f),l.splice(1,0,m),d=-1;const g=[];for(;++d<o.length;){const v=o[d],y=l[d];h=-1;const x=[];for(;++h<u;){const w=v[h]||"";let b="",_="";if(n.alignDelimiters!==!1){const k=c[h]-(y[h]||0),j=i[h];j===114?b=" ".repeat(k):j===99?k%2?(b=" ".repeat(k/2+.5),_=" ".repeat(k/2-.5)):(b=" ".repeat(k/2),_=b):_=" ".repeat(k)}n.delimiterStart!==!1&&!h&&x.push("|"),n.padding!==!1&&!(n.alignDelimiters===!1&&w==="")&&(n.delimiterStart!==!1||h)&&x.push(" "),n.alignDelimiters!==!1&&x.push(b),x.push(w),n.alignDelimiters!==!1&&x.push(_),n.padding!==!1&&x.push(" "),(n.delimiterEnd!==!1||h!==u-1)&&x.push("|")}g.push(n.delimiterEnd===!1?x.join("").replace(/ +$/,""):x.join(""))}return g.join(`
`)}function lpe(e){return e==null?"":String(e)}function xO(e){const t=typeof e=="string"?e.codePointAt(0):0;return t===67||t===99?99:t===76||t===108?108:t===82||t===114?114:0}function cpe(e,t,n,r){const s=n.enter("blockquote"),i=n.createTracker(r);i.move("> "),i.shift(2);const o=n.indentLines(n.containerFlow(e,i.current()),upe);return s(),o}function upe(e,t,n){return">"+(n?"":" ")+e}function dpe(e,t){return bO(e,t.inConstruct,!0)&&!bO(e,t.notInConstruct,!1)}function bO(e,t,n){if(typeof t=="string"&&(t=[t]),!t||t.length===0)return n;let r=-1;for(;++r<t.length;)if(e.includes(t[r]))return!0;return!1}function wO(e,t,n,r){let s=-1;for(;++s<n.unsafe.length;)if(n.unsafe[s].character===`
`&&dpe(n.stack,n.unsafe[s]))return/[ \t]/.test(r.before)?"":" ";return`\\
`}function hpe(e,t){const n=String(e);let r=n.indexOf(t),s=r,i=0,o=0;if(typeof t!="string")throw new TypeError("Expected substring");for(;r!==-1;)r===s?++i>o&&(o=i):i=1,s=r+t.length,r=n.indexOf(t,s);return o}function fpe(e,t){return!!(t.options.fences===!1&&e.value&&!e.lang&&/[^ \r\n]/.test(e.value)&&!/^[\t ]*(?:[\r\n]|$)|(?:^|[\r\n])[\t ]*$/.test(e.value))}function mpe(e){const t=e.options.fence||"`";if(t!=="`"&&t!=="~")throw new Error("Cannot serialize code with `"+t+"` for `options.fence`, expected `` ` `` or `~`");return t}function ppe(e,t,n,r){const s=mpe(n),i=e.value||"",o=s==="`"?"GraveAccent":"Tilde";if(fpe(e,n)){const h=n.enter("codeIndented"),f=n.indentLines(i,gpe);return h(),f}const l=n.createTracker(r),c=s.repeat(Math.max(hpe(i,s)+1,3)),u=n.enter("codeFenced");let d=l.move(c);if(e.lang){const h=n.enter(`codeFencedLang${o}`);d+=l.move(n.safe(e.lang,{before:d,after:" ",encode:["`"],...l.current()})),h()}if(e.lang&&e.meta){const h=n.enter(`codeFencedMeta${o}`);d+=l.move(" "),d+=l.move(n.safe(e.meta,{before:d,after:`
`,encode:["`"],...l.current()})),h()}return d+=l.move(`
`),i&&(d+=l.move(i+`
`)),d+=l.move(c),u(),d}function gpe(e,t,n){return(n?"":"    ")+e}function nA(e){const t=e.options.quote||'"';if(t!=='"'&&t!=="'")throw new Error("Cannot serialize title with `"+t+"` for `options.quote`, expected `\"`, or `'`");return t}function vpe(e,t,n,r){const s=nA(n),i=s==='"'?"Quote":"Apostrophe",o=n.enter("definition");let l=n.enter("label");const c=n.createTracker(r);let u=c.move("[");return u+=c.move(n.safe(n.associationId(e),{before:u,after:"]",...c.current()})),u+=c.move("]: "),l(),!e.url||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),u+=c.move("<"),u+=c.move(n.safe(e.url,{before:u,after:">",...c.current()})),u+=c.move(">")):(l=n.enter("destinationRaw"),u+=c.move(n.safe(e.url,{before:u,after:e.title?" ":`
`,...c.current()}))),l(),e.title&&(l=n.enter(`title${i}`),u+=c.move(" "+s),u+=c.move(n.safe(e.title,{before:u,after:s,...c.current()})),u+=c.move(s),l()),o(),u}function ype(e){const t=e.options.emphasis||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize emphasis with `"+t+"` for `options.emphasis`, expected `*`, or `_`");return t}function zm(e){return"&#x"+e.toString(16).toUpperCase()+";"}function Fy(e,t,n){const r=Zd(e),s=Zd(t);return r===void 0?s===void 0?n==="_"?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!0}:r===1?s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!0}:{inside:!1,outside:!1}:s===void 0?{inside:!1,outside:!1}:s===1?{inside:!0,outside:!1}:{inside:!1,outside:!1}}_z.peek=xpe;function _z(e,t,n,r){const s=ype(n),i=n.enter("emphasis"),o=n.createTracker(r),l=o.move(s);let c=o.move(n.containerPhrasing(e,{after:s,before:l,...o.current()}));const u=c.charCodeAt(0),d=Fy(r.before.charCodeAt(r.before.length-1),u,s);d.inside&&(c=zm(u)+c.slice(1));const h=c.charCodeAt(c.length-1),f=Fy(r.after.charCodeAt(0),h,s);f.inside&&(c=c.slice(0,-1)+zm(h));const m=o.move(s);return i(),n.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},l+c+m}function xpe(e,t,n){return n.options.emphasis||"*"}function bpe(e,t){let n=!1;return eA(e,function(r){if("value"in r&&/\r?\n|\r/.test(r.value)||r.type==="break")return n=!0,G1}),!!((!e.depth||e.depth<3)&&VC(e)&&(t.options.setext||n))}function wpe(e,t,n,r){const s=Math.max(Math.min(6,e.depth||1),1),i=n.createTracker(r);if(bpe(e,n)){const d=n.enter("headingSetext"),h=n.enter("phrasing"),f=n.containerPhrasing(e,{...i.current(),before:`
`,after:`
`});return h(),d(),f+`
`+(s===1?"=":"-").repeat(f.length-(Math.max(f.lastIndexOf("\r"),f.lastIndexOf(`
`))+1))}const o="#".repeat(s),l=n.enter("headingAtx"),c=n.enter("phrasing");i.move(o+" ");let u=n.containerPhrasing(e,{before:"# ",after:`
`,...i.current()});return/^[\t ]/.test(u)&&(u=zm(u.charCodeAt(0))+u.slice(1)),u=u?o+" "+u:o,n.options.closeAtx&&(u+=" "+o),c(),l(),u}kz.peek=jpe;function kz(e){return e.value||""}function jpe(){return"<"}Sz.peek=_pe;function Sz(e,t,n,r){const s=nA(n),i=s==='"'?"Quote":"Apostrophe",o=n.enter("image");let l=n.enter("label");const c=n.createTracker(r);let u=c.move("![");return u+=c.move(n.safe(e.alt,{before:u,after:"]",...c.current()})),u+=c.move("]("),l(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(l=n.enter("destinationLiteral"),u+=c.move("<"),u+=c.move(n.safe(e.url,{before:u,after:">",...c.current()})),u+=c.move(">")):(l=n.enter("destinationRaw"),u+=c.move(n.safe(e.url,{before:u,after:e.title?" ":")",...c.current()}))),l(),e.title&&(l=n.enter(`title${i}`),u+=c.move(" "+s),u+=c.move(n.safe(e.title,{before:u,after:s,...c.current()})),u+=c.move(s),l()),u+=c.move(")"),o(),u}function _pe(){return"!"}Nz.peek=kpe;function Nz(e,t,n,r){const s=e.referenceType,i=n.enter("imageReference");let o=n.enter("label");const l=n.createTracker(r);let c=l.move("![");const u=n.safe(e.alt,{before:c,after:"]",...l.current()});c+=l.move(u+"]["),o();const d=n.stack;n.stack=[],o=n.enter("reference");const h=n.safe(n.associationId(e),{before:c,after:"]",...l.current()});return o(),n.stack=d,i(),s==="full"||!u||u!==h?c+=l.move(h+"]"):s==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function kpe(){return"!"}Cz.peek=Spe;function Cz(e,t,n){let r=e.value||"",s="`",i=-1;for(;new RegExp("(^|[^`])"+s+"([^`]|$)").test(r);)s+="`";for(/[^ \r\n]/.test(r)&&(/^[ \r\n]/.test(r)&&/[ \r\n]$/.test(r)||/^`|`$/.test(r))&&(r=" "+r+" ");++i<n.unsafe.length;){const o=n.unsafe[i],l=n.compilePattern(o);let c;if(o.atBreak)for(;c=l.exec(r);){let u=c.index;r.charCodeAt(u)===10&&r.charCodeAt(u-1)===13&&u--,r=r.slice(0,u)+" "+r.slice(c.index+1)}}return s+r+s}function Spe(){return"`"}function Az(e,t){const n=VC(e);return!!(!t.options.resourceLink&&e.url&&!e.title&&e.children&&e.children.length===1&&e.children[0].type==="text"&&(n===e.url||"mailto:"+n===e.url)&&/^[a-z][a-z+.-]+:/i.test(e.url)&&!/[\0- <>\u007F]/.test(e.url))}Ez.peek=Npe;function Ez(e,t,n,r){const s=nA(n),i=s==='"'?"Quote":"Apostrophe",o=n.createTracker(r);let l,c;if(Az(e,n)){const d=n.stack;n.stack=[],l=n.enter("autolink");let h=o.move("<");return h+=o.move(n.containerPhrasing(e,{before:h,after:">",...o.current()})),h+=o.move(">"),l(),n.stack=d,h}l=n.enter("link"),c=n.enter("label");let u=o.move("[");return u+=o.move(n.containerPhrasing(e,{before:u,after:"](",...o.current()})),u+=o.move("]("),c(),!e.url&&e.title||/[\0- \u007F]/.test(e.url)?(c=n.enter("destinationLiteral"),u+=o.move("<"),u+=o.move(n.safe(e.url,{before:u,after:">",...o.current()})),u+=o.move(">")):(c=n.enter("destinationRaw"),u+=o.move(n.safe(e.url,{before:u,after:e.title?" ":")",...o.current()}))),c(),e.title&&(c=n.enter(`title${i}`),u+=o.move(" "+s),u+=o.move(n.safe(e.title,{before:u,after:s,...o.current()})),u+=o.move(s),c()),u+=o.move(")"),l(),u}function Npe(e,t,n){return Az(e,n)?"<":"["}Tz.peek=Cpe;function Tz(e,t,n,r){const s=e.referenceType,i=n.enter("linkReference");let o=n.enter("label");const l=n.createTracker(r);let c=l.move("[");const u=n.containerPhrasing(e,{before:c,after:"]",...l.current()});c+=l.move(u+"]["),o();const d=n.stack;n.stack=[],o=n.enter("reference");const h=n.safe(n.associationId(e),{before:c,after:"]",...l.current()});return o(),n.stack=d,i(),s==="full"||!u||u!==h?c+=l.move(h+"]"):s==="shortcut"?c=c.slice(0,-1):c+=l.move("]"),c}function Cpe(){return"["}function rA(e){const t=e.options.bullet||"*";if(t!=="*"&&t!=="+"&&t!=="-")throw new Error("Cannot serialize items with `"+t+"` for `options.bullet`, expected `*`, `+`, or `-`");return t}function Ape(e){const t=rA(e),n=e.options.bulletOther;if(!n)return t==="*"?"-":"*";if(n!=="*"&&n!=="+"&&n!=="-")throw new Error("Cannot serialize items with `"+n+"` for `options.bulletOther`, expected `*`, `+`, or `-`");if(n===t)throw new Error("Expected `bullet` (`"+t+"`) and `bulletOther` (`"+n+"`) to be different");return n}function Epe(e){const t=e.options.bulletOrdered||".";if(t!=="."&&t!==")")throw new Error("Cannot serialize items with `"+t+"` for `options.bulletOrdered`, expected `.` or `)`");return t}function Pz(e){const t=e.options.rule||"*";if(t!=="*"&&t!=="-"&&t!=="_")throw new Error("Cannot serialize rules with `"+t+"` for `options.rule`, expected `*`, `-`, or `_`");return t}function Tpe(e,t,n,r){const s=n.enter("list"),i=n.bulletCurrent;let o=e.ordered?Epe(n):rA(n);const l=e.ordered?o==="."?")":".":Ape(n);let c=t&&n.bulletLastUsed?o===n.bulletLastUsed:!1;if(!e.ordered){const d=e.children?e.children[0]:void 0;if((o==="*"||o==="-")&&d&&(!d.children||!d.children[0])&&n.stack[n.stack.length-1]==="list"&&n.stack[n.stack.length-2]==="listItem"&&n.stack[n.stack.length-3]==="list"&&n.stack[n.stack.length-4]==="listItem"&&n.indexStack[n.indexStack.length-1]===0&&n.indexStack[n.indexStack.length-2]===0&&n.indexStack[n.indexStack.length-3]===0&&(c=!0),Pz(n)===o&&d){let h=-1;for(;++h<e.children.length;){const f=e.children[h];if(f&&f.type==="listItem"&&f.children&&f.children[0]&&f.children[0].type==="thematicBreak"){c=!0;break}}}}c&&(o=l),n.bulletCurrent=o;const u=n.containerFlow(e,r);return n.bulletLastUsed=o,n.bulletCurrent=i,s(),u}function Ppe(e){const t=e.options.listItemIndent||"one";if(t!=="tab"&&t!=="one"&&t!=="mixed")throw new Error("Cannot serialize items with `"+t+"` for `options.listItemIndent`, expected `tab`, `one`, or `mixed`");return t}function Ope(e,t,n,r){const s=Ppe(n);let i=n.bulletCurrent||rA(n);t&&t.type==="list"&&t.ordered&&(i=(typeof t.start=="number"&&t.start>-1?t.start:1)+(n.options.incrementListMarker===!1?0:t.children.indexOf(e))+i);let o=i.length+1;(s==="tab"||s==="mixed"&&(t&&t.type==="list"&&t.spread||e.spread))&&(o=Math.ceil(o/4)*4);const l=n.createTracker(r);l.move(i+" ".repeat(o-i.length)),l.shift(o);const c=n.enter("listItem"),u=n.indentLines(n.containerFlow(e,l.current()),d);return c(),u;function d(h,f,m){return f?(m?"":" ".repeat(o))+h:(m?i:i+" ".repeat(o-i.length))+h}}function Ipe(e,t,n,r){const s=n.enter("paragraph"),i=n.enter("phrasing"),o=n.containerPhrasing(e,r);return i(),s(),o}const Rpe=Xb(["break","delete","emphasis","footnote","footnoteReference","image","imageReference","inlineCode","inlineMath","link","linkReference","mdxJsxTextElement","mdxTextExpression","strong","text","textDirective"]);function Mpe(e,t,n,r){return(e.children.some(function(o){return Rpe(o)})?n.containerPhrasing:n.containerFlow).call(n,e,r)}function Dpe(e){const t=e.options.strong||"*";if(t!=="*"&&t!=="_")throw new Error("Cannot serialize strong with `"+t+"` for `options.strong`, expected `*`, or `_`");return t}Oz.peek=Lpe;function Oz(e,t,n,r){const s=Dpe(n),i=n.enter("strong"),o=n.createTracker(r),l=o.move(s+s);let c=o.move(n.containerPhrasing(e,{after:s,before:l,...o.current()}));const u=c.charCodeAt(0),d=Fy(r.before.charCodeAt(r.before.length-1),u,s);d.inside&&(c=zm(u)+c.slice(1));const h=c.charCodeAt(c.length-1),f=Fy(r.after.charCodeAt(0),h,s);f.inside&&(c=c.slice(0,-1)+zm(h));const m=o.move(s+s);return i(),n.attentionEncodeSurroundingInfo={after:f.outside,before:d.outside},l+c+m}function Lpe(e,t,n){return n.options.strong||"*"}function $pe(e,t,n,r){return n.safe(e.value,r)}function Fpe(e){const t=e.options.ruleRepetition||3;if(t<3)throw new Error("Cannot serialize rules with repetition `"+t+"` for `options.ruleRepetition`, expected `3` or more");return t}function Upe(e,t,n){const r=(Pz(n)+(n.options.ruleSpaces?" ":"")).repeat(Fpe(n));return n.options.ruleSpaces?r.slice(0,-1):r}const Iz={blockquote:cpe,break:wO,code:ppe,definition:vpe,emphasis:_z,hardBreak:wO,heading:wpe,html:kz,image:Sz,imageReference:Nz,inlineCode:Cz,link:Ez,linkReference:Tz,list:Tpe,listItem:Ope,paragraph:Ipe,root:Mpe,strong:Oz,text:$pe,thematicBreak:Upe};function Bpe(){return{enter:{table:zpe,tableData:jO,tableHeader:jO,tableRow:qpe},exit:{codeText:Hpe,table:Wpe,tableData:Sj,tableHeader:Sj,tableRow:Sj}}}function zpe(e){const t=e._align;this.enter({type:"table",align:t.map(function(n){return n==="none"?null:n}),children:[]},e),this.data.inTable=!0}function Wpe(e){this.exit(e),this.data.inTable=void 0}function qpe(e){this.enter({type:"tableRow",children:[]},e)}function Sj(e){this.exit(e)}function jO(e){this.enter({type:"tableCell",children:[]},e)}function Hpe(e){let t=this.resume();this.data.inTable&&(t=t.replace(/\\([\\|])/g,Kpe));const n=this.stack[this.stack.length-1];n.type,n.value=t,this.exit(e)}function Kpe(e,t){return t==="|"?t:e}function Vpe(e){const t=e||{},n=t.tableCellPadding,r=t.tablePipeAlign,s=t.stringLength,i=n?" ":"|";return{unsafe:[{character:"\r",inConstruct:"tableCell"},{character:`
`,inConstruct:"tableCell"},{atBreak:!0,character:"|",after:"[	 :-]"},{character:"|",inConstruct:"tableCell"},{atBreak:!0,character:":",after:"-"},{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{inlineCode:f,table:o,tableCell:c,tableRow:l}};function o(m,g,v,y){return u(d(m,v,y),m.align)}function l(m,g,v,y){const x=h(m,v,y),w=u([x]);return w.slice(0,w.indexOf(`
`))}function c(m,g,v,y){const x=v.enter("tableCell"),w=v.enter("phrasing"),b=v.containerPhrasing(m,{...y,before:i,after:i});return w(),x(),b}function u(m,g){return ope(m,{align:g,alignDelimiters:r,padding:n,stringLength:s})}function d(m,g,v){const y=m.children;let x=-1;const w=[],b=g.enter("table");for(;++x<y.length;)w[x]=h(y[x],g,v);return b(),w}function h(m,g,v){const y=m.children;let x=-1;const w=[],b=g.enter("tableRow");for(;++x<y.length;)w[x]=c(y[x],m,g,v);return b(),w}function f(m,g,v){let y=Iz.inlineCode(m,g,v);return v.stack.includes("tableCell")&&(y=y.replace(/\|/g,"\\$&")),y}}function Gpe(){return{exit:{taskListCheckValueChecked:_O,taskListCheckValueUnchecked:_O,paragraph:Xpe}}}function Ype(){return{unsafe:[{atBreak:!0,character:"-",after:"[:|-]"}],handlers:{listItem:Jpe}}}function _O(e){const t=this.stack[this.stack.length-2];t.type,t.checked=e.type==="taskListCheckValueChecked"}function Xpe(e){const t=this.stack[this.stack.length-2];if(t&&t.type==="listItem"&&typeof t.checked=="boolean"){const n=this.stack[this.stack.length-1];n.type;const r=n.children[0];if(r&&r.type==="text"){const s=t.children;let i=-1,o;for(;++i<s.length;){const l=s[i];if(l.type==="paragraph"){o=l;break}}o===n&&(r.value=r.value.slice(1),r.value.length===0?n.children.shift():n.position&&r.position&&typeof r.position.start.offset=="number"&&(r.position.start.column++,r.position.start.offset++,n.position.start=Object.assign({},r.position.start)))}}this.exit(e)}function Jpe(e,t,n,r){const s=e.children[0],i=typeof e.checked=="boolean"&&s&&s.type==="paragraph",o="["+(e.checked?"x":" ")+"] ",l=n.createTracker(r);i&&l.move(o);let c=Iz.listItem(e,t,n,{...r,...l.current()});return i&&(c=c.replace(/^(?:[*+-]|\d+\.)([\r\n]| {1,3})/,u)),c;function u(d){return d+o}}function Qpe(){return[Tme(),Jme(),tpe(),Bpe(),Gpe()]}function Zpe(e){return{extensions:[Pme(),Qme(e),npe(),Vpe(e),Ype()]}}const ege={tokenize:ige,partial:!0},Rz={tokenize:oge,partial:!0},Mz={tokenize:lge,partial:!0},Dz={tokenize:cge,partial:!0},tge={tokenize:uge,partial:!0},Lz={name:"wwwAutolink",tokenize:age,previous:Fz},$z={name:"protocolAutolink",tokenize:sge,previous:Uz},Uo={name:"emailAutolink",tokenize:rge,previous:Bz},Yi={};function nge(){return{text:Yi}}let oc=48;for(;oc<123;)Yi[oc]=Uo,oc++,oc===58?oc=65:oc===91&&(oc=97);Yi[43]=Uo;Yi[45]=Uo;Yi[46]=Uo;Yi[95]=Uo;Yi[72]=[Uo,$z];Yi[104]=[Uo,$z];Yi[87]=[Uo,Lz];Yi[119]=[Uo,Lz];function rge(e,t,n){const r=this;let s,i;return o;function o(h){return!Q1(h)||!Bz.call(r,r.previous)||aA(r.events)?n(h):(e.enter("literalAutolink"),e.enter("literalAutolinkEmail"),l(h))}function l(h){return Q1(h)?(e.consume(h),l):h===64?(e.consume(h),c):n(h)}function c(h){return h===46?e.check(tge,d,u)(h):h===45||h===95||oa(h)?(i=!0,e.consume(h),c):d(h)}function u(h){return e.consume(h),s=!0,c}function d(h){return i&&s&&wa(r.previous)?(e.exit("literalAutolinkEmail"),e.exit("literalAutolink"),t(h)):n(h)}}function age(e,t,n){const r=this;return s;function s(o){return o!==87&&o!==119||!Fz.call(r,r.previous)||aA(r.events)?n(o):(e.enter("literalAutolink"),e.enter("literalAutolinkWww"),e.check(ege,e.attempt(Rz,e.attempt(Mz,i),n),n)(o))}function i(o){return e.exit("literalAutolinkWww"),e.exit("literalAutolink"),t(o)}}function sge(e,t,n){const r=this;let s="",i=!1;return o;function o(h){return(h===72||h===104)&&Uz.call(r,r.previous)&&!aA(r.events)?(e.enter("literalAutolink"),e.enter("literalAutolinkHttp"),s+=String.fromCodePoint(h),e.consume(h),l):n(h)}function l(h){if(wa(h)&&s.length<5)return s+=String.fromCodePoint(h),e.consume(h),l;if(h===58){const f=s.toLowerCase();if(f==="http"||f==="https")return e.consume(h),c}return n(h)}function c(h){return h===47?(e.consume(h),i?u:(i=!0,c)):n(h)}function u(h){return h===null||My(h)||An(h)||tu(h)||Vb(h)?n(h):e.attempt(Rz,e.attempt(Mz,d),n)(h)}function d(h){return e.exit("literalAutolinkHttp"),e.exit("literalAutolink"),t(h)}}function ige(e,t,n){let r=0;return s;function s(o){return(o===87||o===119)&&r<3?(r++,e.consume(o),s):o===46&&r===3?(e.consume(o),i):n(o)}function i(o){return o===null?n(o):t(o)}}function oge(e,t,n){let r,s,i;return o;function o(u){return u===46||u===95?e.check(Dz,c,l)(u):u===null||An(u)||tu(u)||u!==45&&Vb(u)?c(u):(i=!0,e.consume(u),o)}function l(u){return u===95?r=!0:(s=r,r=void 0),e.consume(u),o}function c(u){return s||r||!i?n(u):t(u)}}function lge(e,t){let n=0,r=0;return s;function s(o){return o===40?(n++,e.consume(o),s):o===41&&r<n?i(o):o===33||o===34||o===38||o===39||o===41||o===42||o===44||o===46||o===58||o===59||o===60||o===63||o===93||o===95||o===126?e.check(Dz,t,i)(o):o===null||An(o)||tu(o)?t(o):(e.consume(o),s)}function i(o){return o===41&&r++,e.consume(o),s}}function cge(e,t,n){return r;function r(l){return l===33||l===34||l===39||l===41||l===42||l===44||l===46||l===58||l===59||l===63||l===95||l===126?(e.consume(l),r):l===38?(e.consume(l),i):l===93?(e.consume(l),s):l===60||l===null||An(l)||tu(l)?t(l):n(l)}function s(l){return l===null||l===40||l===91||An(l)||tu(l)?t(l):r(l)}function i(l){return wa(l)?o(l):n(l)}function o(l){return l===59?(e.consume(l),r):wa(l)?(e.consume(l),o):n(l)}}function uge(e,t,n){return r;function r(i){return e.consume(i),s}function s(i){return oa(i)?n(i):t(i)}}function Fz(e){return e===null||e===40||e===42||e===95||e===91||e===93||e===126||An(e)}function Uz(e){return!wa(e)}function Bz(e){return!(e===47||Q1(e))}function Q1(e){return e===43||e===45||e===46||e===95||oa(e)}function aA(e){let t=e.length,n=!1;for(;t--;){const r=e[t][1];if((r.type==="labelLink"||r.type==="labelImage")&&!r._balanced){n=!0;break}if(r._gfmAutolinkLiteralWalkedInto){n=!1;break}}return e.length>0&&!n&&(e[e.length-1][1]._gfmAutolinkLiteralWalkedInto=!0),n}const dge={tokenize:xge,partial:!0};function hge(){return{document:{91:{name:"gfmFootnoteDefinition",tokenize:gge,continuation:{tokenize:vge},exit:yge}},text:{91:{name:"gfmFootnoteCall",tokenize:pge},93:{name:"gfmPotentialFootnoteCall",add:"after",tokenize:fge,resolveTo:mge}}}}function fge(e,t,n){const r=this;let s=r.events.length;const i=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let o;for(;s--;){const c=r.events[s][1];if(c.type==="labelImage"){o=c;break}if(c.type==="gfmFootnoteCall"||c.type==="labelLink"||c.type==="label"||c.type==="image"||c.type==="link")break}return l;function l(c){if(!o||!o._balanced)return n(c);const u=li(r.sliceSerialize({start:o.end,end:r.now()}));return u.codePointAt(0)!==94||!i.includes(u.slice(1))?n(c):(e.enter("gfmFootnoteCallLabelMarker"),e.consume(c),e.exit("gfmFootnoteCallLabelMarker"),t(c))}}function mge(e,t){let n=e.length;for(;n--;)if(e[n][1].type==="labelImage"&&e[n][0]==="enter"){e[n][1];break}e[n+1][1].type="data",e[n+3][1].type="gfmFootnoteCallLabelMarker";const r={type:"gfmFootnoteCall",start:Object.assign({},e[n+3][1].start),end:Object.assign({},e[e.length-1][1].end)},s={type:"gfmFootnoteCallMarker",start:Object.assign({},e[n+3][1].end),end:Object.assign({},e[n+3][1].end)};s.end.column++,s.end.offset++,s.end._bufferIndex++;const i={type:"gfmFootnoteCallString",start:Object.assign({},s.end),end:Object.assign({},e[e.length-1][1].start)},o={type:"chunkString",contentType:"string",start:Object.assign({},i.start),end:Object.assign({},i.end)},l=[e[n+1],e[n+2],["enter",r,t],e[n+3],e[n+4],["enter",s,t],["exit",s,t],["enter",i,t],["enter",o,t],["exit",o,t],["exit",i,t],e[e.length-2],e[e.length-1],["exit",r,t]];return e.splice(n,e.length-n+1,...l),e}function pge(e,t,n){const r=this,s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i=0,o;return l;function l(h){return e.enter("gfmFootnoteCall"),e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),c}function c(h){return h!==94?n(h):(e.enter("gfmFootnoteCallMarker"),e.consume(h),e.exit("gfmFootnoteCallMarker"),e.enter("gfmFootnoteCallString"),e.enter("chunkString").contentType="string",u)}function u(h){if(i>999||h===93&&!o||h===null||h===91||An(h))return n(h);if(h===93){e.exit("chunkString");const f=e.exit("gfmFootnoteCallString");return s.includes(li(r.sliceSerialize(f)))?(e.enter("gfmFootnoteCallLabelMarker"),e.consume(h),e.exit("gfmFootnoteCallLabelMarker"),e.exit("gfmFootnoteCall"),t):n(h)}return An(h)||(o=!0),i++,e.consume(h),h===92?d:u}function d(h){return h===91||h===92||h===93?(e.consume(h),i++,u):u(h)}}function gge(e,t,n){const r=this,s=r.parser.gfmFootnotes||(r.parser.gfmFootnotes=[]);let i,o=0,l;return c;function c(g){return e.enter("gfmFootnoteDefinition")._container=!0,e.enter("gfmFootnoteDefinitionLabel"),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),u}function u(g){return g===94?(e.enter("gfmFootnoteDefinitionMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionMarker"),e.enter("gfmFootnoteDefinitionLabelString"),e.enter("chunkString").contentType="string",d):n(g)}function d(g){if(o>999||g===93&&!l||g===null||g===91||An(g))return n(g);if(g===93){e.exit("chunkString");const v=e.exit("gfmFootnoteDefinitionLabelString");return i=li(r.sliceSerialize(v)),e.enter("gfmFootnoteDefinitionLabelMarker"),e.consume(g),e.exit("gfmFootnoteDefinitionLabelMarker"),e.exit("gfmFootnoteDefinitionLabel"),f}return An(g)||(l=!0),o++,e.consume(g),g===92?h:d}function h(g){return g===91||g===92||g===93?(e.consume(g),o++,d):d(g)}function f(g){return g===58?(e.enter("definitionMarker"),e.consume(g),e.exit("definitionMarker"),s.includes(i)||s.push(i),rn(e,m,"gfmFootnoteDefinitionWhitespace")):n(g)}function m(g){return t(g)}}function vge(e,t,n){return e.check(sg,t,e.attempt(dge,t,n))}function yge(e){e.exit("gfmFootnoteDefinition")}function xge(e,t,n){const r=this;return rn(e,s,"gfmFootnoteDefinitionIndent",5);function s(i){const o=r.events[r.events.length-1];return o&&o[1].type==="gfmFootnoteDefinitionIndent"&&o[2].sliceSerialize(o[1],!0).length===4?t(i):n(i)}}function bge(e){let n=(e||{}).singleTilde;const r={name:"strikethrough",tokenize:i,resolveAll:s};return n==null&&(n=!0),{text:{126:r},insideSpan:{null:[r]},attentionMarkers:{null:[126]}};function s(o,l){let c=-1;for(;++c<o.length;)if(o[c][0]==="enter"&&o[c][1].type==="strikethroughSequenceTemporary"&&o[c][1]._close){let u=c;for(;u--;)if(o[u][0]==="exit"&&o[u][1].type==="strikethroughSequenceTemporary"&&o[u][1]._open&&o[c][1].end.offset-o[c][1].start.offset===o[u][1].end.offset-o[u][1].start.offset){o[c][1].type="strikethroughSequence",o[u][1].type="strikethroughSequence";const d={type:"strikethrough",start:Object.assign({},o[u][1].start),end:Object.assign({},o[c][1].end)},h={type:"strikethroughText",start:Object.assign({},o[u][1].end),end:Object.assign({},o[c][1].start)},f=[["enter",d,l],["enter",o[u][1],l],["exit",o[u][1],l],["enter",h,l]],m=l.parser.constructs.insideSpan.null;m&&cs(f,f.length,0,Gb(m,o.slice(u+1,c),l)),cs(f,f.length,0,[["exit",h,l],["enter",o[c][1],l],["exit",o[c][1],l],["exit",d,l]]),cs(o,u-1,c-u+3,f),c=u+f.length-2;break}}for(c=-1;++c<o.length;)o[c][1].type==="strikethroughSequenceTemporary"&&(o[c][1].type="data");return o}function i(o,l,c){const u=this.previous,d=this.events;let h=0;return f;function f(g){return u===126&&d[d.length-1][1].type!=="characterEscape"?c(g):(o.enter("strikethroughSequenceTemporary"),m(g))}function m(g){const v=Zd(u);if(g===126)return h>1?c(g):(o.consume(g),h++,m);if(h<2&&!n)return c(g);const y=o.exit("strikethroughSequenceTemporary"),x=Zd(g);return y._open=!x||x===2&&!!v,y._close=!v||v===2&&!!x,l(g)}}}class wge{constructor(){this.map=[]}add(t,n,r){jge(this,t,n,r)}consume(t){if(this.map.sort(function(i,o){return i[0]-o[0]}),this.map.length===0)return;let n=this.map.length;const r=[];for(;n>0;)n-=1,r.push(t.slice(this.map[n][0]+this.map[n][1]),this.map[n][2]),t.length=this.map[n][0];r.push(t.slice()),t.length=0;let s=r.pop();for(;s;){for(const i of s)t.push(i);s=r.pop()}this.map.length=0}}function jge(e,t,n,r){let s=0;if(!(n===0&&r.length===0)){for(;s<e.map.length;){if(e.map[s][0]===t){e.map[s][1]+=n,e.map[s][2].push(...r);return}s+=1}e.map.push([t,n,r])}}function _ge(e,t){let n=!1;const r=[];for(;t<e.length;){const s=e[t];if(n){if(s[0]==="enter")s[1].type==="tableContent"&&r.push(e[t+1][1].type==="tableDelimiterMarker"?"left":"none");else if(s[1].type==="tableContent"){if(e[t-1][1].type==="tableDelimiterMarker"){const i=r.length-1;r[i]=r[i]==="left"?"center":"right"}}else if(s[1].type==="tableDelimiterRow")break}else s[0]==="enter"&&s[1].type==="tableDelimiterRow"&&(n=!0);t+=1}return r}function kge(){return{flow:{null:{name:"table",tokenize:Sge,resolveAll:Nge}}}}function Sge(e,t,n){const r=this;let s=0,i=0,o;return l;function l(A){let N=r.events.length-1;for(;N>-1;){const B=r.events[N][1].type;if(B==="lineEnding"||B==="linePrefix")N--;else break}const L=N>-1?r.events[N][1].type:null,M=L==="tableHead"||L==="tableRow"?j:c;return M===j&&r.parser.lazy[r.now().line]?n(A):M(A)}function c(A){return e.enter("tableHead"),e.enter("tableRow"),u(A)}function u(A){return A===124||(o=!0,i+=1),d(A)}function d(A){return A===null?n(A):St(A)?i>1?(i=0,r.interrupt=!0,e.exit("tableRow"),e.enter("lineEnding"),e.consume(A),e.exit("lineEnding"),m):n(A):Yt(A)?rn(e,d,"whitespace")(A):(i+=1,o&&(o=!1,s+=1),A===124?(e.enter("tableCellDivider"),e.consume(A),e.exit("tableCellDivider"),o=!0,d):(e.enter("data"),h(A)))}function h(A){return A===null||A===124||An(A)?(e.exit("data"),d(A)):(e.consume(A),A===92?f:h)}function f(A){return A===92||A===124?(e.consume(A),h):h(A)}function m(A){return r.interrupt=!1,r.parser.lazy[r.now().line]?n(A):(e.enter("tableDelimiterRow"),o=!1,Yt(A)?rn(e,g,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(A):g(A))}function g(A){return A===45||A===58?y(A):A===124?(o=!0,e.enter("tableCellDivider"),e.consume(A),e.exit("tableCellDivider"),v):k(A)}function v(A){return Yt(A)?rn(e,y,"whitespace")(A):y(A)}function y(A){return A===58?(i+=1,o=!0,e.enter("tableDelimiterMarker"),e.consume(A),e.exit("tableDelimiterMarker"),x):A===45?(i+=1,x(A)):A===null||St(A)?_(A):k(A)}function x(A){return A===45?(e.enter("tableDelimiterFiller"),w(A)):k(A)}function w(A){return A===45?(e.consume(A),w):A===58?(o=!0,e.exit("tableDelimiterFiller"),e.enter("tableDelimiterMarker"),e.consume(A),e.exit("tableDelimiterMarker"),b):(e.exit("tableDelimiterFiller"),b(A))}function b(A){return Yt(A)?rn(e,_,"whitespace")(A):_(A)}function _(A){return A===124?g(A):A===null||St(A)?!o||s!==i?k(A):(e.exit("tableDelimiterRow"),e.exit("tableHead"),t(A)):k(A)}function k(A){return n(A)}function j(A){return e.enter("tableRow"),S(A)}function S(A){return A===124?(e.enter("tableCellDivider"),e.consume(A),e.exit("tableCellDivider"),S):A===null||St(A)?(e.exit("tableRow"),t(A)):Yt(A)?rn(e,S,"whitespace")(A):(e.enter("data"),T(A))}function T(A){return A===null||A===124||An(A)?(e.exit("data"),S(A)):(e.consume(A),A===92?O:T)}function O(A){return A===92||A===124?(e.consume(A),T):T(A)}}function Nge(e,t){let n=-1,r=!0,s=0,i=[0,0,0,0],o=[0,0,0,0],l=!1,c=0,u,d,h;const f=new wge;for(;++n<e.length;){const m=e[n],g=m[1];m[0]==="enter"?g.type==="tableHead"?(l=!1,c!==0&&(kO(f,t,c,u,d),d=void 0,c=0),u={type:"table",start:Object.assign({},g.start),end:Object.assign({},g.end)},f.add(n,0,[["enter",u,t]])):g.type==="tableRow"||g.type==="tableDelimiterRow"?(r=!0,h=void 0,i=[0,0,0,0],o=[0,n+1,0,0],l&&(l=!1,d={type:"tableBody",start:Object.assign({},g.start),end:Object.assign({},g.end)},f.add(n,0,[["enter",d,t]])),s=g.type==="tableDelimiterRow"?2:d?3:1):s&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")?(r=!1,o[2]===0&&(i[1]!==0&&(o[0]=o[1],h=ev(f,t,i,s,void 0,h),i=[0,0,0,0]),o[2]=n)):g.type==="tableCellDivider"&&(r?r=!1:(i[1]!==0&&(o[0]=o[1],h=ev(f,t,i,s,void 0,h)),i=o,o=[i[1],n,0,0])):g.type==="tableHead"?(l=!0,c=n):g.type==="tableRow"||g.type==="tableDelimiterRow"?(c=n,i[1]!==0?(o[0]=o[1],h=ev(f,t,i,s,n,h)):o[1]!==0&&(h=ev(f,t,o,s,n,h)),s=0):s&&(g.type==="data"||g.type==="tableDelimiterMarker"||g.type==="tableDelimiterFiller")&&(o[3]=n)}for(c!==0&&kO(f,t,c,u,d),f.consume(t.events),n=-1;++n<t.events.length;){const m=t.events[n];m[0]==="enter"&&m[1].type==="table"&&(m[1]._align=_ge(t.events,n))}return e}function ev(e,t,n,r,s,i){const o=r===1?"tableHeader":r===2?"tableDelimiter":"tableData",l="tableContent";n[0]!==0&&(i.end=Object.assign({},Ku(t.events,n[0])),e.add(n[0],0,[["exit",i,t]]));const c=Ku(t.events,n[1]);if(i={type:o,start:Object.assign({},c),end:Object.assign({},c)},e.add(n[1],0,[["enter",i,t]]),n[2]!==0){const u=Ku(t.events,n[2]),d=Ku(t.events,n[3]),h={type:l,start:Object.assign({},u),end:Object.assign({},d)};if(e.add(n[2],0,[["enter",h,t]]),r!==2){const f=t.events[n[2]],m=t.events[n[3]];if(f[1].end=Object.assign({},m[1].end),f[1].type="chunkText",f[1].contentType="text",n[3]>n[2]+1){const g=n[2]+1,v=n[3]-n[2]-1;e.add(g,v,[])}}e.add(n[3]+1,0,[["exit",h,t]])}return s!==void 0&&(i.end=Object.assign({},Ku(t.events,s)),e.add(s,0,[["exit",i,t]]),i=void 0),i}function kO(e,t,n,r,s){const i=[],o=Ku(t.events,n);s&&(s.end=Object.assign({},o),i.push(["exit",s,t])),r.end=Object.assign({},o),i.push(["exit",r,t]),e.add(n+1,0,i)}function Ku(e,t){const n=e[t],r=n[0]==="enter"?"start":"end";return n[1][r]}const Cge={name:"tasklistCheck",tokenize:Ege};function Age(){return{text:{91:Cge}}}function Ege(e,t,n){const r=this;return s;function s(c){return r.previous!==null||!r._gfmTasklistFirstContentOfListItem?n(c):(e.enter("taskListCheck"),e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),i)}function i(c){return An(c)?(e.enter("taskListCheckValueUnchecked"),e.consume(c),e.exit("taskListCheckValueUnchecked"),o):c===88||c===120?(e.enter("taskListCheckValueChecked"),e.consume(c),e.exit("taskListCheckValueChecked"),o):n(c)}function o(c){return c===93?(e.enter("taskListCheckMarker"),e.consume(c),e.exit("taskListCheckMarker"),e.exit("taskListCheck"),l):n(c)}function l(c){return St(c)?t(c):Yt(c)?e.check({tokenize:Tge},t,n)(c):n(c)}}function Tge(e,t,n){return rn(e,r,"whitespace");function r(s){return s===null?n(s):t(s)}}function Pge(e){return X6([nge(),hge(),bge(e),kge(),Age()])}const Oge={};function Uy(e){const t=this,n=e||Oge,r=t.data(),s=r.micromarkExtensions||(r.micromarkExtensions=[]),i=r.fromMarkdownExtensions||(r.fromMarkdownExtensions=[]),o=r.toMarkdownExtensions||(r.toMarkdownExtensions=[]);s.push(Pge(n)),i.push(Qpe()),o.push(Zpe(n))}function Ige(e){yz(e,[/\r?\n|\r/g,Rge])}function Rge(){return{type:"break"}}function zz(){return function(e){Ige(e)}}const Wz=({url:e,isDark:t=!1})=>{const[n,r]=p.useState(null),[s,i]=p.useState(!0),[o,l]=p.useState(!1);return p.useEffect(()=>{let c=!0;return(async()=>{try{const h=await(await fetch(`https://api.microlink.io?url=${encodeURIComponent(e)}`)).json();c&&(h.status==="success"&&h.data?r(h.data):l(!0),i(!1))}catch{c&&(l(!0),i(!1))}})(),()=>{c=!1}},[e]),s?a.jsxs("div",{className:"flex items-center gap-2 mt-2 p-3 border rounded-lg bg-black/5 animate-pulse",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin opacity-50"}),a.jsx("span",{className:"text-xs opacity-50",children:"Loading preview..."})]}):o||!n||!n.title&&!n.image?null:a.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"block mt-2 no-underline",children:a.jsxs(He,{className:`overflow-hidden transition-all hover:shadow-md ${t?"bg-blue-700/50 border-blue-400 text-white":"bg-white border-slate-200 text-slate-900"}`,children:[n.image&&a.jsx("div",{className:"w-full aspect-video overflow-hidden bg-slate-100 relative",children:a.jsx("img",{src:n.image.url,alt:n.title,className:"w-full h-full object-cover",loading:"lazy"})}),a.jsxs(lt,{className:"p-3",children:[a.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[n.logo&&a.jsx("img",{src:n.logo.url,alt:"",className:"w-4 h-4 rounded-sm"}),a.jsx("span",{className:"text-[10px] font-medium uppercase tracking-wider opacity-70",children:n.publisher||new URL(e).hostname})]}),a.jsx("h4",{className:"text-sm font-semibold line-clamp-1 mb-1",children:n.title}),n.description&&a.jsx("p",{className:"text-xs opacity-70 line-clamp-2 leading-relaxed",children:n.description})]})]})})};function Z1({isOpen:e,onClose:t,src:n,mediaType:r,fileName:s="File"}){const[i,o]=p.useState(!1),[l,c]=p.useState(!1),[u,d]=p.useState(!1);if(p.useEffect(()=>{if(e)o(!0),d(!1),requestAnimationFrame(()=>{requestAnimationFrame(()=>{c(!0)})});else{c(!1);const v=setTimeout(()=>{o(!1),d(!1)},300);return()=>clearTimeout(v)}},[e]),p.useEffect(()=>{const v=y=>{y.key==="Escape"&&e&&t()};return window.addEventListener("keydown",v),()=>window.removeEventListener("keydown",v)},[e,t]),!i)return null;const h=v=>{v.target===v.currentTarget&&(u?d(!1):t())},f=()=>{const v=document.createElement("a");v.href=n,v.download=s,v.target="_blank",document.body.appendChild(v),v.click(),document.body.removeChild(v)},m=()=>{d(!u)},g=()=>{switch(r){case"image":return a.jsx("div",{className:`transition-all duration-300 ease-out ${u?"overflow-auto max-h-[calc(100vh-56px)] max-w-full":"flex items-center justify-center overflow-hidden"}`,style:u?{cursor:"zoom-out"}:{cursor:"zoom-in"},onClick:v=>{v.stopPropagation(),m()},children:a.jsx("img",{src:n,alt:s,draggable:!1,className:`transition-all duration-300 ease-out select-none ${u?"":"max-h-[calc(100vh-56px)] max-w-full object-contain"}`})});case"pdf":return a.jsx("div",{className:"w-[90vw] max-w-4xl bg-white rounded-lg overflow-hidden shadow-2xl",style:{height:"calc(100vh - 72px)"},children:a.jsx("embed",{src:n,type:"application/pdf",className:"w-full h-full"})});case"video":return a.jsx("div",{className:"max-w-4xl w-[90vw] bg-black rounded-lg overflow-hidden shadow-2xl",children:a.jsx("video",{src:n,controls:!0,autoPlay:!0,style:{maxHeight:"calc(100vh - 72px)"},className:"w-full",children:"Your browser does not support video playback."})});case"audio":return a.jsxs("div",{className:"bg-background p-8 rounded-lg shadow-2xl max-w-md w-[90vw]",children:[a.jsx("div",{className:"text-center mb-4",children:a.jsx("div",{className:"w-20 h-20 mx-auto mb-4 bg-primary/10 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-10 h-10 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19V6l12-3v13M9 19c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zm12-3c0 1.105-1.343 2-3 2s-3-.895-3-2 1.343-2 3-2 3 .895 3 2zM9 10l12-3"})})})}),a.jsx("audio",{src:n,controls:!0,autoPlay:!0,className:"w-full",children:"Your browser does not support audio playback."})]});default:return a.jsxs("div",{className:"bg-background p-8 rounded-lg shadow-2xl text-center",children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:"Cannot preview this file type"}),a.jsxs(se,{onClick:f,children:[a.jsx(KT,{className:"h-4 w-4 mr-2"}),"Download ",s]})]})}};return a.jsxs("div",{className:`fixed inset-0 z-50 flex flex-col transition-opacity duration-300 ease-out ${l?"opacity-100":"opacity-0"}`,style:{backgroundColor:"rgba(0, 0, 0, 0.92)"},children:[a.jsxs("div",{className:`flex-shrink-0 h-14 px-4 flex items-center justify-between border-b border-white/10 z-10 transition-transform duration-300 ease-out ${l?"translate-y-0":"-translate-y-full"}`,style:{backgroundColor:"rgba(0, 0, 0, 0.7)"},children:[a.jsx("p",{className:"text-white text-sm font-medium truncate max-w-[40vw] md:max-w-md",children:s}),a.jsxs("div",{className:"flex items-center gap-1",children:[r==="image"&&a.jsx(se,{variant:"ghost",size:"icon",onClick:m,className:"text-white hover:bg-white/20",title:u?"Zoom out":"Zoom in",children:u?a.jsx(aG,{className:"h-5 w-5"}):a.jsx(rG,{className:"h-5 w-5"})}),a.jsx(se,{variant:"ghost",size:"icon",onClick:f,className:"text-white hover:bg-white/20",title:"Download",children:a.jsx(KT,{className:"h-5 w-5"})}),a.jsx(se,{variant:"ghost",size:"icon",onClick:t,className:"text-white hover:bg-white/20",title:"Close",children:a.jsx(Nh,{className:"h-5 w-5"})})]})]}),a.jsx("div",{className:`flex-1 flex items-center justify-center transition-all duration-300 ease-out ${l?"opacity-100 scale-100":"opacity-0 scale-95"} ${u&&r==="image"?"overflow-auto p-0":"overflow-hidden p-4"}`,onClick:h,children:g()})]})}const SO=["image/jpeg","image/png","image/gif","image/webp","application/pdf","video/mp4","audio/mpeg","audio/ogg"],Mge=10*1024*1024;function qv(e){return e.startsWith("image/")?"image":e.startsWith("video/")?"video":e.startsWith("audio/")?"voice":"file"}function Dge(e){return e.startsWith("image/")?a.jsx(GV,{className:"h-4 w-4"}):e.startsWith("audio/")?a.jsx(R4,{className:"h-4 w-4"}):e.startsWith("video/")?a.jsx(VV,{className:"h-4 w-4"}):a.jsx(gd,{className:"h-4 w-4"})}async function sA(e){const t=Date.now(),n=Math.random().toString(36).substring(2,8),r=e.name.split(".").pop()||"bin",i=`attachments/${`${t}_${n}.${r}`}`,{data:o,error:l}=await Wr.storage.from("chat-attachments").upload(i,e,{cacheControl:"3600",upsert:!1});if(l)throw l;const{data:c}=Wr.storage.from("chat-attachments").getPublicUrl(i);return{url:c.publicUrl,fileName:e.name,fileSize:e.size,mimeType:e.type,type:qv(e.type)}}function iA({onFileStaged:e,disabled:t=!1,className:n=""}){const r=p.useRef(null),s=()=>{var o;(o=r.current)==null||o.click()},i=o=>{var c;const l=(c=o.target.files)==null?void 0:c[0];if(l){if(o.target.value="",!SO.includes(l.type)){ze.error("File type not allowed. Allowed: images, PDF, audio, video");return}if(l.size>Mge){ze.error("File too large. Max size: 10MB");return}if(l.type.startsWith("image/")){const u=new FileReader;u.onload=d=>{var h;e({file:l,preview:(h=d.target)==null?void 0:h.result,type:qv(l.type)})},u.readAsDataURL(l)}else if(l.type==="application/pdf"||l.type.startsWith("video/")||l.type.startsWith("audio/")){const u=URL.createObjectURL(l);e({file:l,preview:u,type:qv(l.type)})}else e({file:l,preview:null,type:qv(l.type)})}};return a.jsxs(a.Fragment,{children:[a.jsx("input",{ref:r,type:"file",accept:SO.join(","),onChange:i,className:"hidden",disabled:t}),a.jsx(se,{type:"button",variant:"ghost",size:"icon",onClick:s,disabled:t,className:n,title:"Attach file",children:a.jsx(JV,{className:"h-5 w-5"})})]})}function oA({stagedFile:e,onRemove:t,isUploading:n=!1}){const[r,s]=p.useState(!1),i=e.file.type==="application/pdf",o=e.file.type.startsWith("image/"),l=e.file.type.startsWith("video/"),c=e.file.type.startsWith("audio/"),u=()=>o?"image":i?"pdf":l?"video":c?"audio":"file",d=o||i||l||c,h=()=>{d&&e.preview&&!n&&s(!0)},f=()=>{if(e.preview){if(o)return a.jsx("img",{src:e.preview,alt:"Preview",className:"h-16 w-16 object-cover rounded cursor-pointer hover:opacity-80 transition-opacity",onClick:h});if(i)return a.jsx("div",{className:"h-20 w-28 rounded overflow-hidden border bg-white cursor-pointer hover:opacity-80 transition-opacity",onClick:h,children:a.jsx("embed",{src:`${e.preview}#toolbar=0&navpanes=0&scrollbar=0`,type:"application/pdf",className:"w-full h-full pointer-events-none"})});if(l)return a.jsxs("div",{className:"h-16 w-24 rounded overflow-hidden bg-black cursor-pointer hover:opacity-80 transition-opacity relative",onClick:h,children:[a.jsx("video",{src:e.preview,className:"w-full h-full object-cover",muted:!0}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/30",children:a.jsx("div",{className:"w-8 h-8 rounded-full bg-white/80 flex items-center justify-center",children:a.jsx("div",{className:"w-0 h-0 border-l-[10px] border-l-black border-y-[6px] border-y-transparent ml-1"})})})]});if(c)return a.jsx("div",{className:"h-16 w-16 flex items-center justify-center bg-primary/10 rounded cursor-pointer hover:bg-primary/20 transition-colors",onClick:h,children:a.jsx(R4,{className:"h-8 w-8 text-primary"})})}return a.jsx("div",{className:"h-16 w-16 flex items-center justify-center bg-primary/10 rounded",children:Dge(e.file.type)})};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"relative inline-flex items-center gap-3 px-3 py-2 bg-muted rounded-lg border",children:[n&&a.jsx("div",{className:"absolute inset-0 bg-background/80 flex items-center justify-center rounded-lg z-10",children:a.jsx(Ht,{className:"h-4 w-4 animate-spin"})}),f(),a.jsxs("div",{className:"flex flex-col min-w-0 max-w-[150px]",children:[a.jsx("span",{className:"text-xs font-medium truncate",children:e.file.name}),a.jsxs("span",{className:"text-xs text-muted-foreground",children:[(e.file.size/1024).toFixed(1)," KB"]}),d&&a.jsx("button",{type:"button",onClick:h,className:"text-xs text-blue-600 font-medium hover:underline text-left",children:"Click to preview"})]}),a.jsx(se,{type:"button",variant:"ghost",size:"icon",className:"h-6 w-6 shrink-0",onClick:t,disabled:n,title:"Remove attachment",children:a.jsx(Nh,{className:"h-4 w-4"})})]}),e.preview&&a.jsx(Z1,{isOpen:r,onClose:()=>s(!1),src:e.preview,mediaType:u(),fileName:e.file.name})]})}function lA({fileLink:e,type:t,fileName:n}){var c,u;const[r,s]=p.useState(!1);if(!e)return null;const i=n||(()=>{try{const h=new URL(e).pathname.split("/").pop()||"file",f=decodeURIComponent(h);return f.length>40?f.slice(0,37)+"...":f}catch{return"Download file"}})(),l=(((u=(c=e.split(".").pop())==null?void 0:c.toLowerCase())==null?void 0:u.split("?")[0])??"")==="pdf"||t==="file"&&i.toLowerCase().endsWith(".pdf");return t==="image"?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:e,alt:i,className:"max-w-full h-auto rounded-lg max-h-64 object-contain cursor-pointer hover:opacity-90 transition-opacity",loading:"lazy",onClick:()=>s(!0)}),a.jsx(Z1,{isOpen:r,onClose:()=>s(!1),src:e,mediaType:"image",fileName:i})]}):t==="video"?a.jsx("video",{src:e,controls:!0,className:"max-w-full rounded-lg max-h-64",children:"Your browser does not support video."}):t==="voice"?a.jsxs("audio",{controls:!0,className:"max-w-full",children:[a.jsx("source",{src:e}),"Your browser does not support audio."]}):l?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"w-64 h-48 rounded-lg overflow-hidden border bg-white cursor-pointer hover:opacity-90 transition-opacity relative group",onClick:()=>s(!0),children:[a.jsx("embed",{src:`${e}#toolbar=0&navpanes=0&scrollbar=0`,type:"application/pdf",className:"w-full h-full pointer-events-none"}),a.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors flex items-center justify-center opacity-0 group-hover:opacity-100",children:a.jsx("span",{className:"bg-white/90 text-xs font-medium px-2 py-1 rounded shadow",children:"Click to preview"})})]}),a.jsxs("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-1.5 mt-1 rounded-lg bg-muted/50 hover:bg-muted transition-colors text-sm",children:[a.jsx(gd,{className:"h-4 w-4 text-red-500"}),a.jsx("span",{className:"truncate max-w-[200px]",children:i})]}),a.jsx(Z1,{isOpen:r,onClose:()=>s(!1),src:e,mediaType:"pdf",fileName:i})]}):a.jsxs("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-3 py-2 rounded-lg bg-muted/50 hover:bg-muted transition-colors",children:[a.jsx(gd,{className:"h-5 w-5 text-primary"}),a.jsx("span",{className:"text-sm truncate max-w-[200px]",children:i})]})}const Lge=e=>e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),$ge=e=>{const t=e.trim().toLowerCase();return t==="telegram"||t==="Telegram"?"Telegram":t==="whatsapp"||t==="wa"?"WhatsApp":t==="web"?"Web":e},dl=e=>{if(!e)return null;const t=String(e.status||"").toLowerCase();return t==="closed"?"done":t==="open"?"unassigned":t==="pending"||t==="assigned"?"assigned":"unassigned"},Nj=e=>dl(e)==="assigned",Cj=e=>dl(e)==="unassigned",tv=e=>dl(e)==="done",Fge=24*60*60*1e3,Uge=e=>{const t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),r=String(e.getDate()).padStart(2,"0");return`${t} -${n} -${r} `},Bge=e=>{if(Number.isNaN(e.getTime()))return"";const t=new Date,n=new Date(t.getFullYear(),t.getMonth(),t.getDate()),r=new Date(e.getFullYear(),e.getMonth(),e.getDate()),s=n.getTime()-r.getTime(),i=Math.floor(s/Fge);return i===0?"Today":i===1?"Yesterday":e.toLocaleDateString(void 0,{day:"numeric",month:"short",year:"numeric"})},zge=({message:e,isLastMessage:t,highlighted:n=!1,matches:r=[],activeMatchOrder:s=-1})=>{var _,k;const i=e.role==="assistant"||e.role==="agent"||e.direction==="out",o=e.role==="system"||e.type==="event"||e.type==="note",l=e.role==="assistant",c=e.role==="agent",u=(e.body||"").trim(),d=e.type==="text"||!e.type||e.type==="event"||e.type==="note",h=!d&&u.length>0;let f=e.type;if(h&&(!f||f==="text")){const j=((k=(_=u.split(".").pop())==null?void 0:_.toLowerCase())==null?void 0:k.split("?")[0])??"";["jpg","jpeg","png","gif","webp","svg","bmp","avif"].includes(j)?f="image":["mp4","webm","mov","avi","mkv"].includes(j)?f="video":["mp3","wav","ogg","aac","flac","m4a"].includes(j)?f="voice":f="file"}const m=h?u:null,v=d&&u.length>0||r.length>0,y=!!m,x=j=>a.jsxs("div",{className:`mt-1 flex items-center gap-1 text-[10px] ${j?c?"text-blue-100":l?"text-blue-700":"text-muted-foreground":"text-muted-foreground"} ${!j&&i?"justify-end":""}`,children:[a.jsx("span",{children:new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),i&&(e._status==="pending"?a.jsx(Ht,{className:"h-3 w-3 animate-spin","aria-label":"pending"}):t?a.jsx(BV,{className:"h-3 w-3","aria-label":"sent"}):null)]}),w={a:({href:j,children:S})=>{const T=j||"";return Hf(T)?a.jsx("img",{src:T,alt:"User uploaded content",className:"rounded-lg max-w-full h-auto my-2 border border-black/10 shadow-sm",loading:"lazy"}):a.jsx("a",{href:T,target:"_blank",rel:"noopener noreferrer",className:c?"text-blue-300 font-medium underline hover:text-white":"text-blue-600 font-medium underline hover:text-blue-800",children:S})},img:({src:j,alt:S})=>a.jsx("img",{src:j,alt:S,className:"rounded-lg max-w-full h-auto my-2 border border-black/10 shadow-sm overflow-hidden",loading:"lazy"})},b=()=>{const j=e.body||"";if(!j||r.length===0)return j;const S=[...r].sort((A,N)=>A.start-N.start),T=[];let O=0;return S.forEach(({start:A,length:N},L)=>{A>O&&T.push(j.slice(O,A));const M=j.slice(A,A+N);T.push({type:"highlight",content:M,index:L}),O=A+N}),O<j.length&&T.push(j.slice(O)),T.map((A,N)=>{if(typeof A=="string")return a.jsx("span",{children:A},`seg - ${N} `);const L=A.index===s;return a.jsx("mark",{className:`rounded - sm px - 0.5 text - current text - black ${L?"bg-orange-300":"bg-yellow-200"} `,children:A.content},`highlight - ${A.index} `)})};return o?a.jsx("div",{className:"flex justify-center my-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm text-muted-foreground",children:e.body||"System event"}),a.jsxs("div",{className:"flex items-center justify-center gap-2 mt-1 text-xs text-muted-foreground",children:[a.jsx("span",{children:new Date(e.created_at).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),a.jsx("span",{children:""}),a.jsx("span",{children:"system"})]})]})}):a.jsx("div",{className:`flex ${i?"justify-end":"justify-start"} mb-3`,children:a.jsxs("div",{className:`flex ${i?"flex-row-reverse":"flex-row"} items-end gap-2 max-w-[85%]`,children:[a.jsxs(Da,{className:"h-8 w-8",children:[a.jsx(Yc,{src:""}),a.jsx(La,{className:"text-xs",children:i?"A":e.contact_avatar})]}),a.jsxs("div",{className:`flex flex-col ${i?"items-end":"items-start"} min-w-0 max-w-full space-y-1`,children:[y&&a.jsx("div",{className:"max-w-full",children:a.jsx(lA,{fileLink:m,type:f})}),v&&a.jsxs("div",{className:`px-4 py-2 rounded-2xl text-sm shadow-sm ${c?"bg-blue-600 text-white":l?"bg-blue-100 text-blue-900":"bg-muted text-foreground"} ${n?"ring-2 ring-yellow-300":""}`,children:[r.length>0?a.jsx("p",{className:"whitespace-pre-wrap [overflow-wrap:anywhere]",children:b()}):a.jsx("div",{className:`prose prose-sm leading-normal max-w-none [overflow-wrap:anywhere] [&>*:first-child]:mt-0 [&>*:last-child]:mb-0 ${c?"text-white [&_*]:text-inherit [&_li]:marker:text-white [&_code]:text-blue-100 [&_code]:bg-blue-700":"dark:prose-invert"} `,children:a.jsx($y,{remarkPlugins:[Uy,zz],components:w,children:e.body||""})}),(()=>{const j=V4(e.body);return j.length===0?null:a.jsx("div",{className:"space-y-2 mt-2",children:j.map(S=>!Hf(S)&&a.jsx(Wz,{url:S,isDark:c},S))})})(),x(!0)]}),!v&&x(!1)]})]})})};function Wge(){var Jr,Et,$n,Dt,J,Ae,Fe,mt;const[e,t]=KN(),[n,r]=p.useState(""),[s,i]=p.useState(""),[o,l]=p.useState(null),[c,u]=p.useState("assigned"),[d,h]=p.useState(!1);p.useState(!1),p.useState(!1);const[f,m]=p.useState(""),[g,v]=p.useState(null),[y,x]=p.useState(0),w=p.useRef(null),b=p.useRef({}),[_,k]=p.useState(null),[j,S]=p.useState(!1),T=f.trim(),{conversations:O,messages:A,loading:N,error:L,fetchConversations:M,fetchMessages:B,sendMessage:$,createConversation:z,addThreadLabel:R,removeThreadLabel:C,assignThread:D,assignThreadToUser:E,takeoverThread:F,unassignThread:I,clearCollaborator:P,deleteThread:U,setThreadCollaborator:Z}=Pce();FC();const{agents:X}=Ql(),{user:K}=Ar(),{hasRole:ie,hasPermission:H}=Nr(),he=ie("master_agent"),me=ie("super_agent");ie("agent");const ae=he||me;H("messages.create");const Ne=(K==null?void 0:K.id)??null,[de,Q]=p.useState(null),[fe,Be]=p.useState(!1),[je,Ce]=p.useState(!1),[Ze,rt]=p.useState(null),[Je,te]=p.useState(!1),We=H("contacts.delete"),[Ue,ue]=p.useState({}),xe=p.useRef(!1),ce=p.useRef(!1),qe=p.useMemo(()=>`chat.threadFilters.v1:${(K==null?void 0:K.id)||"anon"} `,[K==null?void 0:K.id]),[Se,nt]=p.useState({}),[vt,xt]=p.useState({}),[wt,ht]=p.useState([]),_t=V=>{k(V)},Wt=()=>{k(null)},[pe,Oe]=p.useState({});p.useMemo(()=>X.filter(V=>String((V==null?void 0:V.primaryRole)||"").toLowerCase()==="super_agent").map(V=>({value:V.user_id,label:V.display_name||V.email||"Unknown Agent"})),[X]);const W=p.useMemo(()=>X.filter(V=>String((V==null?void 0:V.primaryRole)||"").toLowerCase()!=="master_agent").map(V=>({value:V.user_id,label:V.display_name||V.email||"Unknown Agent"})),[X]),q=p.useMemo(()=>Object.fromEntries(X.map(V=>[String(V.user_id),String(V.display_name||V.email||"Unknown")])),[X]),Y=p.useMemo(()=>V=>q[V]||pe[V]||V,[q,pe]),[ne,_e]=p.useState(null);S3();const Le=p.useMemo(()=>{if(!o)return null;const V=O.find(re=>re.id===o);return(V==null?void 0:V.assignee_user_id)??null},[o,O]),be=p.useMemo(()=>o?(ne==null?void 0:ne.threadId)===o?ne.userId:Le:null,[o,ne,Le]);p.useEffect(()=>{if(!o){_e(null);return}(ne==null?void 0:ne.threadId)===o&&Le===ne.userId&&_e(null)},[o,Le,ne]),p.useEffect(()=>{if(!be){ht([]);return}let V=!0;return(async()=>{const{data:ke,error:Re}=await kt.from("super_agent_members").select("agent_user_id").eq("super_agent_id",be);if(V){if(Re){console.warn("Failed to fetch super agent members",Re),ht([]);return}ht((ke||[]).map(De=>String(De.agent_user_id)))}})(),()=>{V=!1}},[be]);const ee=p.useMemo(()=>{if(!T)return[];const V=Lge(T);return V?A.flatMap(re=>{const ke=re.body||"";if(!ke)return[];const Re=new RegExp(V,"gi"),De=[];let we=0,yt;for(;(yt=Re.exec(ke))!==null;)De.push({messageId:re.id,start:yt.index,length:yt[0].length,order:we}),we+=1,yt.index===Re.lastIndex&&Re.lastIndex++;return De}):[]},[T,A]),oe=p.useMemo(()=>{if(ee.length===0)return{};const V=ee.reduce((re,ke)=>(re[ke.messageId]||(re[ke.messageId]=[]),re[ke.messageId].push({start:ke.start,length:ke.length}),re),{});return Object.values(V).forEach(re=>{re.sort((ke,Re)=>ke.start-Re.start)}),V},[ee]),Ee=ee.length,Xe=Ee>0?ee[y]:null,$e=p.useMemo(()=>A.length>0?A[A.length-1].id:null,[A]),jt=p.useMemo(()=>{const V=[];let re=null;return A.forEach(ke=>{const Re=ke.created_at;if(Re){const De=new Date(Re);if(!Number.isNaN(De.getTime())){const we=Uge(De);if(we!==re){const yt=Bge(De);yt&&V.push({type:"date",key:`date - ${we} `,label:yt}),re=we}}}V.push({type:"message",key:ke.id,message:ke})}),V},[A]),et=V=>{const re=(V??"").toString();return!re||re==="all"?"":re},It=V=>{var re,ke;return!!((re=V.dateRange)!=null&&re.from||(ke=V.dateRange)!=null&&ke.to||et(V.inbox)||et(V.channelType)||et(V.platformId)||et(V.status)||et(V.agent)||et(V.resolvedBy))},Rt=V=>{var Re,De;const re=(Re=V.dateRange)!=null&&Re.from?V.dateRange.from.getTime():0,ke=(De=V.dateRange)!=null&&De.to?V.dateRange.to.getTime():0;return[re,ke,et(V.inbox),et(V.channelType),et(V.platformId),et(V.status),et(V.agent),et(V.resolvedBy)].join("|")},En=V=>{const re=V.get("f_from"),ke=V.get("f_to"),Re=re?Number(re):0,De=ke?Number(ke):0,we=Re||De?{from:Re?new Date(Re):void 0,to:De?new Date(De):void 0}:void 0,yt=et(V.get("f_inbox")),Pt=et(V.get("f_channelType")),Zt=et(V.get("f_platformId")),Sn=et(V.get("f_status")),Ji=et(V.get("f_agent")),Ho=et(V.get("f_resolvedBy")),Tr={};return we&&(Tr.dateRange=we),yt&&(Tr.inbox=yt),Pt&&(Tr.channelType=Pt),Zt&&(Tr.platformId=Zt),Sn&&(Tr.status=Sn),Ji&&(Tr.agent=Ji),Ho&&(Tr.resolvedBy=Ho),Tr},Vn=(V,re)=>{var Re,De;["f_from","f_to","f_inbox","f_channelType","f_platformId","f_status","f_agent","f_resolvedBy"].forEach(we=>V.delete(we)),(Re=re.dateRange)!=null&&Re.from&&V.set("f_from",String(re.dateRange.from.getTime())),(De=re.dateRange)!=null&&De.to&&V.set("f_to",String(re.dateRange.to.getTime())),et(re.inbox)&&V.set("f_inbox",et(re.inbox)),et(re.channelType)&&V.set("f_channelType",et(re.channelType)),et(re.platformId)&&V.set("f_platformId",et(re.platformId)),et(re.status)&&V.set("f_status",et(re.status)),et(re.agent)&&V.set("f_agent",et(re.agent)),et(re.resolvedBy)&&V.set("f_resolvedBy",et(re.resolvedBy))},Ln=V=>{ue(V);try{localStorage.setItem(qe,JSON.stringify({...V,dateRange:V.dateRange?{from:V.dateRange.from?V.dateRange.from.getTime():void 0,to:V.dateRange.to?V.dateRange.to.getTime():void 0}:void 0}))}catch{}const re=new URLSearchParams(window.location.search);Vn(re,V),xe.current=!0,t(re,{replace:!0}),setTimeout(()=>{xe.current=!1},0),M(V)};p.useEffect(()=>{x(0)},[T]),p.useEffect(()=>{Ee>0&&y>=Ee&&x(0)},[y,Ee]),p.useEffect(()=>{if(!T||!Xe){v(null);return}v(Xe.messageId);const V=b.current[Xe.messageId];V&&V.scrollIntoView({behavior:"smooth",block:"center"})},[T,Xe]);const Yr=()=>{Ee!==0&&x(V=>(V+1)%Ee)},Ca=()=>{Ee!==0&&x(V=>(V-1+Ee)%Ee)},cr=e.get("contact"),Tn=e.get("thread"),pn=e.get("tab"),ua=p.useRef(!1);p.useEffect(()=>{if(!pn||ua.current)return;const V=pn==="resolved"?"done":pn;(V==="assigned"||V==="unassigned"||V==="done")&&V!==c&&u(V)},[pn]),p.useEffect(()=>{let V=!0;return(async()=>{try{const{data:ke,error:Re}=await kt.from("channels").select("id, display_name, provider").order("created_at",{ascending:!1});if(!V)return;if(Re)throw Re;const De={},we={};(ke||[]).forEach(yt=>{De[String(yt.id)]=String(yt.display_name||"Unknown"),we[String(yt.id)]=String(yt.provider||"")}),nt(De),xt(we)}catch{if(!V)return;nt({}),xt({})}})(),()=>{V=!1}},[]),p.useEffect(()=>{if(xe.current)return;const V=En(e);if(!ce.current&&(ce.current=!0,!It(V)))try{const Re=localStorage.getItem(qe);if(Re){const De=JSON.parse(Re||"{}"),we={...De,dateRange:De!=null&&De.dateRange?{from:De.dateRange.from?new Date(Number(De.dateRange.from)):void 0,to:De.dateRange.to?new Date(Number(De.dateRange.to)):void 0}:void 0};ue(we);const yt=new URLSearchParams(window.location.search);Vn(yt,we),xe.current=!0,t(yt,{replace:!0}),setTimeout(()=>{xe.current=!1},0),M(we);return}}catch{}const re=Rt(V),ke=Rt(Ue);re!==ke&&(ue(V),M(V))},[e.toString(),qe]);const Qn=p.useMemo(()=>[...O.filter(re=>`${re.contact_name} ${re.last_message_preview} `.toLowerCase().includes(n.toLowerCase()))].sort((re,ke)=>{const Re=re.assignee_user_id===Ne||re.collaborator_user_id===Ne?1:0,De=ke.assignee_user_id===Ne||ke.collaborator_user_id===Ne?1:0;if(Re!==De)return De-Re;const we=new Date(re.last_msg_at??re.created_at??0).getTime();return new Date(ke.last_msg_at??ke.created_at??0).getTime()-we}),[O,n,Ne]);p.useEffect(()=>{if(d||N||O.length===0)return;const V=O.filter(Re=>Nj(Re)).length,re=O.filter(Re=>Cj(Re)).length,ke=O.filter(Re=>tv(Re)).length;if(c==="assigned"&&V===0&&re>0){u("unassigned");return}if((c==="assigned"||c==="unassigned")&&V===0&&re===0&&ke>0){u("done");return}},[O,N,c,d]),p.useEffect(()=>{if(pn===c)return;const re=new URLSearchParams(window.location.search);re.set("tab",c),ua.current=!0,t(re,{replace:!0}),setTimeout(()=>{ua.current=!1},0)},[c]),p.useEffect(()=>{var re;if(!Tn||o===Tn||Qn.length===0)return;const V=Qn.find(ke=>ke.id===Tn);V&&(l(V.id),u(dl(V)??"unassigned"),B(V.id),(re=V.channel)!=null&&re.provider&&Xg(V.channel.provider))},[Tn,Qn,o]),p.useEffect(()=>{var re;if(!cr||Tn||o||Qn.length===0)return;const V=Qn.find(ke=>ke.contact_id===cr);V&&(l(V.id),u(dl(V)??"unassigned"),B(V.id),(re=V.channel)!=null&&re.provider&&Xg(V.channel.provider))},[cr,Qn]);const ft=p.useMemo(()=>o&&Qn.find(V=>V.id===o)||null,[o,Qn]),Ja=tv(ft),ur=dl(ft),Xr=p.useMemo(()=>o?(ft==null?void 0:ft.collaborator_user_id)??null:null,[o,ft==null?void 0:ft.collaborator_user_id]),fs=p.useMemo(()=>o?(de==null?void 0:de.threadId)===o?de.userId??null:Xr:null,[o,de,Xr]);p.useEffect(()=>{const V=Array.from(new Set([...be?[be]:[],...fs?[fs]:[],...wt].filter(Boolean)));if(V.length===0)return;const re=V.filter(De=>!q[De]&&!pe[De]);if(re.length===0)return;let ke=!0;return(async()=>{try{const{data:De,error:we}=await kt.from("users_profile").select("user_id, display_name").in("user_id",re);if(!ke)return;if(we)throw we;const yt=Object.fromEntries((De||[]).map(Pt=>[String(Pt.user_id),String(Pt.display_name||"")]));Oe(Pt=>({...Pt,...yt}))}catch(De){console.warn("Failed to fetch user labels",De)}})(),()=>{ke=!1}},[be,fs,wt,q,pe]);const Fs=p.useMemo(()=>{if(!be)return[];const V=new Set(wt);return W.filter(re=>V.has(re.value)).map(re=>({...re,label:Y(re.value)}))},[W,be,wt,Y]),Lr=fs?String(fs):null;p.useMemo(()=>{const V=new Map;return Fs.forEach(re=>V.set(re.value,re)),Lr&&!V.has(Lr)&&V.set(Lr,{value:Lr,label:Y(Lr)}),Array.from(V.values())},[Fs,Lr,Y]),p.useMemo(()=>!Ne||!Lr?!1:Lr===Ne,[Lr,Ne]),((ft==null?void 0:ft.status)||"").toLowerCase();const Us=p.useMemo(()=>Ne?Lr===Ne:!1,[Ne,Lr]),da=p.useMemo(()=>{if(!Us)return"Only the collaborator who took over can send messages."},[Us]);p.useEffect(()=>{if(!o){Q(null);return}(de==null?void 0:de.threadId)===o&&Xr===de.userId&&Q(null)},[o,Xr,de]);const Qa=async()=>{if(ft){if(!(K!=null&&K.id)){ze.error("You must be signed in to take over");return}try{await F(ft.id),Q({threadId:ft.id,userId:K.id}),ze.success("You are now assigned to this chat"),u("assigned"),await M(void 0,{silent:!0})}catch{ze.error("Failed to take over chat")}}},ms=async()=>{if(ft){if(!ae){ze.error("Only master or super agents can move conversations to Unassigned");return}Be(!0);try{await I(ft.id),Q({threadId:ft.id,userId:null}),ze.success("Conversation moved to Unassigned"),u("unassigned"),await M(void 0,{silent:!0}),await B(ft.id)}catch{ze.error("Failed to move conversation to Unassigned")}finally{Be(!1)}}},yi=async()=>{if(ft){Ce(!0);try{const{error:V}=await kt.from("threads").update({status:"closed",ai_access_enabled:!0,ai_handoff_at:null,resolved_at:new Date().toISOString(),resolved_by_user_id:(K==null?void 0:K.id)??null,handover_reason:null}).eq("id",ft.id);if(V)throw V;try{const{data:re}=await le.from("users_profile").select("display_name").eq("user_id",(K==null?void 0:K.id)??"").single();await kt.from("messages").insert([{thread_id:ft.id,direction:null,role:"system",type:"event",body:`Conversation resolved by ${(re==null?void 0:re.display_name)||(K==null?void 0:K.email)||"agent"}.`,payload:{event:"resolve",user_id:(K==null?void 0:K.id)??null}}])}catch(re){console.warn("Failed to insert resolve event message",re)}ze.success("Conversation resolved"),u("done"),await M(void 0,{silent:!0}),await B(ft.id)}catch{ze.error("Failed to resolve")}finally{Ce(!1)}}};p.useLayoutEffect(()=>{const V=w.current;if(V)try{V.scrollTop=V.scrollHeight}catch{}},[A,o]);const Te=async V=>{var ke;const re=Qn.find(Re=>Re.id===V);(ke=re==null?void 0:re.channel)!=null&&ke.provider&&Xg(re.channel.provider),l(V);try{const Re=new URLSearchParams(window.location.search);Re.set("thread",V),re!=null&&re.contact_id&&Re.set("contact",re.contact_id),t(Re,{replace:!0})}catch{}await B(V)};p.useEffect(()=>{const V=()=>c==="done"?Qn.find(ke=>tv(ke))||null:c==="assigned"?Qn.find(ke=>Nj(ke))||null:Qn.find(ke=>Cj(ke))||null;if(!o){const ke=V();ke!=null&&ke.id&&Te(ke.id);return}const re=dl(ft);if(ft&&re!==c){const ke=V();ke!=null&&ke.id?Te(ke.id):l(null)}},[c,Qn,o,ft]);const ut=async()=>{const V=s.trim();if(!(!V&&!_||!o))try{let re;if(_){S(!0);try{const we=await sA(_.file);re={url:we.url,type:we.type}}catch(we){console.error("Failed to upload file:",we),ze.error(we.message||"Could not upload file"),S(!1);return}S(!1)}const{checkAIMessageLimit:ke,autoAssignToSuperAgent:Re}=await fu(async()=>{const{checkAIMessageLimit:we,autoAssignToSuperAgent:yt}=await import("./aiMessageLimit-CzT5SAWG.js");return{checkAIMessageLimit:we,autoAssignToSuperAgent:yt}},[]),De=await ke(kt,o);if(De.isExceeded&&De.superAgentId){if((await Re(kt,o,De.superAgentId)).success){ze.error(`Batas pesan AI telah tercapai(${De.currentCount} / ${De.limit}). Percakapan telah dialihkan ke super agent dan AI access dinonaktifkan.`),await M(void 0,{silent:!0});return}}else if(De.isExceeded&&!De.superAgentId){ze.error(`Batas pesan AI telah tercapai(${De.currentCount} / ${De.limit}). Tidak ada super agent yang tersedia untuk penanganan.`);return}if(K!=null&&K.id){const{data:we}=await le.from("users_profile").select("token_limit_enabled, max_tokens_per_day, max_tokens_per_month").eq("user_id",K.id).maybeSingle();if(we!=null&&we.token_limit_enabled){const yt=new Date,Pt=new Date(Date.UTC(yt.getUTCFullYear(),yt.getUTCMonth(),yt.getUTCDate(),0,0,0)).toISOString(),Zt=new Date(Date.UTC(yt.getUTCFullYear(),yt.getUTCMonth(),1,0,0,0)).toISOString(),[{data:Sn},{data:Ji}]=await Promise.all([le.from("token_usage_logs").select("total_tokens").eq("user_id",K.id).gte("made_at",Pt),le.from("token_usage_logs").select("total_tokens").eq("user_id",K.id).gte("made_at",Zt)]),Ho=(Sn||[]).reduce((Qr,Ko)=>Qr+Number(Ko.total_tokens||0),0),Tr=(Ji||[]).reduce((Qr,Ko)=>Qr+Number(Ko.total_tokens||0),0);if(we.max_tokens_per_day&&Ho>=we.max_tokens_per_day){ze.error("Daily token limit reached");return}if(we.max_tokens_per_month&&Tr>=we.max_tokens_per_month){ze.error("Monthly token limit reached");return}}}i(""),k(null),$(o,V,"assistant",re)}catch{ze.error("Failed to send message")}},bt=V=>{V.key==="Enter"&&!V.shiftKey&&(V.preventDefault(),ut())};p.useEffect(()=>{var V;(V=ft==null?void 0:ft.channel)!=null&&V.provider&&Xg(ft.channel.provider)},[(Jr=ft==null?void 0:ft.channel)==null?void 0:Jr.provider]);const Lt=V=>{if(!V)return"";const re=new Date(V),De=(new Date().getTime()-re.getTime())/(1e3*60*60);if(De<24&&De>=0)return re.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});if(De>=24&&De<48)return"Yesterday";const we=String(re.getMonth()+1).padStart(2,"0"),yt=String(re.getDate()).padStart(2,"0"),Pt=re.getFullYear();return`${we}/${yt}/${Pt}`},Nt=V=>{const re=dl(V);return re==="done"?a.jsx(At,{className:"bg-green-100 text-green-700 border-0",children:"Done"}):re==="assigned"?a.jsx(At,{className:"bg-blue-100 text-blue-700 border-0",children:"Assigned"}):a.jsx(At,{className:"bg-secondary text-secondary-foreground",children:"Unassigned"})},Zn=V=>{const re=V.last_msg_at||V.updated_at||V.created_at||"";return Lt(re)},$r=async()=>{if(Ze){if(!We){ze.error("You do not have permission to delete conversations"),rt(null);return}try{te(!0),await U(Ze.id),ze.success("Conversation deleted"),o===Ze.id&&l(null),rt(null)}catch{ze.error("Failed to delete conversation")}finally{te(!1)}}},gn=V=>{if(!We){ze.error("You do not have permission to delete conversations");return}rt(V)};return N?a.jsxs("div",{className:"flex items-center justify-center h-64",children:[a.jsx(Ht,{className:"h-8 w-8 animate-spin"}),a.jsx("span",{className:"ml-2",children:"Loading conversations..."})]}):L?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsxs("p",{className:"text-red-600 mb-2",children:["Error: ",L]}),a.jsxs(se,{onClick:()=>{M(void 0,{silent:!0})},variant:"outline",children:[a.jsx(ab,{className:"h-4 w-4 mr-2"}),"Retry"]})]})}):a.jsxs("div",{className:"grid w-full grid-cols-[360px_1fr_320px] h-[calc(100vh-120px)] gap-4",children:[a.jsxs("aside",{className:"rounded-lg border bg-card p-3",children:[a.jsxs("div",{className:"mb-3 pb-2 border-b flex items-center justify-between",children:[a.jsx("h2",{className:"text-sm font-medium",children:"Conversations"}),a.jsx("div",{className:"flex items-center gap-1",children:a.jsx(_ce,{value:{dateRange:Ue.dateRange||{},channelType:Ue.channelType||"all",label:[],agent:Ue.agent||"",status:Ue.status||"",resolvedBy:Ue.resolvedBy||"",platformId:Ue.platformId||""},onFilterChange:Ln})})]}),It(Ue)&&a.jsxs("div",{className:"mb-2 flex flex-wrap gap-1",children:[Ue.channelType&&a.jsxs(At,{variant:"secondary",children:["Channel: ",String(Ue.channelType).toLowerCase()==="web"?"Live Chat":String(Ue.channelType)]}),Ue.platformId&&a.jsxs(At,{variant:"secondary",children:["Platform: ",Se[String(Ue.platformId)]||String(Ue.platformId)]}),Ue.status&&a.jsxs(At,{variant:"secondary",children:["Status: ",String(Ue.status)]}),Ue.agent&&a.jsxs(At,{variant:"secondary",children:["Agent: ",Y(String(Ue.agent))]}),Ue.resolvedBy&&a.jsxs(At,{variant:"secondary",children:["Resolved By: ",Y(String(Ue.resolvedBy))]}),(((Et=Ue.dateRange)==null?void 0:Et.from)||(($n=Ue.dateRange)==null?void 0:$n.to))&&a.jsxs(At,{variant:"secondary",children:["Date: ",(Dt=Ue.dateRange)!=null&&Dt.from?new Date(Ue.dateRange.from).toLocaleDateString():""," "," ",(J=Ue.dateRange)!=null&&J.to?new Date(Ue.dateRange.to).toLocaleDateString():""]}),Ue.inbox&&a.jsxs(At,{variant:"secondary",children:["Inbox: ",String(Ue.inbox)]})]}),a.jsxs("div",{className:"relative mb-3",children:[a.jsx(oi,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(it,{placeholder:"Search...",value:n,onChange:V=>r(V.target.value),className:"pl-10 h-8 text-sm"})]}),(()=>{const V=Qn.filter(Pt=>Nj(Pt)),re=Qn.filter(Pt=>Cj(Pt)),ke=Qn.filter(Pt=>tv(Pt)),Re=[{key:"assigned",label:"Assigned",count:V.length,className:"bg-blue-50 dark:bg-blue-950 text-blue-600 dark:text-blue-400 border-blue-500",tooltip:"Lihat percakapan yang ditugaskan ke agen"},{key:"unassigned",label:"Unassigned",count:re.length,className:"bg-red-50 dark:bg-red-950 text-red-600 dark:text-red-400 border-red-500",tooltip:"Lihat percakapan yang menunggu penugasan"},{key:"done",label:"Done",count:ke.length,className:"bg-green-50 dark:bg-green-950 text-green-600 dark:text-green-400 border-green-500",tooltip:"Lihat percakapan yang selesai"}],De=Pt=>a.jsxs("div",{className:"h-[calc(100vh-280px)] flex items-center justify-center rounded-lg border border-dashed text-sm text-muted-foreground bg-muted/40",children:["No ",Pt," threads found"]}),we=Pt=>a.jsx("div",{className:"space-y-1",children:Pt.map(Zt=>{var Tr,Qr,Ko,ju;const Ji=Zt.assignee_user_id===Ne||Zt.collaborator_user_id===Ne?"bg-yellow-50/60 dark:bg-yellow-900/20 hover:bg-yellow-100/80 dark:hover:bg-yellow-900/30":"hover:bg-muted",Ho=o===Zt.id?"bg-blue-50 dark:bg-blue-900/30 border border-blue-200 dark:border-blue-800":Ji;return a.jsxs("div",{className:"relative",children:[a.jsx("button",{type:"button",onClick:()=>Te(Zt.id),className:`w-full p-3 pr-12 text-left transition-colors rounded-lg ${Ho}`,children:a.jsxs("div",{className:"flex items-start justify-between gap-3",children:[a.jsxs("div",{className:"flex items-start gap-2 flex-1 min-w-0",children:[a.jsxs(Da,{className:"h-6 w-6",children:[a.jsx(Yc,{src:Zt.channel_logo_url||""}),a.jsx(La,{className:"text-[10px]",children:""})]}),a.jsxs("div",{className:"min-w-0 flex-1",children:[a.jsx("h3",{className:"text-sm font-medium truncate",children:Zt.contact_name}),a.jsx("p",{className:"text-xs text-muted-foreground truncate mt-1",children:K4(Zt.last_message_preview)||""}),a.jsxs("div",{className:"mt-1 flex items-center gap-1.5 min-w-0",children:[a.jsx(Lc,{className:"h-3.5 w-3.5 text-blue-500 shrink-0"}),a.jsx("span",{className:"text-xs text-muted-foreground truncate",children:((Tr=Zt.channel)==null?void 0:Tr.display_name)||((Qr=Zt.channel)==null?void 0:Qr.provider)||"Unknown"})]})]})]}),a.jsxs("div",{className:"flex flex-col items-end shrink-0 w-[130px] self-stretch justify-between",children:[a.jsxs("div",{className:"flex flex-col items-end",children:[a.jsx("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:Zn(Zt)}),a.jsx("div",{className:"mt-1",children:Nt(Zt)})]}),Zt.channel_provider||(Ko=Zt.channel)!=null&&Ko.provider?a.jsx(At,{variant:"outline",className:"h-5 px-2 text-[10px] shrink-0",children:$ge(String(Zt.channel_provider||((ju=Zt.channel)==null?void 0:ju.provider)))}):a.jsx("span",{})]})]})}),!Zt.contact_id&&We&&a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 z-10 h-7 w-7 text-red-600 hover:text-red-700 hover:bg-red-50 dark:hover:bg-red-950",onClick:mg=>{mg.stopPropagation(),gn(Zt)},children:a.jsx(xa,{className:"h-4 w-4"})})}),a.jsx(ge,{children:a.jsx("p",{children:"Delete conversation"})})]})]},Zt.id)})}),yt=()=>c==="assigned"?V.length===0?De("assigned"):we(V):c==="unassigned"?re.length===0?De("unassigned"):we(re):ke.length===0?De("done"):we(ke);return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"grid w-full grid-cols-3 mb-3 bg-card",children:Re.map(Pt=>a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("button",{type:"button",onClick:()=>{h(!0),u(Pt.key)},className:`text-xs h-8 border-b-2 transition-colors flex items-center justify-center gap-2 px-2 ${c===Pt.key?`${Pt.className}`:"text-muted-foreground border-transparent hover:bg-muted"}`,"aria-pressed":c===Pt.key,children:[Pt.key==="done"?a.jsx(Ef,{className:"h-4 w-4"}):null,a.jsx("span",{children:Pt.label}),a.jsx(At,{variant:"secondary",className:"h-5 text-xs","aria-live":"polite","aria-atomic":"true",children:Pt.count})]})}),a.jsx(ge,{children:a.jsx("p",{children:Pt.tooltip})})]},Pt.key))}),a.jsx("div",{className:"h-[calc(100vh-280px)] overflow-y-auto",children:yt()})]})})(),a.jsx(Hb,{open:!!Ze,onOpenChange:V=>{V||rt(null)},children:a.jsxs(Jp,{children:[a.jsxs(Qp,{children:[a.jsx(eg,{children:"Delete conversation?"}),a.jsx(tg,{children:"This conversation is not linked to a saved contact. Deleting it will remove all associated messages permanently."})]}),a.jsxs(Zp,{children:[a.jsx(rg,{disabled:Je,children:"Cancel"}),a.jsx(ng,{className:"bg-red-600 hover:bg-red-700",onClick:$r,disabled:Je,children:Je?"Deleting":"Delete"})]})]})})]}),a.jsx("article",{className:"flex min-h-[70vh] flex-col rounded-lg border bg-card",children:ft?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between gap-2 border-b px-4 py-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(Da,{className:"h-10 w-10",children:[a.jsx(Yc,{src:""}),a.jsx(La,{className:"text-sm",children:ft.contact_name.charAt(0)})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-base font-semibold leading-tight",children:ft.contact_name}),ft.contact_phone&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:ft.contact_phone})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative",children:[a.jsx(oi,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-3.5 w-3.5 text-muted-foreground"}),a.jsx(it,{value:f,onChange:V=>m(V.target.value),placeholder:"Search messages",className:"pl-7 h-8 w-44 text-xs"})]}),T&&a.jsxs("div",{className:"flex items-center gap-1 text-muted-foreground",children:[a.jsx("span",{className:"text-xs font-medium min-w-[48px] text-right",children:Ee>0?`${y+1} /${Ee}`:"0/0"}),a.jsx(se,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:Ca,disabled:Ee===0,"aria-label":"Temukan sebelumnya",children:a.jsx(T4,{className:"h-4 w-4"})}),a.jsx(se,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8",onClick:Yr,disabled:Ee===0,"aria-label":"Temukan berikutnya",children:a.jsx(Ma,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[ur==="assigned"&&ae&&a.jsx(se,{size:"sm",className:"h-8 bg-red-100 text-red-600 hover:bg-red-200 disabled:opacity-60",onClick:ms,disabled:fe,children:fe?"Moving":"Move to Unassigned"}),ft.status!=="closed"&&a.jsx(se,{size:"sm",className:"h-8 bg-green-600 hover:bg-green-700 text-white disabled:opacity-60",onClick:yi,disabled:je,children:je?"Resolving":"Resolve"})]}),a.jsx(At,{className:ur==="done"?"bg-green-100 text-green-700 border-0":ur==="assigned"?"bg-success text-success-foreground hover:bg-success":"bg-secondary text-secondary-foreground hover:bg-secondary",children:ur==="done"?"Done":ur==="assigned"?"Assigned":"Unassigned"})]})]}),a.jsx(Lb,{viewportRef:w,className:"flex-1 p-4",children:a.jsx("div",{className:"space-y-2",children:A.length===0?a.jsx("div",{className:"text-center text-muted-foreground py-8",children:"No messages yet. Start the conversation!"}):jt.map(V=>{if(V.type==="date")return a.jsx("div",{className:"flex justify-center my-4",children:a.jsx("span",{className:"rounded-full bg-muted px-3 py-1 text-xs font-medium text-muted-foreground",children:V.label})},V.key);const re=V.message;return a.jsx("div",{ref:ke=>{b.current[re.id]=ke},children:a.jsx(zge,{message:re,isLastMessage:re.id===$e,highlighted:g===re.id,matches:oe[re.id]??[],activeMatchOrder:(Xe==null?void 0:Xe.messageId)===re.id?Xe.order:-1})},V.key)})})}),a.jsxs("div",{className:"border-t p-3 space-y-2",children:[_&&a.jsx("div",{className:"px-2",children:a.jsx(oA,{stagedFile:_,onRemove:Wt,isUploading:j})}),!Ja&&fs===(K==null?void 0:K.id)&&a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsx(iA,{onFileStaged:_t,disabled:j||!Us}),a.jsx(qr,{placeholder:`Message ${ft.contact_name}...`,value:s,onChange:V=>i(V.target.value),onKeyDown:bt,className:"flex-1 min-h-[40px] max-h-[120px] resize-none py-2.5",disabled:!Us||j,title:da}),a.jsx(se,{type:"button",onClick:ut,disabled:!s.trim()&&!_||!Us||j,title:da||"Send message",children:a.jsx(bm,{className:"h-4 w-4"})})]}),!Ja&&fs!==(K==null?void 0:K.id)&&a.jsx(se,{type:"button",className:"w-full bg-blue-600 hover:bg-blue-700 text-white",onClick:Qa,disabled:!(K!=null&&K.id),title:K!=null&&K.id?void 0:"You must be signed in",children:"Takeover Chat"})]})]}):a.jsx("div",{className:"flex items-center justify-center h-full",children:a.jsxs("div",{className:"text-center text-muted-foreground",children:[a.jsx(Lc,{className:"h-12 w-12 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No conversation selected"}),a.jsx("p",{children:"Select a conversation from the sidebar to start chatting"})]})})}),a.jsx("aside",{className:"rounded-lg border bg-card p-4",children:ft?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-lg font-semibold",children:ft.contact_name||"Unknown Contact"}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(Lc,{className:"h-4 w-4 text-blue-500"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(At,{variant:"outline",className:"text-xs",children:((Ae=ft.channel)==null?void 0:Ae.display_name)||((Fe=ft.channel)==null?void 0:Fe.provider)||"Unknown"}),((mt=ft.channel)==null?void 0:mt.type)&&a.jsx(At,{variant:"secondary",className:"text-xs",children:ft.channel.type})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-sm font-medium",children:"Handled By"}),a.jsx("div",{className:"rounded-md border bg-muted/50 px-3 py-2 text-sm text-muted-foreground",children:be&&Y(be)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-sm font-medium",children:"Collaborator"}),a.jsx("div",{className:"rounded-md border bg-muted/50 px-3 py-2 text-sm text-muted-foreground",children:Lr&&Y(Lr)||""})]}),ft.additional_data&&Object.keys(ft.additional_data).length>0&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium mb-2",children:"Context"}),a.jsx("div",{className:"rounded-md border bg-muted/50 p-2 text-xs space-y-1",children:Object.entries(ft.additional_data).map(([V,re])=>a.jsxs("div",{className:"flex justify-between gap-2 break-all",children:[a.jsxs("span",{className:"font-medium text-muted-foreground capitalize",children:[V.replace(/_/g," "),":"]}),a.jsx("span",{className:"text-right",children:typeof re=="object"?JSON.stringify(re):String(re)})]},V))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-medium mb-3",children:"Conversation Details"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-muted-foreground",children:"Assigned By"}),a.jsx("span",{children:ft.assigned_by_name||""})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-muted-foreground",children:"Handled By"}),a.jsx("span",{children:be&&Y(be)||""})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-muted-foreground",children:"Resolved By"}),a.jsx("span",{children:ft.resolved_by_name||""})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-muted-foreground",children:"AI Handoff At"}),a.jsx("span",{children:ft.ai_handoff_at?new Date(ft.ai_handoff_at).toLocaleString():""})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("span",{className:"text-muted-foreground shrink-0",children:"Handover Reason"}),ft.handover_reason?a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("span",{className:"truncate max-w-[150px] text-right border-b border-dotted border-muted-foreground/50 cursor-help",children:ft.handover_reason})}),a.jsx(ge,{className:"max-w-[280px]",children:a.jsx("p",{className:"text-xs",children:ft.handover_reason})})]}):a.jsx("span",{children:""})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-muted-foreground",children:"Assigned At"}),a.jsx("span",{children:ft.assigned_at?new Date(ft.assigned_at).toLocaleString():""})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-muted-foreground",children:"Created At"}),a.jsx("span",{children:ft.created_at?new Date(ft.created_at).toLocaleString():""})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-muted-foreground",children:"Resolved At"}),a.jsx("span",{children:ft.resolved_at?new Date(ft.resolved_at).toLocaleString():""})]})]})]})]}):a.jsx("div",{className:"text-sm text-muted-foreground",children:"No conversation selected"})})]})}var Qb="Checkbox",[qge,SUe]=Mr(Qb),[Hge,cA]=qge(Qb);function Kge(e){const{__scopeCheckbox:t,checked:n,children:r,defaultChecked:s,disabled:i,form:o,name:l,onCheckedChange:c,required:u,value:d="on",internal_do_not_use_render:h}=e,[f,m]=Ha({prop:n,defaultProp:s??!1,onChange:c,caller:Qb}),[g,v]=p.useState(null),[y,x]=p.useState(null),w=p.useRef(!1),b=g?!!o||!!g.closest("form"):!0,_={checked:f,disabled:i,setChecked:m,control:g,setControl:v,name:l,form:o,value:d,hasConsumerStoppedPropagationRef:w,required:u,defaultChecked:Pl(s)?!1:s,isFormControl:b,bubbleInput:y,setBubbleInput:x};return a.jsx(Hge,{scope:t,..._,children:Vge(h)?h(_):r})}var qz="CheckboxTrigger",Hz=p.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...r},s)=>{const{control:i,value:o,disabled:l,checked:c,required:u,setControl:d,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:m,bubbleInput:g}=cA(qz,e),v=Ot(s,d),y=p.useRef(c);return p.useEffect(()=>{const x=i==null?void 0:i.form;if(x){const w=()=>h(y.current);return x.addEventListener("reset",w),()=>x.removeEventListener("reset",w)}},[i,h]),a.jsx(ot.button,{type:"button",role:"checkbox","aria-checked":Pl(c)?"mixed":c,"aria-required":u,"data-state":Xz(c),"data-disabled":l?"":void 0,disabled:l,value:o,...r,ref:v,onKeyDown:Ve(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:Ve(n,x=>{h(w=>Pl(w)?!0:!w),g&&m&&(f.current=x.isPropagationStopped(),f.current||x.stopPropagation())})})});Hz.displayName=qz;var uA=p.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c,onCheckedChange:u,form:d,...h}=e;return a.jsx(Kge,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:l,required:o,onCheckedChange:u,name:r,form:d,value:c,internal_do_not_use_render:({isFormControl:f})=>a.jsxs(a.Fragment,{children:[a.jsx(Hz,{...h,ref:t,__scopeCheckbox:n}),f&&a.jsx(Yz,{__scopeCheckbox:n})]})})});uA.displayName=Qb;var Kz="CheckboxIndicator",Vz=p.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,i=cA(Kz,n);return a.jsx(Cr,{present:r||Pl(i.checked)||i.checked===!0,children:a.jsx(ot.span,{"data-state":Xz(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});Vz.displayName=Kz;var Gz="CheckboxBubbleInput",Yz=p.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:o,required:l,disabled:c,name:u,value:d,form:h,bubbleInput:f,setBubbleInput:m}=cA(Gz,e),g=Ot(n,m),v=DC(i),y=$N(r);p.useEffect(()=>{const w=f;if(!w)return;const b=window.HTMLInputElement.prototype,k=Object.getOwnPropertyDescriptor(b,"checked").set,j=!s.current;if(v!==i&&k){const S=new Event("click",{bubbles:j});w.indeterminate=Pl(i),k.call(w,Pl(i)?!1:i),w.dispatchEvent(S)}},[f,v,i,s]);const x=p.useRef(Pl(i)?!1:i);return a.jsx(ot.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??x.current,required:l,disabled:c,name:u,value:d,form:h,...t,tabIndex:-1,ref:g,style:{...t.style,...y,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});Yz.displayName=Gz;function Vge(e){return typeof e=="function"}function Pl(e){return e==="indeterminate"}function Xz(e){return Pl(e)?"indeterminate":e?"checked":"unchecked"}const eh=p.forwardRef(({className:e,...t},n)=>a.jsx(uA,{ref:n,className:Ie("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:a.jsx(Vz,{className:Ie("flex items-center justify-center text-current"),children:a.jsx(SN,{className:"h-4 w-4"})})}));eh.displayName=uA.displayName;const Zb=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{className:"relative w-full overflow-auto",children:a.jsx("table",{ref:n,className:Ie("w-full caption-bottom text-sm",e),...t})}));Zb.displayName="Table";const e0=p.forwardRef(({className:e,...t},n)=>a.jsx("thead",{ref:n,className:Ie("[&_tr]:border-b",e),...t}));e0.displayName="TableHeader";const t0=p.forwardRef(({className:e,...t},n)=>a.jsx("tbody",{ref:n,className:Ie("[&_tr:last-child]:border-0",e),...t}));t0.displayName="TableBody";const Gge=p.forwardRef(({className:e,...t},n)=>a.jsx("tfoot",{ref:n,className:Ie("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...t}));Gge.displayName="TableFooter";const mo=p.forwardRef(({className:e,...t},n)=>a.jsx("tr",{ref:n,className:Ie("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...t}));mo.displayName="TableRow";const tr=p.forwardRef(({className:e,...t},n)=>a.jsx("th",{ref:n,className:Ie("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...t}));tr.displayName="TableHead";const qn=p.forwardRef(({className:e,...t},n)=>a.jsx("td",{ref:n,className:Ie("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...t}));qn.displayName="TableCell";const Yge=p.forwardRef(({className:e,...t},n)=>a.jsx("caption",{ref:n,className:Ie("mt-4 text-sm text-muted-foreground",e),...t}));Yge.displayName="TableCaption";const Xge=e=>K4(String(e??"").replace(/\s+/g," ").trim().slice(0,200))||"",Jge=e=>{const t=new Date(e);return Number.isNaN(t.getTime())?"":t.toLocaleString(void 0,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})},Qge=e=>{const t=e.trim().toLowerCase();return t==="telegram"||t==="Telegram"?"Telegram":t==="whatsapp"||t==="wa"?"WhatsApp":t==="web"?"Web":e};function Zge({open:e,onOpenChange:t,contact:n,onSelectThread:r}){const[s,i]=p.useState(!1),[o,l]=p.useState(null),[c,u]=p.useState([]),[d,h]=p.useState("");p.useEffect(()=>{if(!e||!(n!=null&&n.id))return;let g=!0;return(async()=>{try{i(!0),l(null),await Qd();const{data:y,error:x}=await kt.from("threads").select(`
            id,
            contact_id,
            channel_id,
            status,
            last_msg_at,
            created_at,
            channels!inner(id, display_name, provider, type, logo_url, profile_photo_url, external_id),
            messages(id, body, role, direction, created_at, seq)
          `).eq("contact_id",n.id).order("last_msg_at",{ascending:!1}).order("created_at",{foreignTable:"messages",ascending:!1}).limit(1,{foreignTable:"messages"});if(!g)return;if(x)throw x;const w=(y||[]).map(k=>{const j=Array.isArray(k.messages)&&k.messages.length>0?k.messages[0]:null,S=Xge(j==null?void 0:j.body),T=(j==null?void 0:j.created_at)??k.last_msg_at??null;return{id:String(k.id),contact_id:String(k.contact_id),channel_id:String(k.channel_id),status:k.status,last_msg_at:T,created_at:String(k.created_at),channel:k.channels?{id:String(k.channels.id),display_name:k.channels.display_name??null,provider:k.channels.provider??null,type:k.channels.type??null,logo_url:k.channels.logo_url??null,profile_photo_url:k.channels.profile_photo_url??null,external_id:k.channels.external_id??null}:null,last_message_preview:S}}),b=new Map;for(const k of w)b.has(k.channel_id)||b.set(k.channel_id,k);const _=Array.from(b.values()).sort((k,j)=>{const S=new Date(k.last_msg_at??k.created_at??0).getTime();return new Date(j.last_msg_at??j.created_at??0).getTime()-S});u(_)}catch(y){if(!g)return;const x=y instanceof Error?y.message:"Failed to load conversations";l(x),u([])}finally{if(!g)return;i(!1)}})(),()=>{g=!1}},[e,n==null?void 0:n.id]);const f=p.useMemo(()=>{const g=d.trim().toLowerCase();return g?c.filter(v=>{var b,_;const y=String(((b=v.channel)==null?void 0:b.display_name)||"").toLowerCase(),x=String(((_=v.channel)==null?void 0:_.provider)||"").toLowerCase(),w=String(v.last_message_preview||"").toLowerCase();return y.includes(g)||x.includes(g)||w.includes(g)}):c},[c,d]),m=(n==null?void 0:n.name)||(n==null?void 0:n.phone)||"Contact";return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsxs(un,{className:"sm:max-w-[720px] max-h-[80vh] overflow-hidden",children:[a.jsx(dn,{children:a.jsxs(hn,{className:"flex items-center gap-2 pr-10",children:[a.jsxs("span",{className:"min-w-0 truncate",children:["Conversations for ",m]}),a.jsx(At,{variant:"secondary",className:"shrink-0",children:c.length})]})}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs("div",{className:"relative flex-1",children:[a.jsx(oi,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),a.jsx(it,{value:d,onChange:g=>h(g.target.value),placeholder:"Search by channel or message",className:"pl-9",autoFocus:!0})]})}),a.jsx(Kd,{}),a.jsx("div",{className:"max-h-[52vh] overflow-y-auto pr-1 pb-2",children:a.jsx("div",{className:"space-y-2 p-1 pb-2",children:s?a.jsxs("div",{className:"flex items-center justify-center gap-2 py-10 text-sm text-muted-foreground",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin"}),"Loading conversations"]}):o?a.jsx("div",{className:"py-10 text-center text-sm text-destructive",children:o}):f.length===0?a.jsx("div",{className:"py-10 text-center text-sm text-muted-foreground",children:d.trim()?"No threads match your search.":"No conversations for this contact yet."}):f.map(g=>{var b,_;const v=((b=g.channel)==null?void 0:b.display_name)||"Channel",y=(((_=g.channel)==null?void 0:_.provider)||"").toString(),x=y?Qge(y):"",w=g.last_msg_at||g.created_at;return a.jsxs(se,{type:"button",variant:"ghost",className:"w-full justify-between gap-3 rounded-lg border border-border bg-card px-3 py-3 text-left hover:bg-muted/60 h-auto",onClick:()=>r(g),children:[a.jsxs("div",{className:"flex min-w-0 items-start gap-3",children:[a.jsx("div",{className:"mt-0.5 rounded-md bg-blue-600/10 p-2 text-blue-700",children:a.jsx(Lc,{className:"h-4 w-4"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"min-w-0 truncate font-medium",children:v}),a.jsx(At,{variant:g.status==="closed"?"secondary":g.status==="pending"?"outline":"default",className:"capitalize",children:g.status})]}),a.jsx("div",{className:"mt-1 line-clamp-2 text-xs text-muted-foreground",children:g.last_message_preview})]})]}),a.jsxs("div",{className:"flex shrink-0 items-center gap-2 self-stretch",children:[a.jsxs("div",{className:"flex h-full flex-col items-end justify-between",children:[a.jsx("div",{className:"text-xs text-muted-foreground whitespace-nowrap",children:Jge(w)}),x?a.jsx(At,{variant:"outline",className:"h-5 px-2 text-[10px]",children:x}):a.jsx("span",{})]}),a.jsx(Mp,{className:"h-4 w-4 text-muted-foreground"})]})]},g.id)})})}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Each channel can have only one thread for a contact (unless an admin deletes the previous thread)."})]})})}function eve(){var _t,Wt,pe,Oe;const{hasRole:e}=Nr(),t=e("master_agent");e("super_agent");const[n,r]=p.useState([]),[s,i]=p.useState(1),[o,l]=p.useState(""),[c,u]=p.useState(100),[d,h]=p.useState(null),[f,m]=p.useState(!0),[g,v]=p.useState(!1),[y,x]=p.useState({chatStatus:"",handledBy:"",dateRange:{}}),[w,b]=p.useState(!1),[_,k]=p.useState(!1),[j,S]=p.useState(!1),[T,O]=p.useState(""),[A,N]=p.useState(""),[L,M]=p.useState(""),[B,$]=p.useState(!1),[z,R]=p.useState(!1),[C,D]=p.useState(null),[E,F]=p.useState(!1),[I,P]=p.useState(null),U=Va(),{hasPermission:Z}=Nr(),X=Z("contacts.delete"),{contacts:K,loading:ie,error:H,totalCount:he,fetchContacts:me,deleteContact:ae,updateContact:Ne,deleteMultipleContacts:de}=FC();p.useEffect(()=>{const W=setTimeout(()=>{me(s,c,o,y)},300);return()=>clearTimeout(W)},[o,s,c,y]);const Q=W=>{r(W?K.map(q=>q.id):[])},fe=(W,q)=>{r(q?[...n,W]:n.filter(Y=>Y!==W))},Be=()=>{if(n.length!==0){if(!X){ze.error("You do not have permission to delete contacts");return}k(!0)}},je=W=>{P(W),F(!0)},Ce=W=>{if(!I)return;const q=new URLSearchParams({menu:"chat",contact:I.id,thread:W.id});F(!1),U({pathname:"/chat",search:q.toString()}),ze.success(`Opening conversation with ${I.name||"contact"}`)},Ze=W=>{D(W),R(!0)},rt=W=>{D(W),O(W.name||""),N(W.phone||""),M(W.notes||""),S(!0)},Je=async()=>{try{await de(n),r([]),k(!1),ze.success(`Successfully deleted ${n.length} contact(s)`)}catch{ze.error("Failed to delete contacts")}},te=async()=>{if(C)try{$(!0),await Ne(C.id,{name:T.trim()||null,phone:A.trim()||null,notes:L.trim()||null}),ze.success("Contact updated"),S(!1)}catch{ze.error("Failed to update contact")}finally{$(!1)}},We=()=>{me(s,c,o,y),ze.info("Contacts refreshed")},Ue=(W,q)=>{x(Y=>({...Y,[W]:q}))},ue=(W,q)=>{x(Y=>({...Y,dateRange:{...Y.dateRange,[W]:q}}))},xe=()=>{x({chatStatus:"",handledBy:"",dateRange:{}})},ce=Object.values(y).some(W=>typeof W=="string"?W!=="":Object.values(W).some(q=>q!=="")),qe=n.length===K.length&&K.length>0,Se=n.length>0&&n.length<K.length,nt=W=>{d===W?m(!f):(h(W),m(!0))},vt=(()=>{if(!d)return K;const W=[...K];return W.sort((q,Y)=>{const ne=q[d],_e=Y[d];if(ne==null&&_e==null)return 0;if(ne==null)return f?1:-1;if(_e==null)return f?-1:1;if(d==="chatCreatedAtISO"||d==="created_at"){const ee=new Date(ne).getTime(),oe=new Date(_e).getTime();return f?ee-oe:oe-ee}const Le=String(ne).toLowerCase(),be=String(_e).toLowerCase();return Le<be?f?-1:1:Le>be?f?1:-1:0}),W})(),xt=(()=>{let W=vt;return y.handledBy&&(W=W.filter(q=>q.handledBy===y.handledBy)),W})(),wt=xt.length,ht=W=>{if(!W||W==="")return a.jsx("span",{className:"text-muted-foreground",children:""});const q=W.toLowerCase(),Y=q==="open"?"bg-blue-100 text-blue-700":q==="assigned"?"bg-indigo-100 text-indigo-700":q==="pending"?"bg-amber-100 text-amber-700":"bg-green-100 text-green-700",ne=q.charAt(0).toUpperCase()+q.slice(1);return a.jsx(At,{className:`${Y} border-0`,children:ne})};return a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-semibold",children:"Contacts"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Total Contacts: ",ie?"...":`${wt.toLocaleString()} of ${he.toLocaleString()}`]})]}),a.jsxs("div",{className:"flex gap-4 items-center justify-between",children:[a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsxs(Ii,{open:g,onOpenChange:v,children:[a.jsx(Ri,{asChild:!0,children:a.jsxs(se,{variant:"outline",className:"gap-2",children:[a.jsx(M4,{className:"w-4 h-4"}),"Filter",ce&&a.jsx("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})]})}),a.jsx(ni,{className:"w-80 p-4",align:"start",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"font-medium",children:"Filter Contacts"}),ce&&a.jsx(se,{variant:"ghost",size:"sm",onClick:xe,className:"h-8 px-2 text-xs",children:"Clear All"})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[a.jsx("label",{className:"text-sm font-medium",children:"Chat Status"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"w-4 h-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Filter berdasarkan status percakapan: Open (terbuka), Assigned (ditangani), Pending (menunggu), atau Closed (tertutup)"})})]})]}),a.jsxs(tn,{value:y.chatStatus,onValueChange:W=>Ue("chatStatus",W==="all"?"":W),children:[a.jsx(Jt,{className:"h-8",children:a.jsx(Gt,{placeholder:"All statuses"})}),a.jsxs(Qt,{children:[a.jsx(st,{value:"all",children:"All statuses"}),a.jsx(st,{value:"open",children:"Open"}),a.jsx(st,{value:"assigned",children:"Assigned"}),a.jsx(st,{value:"pending",children:"Pending"}),a.jsx(st,{value:"closed",children:"Closed"})]})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-1 mb-1",children:[a.jsx("label",{className:"text-sm font-medium",children:"Handled By"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"w-4 h-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Filter berdasarkan siapa yang menangani percakapan: Assigned (ditugaskan ke agen) atau Unassigned (belum ditugaskan)"})})]})]}),a.jsxs(tn,{value:y.handledBy||"",onValueChange:W=>Ue("handledBy",W==="all"?"":W),children:[a.jsx(Jt,{className:"h-8",children:a.jsx(Gt,{placeholder:"All agents"})}),a.jsxs(Qt,{children:[a.jsx(st,{value:"all",children:"All"}),a.jsx(st,{value:"assigned",children:"Assigned"}),a.jsx(st,{value:"unassigned",children:"Unassigned"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("label",{className:"text-sm font-medium",children:"Date Range"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"w-4 h-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Filter berdasarkan rentang tanggal kontak dibuat. Pilih tanggal mulai dan tanggal akhir untuk membatasi hasil pencarian"})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsx("div",{children:a.jsx(it,{type:"date",placeholder:"From",value:y.dateRange.from,onChange:W=>ue("from",W.target.value),className:"h-8 text-xs"})}),a.jsx("div",{children:a.jsx(it,{type:"date",placeholder:"To",value:y.dateRange.to,onChange:W=>ue("to",W.target.value),className:"h-8 text-xs"})})]})]})]})]})})]}),a.jsxs("div",{className:"relative",children:[a.jsx(oi,{className:"w-4 h-4 absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"}),a.jsx(it,{placeholder:"Cari berdasarkan Nama atau Telepon",className:"pl-10 pr-8 w-80",value:o,onChange:W=>l(W.target.value)}),o&&a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("button",{type:"button",onClick:()=>l(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground","aria-label":"Clear search",children:a.jsx(Nh,{className:"h-4 w-4"})})}),a.jsx(ge,{children:a.jsx("p",{children:"Hapus pencarian"})})]})]}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"outline",size:"sm",onClick:We,disabled:ie,children:a.jsx(ab,{className:`w-4 h-4 ${ie?"animate-spin":""}`})})}),a.jsx(ge,{children:a.jsx("p",{children:"Segarkan daftar kontak"})})]})]}),a.jsxs("div",{className:"flex gap-2",children:[X&&a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs(se,{variant:n.length>0?"destructive":"outline",className:n.length>0?"bg-red-600 hover:bg-red-700 text-white":"",onClick:Be,disabled:n.length===0,children:["Delete Selected (",n.length,")"]})}),a.jsx(ge,{children:a.jsx("p",{children:"Hapus kontak yang dipilih"})})]}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"outline",onClick:async()=>{try{b(!0);const{data:W,error:q}=await kt.from("contacts").select(`
                            id,
                            name,
                            phone,
                            email,
                            notes,
                            created_at,
                            threads!left(
                              status,
                              assignee_user_id,
                              created_at,
                              channels(display_name, provider, type)
                            )
                          `);if(q)throw q;const Y=(W||[]).map(ee=>{var Ee,Xe,$e;const oe=(ee.threads||[])[0]||null;return{id:ee.id,name:ee.name??"",phone:ee.phone??"",email:ee.email??"",notes:ee.notes??"",contact_created_at:ee.created_at??"",chat_status:(oe==null?void 0:oe.status)??"",handled_by:(oe==null?void 0:oe.assignee_user_id)??"",chat_channel:((Ee=oe==null?void 0:oe.channels)==null?void 0:Ee.display_name)??"",chat_channel_provider:((Xe=oe==null?void 0:oe.channels)==null?void 0:Xe.provider)??"",chat_channel_type:(($e=oe==null?void 0:oe.channels)==null?void 0:$e.type)??"",chat_created_at:(oe==null?void 0:oe.created_at)??""}}),ne=[["ID","Name","Phone","Email","Notes","Contact Created At","Chat Status","Handled By","Chat Channel","Chat Channel Provider","Chat Channel Type","Chat Created At"].join(","),...Y.map(ee=>{var oe;return[ee.id,ee.name,ee.phone,ee.email,(oe=ee.notes)==null?void 0:oe.replace(/"/g,'""'),ee.contact_created_at,ee.chat_status,ee.handled_by,ee.chat_channel,ee.chat_channel_provider,ee.chat_channel_type,ee.chat_created_at].map(Ee=>`"${Ee??""}"`).join(",")})].join(`
`),_e=new Blob([ne],{type:"text/csv;charset=utf-8;"}),Le=URL.createObjectURL(_e),be=document.createElement("a");be.href=Le,be.setAttribute("download",`contacts-${new Date().toISOString()}.csv`),document.body.appendChild(be),be.click(),document.body.removeChild(be),URL.revokeObjectURL(Le),ze.success("Contacts exported to CSV")}catch(W){console.error("Failed to export contacts:",W),ze.error("Failed to export contacts")}finally{b(!1)}},disabled:w,children:w?a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin"}),"Exporting..."]}):"Export"})}),a.jsx(ge,{children:a.jsx("p",{children:"Ekspor daftar kontak"})})]})]})]})]}),H&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("p",{className:"text-red-800 text-sm",children:["Error: ",H]})}),a.jsx(He,{children:a.jsx(lt,{className:"p-0",children:a.jsxs(Zb,{children:[a.jsx(e0,{children:a.jsxs(mo,{children:[a.jsx(tr,{className:"w-12",children:a.jsx(eh,{checked:qe,onCheckedChange:Q,"aria-label":"Select all contacts",className:Se?"data-[state=checked]:bg-blue-600":""})}),a.jsx(tr,{className:"text-xs py-2",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("span",{className:"cursor-help",children:"ACTION"})}),a.jsx(ge,{children:a.jsx("p",{children:"Aksi yang dapat dilakukan pada kontak (lihat, edit, hapus)"})})]})}),a.jsx(tr,{className:"text-xs py-2",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("button",{className:"flex items-center gap-1 text-xs",onClick:()=>nt("name"),children:["NAME ",d==="name"?f?a.jsx(Yo,{className:"h-3.5 w-3.5"}):a.jsx(to,{className:"h-3.5 w-3.5"}):a.jsx(Go,{className:"h-3.5 w-3.5"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Nama kontak (klik untuk mengurutkan)"})})]})}),a.jsx(tr,{className:"text-xs py-2",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("button",{className:"flex items-center gap-1 text-xs",onClick:()=>nt("phone"),children:["PHONE ",d==="phone"?f?a.jsx(Yo,{className:"h-3.5 w-3.5"}):a.jsx(to,{className:"h-3.5 w-3.5"}):a.jsx(Go,{className:"h-3.5 w-3.5"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Nomor telepon kontak (klik untuk mengurutkan)"})})]})}),a.jsx(tr,{className:"text-xs py-2",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("button",{className:"flex items-center gap-1 text-xs",onClick:()=>nt("notes"),children:["NOTE ",d==="notes"?f?a.jsx(Yo,{className:"h-3.5 w-3.5"}):a.jsx(to,{className:"h-3.5 w-3.5"}):a.jsx(Go,{className:"h-3.5 w-3.5"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Catatan atau keterangan tambahan kontak (klik untuk mengurutkan)"})})]})}),a.jsx(tr,{className:"text-xs py-2",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("button",{className:"flex items-center gap-1 text-xs",onClick:()=>nt("inbox"),children:["CHANNEL ",d==="inbox"?f?a.jsx(Yo,{className:"h-3.5 w-3.5"}):a.jsx(to,{className:"h-3.5 w-3.5"}):a.jsx(Go,{className:"h-3.5 w-3.5"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Saluran komunikasi kontak (klik untuk mengurutkan)"})})]})}),a.jsx(tr,{className:"text-xs py-2",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("button",{className:"flex items-center gap-1 text-xs",onClick:()=>nt("channelType"),children:["PLATFORM ",d==="channelType"?f?a.jsx(Yo,{className:"h-3.5 w-3.5"}):a.jsx(to,{className:"h-3.5 w-3.5"}):a.jsx(Go,{className:"h-3.5 w-3.5"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Platform komunikasi (WhatsApp, Telegram, dll) (klik untuk mengurutkan)"})})]})}),a.jsx(tr,{className:"text-xs py-2",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("button",{className:"flex items-center gap-1 text-xs",onClick:()=>nt("chatStatus"),children:["CHAT STATUS ",d==="chatStatus"?f?a.jsx(Yo,{className:"h-3.5 w-3.5"}):a.jsx(to,{className:"h-3.5 w-3.5"}):a.jsx(Go,{className:"h-3.5 w-3.5"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Status percakapan (Open, Pending, Closed) (klik untuk mengurutkan)"})})]})}),a.jsx(tr,{className:"text-xs py-2",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("button",{className:"flex items-center gap-1 text-xs",onClick:()=>nt("chatCreatedAtISO"),children:["CREATED AT ",d==="chatCreatedAtISO"?f?a.jsx(Yo,{className:"h-3.5 w-3.5"}):a.jsx(to,{className:"h-3.5 w-3.5"}):a.jsx(Go,{className:"h-3.5 w-3.5"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Tanggal dan waktu kontak dibuat (klik untuk mengurutkan)"})})]})}),a.jsx(tr,{className:"text-xs py-2",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("button",{className:"flex items-center gap-1 text-xs",onClick:()=>nt("handledBy"),children:["HANDLED BY ",d==="handledBy"?f?a.jsx(Yo,{className:"h-3.5 w-3.5"}):a.jsx(to,{className:"h-3.5 w-3.5"}):a.jsx(Go,{className:"h-3.5 w-3.5"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Agen yang menangani percakapan (klik untuk mengurutkan)"})})]})})]})}),a.jsx(t0,{children:ie?a.jsx(mo,{children:a.jsx(qn,{colSpan:10,className:"text-center py-8",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx(Ht,{className:"w-4 h-4 animate-spin"}),a.jsx("span",{children:"Loading contacts..."})]})})}):K.length===0?a.jsx(mo,{children:a.jsx(qn,{colSpan:10,className:"text-center py-8",children:a.jsx("div",{className:"text-muted-foreground",children:o?"No contacts found matching your search.":"No contacts found."})})}):xt.map(W=>{var q;return a.jsxs(mo,{className:`hover:bg-muted/50 ${n.includes(W.id)?"bg-blue-50":""}`,children:[a.jsx(qn,{children:a.jsx(eh,{checked:n.includes(W.id),onCheckedChange:Y=>fe(W.id,Y),"aria-label":`Select ${W.name}`})}),a.jsx(qn,{children:a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-blue-600 hover:bg-blue-700 text-white","aria-label":"View detailed conversation",onClick:()=>je(W),variant:"ghost",title:"Open conversation",children:a.jsx(Lc,{className:"h-4 w-4"})})}),a.jsx(ge,{children:"Open conversation"})]}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-green-600 hover:bg-green-700 text-white","aria-label":"View contact details",onClick:()=>Ze(W),variant:"ghost",title:"View details",children:a.jsx(CN,{className:"h-4 w-4"})})}),a.jsx(ge,{children:"View details"})]}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-yellow-500 hover:bg-yellow-600 text-white","aria-label":"Edit contact",onClick:()=>rt(W),variant:"ghost",title:"Edit contact",children:a.jsx(Ia,{className:"h-4 w-4"})})}),a.jsx(ge,{children:"Edit contact"})]})]})}),a.jsx(qn,{className:"font-medium",children:a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx(Da,{className:"h-8 w-8",children:a.jsx(La,{className:"text-xs",children:(q=(W.name||W.phone||"?")[0])==null?void 0:q.toUpperCase()})}),a.jsx("div",{className:"min-w-0",children:a.jsx("div",{className:"truncate",children:W.name||"Unnamed Contact"})})]})}),a.jsx(qn,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{children:W.phone||"-"}),W.phone&&a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>{navigator.clipboard.writeText(W.phone),ze.success("Phone copied")},children:a.jsx(qf,{className:"h-3 w-3"})})}),a.jsx(ge,{children:"Copy phone"})]})]})}),a.jsx(qn,{children:W.notes?a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("span",{className:"line-clamp-1 max-w-[260px] inline-block align-middle",children:W.notes})}),a.jsx(ge,{className:"max-w-sm",children:W.notes})]}):a.jsx("span",{className:"text-muted-foreground",children:"-"})}),a.jsx(qn,{children:W.inbox?a.jsx(At,{variant:"outline",children:W.inbox}):""}),a.jsx(qn,{children:W.channelProvider?a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(At,{variant:"secondary",className:"capitalize",children:W.channelProvider})}):a.jsx("span",{className:"text-muted-foreground",children:""})}),a.jsx(qn,{children:ht(W.chatStatus)}),a.jsx(qn,{className:"font-mono text-sm whitespace-nowrap",children:W.chatCreatedAt||"-"}),a.jsx(qn,{children:W.handledBy&&W.handledBy!==""?a.jsx(At,{className:"bg-purple-100 text-purple-700 border-0",children:W.handledBy}):a.jsx("span",{className:"text-muted-foreground",children:""})})]},W.id)})})]})})}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(se,{variant:"outline",size:"sm",disabled:s===1||ie,onClick:()=>i(s-1),children:a.jsx(NN,{className:"w-4 h-4"})}),a.jsxs("span",{className:"text-sm",children:["Page ",a.jsx("span",{className:"font-medium",children:s})," of ",a.jsx("span",{className:"font-medium",children:Math.max(1,Math.ceil(wt/c))})]}),a.jsx(se,{variant:"outline",size:"sm",disabled:s>=Math.ceil(wt/c)||ie,onClick:()=>i(s+1),children:a.jsx(Mp,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{children:"Items per page:"}),a.jsxs(tn,{value:c.toString(),onValueChange:W=>u(parseInt(W)),children:[a.jsx(Jt,{className:"w-20 h-8",children:a.jsx(Gt,{})}),a.jsxs(Qt,{children:[a.jsx(st,{value:"50",children:"50"}),a.jsx(st,{value:"100",children:"100"}),a.jsx(st,{value:"200",children:"200"})]})]}),a.jsx("span",{children:"rows"})]}),a.jsxs("span",{children:["Total: ",a.jsx("span",{className:"font-medium",children:wt.toLocaleString()})]})]})]}),a.jsx(Hb,{open:_,onOpenChange:k,children:a.jsxs(Jp,{children:[a.jsxs(Qp,{children:[a.jsx(eg,{children:"Are you sure?"}),a.jsxs(tg,{children:["This action cannot be undone. This will permanently delete ",n.length," contact",n.length>1?"s":"","."]})]}),a.jsxs(Zp,{children:[a.jsx(rg,{children:"Cancel"}),a.jsxs(ng,{onClick:Je,className:"bg-red-600 hover:bg-red-700",children:["Delete ",n.length," Contact",n.length>1?"s":""]})]})]})}),a.jsx(xn,{open:j,onOpenChange:S,children:a.jsxs(un,{children:[a.jsx(dn,{children:a.jsx(hn,{children:"Edit Contact"})}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Qe,{children:"Name"}),a.jsx(it,{value:T,onChange:W=>O(W.target.value),placeholder:"Full name"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Qe,{children:"Phone"}),a.jsx(it,{value:A,onChange:W=>N(W.target.value),placeholder:"Phone number"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Qe,{children:"Notes"}),a.jsx(qr,{value:L,onChange:W=>M(W.target.value),placeholder:"Notes"})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[a.jsx(se,{variant:"outline",onClick:()=>S(!1),disabled:B,children:"Cancel"}),a.jsx(se,{onClick:te,disabled:B,className:"bg-blue-600 hover:bg-blue-700",children:B?"Saving":"Save"})]})]})]})}),a.jsx(xn,{open:z,onOpenChange:R,children:a.jsxs(un,{className:"max-w-2xl",children:[a.jsx(dn,{children:a.jsxs(hn,{className:"flex items-center gap-3",children:[a.jsx(Da,{className:"h-10 w-10",children:a.jsx(La,{children:((Wt=(_t=C==null?void 0:C.name)==null?void 0:_t[0])==null?void 0:Wt.toUpperCase())||((Oe=(pe=C==null?void 0:C.phone)==null?void 0:pe[0])==null?void 0:Oe.toUpperCase())||"?"})}),a.jsxs("div",{children:[a.jsx("div",{className:"text-lg font-semibold",children:(C==null?void 0:C.name)||"Unnamed Contact"}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Contact Details"})]})]})}),C&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Name"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(yy,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:C.name||"Unnamed Contact"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ZV,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:C.phone||"-"}),C.phone&&a.jsx(se,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0",onClick:()=>{navigator.clipboard.writeText(C.phone),ze.success("Phone copied to clipboard")},children:a.jsx(qf,{className:"h-3 w-3"})})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Notes"}),a.jsx("div",{className:"p-3 bg-muted rounded-md",children:C.notes?a.jsx("p",{className:"text-sm",children:C.notes}):a.jsx("span",{className:"text-muted-foreground text-sm",children:"No notes"})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Label Names"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx("span",{children:C.labelNames||"-"})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Inbox"}),a.jsx("div",{className:"flex items-center gap-2",children:C.inbox?a.jsx(At,{variant:"outline",children:C.inbox}):a.jsx("span",{className:"text-muted-foreground",children:""})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Chat Status"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Mv,{className:"h-4 w-4 text-muted-foreground"}),ht(C.chatStatus)]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Handled By"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(yy,{className:"h-4 w-4 text-muted-foreground"}),C.handledBy&&C.handledBy!==""?a.jsx(At,{className:"bg-purple-100 text-purple-700 border-0",children:C.handledBy}):a.jsx("span",{className:"text-muted-foreground",children:""})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Contact Created At"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Hc,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{className:"font-mono text-sm",children:C.created_at?new Date(C.created_at).toLocaleString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}):"-"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{className:"text-sm font-medium text-muted-foreground",children:"Chat Created At"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Hc,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{className:"font-mono text-sm",children:C.chatCreatedAt||"-"})]})]})]}),t&&C&&a.jsxs("div",{className:"space-y-2 pt-4 border-t",children:[a.jsxs(Qe,{className:"text-sm font-medium text-muted-foreground flex items-center gap-2",children:[a.jsx(D4,{className:"h-4 w-4"}),"Contact UUID"]}),a.jsxs("div",{className:"flex items-center gap-2 p-3 bg-muted rounded-md",children:[a.jsx("code",{className:"flex-1 font-mono text-xs text-foreground break-all",children:C.id}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 flex-shrink-0",onClick:()=>{navigator.clipboard.writeText(C.id),ze.success("Contact UUID copied to clipboard")},children:a.jsx(qf,{className:"h-4 w-4"})})}),a.jsx(ge,{children:"Copy UUID"})]})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Unique identifier for this contact. Use this UUID for GDPR deletion requests or system integrations."})]}),a.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[a.jsxs(se,{onClick:()=>je(C),className:"flex-1",children:[a.jsx(Lc,{className:"h-4 w-4 mr-2"}),"View Conversation"]}),a.jsxs(se,{variant:"outline",onClick:()=>rt(C),className:"flex-1",children:[a.jsx(Ia,{className:"h-4 w-4 mr-2"}),"Edit Contact"]})]})]})]})}),a.jsx(Zge,{open:E,onOpenChange:W=>{F(W),W||P(null)},contact:I?{id:I.id,name:I.name,phone:I.phone}:null,onSelectThread:Ce})]})}const Jz=()=>{const[e,t]=p.useState([]),[n,r]=p.useState(!0),[s,i]=p.useState(null),o=async()=>{try{r(!0),i(null);const{data:{user:h}}=await le.auth.getUser();if(!h){t([]);return}const{data:f,error:m}=await le.from("org_members").select("org_id").eq("user_id",h.id);if(m||!f||f.length===0){t([]);return}const g=f.map(N=>N.org_id),{data:v}=await le.from("user_roles").select("role_id").eq("user_id",h.id);let y=!1,x=!1,w=!1;if(v&&v.length>0){const N=v.map(B=>B.role_id),{data:L}=await le.from("roles").select("id, name").in("id",N),M=(L||[]).map(B=>(B.name||"").toLowerCase());y=M.includes("master_agent"),x=M.includes("super_agent"),w=M.includes("agent")&&!y&&!x}let b=null;if(w){const{data:N}=await le.from("channel_agents").select("channel_id").eq("user_id",h.id);b=new Set((N||[]).map(L=>L.channel_id))}const{data:_,error:k}=await le.from("channels").select(`
          *
        `).in("org_id",g).order("created_at",{ascending:!1});if(k){console.error("Error fetching channels:",k),i(k.message);return}const{data:j,error:S}=await le.from("org_members").select(`
          org_id,
          user_id,
          role,
          v_users!inner (
            display_name,
            email
          )
        `).in("org_id",g);S&&console.error("Error fetching org members for platforms:",S);const T={};for(const N of j||[]){const L=N.org_id;T[L]||(T[L]=[]),T[L].push(N)}const O=(_||[]).filter(N=>b?b.has(N.id):!0),A=await Promise.all(O.map(async N=>{try{const{data:L}=await le.from("channel_agents").select("user_id").eq("channel_id",N.id),M=(L||[]).map(z=>z.user_id);let B=[];if(M.length>0){const[z,R]=await Promise.all([le.from("users_profile").select("user_id, display_name").in("user_id",M),le.from("v_users").select("id, display_name, email").in("id",M)]),C=z.data||[],D=R.data||[],E={};D.forEach(F=>{E[F.id]={display_name:F.display_name,email:F.email}}),C.forEach(F=>{var I,P;E[F.user_id]={display_name:F.display_name??((I=E[F.user_id])==null?void 0:I.display_name),email:(P=E[F.user_id])==null?void 0:P.email}}),B=Object.entries(E).map(([F,I])=>({user_id:F,...I}))}const $=M.map(z=>{const R=B.find(C=>C.user_id===z||C.id===z)||{};return{user_id:z,display_name:R.display_name||(R==null?void 0:R.display_name),email:R.email}});return{...N,provider:N.provider,status:N.is_active?"active":"inactive",human_agents:$,super_agent_id:N.super_agent_id??null,credentials:(N==null?void 0:N.credentials)??null}}catch{return{...N,provider:N.provider,status:N.is_active?"active":"inactive",human_agents:[],super_agent_id:N.super_agent_id??null,credentials:(N==null?void 0:N.credentials)??null}}}));t(A)}catch(h){console.error("Error fetching platforms:",h),i("Failed to fetch platforms")}finally{r(!1)}},l=async h=>{var f;try{i(null);const{data:{user:m}}=await le.auth.getUser();if(!m)throw new Error("User not authenticated");const{data:g,error:v}=await le.from("org_members").select("org_id").eq("user_id",m.id).limit(1);if(v)throw v;const y=(f=g==null?void 0:g[0])==null?void 0:f.org_id;if(!y)throw new Error("User not found in any organization");if(!h.ai_profile_id)throw new Error("AI agent is required when creating a platform");const{data:x,error:w}=await le.from("ai_profiles").select("super_agent_id").eq("id",h.ai_profile_id).single();if(w)throw w;const b=x==null?void 0:x.super_agent_id;if(!b)throw new Error("Selected AI agent does not have a super agent assigned. Please update the AI agent first.");const _=h.provider==="whatsapp"?String(h.display_name||"").toLowerCase().replace(/\s/g,""):null,{data:k,error:j}=await le.from("channels").insert({org_id:y,display_name:h.display_name,credentials:h.provider==="whatsapp"?{waha_session_name:_}:{},provider:h.provider,type:"inbox",profile_photo_url:h.profile_photo_url,ai_profile_id:h.ai_profile_id,super_agent_id:b,is_active:!0,external_id:h.provider==="whatsapp"?_:null}).select().single();if(j)throw j;if(h.human_agent_ids&&h.human_agent_ids.length>0){const S=h.human_agent_ids.map(O=>({channel_id:k.id,user_id:O})),{error:T}=await le.from("channel_agents").insert(S);T&&console.warn("Failed to attach channel agents on create:",T)}await o();try{await en({action:"channel.create",resource:"channel",resourceId:(k==null?void 0:k.id)??null,context:{...h,super_agent_id:b}})}catch{}return k}catch(m){throw console.error("Error creating platform:",m),i(m.message||"Failed to create platform"),m}},c=async(h,f)=>{try{i(null);const m={};if(typeof f.display_name<"u"&&(m.display_name=f.display_name),typeof f.profile_photo_url<"u"&&(m.profile_photo_url=f.profile_photo_url),typeof f.ai_profile_id<"u"&&(m.ai_profile_id=f.ai_profile_id,f.ai_profile_id)){const{data:g,error:v}=await le.from("ai_profiles").select("super_agent_id").eq("id",f.ai_profile_id).single();if(v)throw v;const y=g==null?void 0:g.super_agent_id;if(!y)throw new Error("Selected AI agent does not have a super agent assigned. Please update the AI agent first.");m.super_agent_id=y}if(typeof f.provider<"u"&&(m.provider=f.provider),Object.keys(m).length>0){const{error:g}=await le.from("channels").update(m).eq("id",h);if(g)throw g}if(f.human_agent_ids!==void 0){const{error:g}=await le.from("channel_agents").delete().eq("channel_id",h);if(g&&console.error("Error removing human agents:",g),f.human_agent_ids.length>0){const v=f.human_agent_ids.map(x=>({channel_id:h,user_id:x})),{error:y}=await le.from("channel_agents").insert(v);y&&console.error("Error adding human agents:",y)}}await o();try{await en({action:"channel.update",resource:"channel",resourceId:h,context:f})}catch{}}catch(m){throw console.error("Error updating platform:",m),i(m.message||"Failed to update platform"),m}},u=async(h,f,m)=>{const g=[/^image\//i],v=/\.(png|jpe?g|webp)$/i;if(!(g.some(b=>b.test(f.type||""))||v.test(f.name||"")))throw new Error("Only image files are allowed (PNG, JPG, WEBP).");const x=5*1024*1024;if(typeof f.size=="number"&&f.size>x)throw new Error("Image is too large. Maximum size is 5 MB.");async function w(b){try{if(typeof window>"u")return null;const _=document.createElement("img"),k=URL.createObjectURL(b);try{await new Promise((O,A)=>{_.onload=()=>O(),_.onerror=A,_.src=k})}finally{URL.revokeObjectURL(k)}const j=document.createElement("canvas");j.width=_.naturalWidth||_.width,j.height=_.naturalHeight||_.height;const S=j.getContext("2d");return S?(S.drawImage(_,0,0,j.width,j.height),await new Promise(O=>j.toBlob(A=>O(A),"image/png"))):null}catch{return null}}try{const{data:{user:b}}=await le.auth.getUser();if(!b)throw new Error("User not authenticated");let _=m||"";if(!_){const{data:B,error:$}=await le.from("channels").select("org_id").eq("id",h).single();if($)throw $;_=B==null?void 0:B.org_id}if(!_)throw new Error("Missing org_id for channel");const k="channel-assets",j=`${_}/${h}/profile/avatar.png`,S=await w(f),T=S||f,O=S?"image/png":f.type||"image/*",{error:A}=await le.storage.from(k).upload(j,T,{cacheControl:"31536000",upsert:!0,contentType:O});if(A)throw A;const{data:N}=le.storage.from(k).getPublicUrl(j),L=N==null?void 0:N.publicUrl,{error:M}=await le.from("channels").update({logo_url:L,profile_photo_url:L}).eq("id",h);if(M)throw M;try{await en({action:"channel.avatar.update",resource:"channel",resourceId:h,context:{objectPath:j}})}catch{}return L}catch(b){throw console.error("Error uploading channel avatar:",b),new Error((b==null?void 0:b.message)||"Failed to upload channel avatar")}},d=async(h,f)=>{try{const{data:{user:m}}=await le.auth.getUser();if(!m)throw new Error("User not authenticated");let g=f||"";if(!g){const{data:w,error:b}=await le.from("channels").select("org_id").eq("id",h).single();if(b)throw b;g=w==null?void 0:w.org_id}if(!g)throw new Error("Missing org_id for channel");const v="channel-assets",y=`${g}/${h}/profile/avatar.png`;try{await le.storage.from(v).remove([y])}catch{}const{error:x}=await le.from("channels").update({logo_url:null,profile_photo_url:null}).eq("id",h);if(x)throw x;try{await en({action:"channel.avatar.delete",resource:"channel",resourceId:h,context:{objectPath:y}})}catch{}}catch(m){throw console.error("Error deleting channel avatar:",m),new Error((m==null?void 0:m.message)||"Failed to delete channel avatar")}};return p.useEffect(()=>{o()},[]),{platforms:e,loading:n,error:s,fetchPlatforms:o,createPlatform:l,updatePlatform:c,uploadChannelAvatar:u,deleteChannelAvatar:d}},tve=()=>{const[e,t]=p.useState({}),[n,r]=p.useState(!1),[s,i]=p.useState(null),o=p.useCallback(async l=>{if(!l)return[];try{r(!0),i(null);const{data:c,error:u}=await le.from("channels").select("*").eq("org_id",l).order("created_at",{ascending:!1});if(u)return i(u.message),[];const d=c||[];return t(h=>({...h,[l]:d})),d}catch(c){return i(c instanceof Error?c.message:"Failed to fetch channels"),[]}finally{r(!1)}},[]);return{channelsByOrg:e,loading:n,error:s,fetchByOrgId:o}},Qz=()=>{const{user:e}=Ar(),{userRoles:t,loading:n}=Nr(),[r,s]=p.useState("none"),[i,o]=p.useState(null),[l,c]=p.useState(!0),[u,d]=p.useState(null),h=p.useMemo(()=>t.map(y=>((y==null?void 0:y.name)??"").toLowerCase()),[t]),f=h.includes("master_agent"),m=h.includes("super_agent"),g=h.includes("agent");return p.useEffect(()=>{let y=!0;const x=(w,b,_)=>{y&&((_==null?void 0:_.loading)!==void 0&&c(_.loading),(_==null?void 0:_.error)!==void 0&&d(_.error),s(w),o(b))};return e!=null&&e.id?n?(c(!0),()=>{y=!1}):f?(x("all",null,{loading:!1,error:null}),()=>{y=!1}):m?(x("super",e.id,{loading:!1,error:null}),()=>{y=!1}):g?(c(!0),d(null),(async()=>{try{await Qd();const{data:w,error:b}=await le.from("super_agent_members").select("super_agent_id").eq("agent_user_id",e.id).maybeSingle();if(!y)return;if(b)throw b;const _=(w==null?void 0:w.super_agent_id)??null;_?x("agent",_,{loading:!1,error:null}):x("none",null,{loading:!1,error:"Agent belum memiliki Super Agent penanggung jawab."})}catch(w){if(!y)return;console.error("Failed to resolve agent super scope",w),x("none",null,{loading:!1,error:w instanceof Error?w.message:"Gagal memuat cakupan agen AI."})}})(),()=>{y=!1}):(h.length>0?x("all",null,{loading:!1,error:null}):c(!0),()=>{y=!1}):(x("none",null,{loading:!1,error:null}),()=>{y=!1})},[e==null?void 0:e.id,n,f,m,g,h]),{mode:r,superAgentId:i,loading:l,error:u,refresh:async()=>{if(!(e!=null&&e.id)||!g)return i;c(!0),d(null);try{await Qd();const{data:y,error:x}=await le.from("super_agent_members").select("super_agent_id").eq("agent_user_id",e.id).maybeSingle();if(x)throw x;const w=(y==null?void 0:y.super_agent_id)??null;return w?(s("agent"),o(w)):(s("none"),o(null),d("Agent belum memiliki Super Agent penanggung jawab.")),w}catch(y){return console.error("Failed to refresh agent super scope",y),s("none"),o(null),d(y instanceof Error?y.message:"Gagal memuat cakupan agen AI."),null}finally{c(!1)}}}},n0=()=>{const[e,t]=p.useState([]),[n,r]=p.useState(!0),[s,i]=p.useState(null),o=p.useState({current:null})[0],{user:l}=Ar(),{mode:c,superAgentId:u,loading:d,error:h}=Qz(),f=p.useMemo(()=>{const g="v2",v=(l==null?void 0:l.id)??"anon";return c==="all"?`app.cachedAIAgents:${g}:${v}:all`:c==="none"?`app.cachedAIAgents:${g}:${v}:none`:`app.cachedAIAgents:${g}:${v}:${u??"none"}`},[c,u,l==null?void 0:l.id]),m=async()=>{if(!d)try{const g=`${c}:${u??"null"}`;if(o.current===g)return;if(o.current=g,r(!0),i(h??null),c==="none"){t([]);try{localStorage.setItem(f,JSON.stringify([]))}catch{}return}await Qd();const v="id, org_id, name, description, system_prompt, welcome_message, transfer_conditions, stop_ai_after_handoff, response_temperature, created_at, auto_resolve_after_minutes, enable_resolve, super_agent_id";let y=null,x=null;if(c==="super"||c==="agent"){if(!u){t([]);try{localStorage.setItem(f,JSON.stringify([]))}catch{}return}const{data:w,error:b}=await le.from("ai_profiles").select(v).eq("super_agent_id",u).order("created_at",{ascending:!1});if(y=w,x=b,(x==null?void 0:x.code)==="42703"){const _=await le.from("ai_profiles").select(v).order("created_at",{ascending:!1});y=_.data,x=_.error}}else{const{data:w,error:b}=await le.from("ai_profiles").select(v).order("created_at",{ascending:!1});y=w,x=b}if(x){console.error("Error fetching AI agents:",x),i(x.message),t([]);return}t(y||[]);try{localStorage.setItem(f,JSON.stringify(y||[]))}catch{}}catch(g){console.error("Error fetching AI agents:",g),i("Failed to fetch AI agents"),t([])}finally{o.current=null,r(!1)}};return p.useEffect(()=>{if(d){r(!0);return}if(c==="none"){t([]),i(h??"Tidak ada agen AI yang tersedia untuk akun ini."),r(!1);return}try{const y=localStorage.getItem(f);if(y){const x=JSON.parse(y);Array.isArray(x)&&t(x)}}catch{}const v=setTimeout(()=>m(),50);return()=>clearTimeout(v)},[d,c,h,f]),{aiAgents:e,loading:n||d,error:s,fetchAIAgents:m,scopeMode:c,superAgentId:u}};function r0({options:e,value:t,onChange:n,onValueChange:r,placeholder:s="Select...",disabled:i,className:o}){const[l,c]=p.useState(!1),u=new Set(t),d=g=>{n&&n(g),r&&r(g)},h=g=>{const v=new Set(u);v.has(g)?v.delete(g):v.add(g),d(Array.from(v))},f=e.filter(g=>u.has(g.value)).map(g=>g.label),m=f.length===0?s:`${f.length} selected`;return a.jsxs(Ii,{open:l,onOpenChange:c,children:[a.jsx(Ri,{asChild:!0,children:a.jsxs(se,{type:"button",variant:"outline",role:"combobox","aria-expanded":l,disabled:i,className:Ie("justify-between w-64",o),children:[a.jsx("span",{className:"truncate text-left",children:m}),a.jsx("span",{className:"ml-2 text-muted-foreground",children:""})]})}),a.jsx(ni,{className:"p-0 w-80",align:"start",onOpenAutoFocus:g=>g.preventDefault(),children:a.jsxs(Dm,{children:[a.jsx(Lm,{placeholder:"Search..."}),a.jsxs(f6,{children:[a.jsx($m,{children:"No results found."}),a.jsx(Fm,{children:e.map(g=>a.jsxs(Um,{onSelect:v=>{h(g.value)},className:"cursor-pointer",children:[a.jsx("div",{className:"mr-2 flex h-4 w-4 items-center justify-center",onClick:v=>{v.preventDefault(),v.stopPropagation(),h(g.value)},children:a.jsx(eh,{checked:u.has(g.value),onCheckedChange:()=>h(g.value)})}),a.jsx("span",{children:g.label})]},g.value))})]})]})})]})}const nve={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_HCAPTCHA_SITEKEY:"30583a2e-84ac-496a-8ec2-23043ae06dc0",VITE_SUPABASE_PROJECT_ID:"bkynymyhbfrhvwxqqttk",VITE_SUPABASE_PUBLISHABLE_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJreW55bXloYmZyaHZ3eHFxdHRrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5Mzk1NzIsImV4cCI6MjA3OTUxNTU3Mn0.4ELI9s6908SdW2jd1BM_ht8pTIyLAwPpsqGiGNCdcC0",VITE_SUPABASE_URL:"https://bkynymyhbfrhvwxqqttk.supabase.co",VITE_WEBHOOK_BASE_URL:"https://primary-production-376c.up.railway.app/webhook"},_d=nve??{},Zz=e=>e.replace(/\/$/,""),ek=(()=>{const e=_d==null?void 0:_d.VITE_APP_ORIGIN;return e?Zz(e):"https://synkaai.netlify.app"})(),NO=e=>`${ek}/livechat/${e}`,Hv=(()=>{const e=_d==null?void 0:_d.VITE_WAHA_BASE_URL;return Zz(e||"https://waha-plus-production-97c1.up.railway.app")})(),rve=({isOpen:e,onClose:t,onSubmit:n,isSubmitting:r=!1})=>{const{toast:s}=uu(),{user:i}=Ar(),{hasPermission:o,hasRole:l}=Nr(),{aiAgents:c,loading:u}=n0(),{agents:d,loading:h}=Ql(),[f,m]=p.useState({platformName:"",description:"",phoneNumber:"",selectedAIAgent:"",selectedHumanAgents:[],profilePhoto:null}),[g,v]=p.useState(!1),[y,x]=p.useState(!1),[w,b]=p.useState(null),[_,k]=p.useState(null),[j,S]=p.useState(null);p.useRef(!1);const[T,O]=p.useState(!1),[A,N]=p.useState(!1),[L,M]=p.useState(null),B=o("channels.create"),$=l("super_agent");p.useEffect(()=>{e&&$&&i!=null&&i.id&&(M(i.id),m(I=>({...I,selectedAIAgent:"",selectedHumanAgents:[]})))},[e,$,i==null?void 0:i.id]),p.useMemo(()=>L&&d.find(I=>I.primaryRole==="super_agent"&&I.user_id===L)||null,[L,d]);const z=async()=>{if(!i)return null;const{data:I}=await le.from("org_members").select("org_id").eq("user_id",i.id).single();return(I==null?void 0:I.org_id)||null},R=async()=>{try{x(!0),S(null),b(null);const I=Nn.ENDPOINTS.WHATSAPP.CREATE_SESSION,P=`${Nn.BASE_URL}/ffef6b04-3626-4f9c-8ab8-be3d9971cce3/waha`,U=(f.platformName||"default").replace(/\s/g,""),Z={name:U,start:!0,config:{metadata:{"user.id":(i==null?void 0:i.id)||"","user.email":(i==null?void 0:i.email)||""},proxy:null,debug:!1,noweb:{store:{enabled:!0,fullSync:!1}},webhooks:[{url:P,events:["message","session.status","message.reaction","message.any","message.ack","message.waiting","message.revoked","state.change","group.join","group.leave","presence.update","poll.vote","poll.vote.failed","chat.archive","call.received","call.accepted","call.rejected","label.upsert","label.deleted","label.chat.added","label.chat.deleted","engine.event"],hmac:null,retries:null,customHeaders:null}]}};try{const ie=await Ns(I,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Z)});if(!ie.ok){const H=await ie.text();if(ie.status!==409)throw new Error(`Create session failed (${ie.status}): ${H||"Unknown error"}`)}}catch(ie){throw ie}const X=await Ns(Nn.ENDPOINTS.WHATSAPP.GET_LOGIN_QR,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_name:U})});if(!X.ok)throw new Error(`Request failed with status ${X.status}`);const K=X.headers.get("content-type");if(K&&K.includes("image/")){const ie=await X.blob(),H=URL.createObjectURL(ie);return b(H),k(U),x(!1),{qr:H,sessionName:U}}else try{const ie=await X.json(),H=Array.isArray(ie)?ie[0]:ie;if(!H||!H.data||!H.mimetype)throw new Error("Invalid QR response shape");const he=`data:${H.mimetype};base64,${H.data}`;return b(he),k(U),x(!1),{qr:he,sessionName:U}}catch{const H=await X.text();if(H&&H.length>0){const he=`data:image/png;base64,${H}`;return b(he),k(U),x(!1),{qr:he,sessionName:U}}else throw new Error("Invalid response format")}return x(!1),null}catch(I){return S((I==null?void 0:I.message)||"Failed to generate QR"),x(!1),null}},C=async()=>{try{const P=await(async()=>{if(_&&_.trim().length>0)return _;try{const X=await z();if(!X)return"default";const{data:K}=await le.from("channels").select("display_name, provider").eq("org_id",X).eq("provider","whatsapp").order("created_at",{ascending:!1}).limit(1).maybeSingle();return((K==null?void 0:K.display_name)||"").replace(/\s/g,"")||"default"}catch{return"default"}})(),U=`${Hv}/api/sessions/${encodeURIComponent(P)}`,Z=await fetch(U,{method:"GET",headers:{"Content-Type":"application/json","x-api-key":"asd"}});if(Z.ok){const X=await Z.json();return X&&X.status==="WORKING"&&X.me&&X.me.id?(v(!0),b(null),s({title:"Success",description:"WhatsApp connected successfully!"}),!0):(v(!1),!1)}return!1}catch(I){return console.error("Error checking session status:",I),!1}};p.useEffect(()=>{if(!w||g)return;const I=setInterval(async()=>{await C()&&clearInterval(I)},5e3);return()=>clearInterval(I)},[w,g]);const D=!!(f.platformName&&f.selectedAIAgent&&L&&B),E=async()=>{try{O(!0)}finally{O(!1),m({platformName:"",description:"",phoneNumber:"",selectedAIAgent:"",selectedHumanAgents:[],profilePhoto:null}),v(!1),x(!1),b(null),S(null),M(null),t()}},F=async()=>{try{if(N(!0),!B){s({title:"Permission denied",description:"You do not have permission to create channels.",variant:"destructive"}),N(!1);return}if(!L||!f.selectedAIAgent){s({title:"Missing required fields",description:"Please select a Super Agent and an AI Agent.",variant:"destructive"}),N(!1);return}if(!await z())throw new Error("User not found in any organization");const P=await R(),U={...f,phoneNumber:void 0,platformType:"whatsapp",selectedSuperAgentId:L};if(await n(U),s({title:"Success",description:"Channel successfully created."}),P)try{window.dispatchEvent(new CustomEvent("open-wa-qr",{detail:{sessionName:P.sessionName,qr:P.qr}}))}catch{}try{window.dispatchEvent(new CustomEvent("refresh-platforms"))}catch{}t(),m({platformName:"",description:"",phoneNumber:"",selectedAIAgent:"",selectedHumanAgents:[],profilePhoto:null}),M(null)}catch(I){console.error("Error submitting form:",I),s({title:"Error",description:I.message||"Failed to create WhatsApp platform",variant:"destructive"})}finally{N(!1)}};return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsx(un,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",style:{overflowX:"visible",overflowY:"auto"},children:a.jsxs("div",{children:[a.jsxs(dn,{children:[a.jsx(hn,{children:"Setup WhatsApp Platform"}),a.jsx(Hr,{children:"Configure your new WhatsApp platform with all the necessary information."})]}),a.jsxs("div",{className:"mt-6 space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"platformName",children:"Platform Name *"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Nama platform atau merek yang akan ditampilkan kepada pelanggan"})})]})]}),a.jsx(it,{id:"platformName",placeholder:"Enter your platform or brand name",value:f.platformName,onChange:I=>m(P=>({...P,platformName:I.target.value}))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"profilePhoto",children:"Profile Photo / Logo"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Foto profil atau logo yang akan ditampilkan di WhatsApp Business"})})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"h-16 w-16 rounded-full bg-muted flex items-center justify-center border-2 border-dashed border-muted-foreground/25",children:f.profilePhoto?a.jsx("img",{src:URL.createObjectURL(f.profilePhoto),alt:"Profile",className:"h-16 w-16 rounded-full object-cover"}):a.jsx(Kc,{className:"h-6 w-6 text-muted-foreground"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx(it,{id:"profilePhoto",type:"file",accept:"image/*",onChange:I=>{var U;const P=((U=I.target.files)==null?void 0:U[0])||null;m(Z=>({...Z,profilePhoto:P}))},className:"hidden"}),a.jsxs(se,{variant:"outline",onClick:()=>{var I;return(I=document.getElementById("profilePhoto"))==null?void 0:I.click()},children:[a.jsx(Kc,{className:"h-4 w-4 mr-2"})," Upload Photo"]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"description",children:"Description"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Deskripsi bisnis dan layanan yang akan ditampilkan kepada pelanggan"})})]})]}),a.jsx(qr,{id:"description",placeholder:"Describe your business and what you offer",value:f.description,onChange:I=>m(P=>({...P,description:I.target.value})),rows:3})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"text-xs font-medium text-emerald-700",children:"Super Agent (1 max)"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Super Agent yang akan mengawasi dan mengelola platform WhatsApp ini"})})]})]}),h?a.jsx("div",{className:"rounded-md border bg-muted px-3 py-2 text-sm",children:"Loading super agents..."}):a.jsxs(tn,{value:L||"",onValueChange:I=>{M(I),m(P=>({...P,selectedAIAgent:"",selectedHumanAgents:[]}))},disabled:$,children:[a.jsx(Jt,{children:a.jsx(Gt,{placeholder:"Choose a Super Agent"})}),a.jsx(Qt,{className:"bg-background border z-50",children:d.filter(I=>I.primaryRole==="super_agent").map(I=>a.jsx(st,{value:I.user_id,children:I.display_name||I.email||I.user_id.slice(0,8)},I.user_id))})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Default mengikuti super agent pada AI agent terpilih. Anda bisa mengubahnya di sini."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"aiAgent",children:"Select AI Agent *"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Agen AI yang akan menangani percakapan otomatis di platform WhatsApp ini"})})]})]}),u?a.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading AI agents..."}):a.jsxs(tn,{value:f.selectedAIAgent,onValueChange:I=>{const P=c.find(U=>U.id===I);if(!L){s({title:"Select a Super Agent first",description:"Pilih super agent terlebih dahulu, lalu pilih AI agent.",variant:"destructive"});return}if(!P||P.super_agent_id!==L){s({title:"AI agent tidak sesuai",description:"AI agent yang dipilih tidak berada di bawah super agent terpilih.",variant:"destructive"});return}m(U=>({...U,selectedAIAgent:I,selectedHumanAgents:[]}))},children:[a.jsx(Jt,{children:a.jsx(Gt,{placeholder:L?"Choose an AI agent":"Select a Super Agent first"})}),a.jsx(Qt,{className:"bg-background border z-50",children:c.filter(I=>L?I.super_agent_id===L:!1).map(I=>a.jsx(st,{value:I.id,children:I.name},I.id))})]})]}),f.selectedAIAgent&&!L&&a.jsx("p",{className:"text-xs text-amber-600",children:"AI agent terpilih belum memiliki super agent. Tetapkan super agent di halaman AI Agents terlebih dahulu."}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{children:"Assign Agents"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Agen manusia yang akan menangani percakapan yang memerlukan intervensi manual"})})]})]}),h?a.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading human agents..."}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"text-xs font-medium",children:["Agents ",L?"":"(select an AI agent first)"]}),(()=>{const P=d.filter(U=>U.primaryRole==="agent").filter(U=>!!L&&U.super_agent_id===L).map(U=>({value:U.user_id,label:U.display_name||U.email||`Agent ${U.user_id.slice(0,8)}`}));return a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(r0,{options:P,value:f.selectedHumanAgents,onValueChange:U=>m(Z=>({...Z,selectedHumanAgents:U})),disabled:!L,placeholder:L?"Select human agents":"Select an AI agent first"}),a.jsx(se,{type:"button",variant:"outline",disabled:!L||P.length===0,onClick:()=>m(U=>({...U,selectedHumanAgents:P.map(Z=>Z.value)})),children:"Select All"}),a.jsx(se,{type:"button",variant:"ghost",disabled:!L||f.selectedHumanAgents.length===0,onClick:()=>m(U=>({...U,selectedHumanAgents:[]})),children:"Unselect All"})]})})()]})})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx(se,{variant:"outline",onClick:E,disabled:r||T,className:"text-blue-700 border-blue-200 hover:bg-blue-50",children:T?a.jsxs(a.Fragment,{children:[a.jsx(Ht,{className:"mr-2 h-4 w-4 animate-spin"}),"Cancelling..."]}):"Cancel"}),a.jsx(se,{onClick:F,disabled:r||A||!D,className:"bg-blue-100 hover:bg-blue-200 text-blue-700 transition-all duration-200 hover:shadow-md active:scale-[.98]","aria-busy":r||A,children:r||A?a.jsxs(a.Fragment,{children:[a.jsx(Ht,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating..."]}):"Create WhatsApp Platform"})]})]})})})},ave=({isOpen:e,onClose:t,onSubmit:n,isSubmitting:r=!1})=>{const{toast:s}=uu(),{user:i}=Ar(),{hasPermission:o,hasRole:l}=Nr(),{aiAgents:c,loading:u}=n0(),{agents:d,loading:h}=Ql(),{uploadChannelAvatar:f}=Jz(),[m,g]=p.useState({displayName:"",description:"",telegramBotToken:"",selectedAIAgent:"",selectedHumanAgents:[],profilePhoto:null}),[v,y]=p.useState(!1),[x,w]=p.useState(null),[b,_]=p.useState(!1),[k,j]=p.useState(null),S=(m.telegramBotToken||"").trim(),T=!!k&&k===S,O=o("channels.create"),A=l("super_agent");p.useEffect(()=>{e&&A&&i!=null&&i.id&&(w(i.id),g(z=>({...z,selectedAIAgent:"",selectedHumanAgents:[]})))},[e,A,i==null?void 0:i.id]);const N=p.useMemo(()=>x&&d.find(z=>z.primaryRole==="super_agent"&&z.user_id===x)||null,[x,d]),L=!!(m.displayName&&m.selectedAIAgent&&m.telegramBotToken&&x&&O&&T),M=async()=>{if(!i)return null;const{data:z}=await le.from("org_members").select("org_id").eq("user_id",i.id).single();return(z==null?void 0:z.org_id)||null},B=async()=>{const z=(m.telegramBotToken||"").trim();if(!z){s({title:"Telegram bot token required",description:"Enter your BotFather token before validating.",variant:"destructive"});return}try{_(!0);const R=await M(),C={telegram_bot_token:z};R&&(C.org_id=R);const D=await Ns(Nn.ENDPOINTS.TELEGRAM.VERIFY_TOKEN,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(C)});let E=null;try{const I=await D.text();E=I?JSON.parse(I):null}catch{throw new Error("Token is invalid")}if(!D.ok)throw new Error("Token is invalid");if(E===null||typeof E!="object"||Array.isArray(E))throw new Error("Token is invalid");const F=E.valid;if(typeof F!="boolean")throw new Error("Token is invalid");if(F!==!0)throw new Error("Token is invalid");j(z),s({title:"Token validated",description:"Telegram bot token has been successfully verified."})}catch(R){console.error("Telegram token validation failed:",R),j(null);const C=R&&typeof R.message=="string"?R.message:"",D=String(C).toLowerCase();s({title:"Validation failed",description:D.includes("empty")||D.includes("required")?C||"Telegram bot token is required":"Token is invalid",variant:"destructive"})}finally{_(!1)}},$=async()=>{var z;try{if(v)return;if(y(!0),!O){s({title:"Permission denied",description:"You do not have permission to create channels.",variant:"destructive"}),y(!1);return}if(!x||!m.selectedAIAgent){s({title:"Missing required fields",description:"Please select a Super Agent and an AI Agent.",variant:"destructive"}),y(!1);return}if(!T){s({title:"Token validation required",description:"You must validate the Telegram bot token before creating this platform.",variant:"destructive"}),y(!1);return}const R=await M();if(!R)throw new Error("User not found in any organization");const C=(m.telegramBotToken||"").trim();if(!C)throw new Error("Telegram bot token is required");try{const{data:I}=await le.from("channels").select("id").eq("provider","telegram").eq("external_id",C).limit(1);if(Array.isArray(I)&&I.length>0){s({title:"Duplicate token",description:"A Telegram bot with this BotFather token already exists.",variant:"destructive"}),y(!1);return}}catch{}const D={brand_name:m.displayName,display_name:m.displayName,description:m.description,telegram_bot_token:m.telegramBotToken,ai_profile_id:m.selectedAIAgent,human_agent_ids:m.selectedHumanAgents,super_agent_id:x,org_id:R,platform_type:"telegram"},E=await Ns(Nn.ENDPOINTS.TELEGRAM.CREATE_PLATFORM,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(D)});if(!E.ok)throw new Error(`Telegram webhook failed with status ${E.status}`);let F=null;try{if((E.headers.get("content-type")||"").includes("application/json"))F=await E.json();else{const P=await E.text();try{F=P?JSON.parse(P):null}catch{F={raw:P||null}}}}catch{F=null}try{if(m.profilePhoto){let I=(F==null?void 0:F.channel_id)||(F==null?void 0:F.id)||((z=F==null?void 0:F.channel)==null?void 0:z.id)||null;if(!I){const{data:P}=await le.from("channels").select("id").eq("org_id",R).eq("provider","telegram").eq("external_id",C).limit(1).maybeSingle();I=(P==null?void 0:P.id)||null}I&&await f(I,m.profilePhoto,R)}}catch(I){console.warn("Telegram avatar upload failed:",I)}s({title:"Success",description:"Telegram channel created successfully"});try{window.dispatchEvent(new CustomEvent("refresh-platforms"))}catch{}t(),g({displayName:"",description:"",telegramBotToken:"",selectedAIAgent:"",selectedHumanAgents:[],profilePhoto:null}),w(null)}catch(R){console.error("Error submitting form:",R),s({title:"Error",description:R.message||"Failed to create Telegram platform",variant:"destructive"})}finally{y(!1)}};return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsx(un,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",style:{overflowX:"visible",overflowY:"auto"},children:a.jsxs("div",{children:[a.jsxs(dn,{children:[a.jsx(hn,{children:"Setup Telegram Bot Platform"}),a.jsx(Hr,{children:"Configure your new Telegram bot platform with all the necessary information."})]}),a.jsxs("div",{className:"mt-6 space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"displayName",children:"Display Name *"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Nama yang akan ditampilkan di widget chat Telegram"})})]})]}),a.jsx(it,{id:"displayName",placeholder:"Enter the display name",value:m.displayName,onChange:z=>g(R=>({...R,displayName:z.target.value}))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"description",children:"Description"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Deskripsi bisnis dan layanan yang akan ditampilkan kepada pelanggan"})})]})]}),a.jsx(qr,{id:"description",placeholder:"Describe your business and what you offer",value:m.description,onChange:z=>g(R=>({...R,description:z.target.value})),rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"profilePhoto",children:"Profile Photo / Logo"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Foto profil atau logo yang akan ditampilkan di bot Telegram"})})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"h-16 w-16 rounded-full bg-muted flex items-center justify-center border-2 border-dashed border-muted-foreground/25",children:m.profilePhoto?a.jsx("img",{src:URL.createObjectURL(m.profilePhoto),alt:"Profile",className:"h-16 w-16 rounded-full object-cover"}):a.jsx(Kc,{className:"h-6 w-6 text-muted-foreground"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx(it,{id:"profilePhoto",type:"file",accept:"image/*",onChange:z=>{var C;const R=((C=z.target.files)==null?void 0:C[0])||null;g(D=>({...D,profilePhoto:R}))},className:"hidden"}),a.jsxs(se,{variant:"outline",onClick:()=>{var z;return(z=document.getElementById("profilePhoto"))==null?void 0:z.click()},children:[a.jsx(Kc,{className:"h-4 w-4 mr-2"})," Upload Photo"]})]})]})]}),a.jsxs("div",{className:"space-y-4 p-4 border rounded-lg bg-muted/50",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx(Qe,{className:"text-sm font-medium",children:"Telegram Bot Setup"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Follow these steps to set up your Telegram bot"})]})}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"text-sm space-y-2",children:[a.jsx("p",{className:"font-medium",children:"Step 1: Create a bot with BotFather"}),a.jsxs("ol",{className:"list-decimal list-inside text-xs space-y-1 ml-2",children:[a.jsx("li",{children:"Open Telegram and search for @BotFather"}),a.jsx("li",{children:"Send /newbot command"}),a.jsx("li",{children:"Choose a name for your bot (organization name)"}),a.jsx("li",{children:"Choose a username (must end with 'bot')"}),a.jsx("li",{children:"Copy the bot token provided"})]})]}),a.jsxs("div",{className:"text-sm space-y-2",children:[a.jsx("p",{className:"font-medium",children:"Step 2: Configure bot settings"}),a.jsxs("ol",{className:"list-decimal list-inside text-xs space-y-1 ml-2",children:[a.jsx("li",{children:"Send /setdescription to set bot description"}),a.jsx("li",{children:"Send /setabouttext to set about text"}),a.jsx("li",{children:"Send /setcommands to set available commands"})]})]}),a.jsxs("div",{className:"text-sm space-y-2",children:[a.jsx("p",{className:"font-medium",children:"Step 3: Enable webhook (optional)"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Your bot will automatically receive messages once connected to our platform."})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"telegramBotToken",children:"Telegram Bot Token *"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Token bot Telegram yang diperoleh dari @BotFather untuk mengautentikasi bot"})})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(it,{id:"telegramBotToken",type:"password",placeholder:"1234567890:ABCdefGHIjklMNOpqrsTUVwxyz",value:m.telegramBotToken,onChange:z=>{const R=z.target.value;g(C=>({...C,telegramBotToken:R})),j(null)},className:"flex-1"}),a.jsx(se,{type:"button",variant:T?"outline":"default",className:T?"border-emerald-600 text-emerald-700 hover:bg-emerald-50":"",onClick:B,disabled:b||!m.telegramBotToken,children:b?a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin"}),"Validating"]}):"Validate"})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Get this token from @BotFather on Telegram. Format: 1234567890:ABCdefGHIjklMNOpqrsTUVwxyz"}),T&&a.jsx("p",{className:"text-xs text-emerald-600",children:"Bot token validated. You can now create this Telegram platform."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{children:"Super Agent *"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Super Agent yang akan mengawasi dan mengelola platform Telegram ini"})})]})]}),h?a.jsx("div",{className:"rounded-md border bg-muted px-3 py-2 text-sm",children:"Loading super agents..."}):a.jsxs(tn,{value:x||"",onValueChange:z=>{w(z),g(R=>({...R,selectedAIAgent:"",selectedHumanAgents:[]}))},disabled:A,children:[a.jsx(Jt,{children:a.jsx(Gt,{placeholder:"Choose a Super Agent"})}),a.jsx(Qt,{className:"bg-background border z-50",children:d.filter(z=>z.primaryRole==="super_agent").map(z=>a.jsx(st,{value:z.user_id,children:z.display_name||z.email||z.user_id.slice(0,8)},z.user_id))})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Default mengikuti super agent pada AI agent terpilih. Anda bisa mengubahnya di sini."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"aiAgent",children:"Select AI Agent *"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Agen AI yang akan menangani percakapan otomatis di platform Telegram ini"})})]})]}),u?a.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading AI agents..."}):a.jsxs(tn,{value:m.selectedAIAgent,onValueChange:z=>{const R=c.find(C=>C.id===z);if(!x){s({title:"Select a Super Agent first",description:"Pilih super agent terlebih dahulu, lalu pilih AI agent.",variant:"destructive"});return}if(!R||R.super_agent_id!==x){s({title:"AI agent tidak sesuai",description:"AI agent yang dipilih tidak berada di bawah super agent terpilih.",variant:"destructive"});return}g(C=>({...C,selectedAIAgent:z,selectedHumanAgents:[]}))},children:[a.jsx(Jt,{children:a.jsx(Gt,{placeholder:x?"Choose an AI agent":"Select a Super Agent first"})}),a.jsx(Qt,{className:"bg-background border z-50",children:c.filter(z=>x?z.super_agent_id===x:!1).map(z=>a.jsx(st,{value:z.id,children:z.name},z.id))})]}),x&&a.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-md bg-muted px-3 py-1 text-xs text-muted-foreground",children:[a.jsx("span",{children:"Super Agent:"}),a.jsx("span",{className:"font-medium",children:(N==null?void 0:N.display_name)||(N==null?void 0:N.email)||x.slice(0,8)})]})]}),m.selectedAIAgent&&!x&&a.jsx("p",{className:"text-xs text-amber-600",children:"AI agent terpilih belum memiliki super agent. Tetapkan super agent di halaman AI Agents terlebih dahulu."}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{children:"Select Human Agents (optional)"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Agen manusia yang akan menangani percakapan yang memerlukan intervensi manual"})})]})]}),h?a.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading human agents..."}):(()=>{const R=d.filter(C=>C.primaryRole==="agent").filter(C=>!!x&&C.super_agent_id===x).map(C=>({value:C.user_id,label:C.display_name||C.email||`Agent ${C.user_id.slice(0,8)}`}));return a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(r0,{options:R,value:m.selectedHumanAgents,onValueChange:C=>g(D=>({...D,selectedHumanAgents:C})),disabled:!x,placeholder:x?"Select human agents":"Select an AI agent first"}),a.jsx(se,{type:"button",variant:"outline",disabled:!x||R.length===0,onClick:()=>g(C=>({...C,selectedHumanAgents:R.map(D=>D.value)})),children:"Select All"}),a.jsx(se,{type:"button",variant:"ghost",disabled:!x||m.selectedHumanAgents.length===0,onClick:()=>g(C=>({...C,selectedHumanAgents:[]})),children:"Unselect All"})]})})()]})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx(se,{variant:"outline",onClick:()=>{v||(g({displayName:"",description:"",telegramBotToken:"",selectedAIAgent:"",selectedHumanAgents:[],profilePhoto:null}),w(null),t())},disabled:r||v,children:"Cancel"}),a.jsx(se,{onClick:$,disabled:r||v||!L,className:"bg-blue-600 hover:bg-blue-700 text-white",children:r||v?a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin"})," Creating..."]}):"Create Telegram Bot Platform"})]})]})})})},sve=({isOpen:e,onClose:t,onSubmit:n,isSubmitting:r=!1})=>{const{toast:s}=uu(),{user:i}=Ar(),{hasPermission:o,hasRole:l}=Nr(),{aiAgents:c,loading:u}=n0(),{agents:d,loading:h}=Ql(),[f,m]=p.useState({description:"",displayName:"",websiteUrl:"",businessCategory:"",selectedAIAgent:"",selectedHumanAgents:[],profilePhoto:null}),[g,v]=p.useState(!1),[y,x]=p.useState(null),w=o("channels.create"),b=l("super_agent");p.useEffect(()=>{e&&b&&i!=null&&i.id&&(x(i.id),m(T=>({...T,selectedAIAgent:"",selectedHumanAgents:[]})))},[e,b,i==null?void 0:i.id]);const _=p.useMemo(()=>y&&d.find(T=>T.primaryRole==="super_agent"&&T.user_id===y)||null,[y,d]),k=!!(f.displayName&&y&&f.selectedAIAgent&&w),j=async()=>{try{if(g)return;if(!w){s({title:"Permission denied",description:"You do not have permission to create channels.",variant:"destructive"});return}if(!y||!f.selectedAIAgent){s({title:"Missing required fields",description:"Please select a Super Agent and an AI Agent.",variant:"destructive"});return}v(!0);const T={...f,platformType:"web",selectedSuperAgentId:y};await n(T);try{window.dispatchEvent(new CustomEvent("refresh-platforms"))}catch{}m({description:"",displayName:"",websiteUrl:"",businessCategory:"",selectedAIAgent:"",selectedHumanAgents:[],profilePhoto:null}),x(null),t()}catch(T){console.error("Error submitting form:",T)}finally{v(!1)}},S=()=>{g||(m({description:"",displayName:"",websiteUrl:"",businessCategory:"",selectedAIAgent:"",selectedHumanAgents:[],profilePhoto:null}),x(null),t())};return a.jsx(xn,{open:e,onOpenChange:t,children:a.jsx(un,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",style:{overflowX:"visible",overflowY:"auto"},children:a.jsxs("div",{children:[a.jsxs(dn,{children:[a.jsx(hn,{children:"Setup Web Live Chat Platform"}),a.jsx(Hr,{children:"Configure your new web live chat platform with all the necessary information."})]}),a.jsxs("div",{className:"mt-6 space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"description",children:"Description"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Deskripsi bisnis dan layanan yang akan ditampilkan kepada pelanggan"})})]})]}),a.jsx(qr,{id:"description",placeholder:"Describe your business and what you offer",value:f.description,onChange:T=>m(O=>({...O,description:T.target.value})),rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"profilePhoto",children:"Profile Photo / Logo"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Foto profil atau logo yang akan ditampilkan di widget live chat"})})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"h-16 w-16 rounded-full bg-muted flex items-center justify-center border-2 border-dashed border-muted-foreground/25",children:f.profilePhoto?a.jsx("img",{src:URL.createObjectURL(f.profilePhoto),alt:"Profile",className:"h-16 w-16 rounded-full object-cover"}):a.jsx(Kc,{className:"h-6 w-6 text-muted-foreground"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx(it,{id:"profilePhoto",type:"file",accept:"image/*",onChange:T=>{var A;const O=((A=T.target.files)==null?void 0:A[0])||null;m(N=>({...N,profilePhoto:O}))},className:"hidden"}),a.jsxs(se,{variant:"outline",onClick:()=>{var T;return(T=document.getElementById("profilePhoto"))==null?void 0:T.click()},children:[a.jsx(Kc,{className:"h-4 w-4 mr-2"})," Upload Photo"]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"displayName",children:"Display Name *"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Nama yang akan ditampilkan di widget live chat"})})]})]}),a.jsx(it,{id:"displayName",placeholder:"Name that will appear in the chat widget",value:f.displayName,onChange:T=>m(O=>({...O,displayName:T.target.value}))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{children:"Super Agent *"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Super Agent yang akan mengawasi dan mengelola platform Live Chat ini"})})]})]}),h?a.jsx("div",{className:"rounded-md border bg-muted px-3 py-2 text-sm",children:"Loading super agents..."}):a.jsxs(tn,{value:y||"",onValueChange:T=>{x(T),m(O=>({...O,selectedAIAgent:"",selectedHumanAgents:[]}))},disabled:b,children:[a.jsx(Jt,{children:a.jsx(Gt,{placeholder:"Choose a Super Agent"})}),a.jsx(Qt,{className:"bg-background border z-50",children:d.filter(T=>T.primaryRole==="super_agent").map(T=>a.jsx(st,{value:T.user_id,children:T.display_name||T.email||T.user_id.slice(0,8)},T.user_id))})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Default mengikuti super agent pada AI agent terpilih. Anda bisa mengubahnya di sini."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"aiAgent",children:"Select AI Agent *"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Agen AI yang akan menangani percakapan otomatis di platform Live Chat ini"})})]})]}),u?a.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading AI agents..."}):a.jsxs(tn,{value:f.selectedAIAgent,onValueChange:T=>{const O=c.find(A=>A.id===T);if(!y){s({title:"Select a Super Agent first",description:"Pilih super agent terlebih dahulu, lalu pilih AI agent.",variant:"destructive"});return}if(!O||O.super_agent_id!==y){s({title:"AI agent tidak sesuai",description:"AI agent yang dipilih tidak berada di bawah super agent terpilih.",variant:"destructive"});return}m(A=>({...A,selectedAIAgent:T,selectedHumanAgents:[]}))},children:[a.jsx(Jt,{children:a.jsx(Gt,{placeholder:y?"Choose an AI agent":"Select a Super Agent first"})}),a.jsx(Qt,{className:"bg-background border z-50",children:c.filter(T=>y?T.super_agent_id===y:!1).map(T=>a.jsx(st,{value:T.id,children:T.name},T.id))})]}),y&&a.jsxs("div",{className:"mt-2 inline-flex items-center gap-2 rounded-md bg-muted px-3 py-1 text-xs text-muted-foreground",children:[a.jsx("span",{children:"Super Agent:"}),a.jsx("span",{className:"font-medium",children:(_==null?void 0:_.display_name)||(_==null?void 0:_.email)||y.slice(0,8)})]})]}),f.selectedAIAgent&&!y&&a.jsx("p",{className:"text-xs text-amber-600",children:"AI agent terpilih belum memiliki super agent. Tetapkan super agent di halaman AI Agents terlebih dahulu."}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{children:"Assign Agents"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{className:"z-[9999] max-w-xs",side:"top",align:"start",sideOffset:5,avoidCollisions:!0,collisionPadding:20,sticky:"always",children:a.jsx("p",{children:"Agen manusia yang akan menangani percakapan yang memerlukan intervensi manual"})})]})]}),h?a.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading human agents..."}):a.jsx(a.Fragment,{children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"text-xs font-medium",children:["Agents ",y?"":"(select an AI agent first)"]}),(()=>{const O=d.filter(A=>A.primaryRole==="agent").filter(A=>!!y&&A.super_agent_id===y).map(A=>({value:A.user_id,label:A.display_name||A.email||`Agent ${A.user_id.slice(0,8)}`}));return a.jsx(a.Fragment,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(r0,{options:O,value:f.selectedHumanAgents,onValueChange:A=>m(N=>({...N,selectedHumanAgents:A})),disabled:!y,placeholder:y?"Select human agents":"Select an AI agent first"}),a.jsx(se,{type:"button",variant:"outline",disabled:!y||O.length===0,onClick:()=>m(A=>({...A,selectedHumanAgents:O.map(N=>N.value)})),children:"Select All"}),a.jsx(se,{type:"button",variant:"ghost",disabled:!y||f.selectedHumanAgents.length===0,onClick:()=>m(A=>({...A,selectedHumanAgents:[]})),children:"Unselect All"})]})})})()]})})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx(se,{variant:"outline",onClick:S,disabled:r||g,children:"Cancel"}),a.jsx(se,{onClick:j,disabled:r||g||!k,children:r||g?a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin"})," Creating..."]}):"Create Web Live Chat Platform"})]})]})})})},nn=p.forwardRef(({permission:e,permissions:t=[],requireAll:n=!1,fallback:r=null,children:s,roleBypass:i=[]},o)=>{const{hasAnyPermission:l,hasAllPermissions:c,hasAnyRole:u,loading:d}=Nr();if(d)return null;const h=e?[e,...t]:t,f=i.length>0?u(i):!1,m=h.length===0?!0:n?c(h):l(h),g=f||m,v=!Array.isArray(s)&&typeof s!="string"&&typeof s!="number";return g?v?a.jsx(bN,{ref:o,children:s}):a.jsx(a.Fragment,{children:s}):a.jsx(a.Fragment,{children:r})}),yn={MASTER_AGENT:"master_agent",SUPER_AGENT:"super_agent",AGENT:"agent"},ive=()=>{var be;const{toast:e}=uu(),{platforms:t,loading:n,error:r,createPlatform:s,fetchPlatforms:i,updatePlatform:o,uploadChannelAvatar:l,deleteChannelAvatar:c}=Jz(),{aiAgents:u,loading:d}=n0(),{agents:h,loading:f}=Ql(),{fetchByOrgId:m,channelsByOrg:g}=tve(),{hasRole:v}=Nr(),[y,x]=p.useState(null),[w,b]=p.useState("whatsapp"),[_,k]=p.useState(""),[j,S]=p.useState(!1),[T,O]=p.useState(null),[A,N]=p.useState(!1),[L,M]=p.useState(!1),[B,$]=p.useState([]),[z,R]=p.useState(!1),[C,D]=p.useState(!1),E=p.useRef(null),[F,I]=p.useState([]),[P,U]=p.useState(!1),[Z,X]=p.useState(null),[K,ie]=p.useState(new Set),[H,he]=p.useState(new Set),[me,ae]=p.useState(null),[Ne,de]=p.useState(null),[Q,fe]=p.useState(null),[Be,je]=p.useState(!1),[Ce,Ze]=p.useState(null),rt=p.useRef(null),[Je,te]=p.useState(!1),We=p.useRef(null),Ue=p.useRef(!1),ue=p.useRef(0);p.useEffect(()=>{t.length>0&&!y&&x(t[0].id)},[t,y]),p.useEffect(()=>{u.length>0&&!_&&k(u[0].id)},[u,_]);const xe=ee=>{const oe=ee==null?void 0:ee.provider;return oe==="whatsapp"?"whatsapp":oe==="telegram"?"telegram":"web"};p.useEffect(()=>{const ee=t.find(oe=>xe(oe)===w);(!y||y&&t.find(oe=>oe.id===y&&xe(oe)!==w))&&x((ee==null?void 0:ee.id)||null)},[t,w]);const ce=t.find(ee=>ee.id===y);p.useEffect(()=>{k(ce&&(ce==null?void 0:ce.ai_profile_id)||"")},[ce==null?void 0:ce.id,ce==null?void 0:ce.ai_profile_id]),p.useEffect(()=>{const ee=Array.from(new Set(t.map(oe=>oe.org_id)));ee.length!==0&&Promise.resolve().then(()=>{ee.forEach(oe=>{m(oe)})})},[t]),p.useEffect(()=>{const ee=()=>{i()};return window.addEventListener("refresh-platforms",ee),()=>window.removeEventListener("refresh-platforms",ee)},[i]);const qe=ce?xe(ce):null,Se=(ce==null?void 0:ce.human_agents)||[],nt=(ce==null?void 0:ce.super_agent_id)??null,vt=v("master_agent")||v("super_agent"),wt=h.filter(ee=>{const oe=nt?ee.super_agent_id===nt:!0;return ee.primaryRole==="agent"&&oe&&!Se.some(Ee=>Ee.user_id===ee.user_id)}).map(ee=>({value:ee.user_id,label:ee.display_name||ee.email||ee.user_id.slice(0,8)})),ht=nt?u.filter(ee=>ee.super_agent_id===nt||ee.id===(ce==null?void 0:ce.ai_profile_id)):u,_t=async ee=>{if(!ce||!vt){$([]);return}if(ee.length===0){$([]);return}$(ee);try{M(!0);const oe=Se.map(Xe=>Xe.user_id),Ee=Array.from(new Set([...oe,...ee]));await o(ce.id,{human_agent_ids:Ee})}catch(oe){e({title:"Failed to add agent",description:(oe==null?void 0:oe.message)||"Please try again",variant:"destructive"})}finally{M(!1),$([])}},Wt=ee=>a.jsxs(a.Fragment,{children:[a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{className:"text-base flex items-center gap-2",children:["Super Agent",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Super Agent yang akan mengawasi dan mengelola platform ini (hanya master agent yang dapat mengatur)"})})]})]})}),a.jsx(lt,{children:(()=>{const oe=(ce==null?void 0:ce.super_agent_id)||null,Xe=(h||[]).find($e=>$e.user_id===oe&&$e.primaryRole==="super_agent")||null;return a.jsxs("div",{className:"text-sm space-y-2",children:[Xe?a.jsxs("div",{className:"inline-flex items-center gap-2 bg-muted px-3 py-1 rounded-md",children:[" ",Xe.display_name||Xe.email||Xe.user_id.slice(0,8)]}):a.jsx("span",{className:"text-muted-foreground",children:"No super agent assigned. Select an AI agent to link a super agent."}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Super agent assignment follows the selected AI agent. To change ownership, switch the AI agent for this platform."})]})})()})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{className:"text-base flex items-center gap-2",children:["AI Agent",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Agen AI yang akan menangani percakapan otomatis di platform ini"})})]})]})}),a.jsx(lt,{children:d?a.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading AI agents..."}):a.jsxs(tn,{value:_||"",onValueChange:async oe=>{ce&&(await o(ce.id,{ai_profile_id:oe||void 0}),k(oe))},children:[a.jsx(Jt,{children:a.jsx(Gt,{placeholder:"Choose an AI agent"})}),a.jsx(Qt,{children:ht.map(oe=>a.jsxs(st,{value:oe.id,children:[" ",oe.name]},oe.id))})]})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{className:"text-base flex items-center gap-2",children:["Human Agent",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Agen manusia yang akan menangani percakapan yang memerlukan intervensi manual"})})]})]})}),a.jsxs(lt,{children:[f?a.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading human agents..."}):Se.length>0?a.jsx("div",{className:"flex flex-wrap gap-2",children:Se.map(oe=>a.jsxs("div",{className:"flex items-center gap-2 bg-muted px-3 py-1 rounded-md",children:[a.jsxs("span",{className:"text-sm",children:[" ",oe.display_name||oe.email||oe.user_id]}),vt&&a.jsx(se,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0",disabled:L||!ce,onClick:async()=>{if(ce)try{M(!0);const Ee=Se.filter(Xe=>Xe.user_id!==oe.user_id).map(Xe=>Xe.user_id);await o(ce.id,{human_agent_ids:Ee})}finally{M(!1)}},children:a.jsx(Nh,{className:"h-3 w-3"})})]},oe.user_id))}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No agents connected"}),vt&&ce&&a.jsx("div",{className:"mt-3 flex items-center gap-2",children:a.jsx(nn,{permission:"channel_agents.update",roleBypass:[yn.SUPER_AGENT],children:a.jsx(r0,{options:wt,value:B,onChange:_t,placeholder:"Select human agents to add",disabled:L})})})]})]}),ee&&a.jsxs(a.Fragment,{children:[a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{className:"text-base flex items-center gap-2",children:["Link LiveChat",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"URL untuk live chat widget yang dapat diembed di website"})})]})]})}),a.jsx(lt,{children:a.jsx("div",{className:"bg-muted p-3 rounded-md",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(it,{value:NO(String((ce==null?void 0:ce.id)||"{platform_id}")),readOnly:!0,className:"bg-background flex-1"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"outline",size:"icon",className:"h-9 w-9 shrink-0",onClick:async()=>{const oe=NO(String((ce==null?void 0:ce.id)||"{platform_id}"));try{await navigator.clipboard.writeText(oe),e({title:"Copied!",description:"Live chat URL copied to clipboard"})}catch{e({title:"Failed to copy",description:"Please try again",variant:"destructive"})}},children:a.jsx(qf,{className:"h-4 w-4"})})}),a.jsx(ge,{children:a.jsx("p",{children:"Copy URL"})})]})]})})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{className:"text-base flex items-center gap-2",children:["Embed Code",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Kode embed untuk menambahkan widget live chat ke website"})})]})]})}),a.jsx(lt,{children:a.jsxs("div",{className:"relative",children:[a.jsx(qr,{value:`<!-- Step 1: Set your config (EDIT THIS) -->
<script>
window.chatConfig = {
  username: document.querySelector('.navbar-right strong').innerText.trim(),   // Your user's identifier (e.g. 'simegantara')
  web: '',        // Your site/brand name  (e.g. 'beat4d')
};
<\/script>

<!-- Step 2: Chat widget loader (DO NOT EDIT BELOW) -->
<script>
(function(){
  var w=window,d=document; if(w.chatWidgetLoaded) return; w.chatWidgetLoaded=true;
  var cfg=w.chatConfig||{}; cfg.baseUrl='${ek}'; cfg.platformId='${(ce==null?void 0:ce.id)||"{platform_id}"}';
  cfg.width=cfg.width||'360px'; cfg.height=cfg.height||'560px';
  var css='#chat-bubble{position:fixed;right:20px;bottom:20px;z-index:999999;background:#1d4ed8;color:#fff;border-radius:9999px;width:56px;height:56px;box-shadow:0 8px 20px rgba(0,0,0,.2);border:0;cursor:pointer;font-size:24px;line-height:56px;text-align:center}'+
           '#chat-panel{position:fixed;right:20px;bottom:92px;width:'+cfg.width+';height:'+cfg.height+';max-width:calc(100% - 40px);max-height:70vh;z-index:999999;box-shadow:0 10px 30px rgba(0,0,0,.25);border-radius:12px;overflow:hidden;opacity:0;transform:translateY(10px);pointer-events:none;transition:opacity .2s ease,transform .2s ease;background:#fff}'+
           '#chat-panel.open{opacity:1;transform:translateY(0);pointer-events:auto}';
  var s=d.createElement('style'); s.type='text/css'; s.appendChild(d.createTextNode(css)); d.head.appendChild(s);
  var bubble=d.createElement('button'); bubble.id='chat-bubble'; bubble.setAttribute('aria-label','Open chat'); bubble.innerHTML='';
  var panel=d.createElement('div'); panel.id='chat-panel';
  var iframeSrc=cfg.baseUrl+'/livechat/'+encodeURIComponent(cfg.platformId); var qs=[];
  if(cfg.username) qs.push('username='+encodeURIComponent(cfg.username));
  if(cfg.web) qs.push('web='+encodeURIComponent(cfg.web));
  if(qs.length) iframeSrc+='?'+qs.join('&');
  var iframe=d.createElement('iframe'); iframe.src=iframeSrc; iframe.style.width='100%'; iframe.style.height='100%'; iframe.style.border='0'; panel.appendChild(iframe);
  bubble.addEventListener('click',function(){ panel.classList.toggle('open'); });
  d.body.appendChild(bubble); d.body.appendChild(panel);
})();
<\/script>`,readOnly:!0,className:"font-mono text-xs h-48 bg-muted pr-12"}),a.jsx("div",{className:"absolute top-2 right-2",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"outline",size:"icon",className:"h-8 w-8",onClick:async()=>{const oe=`<!-- Step 1: Set your config (EDIT THIS) -->
<script>
window.chatConfig = {
  username: document.querySelector('.navbar-right strong').innerText.trim(),   // Your user's identifier (e.g. 'simegantara')
  web: '',        // Your site/brand name  (e.g. 'beat4d')
};
<\/script>

<!-- Step 2: Chat widget loader (DO NOT EDIT BELOW) -->
<script>
(function(){
  var w=window,d=document; if(w.chatWidgetLoaded) return; w.chatWidgetLoaded=true;
  var cfg=w.chatConfig||{}; cfg.baseUrl='${ek}'; cfg.platformId='${(ce==null?void 0:ce.id)||"{platform_id}"}';
  cfg.width=cfg.width||'360px'; cfg.height=cfg.height||'560px';
  var css='#chat-bubble{position:fixed;right:20px;bottom:20px;z-index:999999;background:#1d4ed8;color:#fff;border-radius:9999px;width:56px;height:56px;box-shadow:0 8px 20px rgba(0,0,0,.2);border:0;cursor:pointer;font-size:24px;line-height:56px;text-align:center}'+
           '#chat-panel{position:fixed;right:20px;bottom:92px;width:'+cfg.width+';height:'+cfg.height+';max-width:calc(100% - 40px);max-height:70vh;z-index:999999;box-shadow:0 10px 30px rgba(0,0,0,.25);border-radius:12px;overflow:hidden;opacity:0;transform:translateY(10px);pointer-events:none;transition:opacity .2s ease,transform .2s ease;background:#fff}'+
           '#chat-panel.open{opacity:1;transform:translateY(0);pointer-events:auto}';
  var s=d.createElement('style'); s.type='text/css'; s.appendChild(d.createTextNode(css)); d.head.appendChild(s);
  var bubble=d.createElement('button'); bubble.id='chat-bubble'; bubble.setAttribute('aria-label','Open chat'); bubble.innerHTML='\\uD83D\\uDCAC';
  var panel=d.createElement('div'); panel.id='chat-panel';
  var iframeSrc=cfg.baseUrl+'/livechat/'+encodeURIComponent(cfg.platformId); var qs=[];
  if(cfg.username) qs.push('username='+encodeURIComponent(cfg.username));
  if(cfg.web) qs.push('web='+encodeURIComponent(cfg.web));
  if(qs.length) iframeSrc+='?'+qs.join('&');
  var iframe=d.createElement('iframe'); iframe.src=iframeSrc; iframe.style.width='100%'; iframe.style.height='100%'; iframe.style.border='0'; panel.appendChild(iframe);
  bubble.addEventListener('click',function(){ panel.classList.toggle('open'); });
  d.body.appendChild(bubble); d.body.appendChild(panel);
})();
<\/script>`;try{await navigator.clipboard.writeText(oe),e({title:"Copied!",description:"Embed code copied to clipboard"})}catch{e({title:"Failed to copy",description:"Please try again",variant:"destructive"})}},children:a.jsx(qf,{className:"h-4 w-4"})})}),a.jsx(ge,{children:a.jsx("p",{children:"Copy embed code"})})]})})]})})]})]})]}),pe=ee=>{O(ee),S(!1)},Oe=async ee=>{try{N(!0);const oe={display_name:ee.displayName||ee.platformName||ee.brandName,website_url:ee.websiteUrl||void 0,business_category:ee.businessCategory||void 0,description:ee.description||void 0,ai_profile_id:ee.selectedAIAgent||void 0,provider:T||"web",human_agent_ids:ee.selectedHumanAgents},Ee=await s(oe);if(Ee&&ee.profilePhoto)try{await l(Ee.id,ee.profilePhoto,Ee.org_id)}catch(Xe){e({title:"Avatar upload failed",description:(Xe==null?void 0:Xe.message)||"Could not upload avatar",variant:"destructive"})}e({title:"Success",description:"Platform created successfully!"}),O(null)}catch(oe){e({title:"Error",description:oe.message||"Failed to create platform",variant:"destructive"})}finally{N(!1)}},W=p.useRef([]),q=async()=>{if(!Ue.current){Ue.current=!0,U(!0),X(null);try{const ee=`${Hv}/api/sessions`,oe=await fetch(ee,{method:"GET",headers:{"Content-Type":"application/json","x-api-key":"asd"}});if(!oe.ok)throw new Error(`Request failed with status ${oe.status}`);const Ee=await oe.json(),Xe=Array.isArray(Ee)?Ee:[Ee];I(Xe),W.current=Xe,await Y(Xe),Date.now()>=ue.current&&(ue.current=Date.now()+2e3,await i())}catch(ee){X((ee==null?void 0:ee.message)||"Failed to load sessions")}finally{U(!1),Ue.current=!1}}},Y=async ee=>{var oe,Ee,Xe;try{const{data:$e}=await le.auth.getUser(),jt=$e==null?void 0:$e.user;if(!jt)return;const{data:et}=await le.from("org_members").select("org_id").eq("user_id",jt.id).limit(1),It=(oe=et==null?void 0:et[0])==null?void 0:oe.org_id;if(!It)return;const{data:Rt}=await le.from("channels").select("id, display_name, provider, external_id, credentials").eq("org_id",It).eq("provider","whatsapp");for(const En of ee){const Vn=(En==null?void 0:En.name)||"";if(!Vn)continue;const Ln=String((En==null?void 0:En.status)||"").toUpperCase();let Yr=((Ee=En==null?void 0:En.me)==null?void 0:Ee.id)||null;if(!Yr&&Ln==="WORKING")try{const ft=`${Hv}/api/sessions/${encodeURIComponent(Vn)}`,Ja=await fetch(ft,{method:"GET",headers:{"Content-Type":"application/json","x-api-key":"asd"}});if(Ja.ok){const ur=await Ja.json(),Xr=Array.isArray(ur)?ur[0]:ur;Yr=((Xe=Xr==null?void 0:Xr.me)==null?void 0:Xe.id)||Yr}}catch{}const Ca=Ln==="WORKING"&&!!Yr,cr=(Vn||"").toLowerCase().replace(/\s/g,""),Tn=(Rt||[]).find(ft=>(ft.display_name||"").toLowerCase().replace(/\s/g,"")===cr);if(!Tn)continue;const pn=Tn!=null&&Tn.credentials&&typeof Tn.credentials=="object"?Tn.credentials:{},ua=Vn||cr||null,Qn=Yr||(Tn==null?void 0:Tn.external_id)||(pn==null?void 0:pn.waha_session_name)||ua;await le.from("channels").update({is_active:Ca,external_id:Qn,credentials:{...pn,waha_status:(En==null?void 0:En.status)||null,me_id:Yr,waha_session_name:(pn==null?void 0:pn.waha_session_name)||ua}}).eq("id",Tn.id)}}catch($e){console.error("Failed to sync sessions to channels",$e)}};p.useEffect(()=>{qe==="whatsapp"&&We.current!=="whatsapp"&&(We.current="whatsapp",q()),qe!=="whatsapp"&&(We.current=qe||null)},[qe]),p.useEffect(()=>{const ee=oe=>{const Ee=(oe==null?void 0:oe.detail)||{};de(Ee.qr||null),Ee.sessionName&&Ze(Ee.sessionName),je(!0)};return window.addEventListener("open-wa-qr",ee),()=>window.removeEventListener("open-wa-qr",ee)},[]),p.useEffect(()=>((()=>{if(!Ce||!Be)return;const oe=async()=>{var Ee;try{if(!Ce)return;const Xe=`${Hv}/api/sessions/${encodeURIComponent(Ce)}`,$e=await fetch(Xe,{method:"GET",headers:{"Content-Type":"application/json","x-api-key":"asd"}});if(!$e.ok)return;const jt=await $e.json(),et=String((jt==null?void 0:jt.status)||"").toUpperCase();if(!!((Ee=jt==null?void 0:jt.me)!=null&&Ee.id)&&et==="WORKING"){je(!1),de(null),await q();try{window.dispatchEvent(new CustomEvent("refresh-platforms"))}catch{}e({title:"Connected",description:"WhatsApp connected successfully."})}}catch{}};oe(),rt.current=window.setInterval(oe,3e3)})(),()=>{rt.current&&(clearInterval(rt.current),rt.current=null)}),[Be,Ce]);const ne=async ee=>{ae(ee),fe(null),de(null),je(!0),Ze(ee);try{const oe=await Ns(Nn.ENDPOINTS.WHATSAPP.GET_LOGIN_QR,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_name:ee})});if(!oe.ok)throw new Error(`QR request failed: ${oe.status}`);const Ee=oe.headers.get("content-type");if(Ee&&Ee.includes("image/")){const Xe=await oe.blob();de(URL.createObjectURL(Xe))}else try{const Xe=await oe.json(),$e=Array.isArray(Xe)?Xe[0]:Xe;if(!($e!=null&&$e.data)||!($e!=null&&$e.mimetype))throw new Error("Invalid QR");de(`data:${$e.mimetype};base64,${$e.data}`)}catch{const Xe=await oe.text();Xe&&de(`data:image/png;base64,${Xe}`)}}catch(oe){fe((oe==null?void 0:oe.message)||"Failed to get QR")}finally{ae(null)}},_e=async ee=>{if(!ee)throw new Error("Missing channel");const oe=xe(ee);if(oe==="telegram"){const Xe=await Ns(Nn.ENDPOINTS.TELEGRAM.DELETE_WEBHOOK,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channel_id:ee.id,org_id:ee.org_id,bot_token:(ee==null?void 0:ee.external_id)||null})});if(!Xe.ok){const $e=await Xe.text().catch(()=>"");throw new Error($e||`Telegram delete failed (${Xe.status})`)}return}if(oe==="whatsapp"){const Xe=String((ee==null?void 0:ee.display_name)||"").replace(/\s/g,""),$e=await Ns(Nn.ENDPOINTS.WHATSAPP.DELETE_SESSION,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({channel_id:ee.id,org_id:ee.org_id,session_name:Xe})});if(!$e.ok){const jt=await $e.text().catch(()=>"");throw new Error(jt||`WhatsApp delete failed (${$e.status})`)}return}const{error:Ee}=await le.from("channels").delete().eq("id",ee.id);if(Ee)throw Ee},Le=async ee=>{var oe,Ee,Xe;if(ee){ie($e=>new Set($e).add(ee));try{const $e=await Ns(Nn.ENDPOINTS.WHATSAPP.LOGOUT_SESSION,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_name:ee})});if(!$e.ok)throw new Error(`Logout failed ${$e.status}`);const jt=await Ns(Nn.ENDPOINTS.WHATSAPP.DISCONNECT_SESSION,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({session_name:ee})});if(!jt.ok)throw new Error(`Disconnect failed ${jt.status}`);const et=Date.now();for(;Date.now()-et<2e4;){await q();const It=((Ee=(oe=W.current)==null?void 0:oe.find)==null?void 0:Ee.call(oe,Ln=>((Ln==null?void 0:Ln.name)||"")===ee))||null,Rt=String((It==null?void 0:It.status)||"").toUpperCase(),En=!!((Xe=It==null?void 0:It.me)!=null&&Xe.id);if(!(Rt==="WORKING"&&En))break;await new Promise(Ln=>setTimeout(Ln,2e3))}e({title:"Disconnected",description:`Session ${ee} disconnected`})}catch($e){X(($e==null?void 0:$e.message)||"Failed to disconnect session")}finally{ie($e=>{const jt=new Set($e);return jt.delete(ee),jt})}}};return a.jsxs("div",{className:"flex h-[calc(100vh-120px)]",children:[a.jsx("div",{className:"w-80 border-r border-border bg-card",children:a.jsxs("div",{className:"p-4",children:[a.jsx("div",{className:"flex items-center justify-between mb-4",children:a.jsx("h2",{className:"text-lg font-semibold",children:"Platforms"})}),a.jsx("p",{className:"text-sm text-muted-foreground mb-6",children:"This is where you can connect all your platforms"}),a.jsx(Gc,{value:w,onValueChange:ee=>b(ee),className:"mb-3",children:a.jsxs(Fl,{className:"grid w-full grid-cols-3 bg-muted/50 p-1",children:[a.jsx(_r,{value:"whatsapp",className:"data-[state=active]:bg-white data-[state=active]:text-black data-[state=inactive]:text-muted-foreground data-[state=inactive]:bg-transparent data-[state=inactive]:hover:bg-muted/30",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("span",{children:"WhatsApp"})}),a.jsx(ge,{children:a.jsx("p",{children:"Kelola koneksi WhatsApp Business"})})]})}),a.jsx(_r,{value:"telegram",className:"data-[state=active]:bg-white data-[state=active]:text-black data-[state=inactive]:text-muted-foreground data-[state=inactive]:bg-transparent data-[state=inactive]:hover:bg-muted/30",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("span",{children:"Telegram"})}),a.jsx(ge,{children:a.jsx("p",{children:"Kelola koneksi Bot Telegram"})})]})}),a.jsx(_r,{value:"web",className:"data-[state=active]:bg-white data-[state=active]:text-black data-[state=inactive]:text-muted-foreground data-[state=inactive]:bg-transparent data-[state=inactive]:hover:bg-muted/30",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("span",{children:"Live Chat"})}),a.jsx(ge,{children:a.jsx("p",{children:"Kelola koneksi widget Live Chat"})})]})})]})}),n?a.jsx("div",{className:"space-y-2",children:[1,2,3].map(ee=>a.jsx(He,{className:"animate-pulse",children:a.jsx(lt,{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-10 w-10 rounded-full bg-muted"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"h-4 bg-muted rounded w-3/4 mb-2"}),a.jsx("div",{className:"h-3 bg-muted rounded w-1/2"})]})]})})},ee))}):r?a.jsx("div",{className:"text-sm text-red-600 p-4",children:r}):a.jsx("div",{className:"space-y-2",children:t.filter(ee=>xe(ee)===w).length===0?a.jsx("div",{className:"text-sm text-muted-foreground p-4 text-center",children:"No platforms found. Create your first platform to get started."}):t.filter(ee=>xe(ee)===w).map(ee=>a.jsx(He,{className:`cursor-pointer transition-colors hover:bg-muted/50 ${y===ee.id?"border-primary shadow-sm":""}`,onClick:()=>x(ee.id),children:a.jsx(lt,{className:"p-4",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-10 w-10 rounded-full bg-muted flex items-center justify-center",children:ee.profile_photo_url?a.jsx("img",{src:ee.profile_photo_url,alt:ee.display_name||"Platform",className:"h-10 w-10 rounded-full object-cover"}):a.jsx("span",{className:"text-xs font-medium text-foreground/70",children:(ee.display_name||"").charAt(0)||"?"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h3",{className:"font-medium text-sm truncate",children:ee.display_name||"Unnamed Platform"}),a.jsx("p",{className:"text-[11px] text-muted-foreground capitalize",children:xe(ee)}),a.jsx("p",{className:"text-xs text-muted-foreground",children:ee.description||ee.website_url||""})]}),a.jsx("div",{className:`h-2.5 w-2.5 rounded-full ${ee.status==="active"?"bg-green-500":"bg-gray-300"}`,"aria-label":ee.status==="active"?"Active":"Inactive",title:ee.status==="active"?"Active":"Inactive"})]})})},ee.id))}),a.jsxs(xn,{open:j,onOpenChange:S,children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(vC,{asChild:!0,children:a.jsxs(se,{variant:"outline",className:"w-full mt-4",children:[a.jsx(zi,{className:"h-4 w-4 mr-2"}),"Add Channel"]})})}),a.jsx(ge,{children:a.jsx("p",{children:"Tambahkan saluran atau platform baru"})})]}),a.jsxs(un,{className:"sm:max-w-xl p-0 overflow-hidden",children:[a.jsxs(dn,{className:"p-6 pb-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsx(hn,{className:"text-lg font-semibold",children:"Platform"})}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Select the platform you wish to establish your new inbox."})]}),a.jsxs("div",{className:"px-6 pb-6",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[a.jsxs("button",{onClick:()=>pe("whatsapp"),className:"flex flex-col items-center p-4 rounded-lg border-2 border-border hover:border-primary hover:bg-accent/50 transition-all duration-200 group",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-green-500 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-200",children:a.jsx(Mv,{className:"h-6 w-6 text-white"})}),a.jsx("span",{className:"text-sm font-medium text-center",children:"WhatsApp"}),a.jsx("span",{className:"text-xs text-muted-foreground text-center mt-1",children:"Connect your WhatsApp Business account"})]}),a.jsxs("button",{onClick:()=>pe("web"),className:"flex flex-col items-center p-4 rounded-lg border-2 border-border hover:border-primary hover:bg-accent/50 transition-all duration-200 group",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-200",children:a.jsx(GT,{className:"h-6 w-6 text-white"})}),a.jsx("span",{className:"text-sm font-medium text-center",children:"Web Live Chat"}),a.jsx("span",{className:"text-xs text-muted-foreground text-center mt-1",children:"Add live chat to your website"})]}),a.jsxs("button",{onClick:()=>pe("telegram"),className:"flex flex-col items-center p-4 rounded-lg border-2 border-border hover:border-primary hover:bg-accent/50 transition-all duration-200 group",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-blue-400 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-200",children:a.jsx(bm,{className:"h-6 w-6 text-white"})}),a.jsx("span",{className:"text-sm font-medium text-center",children:"Telegram Bot"}),a.jsx("span",{className:"text-xs text-muted-foreground text-center mt-1",children:"Connect your Telegram bot via BotFather"})]})]}),a.jsx("div",{className:"text-center",children:a.jsx("p",{className:"text-xs text-muted-foreground",children:"More platforms coming soon"})})]})]})]}),a.jsx(rve,{isOpen:T==="whatsapp",onClose:()=>O(null),onSubmit:Oe,isSubmitting:A}),a.jsx(ave,{isOpen:T==="telegram",onClose:()=>O(null),onSubmit:Oe,isSubmitting:A}),a.jsx(sve,{isOpen:T==="web",onClose:()=>O(null),onSubmit:Oe,isSubmitting:A}),a.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center",children:"Add a new platform inbox"})]})}),a.jsx("div",{className:"flex-1 p-6 overflow-y-auto",children:a.jsxs("div",{className:"max-w-4xl",children:[a.jsx("div",{className:"flex items-center justify-between mb-6",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold",children:ce!=null&&ce.display_name?ce.display_name.toUpperCase():"Select Platform"}),a.jsx("p",{className:"text-muted-foreground",children:ce?ce.description||ce.website_url||"":"Choose a platform to manage"})]})}),a.jsxs("div",{className:"grid gap-6",children:[ce?ce&&a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{className:"text-base",children:"Channel Details"})}),a.jsxs(lt,{className:"space-y-6",children:[a.jsxs("div",{className:"grid md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:["Provider",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Jenis platform komunikasi yang digunakan (WhatsApp, Telegram, Live Chat)"})})]})]}),a.jsx("div",{className:"capitalize",children:xe(ce)})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:["Status",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Status koneksi platform saat ini (Aktif atau Tidak Aktif)"})})]})]}),a.jsx("div",{children:ce.status==="active"?"Active":"Inactive"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:["Display Name",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Nama yang ditampilkan untuk platform ini"})})]})]}),a.jsx("div",{children:ce.display_name||""})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:["AI Agent",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Agen AI yang ditugaskan untuk menangani percakapan di platform ini"})})]})]}),a.jsx("div",{children:((be=u.find(ee=>ee.id===(ce==null?void 0:ce.ai_profile_id)))==null?void 0:be.name)||""})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:["Created At",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Tanggal dan waktu platform ini dibuat"})})]})]}),a.jsx("div",{children:ce.created_at?new Date(ce.created_at).toLocaleString():""})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:["Secret Token",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Token rahasia untuk autentikasi dan keamanan platform"})})]})]}),a.jsx("div",{children:(()=>{const ee=ce==null?void 0:ce.secret_token;return ee?ee.length>8?`${ee.slice(0,4)}${ee.slice(-2)}`:"":""})()})]})]}),a.jsxs("div",{className:"rounded-lg border p-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm font-medium mb-3",children:["Channel Profile",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Kelola foto profil atau logo untuk platform ini"})})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"h-12 w-12 rounded-full bg-muted flex items-center justify-center overflow-hidden",children:ce!=null&&ce.profile_photo_url?a.jsx("img",{src:(ce==null?void 0:ce.profile_photo_url)||"",alt:"Avatar",className:"h-12 w-12 object-cover"}):a.jsx("span",{className:"text-xs text-foreground/70",children:((ce==null?void 0:ce.display_name)||"?").charAt(0)})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"outline",size:"sm",onClick:()=>{var ee;return(ee=E.current)==null?void 0:ee.click()},disabled:!ce||z||C,children:z?a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin"})," Uploading..."]}):a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Kc,{className:"h-4 w-4"})," Upload Avatar"]})})}),a.jsx(ge,{children:a.jsx("p",{children:"Unggah foto profil atau logo untuk platform ini"})})]}),a.jsx("input",{ref:E,type:"file",accept:"image/png,image/jpeg,image/webp",className:"hidden",onChange:async ee=>{var Ee;const oe=(Ee=ee.currentTarget.files)==null?void 0:Ee[0];if(!(!oe||!ce))try{R(!0),await l(ce.id,oe,ce.org_id),e({title:"Avatar updated"}),await i()}catch(Xe){e({title:"Avatar upload failed",description:(Xe==null?void 0:Xe.message)||"Please try again",variant:"destructive"})}finally{R(!1);try{ee.currentTarget.value=""}catch{}}}}),!!(ce!=null&&ce.logo_url||ce!=null&&ce.profile_photo_url)&&a.jsx(se,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700",disabled:!ce||z||C,onClick:async()=>{if(ce)try{D(!0),await c(ce.id,ce.org_id),await i(),e({title:"Avatar removed"})}catch(ee){e({title:"Failed to remove avatar",description:(ee==null?void 0:ee.message)||"Please try again",variant:"destructive"})}finally{D(!1)}},children:C?a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin"})," Removing..."]}):a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(xa,{className:"h-4 w-4"})," Remove"]})})]}),a.jsxs("div",{className:"flex items-center gap-2 ml-2 text-xs text-muted-foreground",children:["Accepted: PNG, JPG, WEBP  Max 5 MB",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Format file yang didukung: PNG, JPG, WEBP dengan ukuran maksimal 5 MB"})})]})]})]})]})]})]}):a.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-muted rounded-full flex items-center justify-center mb-4",children:a.jsx(Mv,{className:"w-8 h-8 text-muted-foreground"})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Platform Selected"}),a.jsx("p",{className:"text-muted-foreground mb-6 max-w-md",children:"Select a platform from the left panel to view its details, manage settings, and configure agents."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 w-full max-w-2xl",children:[a.jsxs("div",{className:"p-4 border rounded-lg text-center",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2",children:a.jsx(Mv,{className:"w-4 h-4 text-blue-600"})}),a.jsx("h4",{className:"font-medium mb-1",children:"WhatsApp"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect your WhatsApp business account"})]}),a.jsxs("div",{className:"p-4 border rounded-lg text-center",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2",children:a.jsx(bm,{className:"w-4 h-4 text-blue-600"})}),a.jsx("h4",{className:"font-medium mb-1",children:"Telegram"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Set up a Telegram bot for customer support"})]}),a.jsxs("div",{className:"p-4 border rounded-lg text-center",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-2",children:a.jsx(GT,{className:"w-4 h-4 text-blue-600"})}),a.jsx("h4",{className:"font-medium mb-1",children:"Live Chat"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Embed chat widget on your website"})]})]})]}),qe==="web"&&a.jsx("div",{className:"grid gap-6",children:Wt(!0)}),qe==="whatsapp"&&a.jsxs("div",{className:"grid gap-6",children:[Wt(!1),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{className:"text-base",children:"WhatsApp Sessions"})}),a.jsxs(lt,{children:[P&&a.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading sessions..."}),Z&&a.jsx("div",{className:"text-sm text-red-600",children:Z}),!P&&!Z&&a.jsx("div",{className:"space-y-3",children:(()=>{const ee=((ce==null?void 0:ce.display_name)||"").toLowerCase().replace(/\s/g,""),oe=F.filter(Ee=>((Ee==null?void 0:Ee.name)||"").toLowerCase().replace(/\s/g,"")===ee);if(oe.length===0){const Ee=((ce==null?void 0:ce.display_name)||"").replace(/\s/g,"");return a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"text-sm text-muted-foreground",children:"No session found for this channel."}),a.jsx(se,{variant:"outline",className:"text-blue-600 border-blue-200 hover:bg-blue-50",size:"sm",disabled:!!me,onClick:()=>ne(Ee),children:me===Ee?a.jsx(Ht,{className:"h-3 w-3 animate-spin"}):"Connect"})]})}return oe.map((Ee,Xe)=>{var Ca,cr;const $e=((Ca=Ee==null?void 0:Ee.me)==null?void 0:Ca.id)||"",jt=$e?$e.replace(/@c\.us$/,""):"",et=((cr=Ee==null?void 0:Ee.me)==null?void 0:cr.pushName)||"-",It=String((Ee==null?void 0:Ee.status)||"UNKNOWN").toUpperCase(),Rt=(Ee==null?void 0:Ee.name)||"",En=K.has(Rt)||H.has(Rt)||me===Rt,Vn=!!jt,Ln=It==="SCAN_QR_CODE",Yr=It==="WORKING"&&Vn;return a.jsxs("div",{className:"flex items-center justify-between rounded-md border p-3",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium",children:et}),a.jsx("div",{className:"text-xs text-muted-foreground",children:Ln||!Vn?"Not connected":jt})]}),a.jsx("div",{className:"flex items-center gap-2",children:Yr?a.jsx(se,{variant:"outline",size:"sm",className:"text-amber-700 border-amber-200 hover:bg-amber-50",disabled:En,onClick:()=>Le(Rt),children:K.has(Rt)?a.jsx(Ht,{className:"h-3 w-3 animate-spin"}):"Disconnect"}):a.jsx(se,{variant:"outline",className:"text-blue-600 border-blue-200 hover:bg-blue-50",size:"sm",disabled:En,onClick:()=>ne(Rt),children:me===Rt?a.jsx(Ht,{className:"h-3 w-3 animate-spin"}):"Connect"})})]},Xe)})})()})]})]}),a.jsx(xn,{open:Be,onOpenChange:je,children:a.jsxs(un,{className:"sm:max-w-md",children:[a.jsxs(dn,{children:[a.jsx(hn,{children:"Connect WhatsApp"}),a.jsx(Hr,{children:"Scan this QR with your WhatsApp app to connect."})]}),Q&&a.jsx("div",{className:"text-sm text-red-600",children:Q}),Ne?a.jsxs("div",{className:"flex flex-col items-center gap-3",children:[a.jsx("img",{src:Ne,alt:"QR",className:"w-56 h-56 rounded border"}),a.jsx(se,{variant:"outline",onClick:()=>ne(Ce||((ce==null?void 0:ce.display_name)||"").replace(/\s/g,"")),disabled:!!me,className:"text-blue-600 border-blue-200 hover:bg-blue-50",children:me?a.jsx(Ht,{className:"h-4 w-4 animate-spin"}):"Refresh QR"})]}):a.jsx("div",{className:"flex items-center justify-center h-60",children:a.jsx(Ht,{className:"h-6 w-6 animate-spin"})})]})})]}),qe==="telegram"&&a.jsx("div",{className:"grid gap-6",children:Wt(!1)})]}),ce&&a.jsx("div",{className:"mt-8",children:a.jsxs(He,{className:"bg-red-50 border-2 border-red-200",children:[a.jsx(dt,{children:a.jsxs(ct,{className:"text-base text-red-700 flex items-center gap-2",children:["Danger Zone",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-red-600 cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Zona berbahaya untuk tindakan yang tidak dapat dibatalkan seperti menghapus platform"})})]})]})}),a.jsx(lt,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-red-700",children:"Delete this channel"}),a.jsx("div",{className:"text-xs text-red-600/80",children:"This action cannot be undone."})]}),a.jsxs(Hb,{children:[a.jsx(qce,{asChild:!0,children:a.jsx(se,{className:"bg-red-600 hover:bg-red-700 text-white",disabled:Je,"aria-busy":Je,children:Je?a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin"}),a.jsx("span",{children:"Deleting"})]}):"Delete Channel"})}),a.jsxs(Jp,{children:[a.jsxs(Qp,{children:[a.jsx(eg,{children:"Delete channel?"}),a.jsxs(tg,{children:["This will permanently delete ",(ce==null?void 0:ce.display_name)||"this channel",". This action cannot be undone."]})]}),a.jsxs(Zp,{children:[a.jsx(rg,{children:"Cancel"}),a.jsx(ng,{className:`bg-red-600 hover:bg-red-700 text-white ${Je?"animate-pulse cursor-wait":""}`,"aria-busy":Je,disabled:Je,onClick:async()=>{if(!(!ce||Je))try{te(!0),await _e(ce),e({title:"Deleted",description:"Channel has been deleted."}),x(null),await i()}catch(ee){e({title:"Error",description:(ee==null?void 0:ee.message)||"Failed to delete channel",variant:"destructive"})}finally{te(!1)}},children:Je?a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin"}),a.jsx("span",{children:"Deleting"})]}):"Delete"})]})]})]})]})})]})})]})})]})};var ove=Array.isArray,Xa=ove,lve=typeof mr=="object"&&mr&&mr.Object===Object&&mr,e8=lve,cve=e8,uve=typeof self=="object"&&self&&self.Object===Object&&self,dve=cve||uve||Function("return this")(),Xi=dve,hve=Xi,fve=hve.Symbol,og=fve,CO=og,t8=Object.prototype,mve=t8.hasOwnProperty,pve=t8.toString,mf=CO?CO.toStringTag:void 0;function gve(e){var t=mve.call(e,mf),n=e[mf];try{e[mf]=void 0;var r=!0}catch{}var s=pve.call(e);return r&&(t?e[mf]=n:delete e[mf]),s}var vve=gve,yve=Object.prototype,xve=yve.toString;function bve(e){return xve.call(e)}var wve=bve,AO=og,jve=vve,_ve=wve,kve="[object Null]",Sve="[object Undefined]",EO=AO?AO.toStringTag:void 0;function Nve(e){return e==null?e===void 0?Sve:kve:EO&&EO in Object(e)?jve(e):_ve(e)}var Bo=Nve;function Cve(e){return e!=null&&typeof e=="object"}var zo=Cve,Ave=Bo,Eve=zo,Tve="[object Symbol]";function Pve(e){return typeof e=="symbol"||Eve(e)&&Ave(e)==Tve}var $h=Pve,Ove=Xa,Ive=$h,Rve=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Mve=/^\w*$/;function Dve(e,t){if(Ove(e))return!1;var n=typeof e;return n=="number"||n=="symbol"||n=="boolean"||e==null||Ive(e)?!0:Mve.test(e)||!Rve.test(e)||t!=null&&e in Object(t)}var dA=Dve;function Lve(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var ec=Lve;const Fh=bn(ec);var $ve=Bo,Fve=ec,Uve="[object AsyncFunction]",Bve="[object Function]",zve="[object GeneratorFunction]",Wve="[object Proxy]";function qve(e){if(!Fve(e))return!1;var t=$ve(e);return t==Bve||t==zve||t==Uve||t==Wve}var hA=qve;const qt=bn(hA);var Hve=Xi,Kve=Hve["__core-js_shared__"],Vve=Kve,Aj=Vve,TO=function(){var e=/[^.]+$/.exec(Aj&&Aj.keys&&Aj.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function Gve(e){return!!TO&&TO in e}var Yve=Gve,Xve=Function.prototype,Jve=Xve.toString;function Qve(e){if(e!=null){try{return Jve.call(e)}catch{}try{return e+""}catch{}}return""}var n8=Qve,Zve=hA,eye=Yve,tye=ec,nye=n8,rye=/[\\^$.*+?()[\]{}|]/g,aye=/^\[object .+?Constructor\]$/,sye=Function.prototype,iye=Object.prototype,oye=sye.toString,lye=iye.hasOwnProperty,cye=RegExp("^"+oye.call(lye).replace(rye,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function uye(e){if(!tye(e)||eye(e))return!1;var t=Zve(e)?cye:aye;return t.test(nye(e))}var dye=uye;function hye(e,t){return e==null?void 0:e[t]}var fye=hye,mye=dye,pye=fye;function gye(e,t){var n=pye(e,t);return mye(n)?n:void 0}var yu=gye,vye=yu,yye=vye(Object,"create"),a0=yye,PO=a0;function xye(){this.__data__=PO?PO(null):{},this.size=0}var bye=xye;function wye(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var jye=wye,_ye=a0,kye="__lodash_hash_undefined__",Sye=Object.prototype,Nye=Sye.hasOwnProperty;function Cye(e){var t=this.__data__;if(_ye){var n=t[e];return n===kye?void 0:n}return Nye.call(t,e)?t[e]:void 0}var Aye=Cye,Eye=a0,Tye=Object.prototype,Pye=Tye.hasOwnProperty;function Oye(e){var t=this.__data__;return Eye?t[e]!==void 0:Pye.call(t,e)}var Iye=Oye,Rye=a0,Mye="__lodash_hash_undefined__";function Dye(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=Rye&&t===void 0?Mye:t,this}var Lye=Dye,$ye=bye,Fye=jye,Uye=Aye,Bye=Iye,zye=Lye;function Uh(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Uh.prototype.clear=$ye;Uh.prototype.delete=Fye;Uh.prototype.get=Uye;Uh.prototype.has=Bye;Uh.prototype.set=zye;var Wye=Uh;function qye(){this.__data__=[],this.size=0}var Hye=qye;function Kye(e,t){return e===t||e!==e&&t!==t}var fA=Kye,Vye=fA;function Gye(e,t){for(var n=e.length;n--;)if(Vye(e[n][0],t))return n;return-1}var s0=Gye,Yye=s0,Xye=Array.prototype,Jye=Xye.splice;function Qye(e){var t=this.__data__,n=Yye(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Jye.call(t,n,1),--this.size,!0}var Zye=Qye,exe=s0;function txe(e){var t=this.__data__,n=exe(t,e);return n<0?void 0:t[n][1]}var nxe=txe,rxe=s0;function axe(e){return rxe(this.__data__,e)>-1}var sxe=axe,ixe=s0;function oxe(e,t){var n=this.__data__,r=ixe(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}var lxe=oxe,cxe=Hye,uxe=Zye,dxe=nxe,hxe=sxe,fxe=lxe;function Bh(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Bh.prototype.clear=cxe;Bh.prototype.delete=uxe;Bh.prototype.get=dxe;Bh.prototype.has=hxe;Bh.prototype.set=fxe;var i0=Bh,mxe=yu,pxe=Xi,gxe=mxe(pxe,"Map"),mA=gxe,OO=Wye,vxe=i0,yxe=mA;function xxe(){this.size=0,this.__data__={hash:new OO,map:new(yxe||vxe),string:new OO}}var bxe=xxe;function wxe(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var jxe=wxe,_xe=jxe;function kxe(e,t){var n=e.__data__;return _xe(t)?n[typeof t=="string"?"string":"hash"]:n.map}var o0=kxe,Sxe=o0;function Nxe(e){var t=Sxe(this,e).delete(e);return this.size-=t?1:0,t}var Cxe=Nxe,Axe=o0;function Exe(e){return Axe(this,e).get(e)}var Txe=Exe,Pxe=o0;function Oxe(e){return Pxe(this,e).has(e)}var Ixe=Oxe,Rxe=o0;function Mxe(e,t){var n=Rxe(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}var Dxe=Mxe,Lxe=bxe,$xe=Cxe,Fxe=Txe,Uxe=Ixe,Bxe=Dxe;function zh(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}zh.prototype.clear=Lxe;zh.prototype.delete=$xe;zh.prototype.get=Fxe;zh.prototype.has=Uxe;zh.prototype.set=Bxe;var pA=zh,r8=pA,zxe="Expected a function";function gA(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(zxe);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var o=e.apply(this,r);return n.cache=i.set(s,o)||i,o};return n.cache=new(gA.Cache||r8),n}gA.Cache=r8;var a8=gA;const Wxe=bn(a8);var qxe=a8,Hxe=500;function Kxe(e){var t=qxe(e,function(r){return n.size===Hxe&&n.clear(),r}),n=t.cache;return t}var Vxe=Kxe,Gxe=Vxe,Yxe=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Xxe=/\\(\\)?/g,Jxe=Gxe(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(Yxe,function(n,r,s,i){t.push(s?i.replace(Xxe,"$1"):r||n)}),t}),Qxe=Jxe;function Zxe(e,t){for(var n=-1,r=e==null?0:e.length,s=Array(r);++n<r;)s[n]=t(e[n],n,e);return s}var vA=Zxe,IO=og,ebe=vA,tbe=Xa,nbe=$h,rbe=1/0,RO=IO?IO.prototype:void 0,MO=RO?RO.toString:void 0;function s8(e){if(typeof e=="string")return e;if(tbe(e))return ebe(e,s8)+"";if(nbe(e))return MO?MO.call(e):"";var t=e+"";return t=="0"&&1/e==-rbe?"-0":t}var abe=s8,sbe=abe;function ibe(e){return e==null?"":sbe(e)}var i8=ibe,obe=Xa,lbe=dA,cbe=Qxe,ube=i8;function dbe(e,t){return obe(e)?e:lbe(e,t)?[e]:cbe(ube(e))}var o8=dbe,hbe=$h,fbe=1/0;function mbe(e){if(typeof e=="string"||hbe(e))return e;var t=e+"";return t=="0"&&1/e==-fbe?"-0":t}var l0=mbe,pbe=o8,gbe=l0;function vbe(e,t){t=pbe(t,e);for(var n=0,r=t.length;e!=null&&n<r;)e=e[gbe(t[n++])];return n&&n==r?e:void 0}var yA=vbe,ybe=yA;function xbe(e,t,n){var r=e==null?void 0:ybe(e,t);return r===void 0?n:r}var l8=xbe;const Os=bn(l8);function bbe(e){return e==null}var wbe=bbe;const mn=bn(wbe);var jbe=Bo,_be=Xa,kbe=zo,Sbe="[object String]";function Nbe(e){return typeof e=="string"||!_be(e)&&kbe(e)&&jbe(e)==Sbe}var Cbe=Nbe;const nu=bn(Cbe);var c8={exports:{}},_n={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xA=Symbol.for("react.element"),bA=Symbol.for("react.portal"),c0=Symbol.for("react.fragment"),u0=Symbol.for("react.strict_mode"),d0=Symbol.for("react.profiler"),h0=Symbol.for("react.provider"),f0=Symbol.for("react.context"),Abe=Symbol.for("react.server_context"),m0=Symbol.for("react.forward_ref"),p0=Symbol.for("react.suspense"),g0=Symbol.for("react.suspense_list"),v0=Symbol.for("react.memo"),y0=Symbol.for("react.lazy"),Ebe=Symbol.for("react.offscreen"),u8;u8=Symbol.for("react.module.reference");function Ls(e){if(typeof e=="object"&&e!==null){var t=e.$$typeof;switch(t){case xA:switch(e=e.type,e){case c0:case d0:case u0:case p0:case g0:return e;default:switch(e=e&&e.$$typeof,e){case Abe:case f0:case m0:case y0:case v0:case h0:return e;default:return t}}case bA:return t}}}_n.ContextConsumer=f0;_n.ContextProvider=h0;_n.Element=xA;_n.ForwardRef=m0;_n.Fragment=c0;_n.Lazy=y0;_n.Memo=v0;_n.Portal=bA;_n.Profiler=d0;_n.StrictMode=u0;_n.Suspense=p0;_n.SuspenseList=g0;_n.isAsyncMode=function(){return!1};_n.isConcurrentMode=function(){return!1};_n.isContextConsumer=function(e){return Ls(e)===f0};_n.isContextProvider=function(e){return Ls(e)===h0};_n.isElement=function(e){return typeof e=="object"&&e!==null&&e.$$typeof===xA};_n.isForwardRef=function(e){return Ls(e)===m0};_n.isFragment=function(e){return Ls(e)===c0};_n.isLazy=function(e){return Ls(e)===y0};_n.isMemo=function(e){return Ls(e)===v0};_n.isPortal=function(e){return Ls(e)===bA};_n.isProfiler=function(e){return Ls(e)===d0};_n.isStrictMode=function(e){return Ls(e)===u0};_n.isSuspense=function(e){return Ls(e)===p0};_n.isSuspenseList=function(e){return Ls(e)===g0};_n.isValidElementType=function(e){return typeof e=="string"||typeof e=="function"||e===c0||e===d0||e===u0||e===p0||e===g0||e===Ebe||typeof e=="object"&&e!==null&&(e.$$typeof===y0||e.$$typeof===v0||e.$$typeof===h0||e.$$typeof===f0||e.$$typeof===m0||e.$$typeof===u8||e.getModuleId!==void 0)};_n.typeOf=Ls;c8.exports=_n;var Tbe=c8.exports,Pbe=Bo,Obe=zo,Ibe="[object Number]";function Rbe(e){return typeof e=="number"||Obe(e)&&Pbe(e)==Ibe}var d8=Rbe;const Mbe=bn(d8);var Dbe=d8;function Lbe(e){return Dbe(e)&&e!=+e}var $be=Lbe;const lg=bn($be);var ri=function(t){return t===0?0:t>0?1:-1},Sc=function(t){return nu(t)&&t.indexOf("%")===t.length-1},tt=function(t){return Mbe(t)&&!lg(t)},Fbe=function(t){return mn(t)},Sr=function(t){return tt(t)||nu(t)},Ube=0,x0=function(t){var n=++Ube;return"".concat(t||"").concat(n)},ru=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,s=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(!tt(t)&&!nu(t))return r;var i;if(Sc(t)){var o=t.indexOf("%");i=n*parseFloat(t.slice(0,o))/100}else i=+t;return lg(i)&&(i=r),s&&i>n&&(i=n),i},hl=function(t){if(!t)return null;var n=Object.keys(t);return n&&n.length?t[n[0]]:null},Bbe=function(t){if(!Array.isArray(t))return!1;for(var n=t.length,r={},s=0;s<n;s++)if(!r[t[s]])r[t[s]]=!0;else return!0;return!1},Du=function(t,n){return tt(t)&&tt(n)?function(r){return t+r*(n-t)}:function(){return n}};function tk(e,t,n){return!e||!e.length?null:e.find(function(r){return r&&(typeof t=="function"?t(r):Os(r,t))===n})}var zbe=function(t,n){return tt(t)&&tt(n)?t-n:nu(t)&&nu(n)?t.localeCompare(n):t instanceof Date&&n instanceof Date?t.getTime()-n.getTime():String(t).localeCompare(String(n))};function kd(e,t){for(var n in e)if({}.hasOwnProperty.call(e,n)&&(!{}.hasOwnProperty.call(t,n)||e[n]!==t[n]))return!1;for(var r in t)if({}.hasOwnProperty.call(t,r)&&!{}.hasOwnProperty.call(e,r))return!1;return!0}function nk(e){"@babel/helpers - typeof";return nk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nk(e)}var Wbe=["viewBox","children"],qbe=["aria-activedescendant","aria-atomic","aria-autocomplete","aria-busy","aria-checked","aria-colcount","aria-colindex","aria-colspan","aria-controls","aria-current","aria-describedby","aria-details","aria-disabled","aria-errormessage","aria-expanded","aria-flowto","aria-haspopup","aria-hidden","aria-invalid","aria-keyshortcuts","aria-label","aria-labelledby","aria-level","aria-live","aria-modal","aria-multiline","aria-multiselectable","aria-orientation","aria-owns","aria-placeholder","aria-posinset","aria-pressed","aria-readonly","aria-relevant","aria-required","aria-roledescription","aria-rowcount","aria-rowindex","aria-rowspan","aria-selected","aria-setsize","aria-sort","aria-valuemax","aria-valuemin","aria-valuenow","aria-valuetext","className","color","height","id","lang","max","media","method","min","name","style","target","width","role","tabIndex","accentHeight","accumulate","additive","alignmentBaseline","allowReorder","alphabetic","amplitude","arabicForm","ascent","attributeName","attributeType","autoReverse","azimuth","baseFrequency","baselineShift","baseProfile","bbox","begin","bias","by","calcMode","capHeight","clip","clipPath","clipPathUnits","clipRule","colorInterpolation","colorInterpolationFilters","colorProfile","colorRendering","contentScriptType","contentStyleType","cursor","cx","cy","d","decelerate","descent","diffuseConstant","direction","display","divisor","dominantBaseline","dur","dx","dy","edgeMode","elevation","enableBackground","end","exponent","externalResourcesRequired","fill","fillOpacity","fillRule","filter","filterRes","filterUnits","floodColor","floodOpacity","focusable","fontFamily","fontSize","fontSizeAdjust","fontStretch","fontStyle","fontVariant","fontWeight","format","from","fx","fy","g1","g2","glyphName","glyphOrientationHorizontal","glyphOrientationVertical","glyphRef","gradientTransform","gradientUnits","hanging","horizAdvX","horizOriginX","href","ideographic","imageRendering","in2","in","intercept","k1","k2","k3","k4","k","kernelMatrix","kernelUnitLength","kerning","keyPoints","keySplines","keyTimes","lengthAdjust","letterSpacing","lightingColor","limitingConeAngle","local","markerEnd","markerHeight","markerMid","markerStart","markerUnits","markerWidth","mask","maskContentUnits","maskUnits","mathematical","mode","numOctaves","offset","opacity","operator","order","orient","orientation","origin","overflow","overlinePosition","overlineThickness","paintOrder","panose1","pathLength","patternContentUnits","patternTransform","patternUnits","pointerEvents","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","r","radius","refX","refY","renderingIntent","repeatCount","repeatDur","requiredExtensions","requiredFeatures","restart","result","rotate","rx","ry","seed","shapeRendering","slope","spacing","specularConstant","specularExponent","speed","spreadMethod","startOffset","stdDeviation","stemh","stemv","stitchTiles","stopColor","stopOpacity","strikethroughPosition","strikethroughThickness","string","stroke","strokeDasharray","strokeDashoffset","strokeLinecap","strokeLinejoin","strokeMiterlimit","strokeOpacity","strokeWidth","surfaceScale","systemLanguage","tableValues","targetX","targetY","textAnchor","textDecoration","textLength","textRendering","to","transform","u1","u2","underlinePosition","underlineThickness","unicode","unicodeBidi","unicodeRange","unitsPerEm","vAlphabetic","values","vectorEffect","version","vertAdvY","vertOriginX","vertOriginY","vHanging","vIdeographic","viewTarget","visibility","vMathematical","widths","wordSpacing","writingMode","x1","x2","x","xChannelSelector","xHeight","xlinkActuate","xlinkArcrole","xlinkHref","xlinkRole","xlinkShow","xlinkTitle","xlinkType","xmlBase","xmlLang","xmlns","xmlnsXlink","xmlSpace","y1","y2","y","yChannelSelector","z","zoomAndPan","ref","key","angle"],DO=["points","pathLength"],Ej={svg:Wbe,polygon:DO,polyline:DO},wA=["dangerouslySetInnerHTML","onCopy","onCopyCapture","onCut","onCutCapture","onPaste","onPasteCapture","onCompositionEnd","onCompositionEndCapture","onCompositionStart","onCompositionStartCapture","onCompositionUpdate","onCompositionUpdateCapture","onFocus","onFocusCapture","onBlur","onBlurCapture","onChange","onChangeCapture","onBeforeInput","onBeforeInputCapture","onInput","onInputCapture","onReset","onResetCapture","onSubmit","onSubmitCapture","onInvalid","onInvalidCapture","onLoad","onLoadCapture","onError","onErrorCapture","onKeyDown","onKeyDownCapture","onKeyPress","onKeyPressCapture","onKeyUp","onKeyUpCapture","onAbort","onAbortCapture","onCanPlay","onCanPlayCapture","onCanPlayThrough","onCanPlayThroughCapture","onDurationChange","onDurationChangeCapture","onEmptied","onEmptiedCapture","onEncrypted","onEncryptedCapture","onEnded","onEndedCapture","onLoadedData","onLoadedDataCapture","onLoadedMetadata","onLoadedMetadataCapture","onLoadStart","onLoadStartCapture","onPause","onPauseCapture","onPlay","onPlayCapture","onPlaying","onPlayingCapture","onProgress","onProgressCapture","onRateChange","onRateChangeCapture","onSeeked","onSeekedCapture","onSeeking","onSeekingCapture","onStalled","onStalledCapture","onSuspend","onSuspendCapture","onTimeUpdate","onTimeUpdateCapture","onVolumeChange","onVolumeChangeCapture","onWaiting","onWaitingCapture","onAuxClick","onAuxClickCapture","onClick","onClickCapture","onContextMenu","onContextMenuCapture","onDoubleClick","onDoubleClickCapture","onDrag","onDragCapture","onDragEnd","onDragEndCapture","onDragEnter","onDragEnterCapture","onDragExit","onDragExitCapture","onDragLeave","onDragLeaveCapture","onDragOver","onDragOverCapture","onDragStart","onDragStartCapture","onDrop","onDropCapture","onMouseDown","onMouseDownCapture","onMouseEnter","onMouseLeave","onMouseMove","onMouseMoveCapture","onMouseOut","onMouseOutCapture","onMouseOver","onMouseOverCapture","onMouseUp","onMouseUpCapture","onSelect","onSelectCapture","onTouchCancel","onTouchCancelCapture","onTouchEnd","onTouchEndCapture","onTouchMove","onTouchMoveCapture","onTouchStart","onTouchStartCapture","onPointerDown","onPointerDownCapture","onPointerMove","onPointerMoveCapture","onPointerUp","onPointerUpCapture","onPointerCancel","onPointerCancelCapture","onPointerEnter","onPointerEnterCapture","onPointerLeave","onPointerLeaveCapture","onPointerOver","onPointerOverCapture","onPointerOut","onPointerOutCapture","onGotPointerCapture","onGotPointerCaptureCapture","onLostPointerCapture","onLostPointerCaptureCapture","onScroll","onScrollCapture","onWheel","onWheelCapture","onAnimationStart","onAnimationStartCapture","onAnimationEnd","onAnimationEndCapture","onAnimationIteration","onAnimationIterationCapture","onTransitionEnd","onTransitionEndCapture"],By=function(t,n){if(!t||typeof t=="function"||typeof t=="boolean")return null;var r=t;if(p.isValidElement(t)&&(r=t.props),!Fh(r))return null;var s={};return Object.keys(r).forEach(function(i){wA.includes(i)&&(s[i]=n||function(o){return r[i](r,o)})}),s},Hbe=function(t,n,r){return function(s){return t(n,r,s),null}},zy=function(t,n,r){if(!Fh(t)||nk(t)!=="object")return null;var s=null;return Object.keys(t).forEach(function(i){var o=t[i];wA.includes(i)&&typeof o=="function"&&(s||(s={}),s[i]=Hbe(o,n,r))}),s},Kbe=["children"],Vbe=["children"];function LO(e,t){if(e==null)return{};var n=Gbe(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Gbe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var $O={click:"onClick",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",mouseout:"onMouseOut",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",touchcancel:"onTouchCancel",touchend:"onTouchEnd",touchmove:"onTouchMove",touchstart:"onTouchStart",contextmenu:"onContextMenu",dblclick:"onDoubleClick"},jo=function(t){return typeof t=="string"?t:t?t.displayName||t.name||"Component":""},FO=null,Tj=null,jA=function e(t){if(t===FO&&Array.isArray(Tj))return Tj;var n=[];return p.Children.forEach(t,function(r){mn(r)||(Tbe.isFragment(r)?n=n.concat(e(r.props.children)):n.push(r))}),Tj=n,FO=t,n};function ci(e,t){var n=[],r=[];return Array.isArray(t)?r=t.map(function(s){return jo(s)}):r=[jo(t)],jA(e).forEach(function(s){var i=Os(s,"type.displayName")||Os(s,"type.name");r.indexOf(i)!==-1&&n.push(s)}),n}function rs(e,t){var n=ci(e,t);return n&&n[0]}var UO=function(t){if(!t||!t.props)return!1;var n=t.props,r=n.width,s=n.height;return!(!tt(r)||r<=0||!tt(s)||s<=0)},Ybe=["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColormatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-url","foreignObject","g","glyph","glyphRef","hkern","image","line","lineGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"],Xbe=function(t){return t&&t.type&&nu(t.type)&&Ybe.indexOf(t.type)>=0},Jbe=function(t,n,r,s){var i,o=(i=Ej==null?void 0:Ej[s])!==null&&i!==void 0?i:[];return n.startsWith("data-")||!qt(t)&&(s&&o.includes(n)||qbe.includes(n))||r&&wA.includes(n)},fn=function(t,n,r){if(!t||typeof t=="function"||typeof t=="boolean")return null;var s=t;if(p.isValidElement(t)&&(s=t.props),!Fh(s))return null;var i={};return Object.keys(s).forEach(function(o){var l;Jbe((l=s)===null||l===void 0?void 0:l[o],o,n,r)&&(i[o]=s[o])}),i},rk=function e(t,n){if(t===n)return!0;var r=p.Children.count(t);if(r!==p.Children.count(n))return!1;if(r===0)return!0;if(r===1)return BO(Array.isArray(t)?t[0]:t,Array.isArray(n)?n[0]:n);for(var s=0;s<r;s++){var i=t[s],o=n[s];if(Array.isArray(i)||Array.isArray(o)){if(!e(i,o))return!1}else if(!BO(i,o))return!1}return!0},BO=function(t,n){if(mn(t)&&mn(n))return!0;if(!mn(t)&&!mn(n)){var r=t.props||{},s=r.children,i=LO(r,Kbe),o=n.props||{},l=o.children,c=LO(o,Vbe);return s&&l?kd(i,c)&&rk(s,l):!s&&!l?kd(i,c):!1}return!1},zO=function(t,n){var r=[],s={};return jA(t).forEach(function(i,o){if(Xbe(i))r.push(i);else if(i){var l=jo(i.type),c=n[l]||{},u=c.handler,d=c.once;if(u&&(!d||!s[l])){var h=u(i,l,o);r.push(h),s[l]=!0}}}),r},Qbe=function(t){var n=t&&t.type;return n&&$O[n]?$O[n]:null},Zbe=function(t,n){return jA(n).indexOf(t)},e0e=["children","width","height","viewBox","className","style","title","desc"];function ak(){return ak=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ak.apply(this,arguments)}function t0e(e,t){if(e==null)return{};var n=n0e(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function n0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function sk(e){var t=e.children,n=e.width,r=e.height,s=e.viewBox,i=e.className,o=e.style,l=e.title,c=e.desc,u=t0e(e,e0e),d=s||{width:n,height:r,x:0,y:0},h=on("recharts-surface",i);return G.createElement("svg",ak({},fn(u,!0,"svg"),{className:h,width:n,height:r,style:o,viewBox:"".concat(d.x," ").concat(d.y," ").concat(d.width," ").concat(d.height)}),G.createElement("title",null,l),G.createElement("desc",null,c),t)}var r0e=["children","className"];function ik(){return ik=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ik.apply(this,arguments)}function a0e(e,t){if(e==null)return{};var n=s0e(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function s0e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var Ir=G.forwardRef(function(e,t){var n=e.children,r=e.className,s=a0e(e,r0e),i=on("recharts-layer",r);return G.createElement("g",ik({className:i},fn(s,!0),{ref:t}),n)}),_o=function(t,n){for(var r=arguments.length,s=new Array(r>2?r-2:0),i=2;i<r;i++)s[i-2]=arguments[i]};function i0e(e,t,n){var r=-1,s=e.length;t<0&&(t=-t>s?0:s+t),n=n>s?s:n,n<0&&(n+=s),s=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(s);++r<s;)i[r]=e[r+t];return i}var o0e=i0e,l0e=o0e;function c0e(e,t,n){var r=e.length;return n=n===void 0?r:n,!t&&n>=r?e:l0e(e,t,n)}var u0e=c0e,d0e="\\ud800-\\udfff",h0e="\\u0300-\\u036f",f0e="\\ufe20-\\ufe2f",m0e="\\u20d0-\\u20ff",p0e=h0e+f0e+m0e,g0e="\\ufe0e\\ufe0f",v0e="\\u200d",y0e=RegExp("["+v0e+d0e+p0e+g0e+"]");function x0e(e){return y0e.test(e)}var h8=x0e;function b0e(e){return e.split("")}var w0e=b0e,f8="\\ud800-\\udfff",j0e="\\u0300-\\u036f",_0e="\\ufe20-\\ufe2f",k0e="\\u20d0-\\u20ff",S0e=j0e+_0e+k0e,N0e="\\ufe0e\\ufe0f",C0e="["+f8+"]",ok="["+S0e+"]",lk="\\ud83c[\\udffb-\\udfff]",A0e="(?:"+ok+"|"+lk+")",m8="[^"+f8+"]",p8="(?:\\ud83c[\\udde6-\\uddff]){2}",g8="[\\ud800-\\udbff][\\udc00-\\udfff]",E0e="\\u200d",v8=A0e+"?",y8="["+N0e+"]?",T0e="(?:"+E0e+"(?:"+[m8,p8,g8].join("|")+")"+y8+v8+")*",P0e=y8+v8+T0e,O0e="(?:"+[m8+ok+"?",ok,p8,g8,C0e].join("|")+")",I0e=RegExp(lk+"(?="+lk+")|"+O0e+P0e,"g");function R0e(e){return e.match(I0e)||[]}var M0e=R0e,D0e=w0e,L0e=h8,$0e=M0e;function F0e(e){return L0e(e)?$0e(e):D0e(e)}var U0e=F0e,B0e=u0e,z0e=h8,W0e=U0e,q0e=i8;function H0e(e){return function(t){t=q0e(t);var n=z0e(t)?W0e(t):void 0,r=n?n[0]:t.charAt(0),s=n?B0e(n,1).join(""):t.slice(1);return r[e]()+s}}var K0e=H0e,V0e=K0e,G0e=V0e("toUpperCase"),Y0e=G0e;const b0=bn(Y0e);function Rn(e){return function(){return e}}const x8=Math.cos,Wy=Math.sin,gi=Math.sqrt,qy=Math.PI,w0=2*qy,ck=Math.PI,uk=2*ck,mc=1e-6,X0e=uk-mc;function b8(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function J0e(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return b8;const n=10**t;return function(r){this._+=r[0];for(let s=1,i=r.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}class Q0e{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?b8:J0e(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,s){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(t,n,r,s,i,o){this._append`C${+t},${+n},${+r},${+s},${this._x1=+i},${this._y1=+o}`}arcTo(t,n,r,s,i){if(t=+t,n=+n,r=+r,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let o=this._x1,l=this._y1,c=r-t,u=s-n,d=o-t,h=l-n,f=d*d+h*h;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(f>mc)if(!(Math.abs(h*c-u*d)>mc)||!i)this._append`L${this._x1=t},${this._y1=n}`;else{let m=r-o,g=s-l,v=c*c+u*u,y=m*m+g*g,x=Math.sqrt(v),w=Math.sqrt(f),b=i*Math.tan((ck-Math.acos((v+f-y)/(2*x*w)))/2),_=b/w,k=b/x;Math.abs(_-1)>mc&&this._append`L${t+_*d},${n+_*h}`,this._append`A${i},${i},0,0,${+(h*m>d*g)},${this._x1=t+k*c},${this._y1=n+k*u}`}}arc(t,n,r,s,i,o){if(t=+t,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let l=r*Math.cos(s),c=r*Math.sin(s),u=t+l,d=n+c,h=1^o,f=o?s-i:i-s;this._x1===null?this._append`M${u},${d}`:(Math.abs(this._x1-u)>mc||Math.abs(this._y1-d)>mc)&&this._append`L${u},${d}`,r&&(f<0&&(f=f%uk+uk),f>X0e?this._append`A${r},${r},0,1,${h},${t-l},${n-c}A${r},${r},0,1,${h},${this._x1=u},${this._y1=d}`:f>mc&&this._append`A${r},${r},0,${+(f>=ck)},${h},${this._x1=t+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(t,n,r,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}}function _A(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new Q0e(t)}function kA(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function w8(e){this._context=e}w8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function j0(e){return new w8(e)}function j8(e){return e[0]}function _8(e){return e[1]}function k8(e,t){var n=Rn(!0),r=null,s=j0,i=null,o=_A(l);e=typeof e=="function"?e:e===void 0?j8:Rn(e),t=typeof t=="function"?t:t===void 0?_8:Rn(t);function l(c){var u,d=(c=kA(c)).length,h,f=!1,m;for(r==null&&(i=s(m=o())),u=0;u<=d;++u)!(u<d&&n(h=c[u],u,c))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(h,u,c),+t(h,u,c));if(m)return i=null,m+""||null}return l.x=function(c){return arguments.length?(e=typeof c=="function"?c:Rn(+c),l):e},l.y=function(c){return arguments.length?(t=typeof c=="function"?c:Rn(+c),l):t},l.defined=function(c){return arguments.length?(n=typeof c=="function"?c:Rn(!!c),l):n},l.curve=function(c){return arguments.length?(s=c,r!=null&&(i=s(r)),l):s},l.context=function(c){return arguments.length?(c==null?r=i=null:i=s(r=c),l):r},l}function nv(e,t,n){var r=null,s=Rn(!0),i=null,o=j0,l=null,c=_A(u);e=typeof e=="function"?e:e===void 0?j8:Rn(+e),t=typeof t=="function"?t:Rn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?_8:Rn(+n);function u(h){var f,m,g,v=(h=kA(h)).length,y,x=!1,w,b=new Array(v),_=new Array(v);for(i==null&&(l=o(w=c())),f=0;f<=v;++f){if(!(f<v&&s(y=h[f],f,h))===x)if(x=!x)m=f,l.areaStart(),l.lineStart();else{for(l.lineEnd(),l.lineStart(),g=f-1;g>=m;--g)l.point(b[g],_[g]);l.lineEnd(),l.areaEnd()}x&&(b[f]=+e(y,f,h),_[f]=+t(y,f,h),l.point(r?+r(y,f,h):b[f],n?+n(y,f,h):_[f]))}if(w)return l=null,w+""||null}function d(){return k8().defined(s).curve(o).context(i)}return u.x=function(h){return arguments.length?(e=typeof h=="function"?h:Rn(+h),r=null,u):e},u.x0=function(h){return arguments.length?(e=typeof h=="function"?h:Rn(+h),u):e},u.x1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:Rn(+h),u):r},u.y=function(h){return arguments.length?(t=typeof h=="function"?h:Rn(+h),n=null,u):t},u.y0=function(h){return arguments.length?(t=typeof h=="function"?h:Rn(+h),u):t},u.y1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:Rn(+h),u):n},u.lineX0=u.lineY0=function(){return d().x(e).y(t)},u.lineY1=function(){return d().x(e).y(n)},u.lineX1=function(){return d().x(r).y(t)},u.defined=function(h){return arguments.length?(s=typeof h=="function"?h:Rn(!!h),u):s},u.curve=function(h){return arguments.length?(o=h,i!=null&&(l=o(i)),u):o},u.context=function(h){return arguments.length?(h==null?i=l=null:l=o(i=h),u):i},u}class S8{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function Z0e(e){return new S8(e,!0)}function ewe(e){return new S8(e,!1)}const SA={draw(e,t){const n=gi(t/qy);e.moveTo(n,0),e.arc(0,0,n,0,w0)}},twe={draw(e,t){const n=gi(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}},N8=gi(1/3),nwe=N8*2,rwe={draw(e,t){const n=gi(t/nwe),r=n*N8;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}},awe={draw(e,t){const n=gi(t),r=-n/2;e.rect(r,r,n,n)}},swe=.8908130915292852,C8=Wy(qy/10)/Wy(7*qy/10),iwe=Wy(w0/10)*C8,owe=-x8(w0/10)*C8,lwe={draw(e,t){const n=gi(t*swe),r=iwe*n,s=owe*n;e.moveTo(0,-n),e.lineTo(r,s);for(let i=1;i<5;++i){const o=w0*i/5,l=x8(o),c=Wy(o);e.lineTo(c*n,-l*n),e.lineTo(l*r-c*s,c*r+l*s)}e.closePath()}},Pj=gi(3),cwe={draw(e,t){const n=-gi(t/(Pj*3));e.moveTo(0,n*2),e.lineTo(-Pj*n,-n),e.lineTo(Pj*n,-n),e.closePath()}},ps=-.5,gs=gi(3)/2,dk=1/gi(12),uwe=(dk/2+1)*3,dwe={draw(e,t){const n=gi(t/uwe),r=n/2,s=n*dk,i=r,o=n*dk+n,l=-i,c=o;e.moveTo(r,s),e.lineTo(i,o),e.lineTo(l,c),e.lineTo(ps*r-gs*s,gs*r+ps*s),e.lineTo(ps*i-gs*o,gs*i+ps*o),e.lineTo(ps*l-gs*c,gs*l+ps*c),e.lineTo(ps*r+gs*s,ps*s-gs*r),e.lineTo(ps*i+gs*o,ps*o-gs*i),e.lineTo(ps*l+gs*c,ps*c-gs*l),e.closePath()}};function hwe(e,t){let n=null,r=_A(s);e=typeof e=="function"?e:Rn(e||SA),t=typeof t=="function"?t:Rn(t===void 0?64:+t);function s(){let i;if(n||(n=i=r()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),i)return n=null,i+""||null}return s.type=function(i){return arguments.length?(e=typeof i=="function"?i:Rn(i),s):e},s.size=function(i){return arguments.length?(t=typeof i=="function"?i:Rn(+i),s):t},s.context=function(i){return arguments.length?(n=i??null,s):n},s}function Hy(){}function Ky(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function A8(e){this._context=e}A8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ky(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ky(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function fwe(e){return new A8(e)}function E8(e){this._context=e}E8.prototype={areaStart:Hy,areaEnd:Hy,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Ky(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function mwe(e){return new E8(e)}function T8(e){this._context=e}T8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Ky(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function pwe(e){return new T8(e)}function P8(e){this._context=e}P8.prototype={areaStart:Hy,areaEnd:Hy,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function gwe(e){return new P8(e)}function WO(e){return e<0?-1:1}function qO(e,t,n){var r=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(r||s<0&&-0),o=(n-e._y1)/(s||r<0&&-0),l=(i*s+o*r)/(r+s);return(WO(i)+WO(o))*Math.min(Math.abs(i),Math.abs(o),.5*Math.abs(l))||0}function HO(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Oj(e,t,n){var r=e._x0,s=e._y0,i=e._x1,o=e._y1,l=(i-r)/3;e._context.bezierCurveTo(r+l,s+l*t,i-l,o-l*n,i,o)}function Vy(e){this._context=e}Vy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Oj(this,this._t0,HO(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Oj(this,HO(this,n=qO(this,e,t)),n);break;default:Oj(this,this._t0,n=qO(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function O8(e){this._context=new I8(e)}(O8.prototype=Object.create(Vy.prototype)).point=function(e,t){Vy.prototype.point.call(this,t,e)};function I8(e){this._context=e}I8.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,s,i){this._context.bezierCurveTo(t,e,r,n,i,s)}};function vwe(e){return new Vy(e)}function ywe(e){return new O8(e)}function R8(e){this._context=e}R8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=KO(e),s=KO(t),i=0,o=1;o<n;++i,++o)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],e[o],t[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function KO(e){var t,n=e.length-1,r,s=new Array(n),i=new Array(n),o=new Array(n);for(s[0]=0,i[0]=2,o[0]=e[0]+2*e[1],t=1;t<n-1;++t)s[t]=1,i[t]=4,o[t]=4*e[t]+2*e[t+1];for(s[n-1]=2,i[n-1]=7,o[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=s[t]/i[t-1],i[t]-=r,o[t]-=r*o[t-1];for(s[n-1]=o[n-1]/i[n-1],t=n-2;t>=0;--t)s[t]=(o[t]-s[t+1])/i[t];for(i[n-1]=(e[n]+s[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function xwe(e){return new R8(e)}function _0(e,t){this._context=e,this._t=t}_0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function bwe(e){return new _0(e,.5)}function wwe(e){return new _0(e,0)}function jwe(e){return new _0(e,1)}function th(e,t){if((o=e.length)>1)for(var n=1,r,s,i=e[t[0]],o,l=i.length;n<o;++n)for(s=i,i=e[t[n]],r=0;r<l;++r)i[r][1]+=i[r][0]=isNaN(s[r][1])?s[r][0]:s[r][1]}function hk(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function _we(e,t){return e[t]}function kwe(e){const t=[];return t.key=e,t}function Swe(){var e=Rn([]),t=hk,n=th,r=_we;function s(i){var o=Array.from(e.apply(this,arguments),kwe),l,c=o.length,u=-1,d;for(const h of i)for(l=0,++u;l<c;++l)(o[l][u]=[0,+r(h,o[l].key,u,i)]).data=h;for(l=0,d=kA(t(o));l<c;++l)o[d[l]].index=l;return n(o,d),o}return s.keys=function(i){return arguments.length?(e=typeof i=="function"?i:Rn(Array.from(i)),s):e},s.value=function(i){return arguments.length?(r=typeof i=="function"?i:Rn(+i),s):r},s.order=function(i){return arguments.length?(t=i==null?hk:typeof i=="function"?i:Rn(Array.from(i)),s):t},s.offset=function(i){return arguments.length?(n=i??th,s):n},s}function Nwe(e,t){if((r=e.length)>0){for(var n,r,s=0,i=e[0].length,o;s<i;++s){for(o=n=0;n<r;++n)o+=e[n][s][1]||0;if(o)for(n=0;n<r;++n)e[n][s][1]/=o}th(e,t)}}function Cwe(e,t){if((s=e.length)>0){for(var n=0,r=e[t[0]],s,i=r.length;n<i;++n){for(var o=0,l=0;o<s;++o)l+=e[o][n][1]||0;r[n][1]+=r[n][0]=-l/2}th(e,t)}}function Awe(e,t){if(!(!((o=e.length)>0)||!((i=(s=e[t[0]]).length)>0))){for(var n=0,r=1,s,i,o;r<i;++r){for(var l=0,c=0,u=0;l<o;++l){for(var d=e[t[l]],h=d[r][1]||0,f=d[r-1][1]||0,m=(h-f)/2,g=0;g<l;++g){var v=e[t[g]],y=v[r][1]||0,x=v[r-1][1]||0;m+=y-x}c+=h,u+=m*h}s[r-1][1]+=s[r-1][0]=n,c&&(n-=u/c)}s[r-1][1]+=s[r-1][0]=n,th(e,t)}}function Wm(e){"@babel/helpers - typeof";return Wm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wm(e)}var Ewe=["type","size","sizeType"];function fk(){return fk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},fk.apply(this,arguments)}function VO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function GO(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VO(Object(n),!0).forEach(function(r){Twe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VO(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Twe(e,t,n){return t=Pwe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Pwe(e){var t=Owe(e,"string");return Wm(t)=="symbol"?t:t+""}function Owe(e,t){if(Wm(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Wm(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Iwe(e,t){if(e==null)return{};var n=Rwe(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function Rwe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var M8={symbolCircle:SA,symbolCross:twe,symbolDiamond:rwe,symbolSquare:awe,symbolStar:lwe,symbolTriangle:cwe,symbolWye:dwe},Mwe=Math.PI/180,Dwe=function(t){var n="symbol".concat(b0(t));return M8[n]||SA},Lwe=function(t,n,r){if(n==="area")return t;switch(r){case"cross":return 5*t*t/9;case"diamond":return .5*t*t/Math.sqrt(3);case"square":return t*t;case"star":{var s=18*Mwe;return 1.25*t*t*(Math.tan(s)-Math.tan(s*2)*Math.pow(Math.tan(s),2))}case"triangle":return Math.sqrt(3)*t*t/4;case"wye":return(21-10*Math.sqrt(3))*t*t/8;default:return Math.PI*t*t/4}},$we=function(t,n){M8["symbol".concat(b0(t))]=n},NA=function(t){var n=t.type,r=n===void 0?"circle":n,s=t.size,i=s===void 0?64:s,o=t.sizeType,l=o===void 0?"area":o,c=Iwe(t,Ewe),u=GO(GO({},c),{},{type:r,size:i,sizeType:l}),d=function(){var y=Dwe(r),x=hwe().type(y).size(Lwe(i,l,r));return x()},h=u.className,f=u.cx,m=u.cy,g=fn(u,!0);return f===+f&&m===+m&&i===+i?G.createElement("path",fk({},g,{className:on("recharts-symbols",h),transform:"translate(".concat(f,", ").concat(m,")"),d:d()})):null};NA.registerSymbol=$we;function nh(e){"@babel/helpers - typeof";return nh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nh(e)}function mk(){return mk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mk.apply(this,arguments)}function YO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Fwe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YO(Object(n),!0).forEach(function(r){qm(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YO(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Uwe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Bwe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,L8(r.key),r)}}function zwe(e,t,n){return t&&Bwe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Wwe(e,t,n){return t=Gy(t),qwe(e,D8()?Reflect.construct(t,n||[],Gy(e).constructor):t.apply(e,n))}function qwe(e,t){if(t&&(nh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Hwe(e)}function Hwe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function D8(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(D8=function(){return!!e})()}function Gy(e){return Gy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Gy(e)}function Kwe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pk(e,t)}function pk(e,t){return pk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},pk(e,t)}function qm(e,t,n){return t=L8(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function L8(e){var t=Vwe(e,"string");return nh(t)=="symbol"?t:t+""}function Vwe(e,t){if(nh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(nh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vs=32,CA=function(e){function t(){return Uwe(this,t),Wwe(this,t,arguments)}return Kwe(t,e),zwe(t,[{key:"renderIcon",value:function(r){var s=this.props.inactiveColor,i=vs/2,o=vs/6,l=vs/3,c=r.inactive?s:r.color;if(r.type==="plainline")return G.createElement("line",{strokeWidth:4,fill:"none",stroke:c,strokeDasharray:r.payload.strokeDasharray,x1:0,y1:i,x2:vs,y2:i,className:"recharts-legend-icon"});if(r.type==="line")return G.createElement("path",{strokeWidth:4,fill:"none",stroke:c,d:"M0,".concat(i,"h").concat(l,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(2*l,",").concat(i,`
            H`).concat(vs,"M").concat(2*l,",").concat(i,`
            A`).concat(o,",").concat(o,",0,1,1,").concat(l,",").concat(i),className:"recharts-legend-icon"});if(r.type==="rect")return G.createElement("path",{stroke:"none",fill:c,d:"M0,".concat(vs/8,"h").concat(vs,"v").concat(vs*3/4,"h").concat(-vs,"z"),className:"recharts-legend-icon"});if(G.isValidElement(r.legendIcon)){var u=Fwe({},r);return delete u.legendIcon,G.cloneElement(r.legendIcon,u)}return G.createElement(NA,{fill:c,cx:i,cy:i,size:vs,sizeType:"diameter",type:r.type})}},{key:"renderItems",value:function(){var r=this,s=this.props,i=s.payload,o=s.iconSize,l=s.layout,c=s.formatter,u=s.inactiveColor,d={x:0,y:0,width:vs,height:vs},h={display:l==="horizontal"?"inline-block":"block",marginRight:10},f={display:"inline-block",verticalAlign:"middle",marginRight:4};return i.map(function(m,g){var v=m.formatter||c,y=on(qm(qm({"recharts-legend-item":!0},"legend-item-".concat(g),!0),"inactive",m.inactive));if(m.type==="none")return null;var x=qt(m.value)?null:m.value;_o(!qt(m.value),`The name property is also required when using a function for the dataKey of a chart's cartesian components. Ex: <Bar name="Name of my Data"/>`);var w=m.inactive?u:m.color;return G.createElement("li",mk({className:y,style:h,key:"legend-item-".concat(g)},zy(r.props,m,g)),G.createElement(sk,{width:o,height:o,viewBox:d,style:f},r.renderIcon(m)),G.createElement("span",{className:"recharts-legend-item-text",style:{color:w}},v?v(x,m,g):x))})}},{key:"render",value:function(){var r=this.props,s=r.payload,i=r.layout,o=r.align;if(!s||!s.length)return null;var l={padding:0,margin:0,textAlign:i==="horizontal"?o:"left"};return G.createElement("ul",{className:"recharts-default-legend",style:l},this.renderItems())}}])}(p.PureComponent);qm(CA,"displayName","Legend");qm(CA,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"middle",inactiveColor:"#ccc"});var Gwe=i0;function Ywe(){this.__data__=new Gwe,this.size=0}var Xwe=Ywe;function Jwe(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}var Qwe=Jwe;function Zwe(e){return this.__data__.get(e)}var eje=Zwe;function tje(e){return this.__data__.has(e)}var nje=tje,rje=i0,aje=mA,sje=pA,ije=200;function oje(e,t){var n=this.__data__;if(n instanceof rje){var r=n.__data__;if(!aje||r.length<ije-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new sje(r)}return n.set(e,t),this.size=n.size,this}var lje=oje,cje=i0,uje=Xwe,dje=Qwe,hje=eje,fje=nje,mje=lje;function Wh(e){var t=this.__data__=new cje(e);this.size=t.size}Wh.prototype.clear=uje;Wh.prototype.delete=dje;Wh.prototype.get=hje;Wh.prototype.has=fje;Wh.prototype.set=mje;var $8=Wh,pje="__lodash_hash_undefined__";function gje(e){return this.__data__.set(e,pje),this}var vje=gje;function yje(e){return this.__data__.has(e)}var xje=yje,bje=pA,wje=vje,jje=xje;function Yy(e){var t=-1,n=e==null?0:e.length;for(this.__data__=new bje;++t<n;)this.add(e[t])}Yy.prototype.add=Yy.prototype.push=wje;Yy.prototype.has=jje;var F8=Yy;function _je(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1}var U8=_je;function kje(e,t){return e.has(t)}var B8=kje,Sje=F8,Nje=U8,Cje=B8,Aje=1,Eje=2;function Tje(e,t,n,r,s,i){var o=n&Aje,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;var u=i.get(e),d=i.get(t);if(u&&d)return u==t&&d==e;var h=-1,f=!0,m=n&Eje?new Sje:void 0;for(i.set(e,t),i.set(t,e);++h<l;){var g=e[h],v=t[h];if(r)var y=o?r(v,g,h,t,e,i):r(g,v,h,e,t,i);if(y!==void 0){if(y)continue;f=!1;break}if(m){if(!Nje(t,function(x,w){if(!Cje(m,w)&&(g===x||s(g,x,n,r,i)))return m.push(w)})){f=!1;break}}else if(!(g===v||s(g,v,n,r,i))){f=!1;break}}return i.delete(e),i.delete(t),f}var z8=Tje,Pje=Xi,Oje=Pje.Uint8Array,Ije=Oje;function Rje(e){var t=-1,n=Array(e.size);return e.forEach(function(r,s){n[++t]=[s,r]}),n}var Mje=Rje;function Dje(e){var t=-1,n=Array(e.size);return e.forEach(function(r){n[++t]=r}),n}var AA=Dje,XO=og,JO=Ije,Lje=fA,$je=z8,Fje=Mje,Uje=AA,Bje=1,zje=2,Wje="[object Boolean]",qje="[object Date]",Hje="[object Error]",Kje="[object Map]",Vje="[object Number]",Gje="[object RegExp]",Yje="[object Set]",Xje="[object String]",Jje="[object Symbol]",Qje="[object ArrayBuffer]",Zje="[object DataView]",QO=XO?XO.prototype:void 0,Ij=QO?QO.valueOf:void 0;function e_e(e,t,n,r,s,i,o){switch(n){case Zje:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case Qje:return!(e.byteLength!=t.byteLength||!i(new JO(e),new JO(t)));case Wje:case qje:case Vje:return Lje(+e,+t);case Hje:return e.name==t.name&&e.message==t.message;case Gje:case Xje:return e==t+"";case Kje:var l=Fje;case Yje:var c=r&Bje;if(l||(l=Uje),e.size!=t.size&&!c)return!1;var u=o.get(e);if(u)return u==t;r|=zje,o.set(e,t);var d=$je(l(e),l(t),r,s,i,o);return o.delete(e),d;case Jje:if(Ij)return Ij.call(e)==Ij.call(t)}return!1}var t_e=e_e;function n_e(e,t){for(var n=-1,r=t.length,s=e.length;++n<r;)e[s+n]=t[n];return e}var W8=n_e,r_e=W8,a_e=Xa;function s_e(e,t,n){var r=t(e);return a_e(e)?r:r_e(r,n(e))}var i_e=s_e;function o_e(e,t){for(var n=-1,r=e==null?0:e.length,s=0,i=[];++n<r;){var o=e[n];t(o,n,e)&&(i[s++]=o)}return i}var l_e=o_e;function c_e(){return[]}var u_e=c_e,d_e=l_e,h_e=u_e,f_e=Object.prototype,m_e=f_e.propertyIsEnumerable,ZO=Object.getOwnPropertySymbols,p_e=ZO?function(e){return e==null?[]:(e=Object(e),d_e(ZO(e),function(t){return m_e.call(e,t)}))}:h_e,g_e=p_e;function v_e(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var y_e=v_e,x_e=Bo,b_e=zo,w_e="[object Arguments]";function j_e(e){return b_e(e)&&x_e(e)==w_e}var __e=j_e,eI=__e,k_e=zo,q8=Object.prototype,S_e=q8.hasOwnProperty,N_e=q8.propertyIsEnumerable,C_e=eI(function(){return arguments}())?eI:function(e){return k_e(e)&&S_e.call(e,"callee")&&!N_e.call(e,"callee")},EA=C_e,Xy={exports:{}};function A_e(){return!1}var E_e=A_e;Xy.exports;(function(e,t){var n=Xi,r=E_e,s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,o=i&&i.exports===s,l=o?n.Buffer:void 0,c=l?l.isBuffer:void 0,u=c||r;e.exports=u})(Xy,Xy.exports);var H8=Xy.exports,T_e=9007199254740991,P_e=/^(?:0|[1-9]\d*)$/;function O_e(e,t){var n=typeof e;return t=t??T_e,!!t&&(n=="number"||n!="symbol"&&P_e.test(e))&&e>-1&&e%1==0&&e<t}var TA=O_e,I_e=9007199254740991;function R_e(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=I_e}var PA=R_e,M_e=Bo,D_e=PA,L_e=zo,$_e="[object Arguments]",F_e="[object Array]",U_e="[object Boolean]",B_e="[object Date]",z_e="[object Error]",W_e="[object Function]",q_e="[object Map]",H_e="[object Number]",K_e="[object Object]",V_e="[object RegExp]",G_e="[object Set]",Y_e="[object String]",X_e="[object WeakMap]",J_e="[object ArrayBuffer]",Q_e="[object DataView]",Z_e="[object Float32Array]",e1e="[object Float64Array]",t1e="[object Int8Array]",n1e="[object Int16Array]",r1e="[object Int32Array]",a1e="[object Uint8Array]",s1e="[object Uint8ClampedArray]",i1e="[object Uint16Array]",o1e="[object Uint32Array]",Bn={};Bn[Z_e]=Bn[e1e]=Bn[t1e]=Bn[n1e]=Bn[r1e]=Bn[a1e]=Bn[s1e]=Bn[i1e]=Bn[o1e]=!0;Bn[$_e]=Bn[F_e]=Bn[J_e]=Bn[U_e]=Bn[Q_e]=Bn[B_e]=Bn[z_e]=Bn[W_e]=Bn[q_e]=Bn[H_e]=Bn[K_e]=Bn[V_e]=Bn[G_e]=Bn[Y_e]=Bn[X_e]=!1;function l1e(e){return L_e(e)&&D_e(e.length)&&!!Bn[M_e(e)]}var c1e=l1e;function u1e(e){return function(t){return e(t)}}var K8=u1e,Jy={exports:{}};Jy.exports;(function(e,t){var n=e8,r=t&&!t.nodeType&&t,s=r&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===r,o=i&&n.process,l=function(){try{var c=s&&s.require&&s.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}}();e.exports=l})(Jy,Jy.exports);var d1e=Jy.exports,h1e=c1e,f1e=K8,tI=d1e,nI=tI&&tI.isTypedArray,m1e=nI?f1e(nI):h1e,V8=m1e,p1e=y_e,g1e=EA,v1e=Xa,y1e=H8,x1e=TA,b1e=V8,w1e=Object.prototype,j1e=w1e.hasOwnProperty;function _1e(e,t){var n=v1e(e),r=!n&&g1e(e),s=!n&&!r&&y1e(e),i=!n&&!r&&!s&&b1e(e),o=n||r||s||i,l=o?p1e(e.length,String):[],c=l.length;for(var u in e)(t||j1e.call(e,u))&&!(o&&(u=="length"||s&&(u=="offset"||u=="parent")||i&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||x1e(u,c)))&&l.push(u);return l}var k1e=_1e,S1e=Object.prototype;function N1e(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||S1e;return e===n}var C1e=N1e;function A1e(e,t){return function(n){return e(t(n))}}var G8=A1e,E1e=G8,T1e=E1e(Object.keys,Object),P1e=T1e,O1e=C1e,I1e=P1e,R1e=Object.prototype,M1e=R1e.hasOwnProperty;function D1e(e){if(!O1e(e))return I1e(e);var t=[];for(var n in Object(e))M1e.call(e,n)&&n!="constructor"&&t.push(n);return t}var L1e=D1e,$1e=hA,F1e=PA;function U1e(e){return e!=null&&F1e(e.length)&&!$1e(e)}var cg=U1e,B1e=k1e,z1e=L1e,W1e=cg;function q1e(e){return W1e(e)?B1e(e):z1e(e)}var k0=q1e,H1e=i_e,K1e=g_e,V1e=k0;function G1e(e){return H1e(e,V1e,K1e)}var Y1e=G1e,rI=Y1e,X1e=1,J1e=Object.prototype,Q1e=J1e.hasOwnProperty;function Z1e(e,t,n,r,s,i){var o=n&X1e,l=rI(e),c=l.length,u=rI(t),d=u.length;if(c!=d&&!o)return!1;for(var h=c;h--;){var f=l[h];if(!(o?f in t:Q1e.call(t,f)))return!1}var m=i.get(e),g=i.get(t);if(m&&g)return m==t&&g==e;var v=!0;i.set(e,t),i.set(t,e);for(var y=o;++h<c;){f=l[h];var x=e[f],w=t[f];if(r)var b=o?r(w,x,f,t,e,i):r(x,w,f,e,t,i);if(!(b===void 0?x===w||s(x,w,n,r,i):b)){v=!1;break}y||(y=f=="constructor")}if(v&&!y){var _=e.constructor,k=t.constructor;_!=k&&"constructor"in e&&"constructor"in t&&!(typeof _=="function"&&_ instanceof _&&typeof k=="function"&&k instanceof k)&&(v=!1)}return i.delete(e),i.delete(t),v}var eke=Z1e,tke=yu,nke=Xi,rke=tke(nke,"DataView"),ake=rke,ske=yu,ike=Xi,oke=ske(ike,"Promise"),lke=oke,cke=yu,uke=Xi,dke=cke(uke,"Set"),Y8=dke,hke=yu,fke=Xi,mke=hke(fke,"WeakMap"),pke=mke,gk=ake,vk=mA,yk=lke,xk=Y8,bk=pke,X8=Bo,qh=n8,aI="[object Map]",gke="[object Object]",sI="[object Promise]",iI="[object Set]",oI="[object WeakMap]",lI="[object DataView]",vke=qh(gk),yke=qh(vk),xke=qh(yk),bke=qh(xk),wke=qh(bk),pc=X8;(gk&&pc(new gk(new ArrayBuffer(1)))!=lI||vk&&pc(new vk)!=aI||yk&&pc(yk.resolve())!=sI||xk&&pc(new xk)!=iI||bk&&pc(new bk)!=oI)&&(pc=function(e){var t=X8(e),n=t==gke?e.constructor:void 0,r=n?qh(n):"";if(r)switch(r){case vke:return lI;case yke:return aI;case xke:return sI;case bke:return iI;case wke:return oI}return t});var jke=pc,Rj=$8,_ke=z8,kke=t_e,Ske=eke,cI=jke,uI=Xa,dI=H8,Nke=V8,Cke=1,hI="[object Arguments]",fI="[object Array]",rv="[object Object]",Ake=Object.prototype,mI=Ake.hasOwnProperty;function Eke(e,t,n,r,s,i){var o=uI(e),l=uI(t),c=o?fI:cI(e),u=l?fI:cI(t);c=c==hI?rv:c,u=u==hI?rv:u;var d=c==rv,h=u==rv,f=c==u;if(f&&dI(e)){if(!dI(t))return!1;o=!0,d=!1}if(f&&!d)return i||(i=new Rj),o||Nke(e)?_ke(e,t,n,r,s,i):kke(e,t,c,n,r,s,i);if(!(n&Cke)){var m=d&&mI.call(e,"__wrapped__"),g=h&&mI.call(t,"__wrapped__");if(m||g){var v=m?e.value():e,y=g?t.value():t;return i||(i=new Rj),s(v,y,n,r,i)}}return f?(i||(i=new Rj),Ske(e,t,n,r,s,i)):!1}var Tke=Eke,Pke=Tke,pI=zo;function J8(e,t,n,r,s){return e===t?!0:e==null||t==null||!pI(e)&&!pI(t)?e!==e&&t!==t:Pke(e,t,n,r,J8,s)}var OA=J8,Oke=$8,Ike=OA,Rke=1,Mke=2;function Dke(e,t,n,r){var s=n.length,i=s,o=!r;if(e==null)return!i;for(e=Object(e);s--;){var l=n[s];if(o&&l[2]?l[1]!==e[l[0]]:!(l[0]in e))return!1}for(;++s<i;){l=n[s];var c=l[0],u=e[c],d=l[1];if(o&&l[2]){if(u===void 0&&!(c in e))return!1}else{var h=new Oke;if(r)var f=r(u,d,c,e,t,h);if(!(f===void 0?Ike(d,u,Rke|Mke,r,h):f))return!1}}return!0}var Lke=Dke,$ke=ec;function Fke(e){return e===e&&!$ke(e)}var Q8=Fke,Uke=Q8,Bke=k0;function zke(e){for(var t=Bke(e),n=t.length;n--;){var r=t[n],s=e[r];t[n]=[r,s,Uke(s)]}return t}var Wke=zke;function qke(e,t){return function(n){return n==null?!1:n[e]===t&&(t!==void 0||e in Object(n))}}var Z8=qke,Hke=Lke,Kke=Wke,Vke=Z8;function Gke(e){var t=Kke(e);return t.length==1&&t[0][2]?Vke(t[0][0],t[0][1]):function(n){return n===e||Hke(n,e,t)}}var Yke=Gke;function Xke(e,t){return e!=null&&t in Object(e)}var Jke=Xke,Qke=o8,Zke=EA,eSe=Xa,tSe=TA,nSe=PA,rSe=l0;function aSe(e,t,n){t=Qke(t,e);for(var r=-1,s=t.length,i=!1;++r<s;){var o=rSe(t[r]);if(!(i=e!=null&&n(e,o)))break;e=e[o]}return i||++r!=s?i:(s=e==null?0:e.length,!!s&&nSe(s)&&tSe(o,s)&&(eSe(e)||Zke(e)))}var sSe=aSe,iSe=Jke,oSe=sSe;function lSe(e,t){return e!=null&&oSe(e,t,iSe)}var cSe=lSe,uSe=OA,dSe=l8,hSe=cSe,fSe=dA,mSe=Q8,pSe=Z8,gSe=l0,vSe=1,ySe=2;function xSe(e,t){return fSe(e)&&mSe(t)?pSe(gSe(e),t):function(n){var r=dSe(n,e);return r===void 0&&r===t?hSe(n,e):uSe(t,r,vSe|ySe)}}var bSe=xSe;function wSe(e){return e}var Hh=wSe;function jSe(e){return function(t){return t==null?void 0:t[e]}}var _Se=jSe,kSe=yA;function SSe(e){return function(t){return kSe(t,e)}}var NSe=SSe,CSe=_Se,ASe=NSe,ESe=dA,TSe=l0;function PSe(e){return ESe(e)?CSe(TSe(e)):ASe(e)}var OSe=PSe,ISe=Yke,RSe=bSe,MSe=Hh,DSe=Xa,LSe=OSe;function $Se(e){return typeof e=="function"?e:e==null?MSe:typeof e=="object"?DSe(e)?RSe(e[0],e[1]):ISe(e):LSe(e)}var tc=$Se;function FSe(e,t,n,r){for(var s=e.length,i=n+(r?1:-1);r?i--:++i<s;)if(t(e[i],i,e))return i;return-1}var eW=FSe;function USe(e){return e!==e}var BSe=USe;function zSe(e,t,n){for(var r=n-1,s=e.length;++r<s;)if(e[r]===t)return r;return-1}var WSe=zSe,qSe=eW,HSe=BSe,KSe=WSe;function VSe(e,t,n){return t===t?KSe(e,t,n):qSe(e,HSe,n)}var GSe=VSe,YSe=GSe;function XSe(e,t){var n=e==null?0:e.length;return!!n&&YSe(e,t,0)>-1}var JSe=XSe;function QSe(e,t,n){for(var r=-1,s=e==null?0:e.length;++r<s;)if(n(t,e[r]))return!0;return!1}var ZSe=QSe;function eNe(){}var tNe=eNe,Mj=Y8,nNe=tNe,rNe=AA,aNe=1/0,sNe=Mj&&1/rNe(new Mj([,-0]))[1]==aNe?function(e){return new Mj(e)}:nNe,iNe=sNe,oNe=F8,lNe=JSe,cNe=ZSe,uNe=B8,dNe=iNe,hNe=AA,fNe=200;function mNe(e,t,n){var r=-1,s=lNe,i=e.length,o=!0,l=[],c=l;if(n)o=!1,s=cNe;else if(i>=fNe){var u=t?null:dNe(e);if(u)return hNe(u);o=!1,s=uNe,c=new oNe}else c=t?[]:l;e:for(;++r<i;){var d=e[r],h=t?t(d):d;if(d=n||d!==0?d:0,o&&h===h){for(var f=c.length;f--;)if(c[f]===h)continue e;t&&c.push(h),l.push(d)}else s(c,h,n)||(c!==l&&c.push(h),l.push(d))}return l}var pNe=mNe,gNe=tc,vNe=pNe;function yNe(e,t){return e&&e.length?vNe(e,gNe(t)):[]}var xNe=yNe;const gI=bn(xNe);function tW(e,t,n){return t===!0?gI(e,n):qt(t)?gI(e,t):e}function rh(e){"@babel/helpers - typeof";return rh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rh(e)}var bNe=["ref"];function vI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function eo(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?vI(Object(n),!0).forEach(function(r){S0(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):vI(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function wNe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,rW(r.key),r)}}function jNe(e,t,n){return t&&yI(e.prototype,t),n&&yI(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _Ne(e,t,n){return t=Qy(t),kNe(e,nW()?Reflect.construct(t,n||[],Qy(e).constructor):t.apply(e,n))}function kNe(e,t){if(t&&(rh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return SNe(e)}function SNe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function nW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(nW=function(){return!!e})()}function Qy(e){return Qy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Qy(e)}function NNe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wk(e,t)}function wk(e,t){return wk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},wk(e,t)}function S0(e,t,n){return t=rW(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rW(e){var t=CNe(e,"string");return rh(t)=="symbol"?t:t+""}function CNe(e,t){if(rh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(rh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ANe(e,t){if(e==null)return{};var n=ENe(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function ENe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function TNe(e){return e.value}function PNe(e,t){if(G.isValidElement(e))return G.cloneElement(e,t);if(typeof e=="function")return G.createElement(e,t);t.ref;var n=ANe(t,bNe);return G.createElement(CA,n)}var xI=1,Ss=function(e){function t(){var n;wNe(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=_Ne(this,t,[].concat(s)),S0(n,"lastBoundingBox",{width:-1,height:-1}),n}return NNe(t,e),jNe(t,[{key:"componentDidMount",value:function(){this.updateBBox()}},{key:"componentDidUpdate",value:function(){this.updateBBox()}},{key:"getBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();return r.height=this.wrapperNode.offsetHeight,r.width=this.wrapperNode.offsetWidth,r}return null}},{key:"updateBBox",value:function(){var r=this.props.onBBoxUpdate,s=this.getBBox();s?(Math.abs(s.width-this.lastBoundingBox.width)>xI||Math.abs(s.height-this.lastBoundingBox.height)>xI)&&(this.lastBoundingBox.width=s.width,this.lastBoundingBox.height=s.height,r&&r(s)):(this.lastBoundingBox.width!==-1||this.lastBoundingBox.height!==-1)&&(this.lastBoundingBox.width=-1,this.lastBoundingBox.height=-1,r&&r(null))}},{key:"getBBoxSnapshot",value:function(){return this.lastBoundingBox.width>=0&&this.lastBoundingBox.height>=0?eo({},this.lastBoundingBox):{width:0,height:0}}},{key:"getDefaultPosition",value:function(r){var s=this.props,i=s.layout,o=s.align,l=s.verticalAlign,c=s.margin,u=s.chartWidth,d=s.chartHeight,h,f;if(!r||(r.left===void 0||r.left===null)&&(r.right===void 0||r.right===null))if(o==="center"&&i==="vertical"){var m=this.getBBoxSnapshot();h={left:((u||0)-m.width)/2}}else h=o==="right"?{right:c&&c.right||0}:{left:c&&c.left||0};if(!r||(r.top===void 0||r.top===null)&&(r.bottom===void 0||r.bottom===null))if(l==="middle"){var g=this.getBBoxSnapshot();f={top:((d||0)-g.height)/2}}else f=l==="bottom"?{bottom:c&&c.bottom||0}:{top:c&&c.top||0};return eo(eo({},h),f)}},{key:"render",value:function(){var r=this,s=this.props,i=s.content,o=s.width,l=s.height,c=s.wrapperStyle,u=s.payloadUniqBy,d=s.payload,h=eo(eo({position:"absolute",width:o||"auto",height:l||"auto"},this.getDefaultPosition(c)),c);return G.createElement("div",{className:"recharts-legend-wrapper",style:h,ref:function(m){r.wrapperNode=m}},PNe(i,eo(eo({},this.props),{},{payload:tW(d,u,TNe)})))}}],[{key:"getWithHeight",value:function(r,s){var i=eo(eo({},this.defaultProps),r.props),o=i.layout;return o==="vertical"&&tt(r.props.height)?{height:r.props.height}:o==="horizontal"?{width:r.props.width||s}:null}}])}(p.PureComponent);S0(Ss,"displayName","Legend");S0(Ss,"defaultProps",{iconSize:14,layout:"horizontal",align:"center",verticalAlign:"bottom"});var bI=og,ONe=EA,INe=Xa,wI=bI?bI.isConcatSpreadable:void 0;function RNe(e){return INe(e)||ONe(e)||!!(wI&&e&&e[wI])}var MNe=RNe,DNe=W8,LNe=MNe;function aW(e,t,n,r,s){var i=-1,o=e.length;for(n||(n=LNe),s||(s=[]);++i<o;){var l=e[i];t>0&&n(l)?t>1?aW(l,t-1,n,r,s):DNe(s,l):r||(s[s.length]=l)}return s}var sW=aW;function $Ne(e){return function(t,n,r){for(var s=-1,i=Object(t),o=r(t),l=o.length;l--;){var c=o[e?l:++s];if(n(i[c],c,i)===!1)break}return t}}var FNe=$Ne,UNe=FNe,BNe=UNe(),zNe=BNe,WNe=zNe,qNe=k0;function HNe(e,t){return e&&WNe(e,t,qNe)}var iW=HNe,KNe=cg;function VNe(e,t){return function(n,r){if(n==null)return n;if(!KNe(n))return e(n,r);for(var s=n.length,i=t?s:-1,o=Object(n);(t?i--:++i<s)&&r(o[i],i,o)!==!1;);return n}}var GNe=VNe,YNe=iW,XNe=GNe,JNe=XNe(YNe),IA=JNe,QNe=IA,ZNe=cg;function eCe(e,t){var n=-1,r=ZNe(e)?Array(e.length):[];return QNe(e,function(s,i,o){r[++n]=t(s,i,o)}),r}var oW=eCe;function tCe(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}var nCe=tCe,jI=$h;function rCe(e,t){if(e!==t){var n=e!==void 0,r=e===null,s=e===e,i=jI(e),o=t!==void 0,l=t===null,c=t===t,u=jI(t);if(!l&&!u&&!i&&e>t||i&&o&&c&&!l&&!u||r&&o&&c||!n&&c||!s)return 1;if(!r&&!i&&!u&&e<t||u&&n&&s&&!r&&!i||l&&n&&s||!o&&s||!c)return-1}return 0}var aCe=rCe,sCe=aCe;function iCe(e,t,n){for(var r=-1,s=e.criteria,i=t.criteria,o=s.length,l=n.length;++r<o;){var c=sCe(s[r],i[r]);if(c){if(r>=l)return c;var u=n[r];return c*(u=="desc"?-1:1)}}return e.index-t.index}var oCe=iCe,Dj=vA,lCe=yA,cCe=tc,uCe=oW,dCe=nCe,hCe=K8,fCe=oCe,mCe=Hh,pCe=Xa;function gCe(e,t,n){t.length?t=Dj(t,function(i){return pCe(i)?function(o){return lCe(o,i.length===1?i[0]:i)}:i}):t=[mCe];var r=-1;t=Dj(t,hCe(cCe));var s=uCe(e,function(i,o,l){var c=Dj(t,function(u){return u(i)});return{criteria:c,index:++r,value:i}});return dCe(s,function(i,o){return fCe(i,o,n)})}var vCe=gCe;function yCe(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var xCe=yCe,bCe=xCe,_I=Math.max;function wCe(e,t,n){return t=_I(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=_I(r.length-t,0),o=Array(i);++s<i;)o[s]=r[t+s];s=-1;for(var l=Array(t+1);++s<t;)l[s]=r[s];return l[t]=n(o),bCe(e,this,l)}}var jCe=wCe;function _Ce(e){return function(){return e}}var kCe=_Ce,SCe=yu,NCe=function(){try{var e=SCe(Object,"defineProperty");return e({},"",{}),e}catch{}}(),lW=NCe,CCe=kCe,kI=lW,ACe=Hh,ECe=kI?function(e,t){return kI(e,"toString",{configurable:!0,enumerable:!1,value:CCe(t),writable:!0})}:ACe,TCe=ECe,PCe=800,OCe=16,ICe=Date.now;function RCe(e){var t=0,n=0;return function(){var r=ICe(),s=OCe-(r-n);if(n=r,s>0){if(++t>=PCe)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var MCe=RCe,DCe=TCe,LCe=MCe,$Ce=LCe(DCe),FCe=$Ce,UCe=Hh,BCe=jCe,zCe=FCe;function WCe(e,t){return zCe(BCe(e,t,UCe),e+"")}var qCe=WCe,HCe=fA,KCe=cg,VCe=TA,GCe=ec;function YCe(e,t,n){if(!GCe(n))return!1;var r=typeof t;return(r=="number"?KCe(n)&&VCe(t,n.length):r=="string"&&t in n)?HCe(n[t],e):!1}var N0=YCe,XCe=sW,JCe=vCe,QCe=qCe,SI=N0,ZCe=QCe(function(e,t){if(e==null)return[];var n=t.length;return n>1&&SI(e,t[0],t[1])?t=[]:n>2&&SI(t[0],t[1],t[2])&&(t=[t[0]]),JCe(e,XCe(t,1),[])}),eAe=ZCe;const RA=bn(eAe);function Hm(e){"@babel/helpers - typeof";return Hm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hm(e)}function jk(){return jk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jk.apply(this,arguments)}function tAe(e,t){return sAe(e)||aAe(e,t)||rAe(e,t)||nAe()}function nAe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rAe(e,t){if(e){if(typeof e=="string")return NI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NI(e,t)}}function NI(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function aAe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function sAe(e){if(Array.isArray(e))return e}function CI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Lj(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?CI(Object(n),!0).forEach(function(r){iAe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CI(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function iAe(e,t,n){return t=oAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function oAe(e){var t=lAe(e,"string");return Hm(t)=="symbol"?t:t+""}function lAe(e,t){if(Hm(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Hm(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function cAe(e){return Array.isArray(e)&&Sr(e[0])&&Sr(e[1])?e.join(" ~ "):e}var uAe=function(t){var n=t.separator,r=n===void 0?" : ":n,s=t.contentStyle,i=s===void 0?{}:s,o=t.itemStyle,l=o===void 0?{}:o,c=t.labelStyle,u=c===void 0?{}:c,d=t.payload,h=t.formatter,f=t.itemSorter,m=t.wrapperClassName,g=t.labelClassName,v=t.label,y=t.labelFormatter,x=t.accessibilityLayer,w=x===void 0?!1:x,b=function(){if(d&&d.length){var L={padding:0,margin:0},M=(f?RA(d,f):d).map(function(B,$){if(B.type==="none")return null;var z=Lj({display:"block",paddingTop:4,paddingBottom:4,color:B.color||"#000"},l),R=B.formatter||h||cAe,C=B.value,D=B.name,E=C,F=D;if(R&&E!=null&&F!=null){var I=R(C,D,B,$,d);if(Array.isArray(I)){var P=tAe(I,2);E=P[0],F=P[1]}else E=I}return G.createElement("li",{className:"recharts-tooltip-item",key:"tooltip-item-".concat($),style:z},Sr(F)?G.createElement("span",{className:"recharts-tooltip-item-name"},F):null,Sr(F)?G.createElement("span",{className:"recharts-tooltip-item-separator"},r):null,G.createElement("span",{className:"recharts-tooltip-item-value"},E),G.createElement("span",{className:"recharts-tooltip-item-unit"},B.unit||""))});return G.createElement("ul",{className:"recharts-tooltip-item-list",style:L},M)}return null},_=Lj({margin:0,padding:10,backgroundColor:"#fff",border:"1px solid #ccc",whiteSpace:"nowrap"},i),k=Lj({margin:0},u),j=!mn(v),S=j?v:"",T=on("recharts-default-tooltip",m),O=on("recharts-tooltip-label",g);j&&y&&d!==void 0&&d!==null&&(S=y(v,d));var A=w?{role:"status","aria-live":"assertive"}:{};return G.createElement("div",jk({className:T,style:_},A),G.createElement("p",{className:O,style:k},G.isValidElement(S)?S:"".concat(S)),b())};function Km(e){"@babel/helpers - typeof";return Km=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Km(e)}function av(e,t,n){return t=dAe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function dAe(e){var t=hAe(e,"string");return Km(t)=="symbol"?t:t+""}function hAe(e,t){if(Km(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Km(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pf="recharts-tooltip-wrapper",fAe={visibility:"hidden"};function mAe(e){var t=e.coordinate,n=e.translateX,r=e.translateY;return on(pf,av(av(av(av({},"".concat(pf,"-right"),tt(n)&&t&&tt(t.x)&&n>=t.x),"".concat(pf,"-left"),tt(n)&&t&&tt(t.x)&&n<t.x),"".concat(pf,"-bottom"),tt(r)&&t&&tt(t.y)&&r>=t.y),"".concat(pf,"-top"),tt(r)&&t&&tt(t.y)&&r<t.y))}function AI(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.key,s=e.offsetTopLeft,i=e.position,o=e.reverseDirection,l=e.tooltipDimension,c=e.viewBox,u=e.viewBoxDimension;if(i&&tt(i[r]))return i[r];var d=n[r]-l-s,h=n[r]+s;if(t[r])return o[r]?d:h;if(o[r]){var f=d,m=c[r];return f<m?Math.max(h,c[r]):Math.max(d,c[r])}var g=h+l,v=c[r]+u;return g>v?Math.max(d,c[r]):Math.max(h,c[r])}function pAe(e){var t=e.translateX,n=e.translateY,r=e.useTranslate3d;return{transform:r?"translate3d(".concat(t,"px, ").concat(n,"px, 0)"):"translate(".concat(t,"px, ").concat(n,"px)")}}function gAe(e){var t=e.allowEscapeViewBox,n=e.coordinate,r=e.offsetTopLeft,s=e.position,i=e.reverseDirection,o=e.tooltipBox,l=e.useTranslate3d,c=e.viewBox,u,d,h;return o.height>0&&o.width>0&&n?(d=AI({allowEscapeViewBox:t,coordinate:n,key:"x",offsetTopLeft:r,position:s,reverseDirection:i,tooltipDimension:o.width,viewBox:c,viewBoxDimension:c.width}),h=AI({allowEscapeViewBox:t,coordinate:n,key:"y",offsetTopLeft:r,position:s,reverseDirection:i,tooltipDimension:o.height,viewBox:c,viewBoxDimension:c.height}),u=pAe({translateX:d,translateY:h,useTranslate3d:l})):u=fAe,{cssProperties:u,cssClasses:mAe({translateX:d,translateY:h,coordinate:n})}}function ah(e){"@babel/helpers - typeof";return ah=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ah(e)}function EI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function TI(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?EI(Object(n),!0).forEach(function(r){kk(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):EI(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function vAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function yAe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,uW(r.key),r)}}function xAe(e,t,n){return t&&yAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function bAe(e,t,n){return t=Zy(t),wAe(e,cW()?Reflect.construct(t,n||[],Zy(e).constructor):t.apply(e,n))}function wAe(e,t){if(t&&(ah(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return jAe(e)}function jAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function cW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(cW=function(){return!!e})()}function Zy(e){return Zy=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Zy(e)}function _Ae(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_k(e,t)}function _k(e,t){return _k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},_k(e,t)}function kk(e,t,n){return t=uW(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function uW(e){var t=kAe(e,"string");return ah(t)=="symbol"?t:t+""}function kAe(e,t){if(ah(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ah(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var PI=1,SAe=function(e){function t(){var n;vAe(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=bAe(this,t,[].concat(s)),kk(n,"state",{dismissed:!1,dismissedAtCoordinate:{x:0,y:0},lastBoundingBox:{width:-1,height:-1}}),kk(n,"handleKeyDown",function(o){if(o.key==="Escape"){var l,c,u,d;n.setState({dismissed:!0,dismissedAtCoordinate:{x:(l=(c=n.props.coordinate)===null||c===void 0?void 0:c.x)!==null&&l!==void 0?l:0,y:(u=(d=n.props.coordinate)===null||d===void 0?void 0:d.y)!==null&&u!==void 0?u:0}})}}),n}return _Ae(t,e),xAe(t,[{key:"updateBBox",value:function(){if(this.wrapperNode&&this.wrapperNode.getBoundingClientRect){var r=this.wrapperNode.getBoundingClientRect();(Math.abs(r.width-this.state.lastBoundingBox.width)>PI||Math.abs(r.height-this.state.lastBoundingBox.height)>PI)&&this.setState({lastBoundingBox:{width:r.width,height:r.height}})}else(this.state.lastBoundingBox.width!==-1||this.state.lastBoundingBox.height!==-1)&&this.setState({lastBoundingBox:{width:-1,height:-1}})}},{key:"componentDidMount",value:function(){document.addEventListener("keydown",this.handleKeyDown),this.updateBBox()}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.handleKeyDown)}},{key:"componentDidUpdate",value:function(){var r,s;this.props.active&&this.updateBBox(),this.state.dismissed&&(((r=this.props.coordinate)===null||r===void 0?void 0:r.x)!==this.state.dismissedAtCoordinate.x||((s=this.props.coordinate)===null||s===void 0?void 0:s.y)!==this.state.dismissedAtCoordinate.y)&&(this.state.dismissed=!1)}},{key:"render",value:function(){var r=this,s=this.props,i=s.active,o=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,u=s.children,d=s.coordinate,h=s.hasPayload,f=s.isAnimationActive,m=s.offset,g=s.position,v=s.reverseDirection,y=s.useTranslate3d,x=s.viewBox,w=s.wrapperStyle,b=gAe({allowEscapeViewBox:o,coordinate:d,offsetTopLeft:m,position:g,reverseDirection:v,tooltipBox:this.state.lastBoundingBox,useTranslate3d:y,viewBox:x}),_=b.cssClasses,k=b.cssProperties,j=TI(TI({transition:f&&i?"transform ".concat(l,"ms ").concat(c):void 0},k),{},{pointerEvents:"none",visibility:!this.state.dismissed&&i&&h?"visible":"hidden",position:"absolute",top:0,left:0},w);return G.createElement("div",{tabIndex:-1,className:_,style:j,ref:function(T){r.wrapperNode=T}},u)}}])}(p.PureComponent),NAe=function(){return!(typeof window<"u"&&window.document&&window.document.createElement&&window.setTimeout)},Ol={isSsr:NAe(),get:function(t){return Ol[t]},set:function(t,n){if(typeof t=="string")Ol[t]=n;else{var r=Object.keys(t);r&&r.length&&r.forEach(function(s){Ol[s]=t[s]})}}};function sh(e){"@babel/helpers - typeof";return sh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sh(e)}function OI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function II(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?OI(Object(n),!0).forEach(function(r){MA(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):OI(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function CAe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function AAe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,hW(r.key),r)}}function EAe(e,t,n){return t&&AAe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function TAe(e,t,n){return t=ex(t),PAe(e,dW()?Reflect.construct(t,n||[],ex(e).constructor):t.apply(e,n))}function PAe(e,t){if(t&&(sh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return OAe(e)}function OAe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function dW(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(dW=function(){return!!e})()}function ex(e){return ex=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},ex(e)}function IAe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Sk(e,t)}function Sk(e,t){return Sk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Sk(e,t)}function MA(e,t,n){return t=hW(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hW(e){var t=RAe(e,"string");return sh(t)=="symbol"?t:t+""}function RAe(e,t){if(sh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(sh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function MAe(e){return e.dataKey}function DAe(e,t){return G.isValidElement(e)?G.cloneElement(e,t):typeof e=="function"?G.createElement(e,t):G.createElement(uAe,t)}var or=function(e){function t(){return CAe(this,t),TAe(this,t,arguments)}return IAe(t,e),EAe(t,[{key:"render",value:function(){var r=this,s=this.props,i=s.active,o=s.allowEscapeViewBox,l=s.animationDuration,c=s.animationEasing,u=s.content,d=s.coordinate,h=s.filterNull,f=s.isAnimationActive,m=s.offset,g=s.payload,v=s.payloadUniqBy,y=s.position,x=s.reverseDirection,w=s.useTranslate3d,b=s.viewBox,_=s.wrapperStyle,k=g??[];h&&k.length&&(k=tW(g.filter(function(S){return S.value!=null&&(S.hide!==!0||r.props.includeHidden)}),v,MAe));var j=k.length>0;return G.createElement(SAe,{allowEscapeViewBox:o,animationDuration:l,animationEasing:c,isAnimationActive:f,active:i,coordinate:d,hasPayload:j,offset:m,position:y,reverseDirection:x,useTranslate3d:w,viewBox:b,wrapperStyle:_},DAe(u,II(II({},this.props),{},{payload:k})))}}])}(p.PureComponent);MA(or,"displayName","Tooltip");MA(or,"defaultProps",{accessibilityLayer:!1,allowEscapeViewBox:{x:!1,y:!1},animationDuration:400,animationEasing:"ease",contentStyle:{},coordinate:{x:0,y:0},cursor:!0,cursorStyle:{},filterNull:!0,isAnimationActive:!Ol.isSsr,itemStyle:{},labelStyle:{},offset:10,reverseDirection:{x:!1,y:!1},separator:" : ",trigger:"hover",useTranslate3d:!1,viewBox:{x:0,y:0,height:0,width:0},wrapperStyle:{}});var LAe=Xi,$Ae=function(){return LAe.Date.now()},FAe=$Ae,UAe=/\s/;function BAe(e){for(var t=e.length;t--&&UAe.test(e.charAt(t)););return t}var zAe=BAe,WAe=zAe,qAe=/^\s+/;function HAe(e){return e&&e.slice(0,WAe(e)+1).replace(qAe,"")}var KAe=HAe,VAe=KAe,RI=ec,GAe=$h,MI=NaN,YAe=/^[-+]0x[0-9a-f]+$/i,XAe=/^0b[01]+$/i,JAe=/^0o[0-7]+$/i,QAe=parseInt;function ZAe(e){if(typeof e=="number")return e;if(GAe(e))return MI;if(RI(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=RI(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=VAe(e);var n=XAe.test(e);return n||JAe.test(e)?QAe(e.slice(2),n?2:8):YAe.test(e)?MI:+e}var fW=ZAe,eEe=ec,$j=FAe,DI=fW,tEe="Expected a function",nEe=Math.max,rEe=Math.min;function aEe(e,t,n){var r,s,i,o,l,c,u=0,d=!1,h=!1,f=!0;if(typeof e!="function")throw new TypeError(tEe);t=DI(t)||0,eEe(n)&&(d=!!n.leading,h="maxWait"in n,i=h?nEe(DI(n.maxWait)||0,t):i,f="trailing"in n?!!n.trailing:f);function m(j){var S=r,T=s;return r=s=void 0,u=j,o=e.apply(T,S),o}function g(j){return u=j,l=setTimeout(x,t),d?m(j):o}function v(j){var S=j-c,T=j-u,O=t-S;return h?rEe(O,i-T):O}function y(j){var S=j-c,T=j-u;return c===void 0||S>=t||S<0||h&&T>=i}function x(){var j=$j();if(y(j))return w(j);l=setTimeout(x,v(j))}function w(j){return l=void 0,f&&r?m(j):(r=s=void 0,o)}function b(){l!==void 0&&clearTimeout(l),u=0,r=c=s=l=void 0}function _(){return l===void 0?o:w($j())}function k(){var j=$j(),S=y(j);if(r=arguments,s=this,c=j,S){if(l===void 0)return g(c);if(h)return clearTimeout(l),l=setTimeout(x,t),m(c)}return l===void 0&&(l=setTimeout(x,t)),o}return k.cancel=b,k.flush=_,k}var sEe=aEe,iEe=sEe,oEe=ec,lEe="Expected a function";function cEe(e,t,n){var r=!0,s=!0;if(typeof e!="function")throw new TypeError(lEe);return oEe(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),iEe(e,t,{leading:r,maxWait:t,trailing:s})}var uEe=cEe;const mW=bn(uEe);function Vm(e){"@babel/helpers - typeof";return Vm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vm(e)}function LI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function sv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?LI(Object(n),!0).forEach(function(r){dEe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):LI(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dEe(e,t,n){return t=hEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hEe(e){var t=fEe(e,"string");return Vm(t)=="symbol"?t:t+""}function fEe(e,t){if(Vm(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Vm(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mEe(e,t){return yEe(e)||vEe(e,t)||gEe(e,t)||pEe()}function pEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gEe(e,t){if(e){if(typeof e=="string")return $I(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $I(e,t)}}function $I(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function yEe(e){if(Array.isArray(e))return e}var xs=p.forwardRef(function(e,t){var n=e.aspect,r=e.initialDimension,s=r===void 0?{width:-1,height:-1}:r,i=e.width,o=i===void 0?"100%":i,l=e.height,c=l===void 0?"100%":l,u=e.minWidth,d=u===void 0?0:u,h=e.minHeight,f=e.maxHeight,m=e.children,g=e.debounce,v=g===void 0?0:g,y=e.id,x=e.className,w=e.onResize,b=e.style,_=b===void 0?{}:b,k=p.useRef(null),j=p.useRef();j.current=w,p.useImperativeHandle(t,function(){return Object.defineProperty(k.current,"current",{get:function(){return console.warn("The usage of ref.current.current is deprecated and will no longer be supported."),k.current},configurable:!0})});var S=p.useState({containerWidth:s.width,containerHeight:s.height}),T=mEe(S,2),O=T[0],A=T[1],N=p.useCallback(function(M,B){A(function($){var z=Math.round(M),R=Math.round(B);return $.containerWidth===z&&$.containerHeight===R?$:{containerWidth:z,containerHeight:R}})},[]);p.useEffect(function(){var M=function(D){var E,F=D[0].contentRect,I=F.width,P=F.height;N(I,P),(E=j.current)===null||E===void 0||E.call(j,I,P)};v>0&&(M=mW(M,v,{trailing:!0,leading:!1}));var B=new ResizeObserver(M),$=k.current.getBoundingClientRect(),z=$.width,R=$.height;return N(z,R),B.observe(k.current),function(){B.disconnect()}},[N,v]);var L=p.useMemo(function(){var M=O.containerWidth,B=O.containerHeight;if(M<0||B<0)return null;_o(Sc(o)||Sc(c),`The width(%s) and height(%s) are both fixed numbers,
       maybe you don't need to use a ResponsiveContainer.`,o,c),_o(!n||n>0,"The aspect(%s) must be greater than zero.",n);var $=Sc(o)?M:o,z=Sc(c)?B:c;n&&n>0&&($?z=$/n:z&&($=z*n),f&&z>f&&(z=f)),_o($>0||z>0,`The width(%s) and height(%s) of chart should be greater than 0,
       please check the style of container, or the props width(%s) and height(%s),
       or add a minWidth(%s) or minHeight(%s) or use aspect(%s) to control the
       height and width.`,$,z,o,c,d,h,n);var R=!Array.isArray(m)&&jo(m.type).endsWith("Chart");return G.Children.map(m,function(C){return G.isValidElement(C)?p.cloneElement(C,sv({width:$,height:z},R?{style:sv({height:"100%",width:"100%",maxHeight:z,maxWidth:$},C.props.style)}:{})):C})},[n,m,c,f,h,d,O,o]);return G.createElement("div",{id:y?"".concat(y):void 0,className:on("recharts-responsive-container",x),style:sv(sv({},_),{},{width:o,height:c,minWidth:d,minHeight:h,maxHeight:f}),ref:k},L)}),pW=function(t){return null};pW.displayName="Cell";function Gm(e){"@babel/helpers - typeof";return Gm=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gm(e)}function FI(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Nk(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FI(Object(n),!0).forEach(function(r){xEe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FI(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function xEe(e,t,n){return t=bEe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function bEe(e){var t=wEe(e,"string");return Gm(t)=="symbol"?t:t+""}function wEe(e,t){if(Gm(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(Gm(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Lu={widthCache:{},cacheCount:0},jEe=2e3,_Ee={position:"absolute",top:"-20000px",left:0,padding:0,margin:0,border:"none",whiteSpace:"pre"},UI="recharts_measurement_span";function kEe(e){var t=Nk({},e);return Object.keys(t).forEach(function(n){t[n]||delete t[n]}),t}var Qf=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(t==null||Ol.isSsr)return{width:0,height:0};var r=kEe(n),s=JSON.stringify({text:t,copyStyle:r});if(Lu.widthCache[s])return Lu.widthCache[s];try{var i=document.getElementById(UI);i||(i=document.createElement("span"),i.setAttribute("id",UI),i.setAttribute("aria-hidden","true"),document.body.appendChild(i));var o=Nk(Nk({},_Ee),r);Object.assign(i.style,o),i.textContent="".concat(t);var l=i.getBoundingClientRect(),c={width:l.width,height:l.height};return Lu.widthCache[s]=c,++Lu.cacheCount>jEe&&(Lu.cacheCount=0,Lu.widthCache={}),c}catch{return{width:0,height:0}}},SEe=function(t){return{top:t.top+window.scrollY-document.documentElement.clientTop,left:t.left+window.scrollX-document.documentElement.clientLeft}};function Ym(e){"@babel/helpers - typeof";return Ym=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ym(e)}function tx(e,t){return EEe(e)||AEe(e,t)||CEe(e,t)||NEe()}function NEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function CEe(e,t){if(e){if(typeof e=="string")return BI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return BI(e,t)}}function BI(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function AEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function EEe(e){if(Array.isArray(e))return e}function TEe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zI(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,OEe(r.key),r)}}function PEe(e,t,n){return t&&zI(e.prototype,t),n&&zI(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function OEe(e){var t=IEe(e,"string");return Ym(t)=="symbol"?t:t+""}function IEe(e,t){if(Ym(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(Ym(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var WI=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([*/])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,qI=/(-?\d+(?:\.\d+)?[a-zA-Z%]*)([+-])(-?\d+(?:\.\d+)?[a-zA-Z%]*)/,REe=/^px|cm|vh|vw|em|rem|%|mm|in|pt|pc|ex|ch|vmin|vmax|Q$/,MEe=/(-?\d+(?:\.\d+)?)([a-zA-Z%]+)?/,gW={cm:96/2.54,mm:96/25.4,pt:96/72,pc:96/6,in:96,Q:96/(2.54*40),px:1},DEe=Object.keys(gW),od="NaN";function LEe(e,t){return e*gW[t]}var iv=function(){function e(t,n){TEe(this,e),this.num=t,this.unit=n,this.num=t,this.unit=n,Number.isNaN(t)&&(this.unit=""),n!==""&&!REe.test(n)&&(this.num=NaN,this.unit=""),DEe.includes(n)&&(this.num=LEe(t,n),this.unit="px")}return PEe(e,[{key:"add",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num+n.num,this.unit)}},{key:"subtract",value:function(n){return this.unit!==n.unit?new e(NaN,""):new e(this.num-n.num,this.unit)}},{key:"multiply",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num*n.num,this.unit||n.unit)}},{key:"divide",value:function(n){return this.unit!==""&&n.unit!==""&&this.unit!==n.unit?new e(NaN,""):new e(this.num/n.num,this.unit||n.unit)}},{key:"toString",value:function(){return"".concat(this.num).concat(this.unit)}},{key:"isNaN",value:function(){return Number.isNaN(this.num)}}],[{key:"parse",value:function(n){var r,s=(r=MEe.exec(n))!==null&&r!==void 0?r:[],i=tx(s,3),o=i[1],l=i[2];return new e(parseFloat(o),l??"")}}])}();function vW(e){if(e.includes(od))return od;for(var t=e;t.includes("*")||t.includes("/");){var n,r=(n=WI.exec(t))!==null&&n!==void 0?n:[],s=tx(r,4),i=s[1],o=s[2],l=s[3],c=iv.parse(i??""),u=iv.parse(l??""),d=o==="*"?c.multiply(u):c.divide(u);if(d.isNaN())return od;t=t.replace(WI,d.toString())}for(;t.includes("+")||/.-\d+(?:\.\d+)?/.test(t);){var h,f=(h=qI.exec(t))!==null&&h!==void 0?h:[],m=tx(f,4),g=m[1],v=m[2],y=m[3],x=iv.parse(g??""),w=iv.parse(y??""),b=v==="+"?x.add(w):x.subtract(w);if(b.isNaN())return od;t=t.replace(qI,b.toString())}return t}var HI=/\(([^()]*)\)/;function $Ee(e){for(var t=e;t.includes("(");){var n=HI.exec(t),r=tx(n,2),s=r[1];t=t.replace(HI,vW(s))}return t}function FEe(e){var t=e.replace(/\s+/g,"");return t=$Ee(t),t=vW(t),t}function UEe(e){try{return FEe(e)}catch{return od}}function Fj(e){var t=UEe(e.slice(5,-1));return t===od?"":t}var BEe=["x","y","lineHeight","capHeight","scaleToFit","textAnchor","verticalAnchor","fill"],zEe=["dx","dy","angle","className","breakAll"];function Ck(){return Ck=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ck.apply(this,arguments)}function KI(e,t){if(e==null)return{};var n=WEe(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function WEe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function VI(e,t){return VEe(e)||KEe(e,t)||HEe(e,t)||qEe()}function qEe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function HEe(e,t){if(e){if(typeof e=="string")return GI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return GI(e,t)}}function GI(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function KEe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t===0){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function VEe(e){if(Array.isArray(e))return e}var yW=/[ \f\n\r\t\v\u2028\u2029]+/,xW=function(t){var n=t.children,r=t.breakAll,s=t.style;try{var i=[];mn(n)||(r?i=n.toString().split(""):i=n.toString().split(yW));var o=i.map(function(c){return{word:c,width:Qf(c,s).width}}),l=r?0:Qf("",s).width;return{wordsWithComputedWidth:o,spaceWidth:l}}catch{return null}},GEe=function(t,n,r,s,i){var o=t.maxLines,l=t.children,c=t.style,u=t.breakAll,d=tt(o),h=l,f=function(){var $=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return $.reduce(function(z,R){var C=R.word,D=R.width,E=z[z.length-1];if(E&&(s==null||i||E.width+D+r<Number(s)))E.words.push(C),E.width+=D+r;else{var F={words:[C],width:D};z.push(F)}return z},[])},m=f(n),g=function($){return $.reduce(function(z,R){return z.width>R.width?z:R})};if(!d)return m;for(var v="",y=function($){var z=h.slice(0,$),R=xW({breakAll:u,style:c,children:z+v}).wordsWithComputedWidth,C=f(R),D=C.length>o||g(C).width>Number(s);return[D,C]},x=0,w=h.length-1,b=0,_;x<=w&&b<=h.length-1;){var k=Math.floor((x+w)/2),j=k-1,S=y(j),T=VI(S,2),O=T[0],A=T[1],N=y(k),L=VI(N,1),M=L[0];if(!O&&!M&&(x=k+1),O&&M&&(w=k-1),!O&&M){_=A;break}b++}return _||m},YI=function(t){var n=mn(t)?[]:t.toString().split(yW);return[{words:n}]},YEe=function(t){var n=t.width,r=t.scaleToFit,s=t.children,i=t.style,o=t.breakAll,l=t.maxLines;if((n||r)&&!Ol.isSsr){var c,u,d=xW({breakAll:o,children:s,style:i});if(d){var h=d.wordsWithComputedWidth,f=d.spaceWidth;c=h,u=f}else return YI(s);return GEe({breakAll:o,children:s,maxLines:l,style:i},c,u,n,r)}return YI(s)},XI="#808080",nx=function(t){var n=t.x,r=n===void 0?0:n,s=t.y,i=s===void 0?0:s,o=t.lineHeight,l=o===void 0?"1em":o,c=t.capHeight,u=c===void 0?"0.71em":c,d=t.scaleToFit,h=d===void 0?!1:d,f=t.textAnchor,m=f===void 0?"start":f,g=t.verticalAnchor,v=g===void 0?"end":g,y=t.fill,x=y===void 0?XI:y,w=KI(t,BEe),b=p.useMemo(function(){return YEe({breakAll:w.breakAll,children:w.children,maxLines:w.maxLines,scaleToFit:h,style:w.style,width:w.width})},[w.breakAll,w.children,w.maxLines,h,w.style,w.width]),_=w.dx,k=w.dy,j=w.angle,S=w.className,T=w.breakAll,O=KI(w,zEe);if(!Sr(r)||!Sr(i))return null;var A=r+(tt(_)?_:0),N=i+(tt(k)?k:0),L;switch(v){case"start":L=Fj("calc(".concat(u,")"));break;case"middle":L=Fj("calc(".concat((b.length-1)/2," * -").concat(l," + (").concat(u," / 2))"));break;default:L=Fj("calc(".concat(b.length-1," * -").concat(l,")"));break}var M=[];if(h){var B=b[0].width,$=w.width;M.push("scale(".concat((tt($)?$/B:1)/B,")"))}return j&&M.push("rotate(".concat(j,", ").concat(A,", ").concat(N,")")),M.length&&(O.transform=M.join(" ")),G.createElement("text",Ck({},fn(O,!0),{x:A,y:N,className:on("recharts-text",S),textAnchor:m,fill:x.includes("url")?XI:x}),b.map(function(z,R){var C=z.words.join(T?"":" ");return G.createElement("tspan",{x:A,dy:R===0?L:l,key:"".concat(C,"-").concat(R)},C)}))};function Il(e,t){return e==null||t==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function XEe(e,t){return e==null||t==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function DA(e){let t,n,r;e.length!==2?(t=Il,n=(l,c)=>Il(e(l),c),r=(l,c)=>e(l)-c):(t=e===Il||e===XEe?e:JEe,n=e,r=e);function s(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const h=u+d>>>1;n(l[h],c)<0?u=h+1:d=h}while(u<d)}return u}function i(l,c,u=0,d=l.length){if(u<d){if(t(c,c)!==0)return d;do{const h=u+d>>>1;n(l[h],c)<=0?u=h+1:d=h}while(u<d)}return u}function o(l,c,u=0,d=l.length){const h=s(l,c,u,d-1);return h>u&&r(l[h-1],c)>-r(l[h],c)?h-1:h}return{left:s,center:o,right:i}}function JEe(){return 0}function bW(e){return e===null?NaN:+e}function*QEe(e,t){for(let n of e)n!=null&&(n=+n)>=n&&(yield n)}const ZEe=DA(Il),ug=ZEe.right;DA(bW).center;class JI extends Map{constructor(t,n=nTe){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,s]of t)this.set(r,s)}get(t){return super.get(QI(this,t))}has(t){return super.has(QI(this,t))}set(t,n){return super.set(eTe(this,t),n)}delete(t){return super.delete(tTe(this,t))}}function QI({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function eTe({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function tTe({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(r),e.delete(r)),n}function nTe(e){return e!==null&&typeof e=="object"?e.valueOf():e}function rTe(e=Il){if(e===Il)return wW;if(typeof e!="function")throw new TypeError("compare is not a function");return(t,n)=>{const r=e(t,n);return r||r===0?r:(e(n,n)===0)-(e(t,t)===0)}}function wW(e,t){return(e==null||!(e>=e))-(t==null||!(t>=t))||(e<t?-1:e>t?1:0)}const aTe=Math.sqrt(50),sTe=Math.sqrt(10),iTe=Math.sqrt(2);function rx(e,t,n){const r=(t-e)/Math.max(0,n),s=Math.floor(Math.log10(r)),i=r/Math.pow(10,s),o=i>=aTe?10:i>=sTe?5:i>=iTe?2:1;let l,c,u;return s<0?(u=Math.pow(10,-s)/o,l=Math.round(e*u),c=Math.round(t*u),l/u<e&&++l,c/u>t&&--c,u=-u):(u=Math.pow(10,s)*o,l=Math.round(e/u),c=Math.round(t/u),l*u<e&&++l,c*u>t&&--c),c<l&&.5<=n&&n<2?rx(e,t,n*2):[l,c,u]}function Ak(e,t,n){if(t=+t,e=+e,n=+n,!(n>0))return[];if(e===t)return[e];const r=t<e,[s,i,o]=r?rx(t,e,n):rx(e,t,n);if(!(i>=s))return[];const l=i-s+1,c=new Array(l);if(r)if(o<0)for(let u=0;u<l;++u)c[u]=(i-u)/-o;else for(let u=0;u<l;++u)c[u]=(i-u)*o;else if(o<0)for(let u=0;u<l;++u)c[u]=(s+u)/-o;else for(let u=0;u<l;++u)c[u]=(s+u)*o;return c}function Ek(e,t,n){return t=+t,e=+e,n=+n,rx(e,t,n)[2]}function Tk(e,t,n){t=+t,e=+e,n=+n;const r=t<e,s=r?Ek(t,e,n):Ek(e,t,n);return(r?-1:1)*(s<0?1/-s:s)}function ZI(e,t){let n;for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);return n}function eR(e,t){let n;for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);return n}function jW(e,t,n=0,r=1/0,s){if(t=Math.floor(t),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(e.length-1,r)),!(n<=t&&t<=r))return e;for(s=s===void 0?wW:rTe(s);r>n;){if(r-n>600){const c=r-n+1,u=t-n+1,d=Math.log(c),h=.5*Math.exp(2*d/3),f=.5*Math.sqrt(d*h*(c-h)/c)*(u-c/2<0?-1:1),m=Math.max(n,Math.floor(t-u*h/c+f)),g=Math.min(r,Math.floor(t+(c-u)*h/c+f));jW(e,t,m,g,s)}const i=e[t];let o=n,l=r;for(gf(e,n,t),s(e[r],i)>0&&gf(e,n,r);o<l;){for(gf(e,o,l),++o,--l;s(e[o],i)<0;)++o;for(;s(e[l],i)>0;)--l}s(e[n],i)===0?gf(e,n,l):(++l,gf(e,l,r)),l<=t&&(n=l+1),t<=l&&(r=l-1)}return e}function gf(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function oTe(e,t,n){if(e=Float64Array.from(QEe(e)),!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return eR(e);if(t>=1)return ZI(e);var r,s=(r-1)*t,i=Math.floor(s),o=ZI(jW(e,i).subarray(0,i+1)),l=eR(e.subarray(i+1));return o+(l-o)*(s-i)}}function lTe(e,t,n=bW){if(!(!(r=e.length)||isNaN(t=+t))){if(t<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,s=(r-1)*t,i=Math.floor(s),o=+n(e[i],i,e),l=+n(e[i+1],i+1,e);return o+(l-o)*(s-i)}}function cTe(e,t,n){e=+e,t=+t,n=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+n;for(var r=-1,s=Math.max(0,Math.ceil((t-e)/n))|0,i=new Array(s);++r<s;)i[r]=e+r*n;return i}function $s(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function Wo(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const Pk=Symbol("implicit");function LA(){var e=new JI,t=[],n=[],r=Pk;function s(i){let o=e.get(i);if(o===void 0){if(r!==Pk)return r;e.set(i,o=t.push(i)-1)}return n[o%n.length]}return s.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new JI;for(const o of i)e.has(o)||e.set(o,t.push(o)-1);return s},s.range=function(i){return arguments.length?(n=Array.from(i),s):n.slice()},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return LA(t,n).unknown(r)},$s.apply(s,arguments),s}function Xm(){var e=LA().unknown(void 0),t=e.domain,n=e.range,r=0,s=1,i,o,l=!1,c=0,u=0,d=.5;delete e.unknown;function h(){var f=t().length,m=s<r,g=m?s:r,v=m?r:s;i=(v-g)/Math.max(1,f-c+u*2),l&&(i=Math.floor(i)),g+=(v-g-i*(f-c))*d,o=i*(1-c),l&&(g=Math.round(g),o=Math.round(o));var y=cTe(f).map(function(x){return g+i*x});return n(m?y.reverse():y)}return e.domain=function(f){return arguments.length?(t(f),h()):t()},e.range=function(f){return arguments.length?([r,s]=f,r=+r,s=+s,h()):[r,s]},e.rangeRound=function(f){return[r,s]=f,r=+r,s=+s,l=!0,h()},e.bandwidth=function(){return o},e.step=function(){return i},e.round=function(f){return arguments.length?(l=!!f,h()):l},e.padding=function(f){return arguments.length?(c=Math.min(1,u=+f),h()):c},e.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),h()):c},e.paddingOuter=function(f){return arguments.length?(u=+f,h()):u},e.align=function(f){return arguments.length?(d=Math.max(0,Math.min(1,f)),h()):d},e.copy=function(){return Xm(t(),[r,s]).round(l).paddingInner(c).paddingOuter(u).align(d)},$s.apply(h(),arguments)}function _W(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return _W(t())},e}function Zf(){return _W(Xm.apply(null,arguments).paddingInner(1))}function $A(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function kW(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function dg(){}var Jm=.7,ax=1/Jm,Sd="\\s*([+-]?\\d+)\\s*",Qm="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ui="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",uTe=/^#([0-9a-f]{3,8})$/,dTe=new RegExp(`^rgb\\(${Sd},${Sd},${Sd}\\)$`),hTe=new RegExp(`^rgb\\(${Ui},${Ui},${Ui}\\)$`),fTe=new RegExp(`^rgba\\(${Sd},${Sd},${Sd},${Qm}\\)$`),mTe=new RegExp(`^rgba\\(${Ui},${Ui},${Ui},${Qm}\\)$`),pTe=new RegExp(`^hsl\\(${Qm},${Ui},${Ui}\\)$`),gTe=new RegExp(`^hsla\\(${Qm},${Ui},${Ui},${Qm}\\)$`),tR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};$A(dg,Zm,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:nR,formatHex:nR,formatHex8:vTe,formatHsl:yTe,formatRgb:rR,toString:rR});function nR(){return this.rgb().formatHex()}function vTe(){return this.rgb().formatHex8()}function yTe(){return SW(this).formatHsl()}function rR(){return this.rgb().formatRgb()}function Zm(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=uTe.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?aR(t):n===3?new Ua(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?ov(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?ov(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=dTe.exec(e))?new Ua(t[1],t[2],t[3],1):(t=hTe.exec(e))?new Ua(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=fTe.exec(e))?ov(t[1],t[2],t[3],t[4]):(t=mTe.exec(e))?ov(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=pTe.exec(e))?oR(t[1],t[2]/100,t[3]/100,1):(t=gTe.exec(e))?oR(t[1],t[2]/100,t[3]/100,t[4]):tR.hasOwnProperty(e)?aR(tR[e]):e==="transparent"?new Ua(NaN,NaN,NaN,0):null}function aR(e){return new Ua(e>>16&255,e>>8&255,e&255,1)}function ov(e,t,n,r){return r<=0&&(e=t=n=NaN),new Ua(e,t,n,r)}function xTe(e){return e instanceof dg||(e=Zm(e)),e?(e=e.rgb(),new Ua(e.r,e.g,e.b,e.opacity)):new Ua}function Ok(e,t,n,r){return arguments.length===1?xTe(e):new Ua(e,t,n,r??1)}function Ua(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}$A(Ua,Ok,kW(dg,{brighter(e){return e=e==null?ax:Math.pow(ax,e),new Ua(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?Jm:Math.pow(Jm,e),new Ua(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new Ua($c(this.r),$c(this.g),$c(this.b),sx(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:sR,formatHex:sR,formatHex8:bTe,formatRgb:iR,toString:iR}));function sR(){return`#${Nc(this.r)}${Nc(this.g)}${Nc(this.b)}`}function bTe(){return`#${Nc(this.r)}${Nc(this.g)}${Nc(this.b)}${Nc((isNaN(this.opacity)?1:this.opacity)*255)}`}function iR(){const e=sx(this.opacity);return`${e===1?"rgb(":"rgba("}${$c(this.r)}, ${$c(this.g)}, ${$c(this.b)}${e===1?")":`, ${e})`}`}function sx(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function $c(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function Nc(e){return e=$c(e),(e<16?"0":"")+e.toString(16)}function oR(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ti(e,t,n,r)}function SW(e){if(e instanceof ti)return new ti(e.h,e.s,e.l,e.opacity);if(e instanceof dg||(e=Zm(e)),!e)return new ti;if(e instanceof ti)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),o=NaN,l=i-s,c=(i+s)/2;return l?(t===i?o=(n-r)/l+(n<r)*6:n===i?o=(r-t)/l+2:o=(t-n)/l+4,l/=c<.5?i+s:2-i-s,o*=60):l=c>0&&c<1?0:o,new ti(o,l,c,e.opacity)}function wTe(e,t,n,r){return arguments.length===1?SW(e):new ti(e,t,n,r??1)}function ti(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}$A(ti,wTe,kW(dg,{brighter(e){return e=e==null?ax:Math.pow(ax,e),new ti(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?Jm:Math.pow(Jm,e),new ti(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new Ua(Uj(e>=240?e-240:e+120,s,r),Uj(e,s,r),Uj(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new ti(lR(this.h),lv(this.s),lv(this.l),sx(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=sx(this.opacity);return`${e===1?"hsl(":"hsla("}${lR(this.h)}, ${lv(this.s)*100}%, ${lv(this.l)*100}%${e===1?")":`, ${e})`}`}}));function lR(e){return e=(e||0)%360,e<0?e+360:e}function lv(e){return Math.max(0,Math.min(1,e||0))}function Uj(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const FA=e=>()=>e;function jTe(e,t){return function(n){return e+n*t}}function _Te(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function kTe(e){return(e=+e)==1?NW:function(t,n){return n-t?_Te(t,n,e):FA(isNaN(t)?n:t)}}function NW(e,t){var n=t-e;return n?jTe(e,n):FA(isNaN(e)?t:e)}const cR=function e(t){var n=kTe(t);function r(s,i){var o=n((s=Ok(s)).r,(i=Ok(i)).r),l=n(s.g,i.g),c=n(s.b,i.b),u=NW(s.opacity,i.opacity);return function(d){return s.r=o(d),s.g=l(d),s.b=c(d),s.opacity=u(d),s+""}}return r.gamma=e,r}(1);function STe(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),s;return function(i){for(s=0;s<n;++s)r[s]=e[s]*(1-i)+t[s]*i;return r}}function NTe(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function CTe(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,s=new Array(r),i=new Array(n),o;for(o=0;o<r;++o)s[o]=Kh(e[o],t[o]);for(;o<n;++o)i[o]=t[o];return function(l){for(o=0;o<r;++o)i[o]=s[o](l);return i}}function ATe(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function ix(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function ETe(e,t){var n={},r={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?n[s]=Kh(e[s],t[s]):r[s]=t[s];return function(i){for(s in n)r[s]=n[s](i);return r}}var Ik=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Bj=new RegExp(Ik.source,"g");function TTe(e){return function(){return e}}function PTe(e){return function(t){return e(t)+""}}function OTe(e,t){var n=Ik.lastIndex=Bj.lastIndex=0,r,s,i,o=-1,l=[],c=[];for(e=e+"",t=t+"";(r=Ik.exec(e))&&(s=Bj.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),l[o]?l[o]+=i:l[++o]=i),(r=r[0])===(s=s[0])?l[o]?l[o]+=s:l[++o]=s:(l[++o]=null,c.push({i:o,x:ix(r,s)})),n=Bj.lastIndex;return n<t.length&&(i=t.slice(n),l[o]?l[o]+=i:l[++o]=i),l.length<2?c[0]?PTe(c[0].x):TTe(t):(t=c.length,function(u){for(var d=0,h;d<t;++d)l[(h=c[d]).i]=h.x(u);return l.join("")})}function Kh(e,t){var n=typeof t,r;return t==null||n==="boolean"?FA(t):(n==="number"?ix:n==="string"?(r=Zm(t))?(t=r,cR):OTe:t instanceof Zm?cR:t instanceof Date?ATe:NTe(t)?STe:Array.isArray(t)?CTe:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?ETe:ix)(e,t)}function UA(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}function ITe(e,t){t===void 0&&(t=e,e=Kh);for(var n=0,r=t.length-1,s=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(s,s=t[++n]);return function(o){var l=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return i[l](o-l)}}function RTe(e){return function(){return e}}function ox(e){return+e}var uR=[0,1];function ja(e){return e}function Rk(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:RTe(isNaN(t)?NaN:.5)}function MTe(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function DTe(e,t,n){var r=e[0],s=e[1],i=t[0],o=t[1];return s<r?(r=Rk(s,r),i=n(o,i)):(r=Rk(r,s),i=n(i,o)),function(l){return i(r(l))}}function LTe(e,t,n){var r=Math.min(e.length,t.length)-1,s=new Array(r),i=new Array(r),o=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<r;)s[o]=Rk(e[o],e[o+1]),i[o]=n(t[o],t[o+1]);return function(l){var c=ug(e,l,1,r)-1;return i[c](s[c](l))}}function hg(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function C0(){var e=uR,t=uR,n=Kh,r,s,i,o=ja,l,c,u;function d(){var f=Math.min(e.length,t.length);return o!==ja&&(o=MTe(e[0],e[f-1])),l=f>2?LTe:DTe,c=u=null,h}function h(f){return f==null||isNaN(f=+f)?i:(c||(c=l(e.map(r),t,n)))(r(o(f)))}return h.invert=function(f){return o(s((u||(u=l(t,e.map(r),ix)))(f)))},h.domain=function(f){return arguments.length?(e=Array.from(f,ox),d()):e.slice()},h.range=function(f){return arguments.length?(t=Array.from(f),d()):t.slice()},h.rangeRound=function(f){return t=Array.from(f),n=UA,d()},h.clamp=function(f){return arguments.length?(o=f?!0:ja,d()):o!==ja},h.interpolate=function(f){return arguments.length?(n=f,d()):n},h.unknown=function(f){return arguments.length?(i=f,h):i},function(f,m){return r=f,s=m,d()}}function BA(){return C0()(ja,ja)}function $Te(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function lx(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function ih(e){return e=lx(Math.abs(e)),e?e[1]:NaN}function FTe(e,t){return function(n,r){for(var s=n.length,i=[],o=0,l=e[0],c=0;s>0&&l>0&&(c+l+1>r&&(l=Math.max(1,r-c)),i.push(n.substring(s-=l,s+l)),!((c+=l+1)>r));)l=e[o=(o+1)%e.length];return i.reverse().join(t)}}function UTe(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var BTe=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function ep(e){if(!(t=BTe.exec(e)))throw new Error("invalid format: "+e);var t;return new zA({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}ep.prototype=zA.prototype;function zA(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}zA.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function zTe(e){e:for(var t=e.length,n=1,r=-1,s;n<t;++n)switch(e[n]){case".":r=s=n;break;case"0":r===0&&(r=n),s=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(s+1):e}var CW;function WTe(e,t){var n=lx(e,t);if(!n)return e+"";var r=n[0],s=n[1],i=s-(CW=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,o=r.length;return i===o?r:i>o?r+new Array(i-o+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+lx(e,Math.max(0,t+i-1))[0]}function dR(e,t){var n=lx(e,t);if(!n)return e+"";var r=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}const hR={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:$Te,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>dR(e*100,t),r:dR,s:WTe,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function fR(e){return e}var mR=Array.prototype.map,pR=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function qTe(e){var t=e.grouping===void 0||e.thousands===void 0?fR:FTe(mR.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?fR:UTe(mR.call(e.numerals,String)),o=e.percent===void 0?"%":e.percent+"",l=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(h){h=ep(h);var f=h.fill,m=h.align,g=h.sign,v=h.symbol,y=h.zero,x=h.width,w=h.comma,b=h.precision,_=h.trim,k=h.type;k==="n"?(w=!0,k="g"):hR[k]||(b===void 0&&(b=12),_=!0,k="g"),(y||f==="0"&&m==="=")&&(y=!0,f="0",m="=");var j=v==="$"?n:v==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",S=v==="$"?r:/[%p]/.test(k)?o:"",T=hR[k],O=/[defgprs%]/.test(k);b=b===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,b)):Math.max(0,Math.min(20,b));function A(N){var L=j,M=S,B,$,z;if(k==="c")M=T(N)+M,N="";else{N=+N;var R=N<0||1/N<0;if(N=isNaN(N)?c:T(Math.abs(N),b),_&&(N=zTe(N)),R&&+N==0&&g!=="+"&&(R=!1),L=(R?g==="("?g:l:g==="-"||g==="("?"":g)+L,M=(k==="s"?pR[8+CW/3]:"")+M+(R&&g==="("?")":""),O){for(B=-1,$=N.length;++B<$;)if(z=N.charCodeAt(B),48>z||z>57){M=(z===46?s+N.slice(B+1):N.slice(B))+M,N=N.slice(0,B);break}}}w&&!y&&(N=t(N,1/0));var C=L.length+N.length+M.length,D=C<x?new Array(x-C+1).join(f):"";switch(w&&y&&(N=t(D+N,D.length?x-M.length:1/0),D=""),m){case"<":N=L+N+M+D;break;case"=":N=L+D+N+M;break;case"^":N=D.slice(0,C=D.length>>1)+L+N+M+D.slice(C);break;default:N=D+L+N+M;break}return i(N)}return A.toString=function(){return h+""},A}function d(h,f){var m=u((h=ep(h),h.type="f",h)),g=Math.max(-8,Math.min(8,Math.floor(ih(f)/3)))*3,v=Math.pow(10,-g),y=pR[8+g/3];return function(x){return m(v*x)+y}}return{format:u,formatPrefix:d}}var cv,WA,AW;HTe({thousands:",",grouping:[3],currency:["$",""]});function HTe(e){return cv=qTe(e),WA=cv.format,AW=cv.formatPrefix,cv}function KTe(e){return Math.max(0,-ih(Math.abs(e)))}function VTe(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(ih(t)/3)))*3-ih(Math.abs(e)))}function GTe(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,ih(t)-ih(e))+1}function EW(e,t,n,r){var s=Tk(e,t,n),i;switch(r=ep(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(i=VTe(s,o))&&(r.precision=i),AW(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(i=GTe(s,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=i-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(i=KTe(s))&&(r.precision=i-(r.type==="%")*2);break}}return WA(r)}function nc(e){var t=e.domain;return e.ticks=function(n){var r=t();return Ak(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var s=t();return EW(s[0],s[s.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),s=0,i=r.length-1,o=r[s],l=r[i],c,u,d=10;for(l<o&&(u=o,o=l,l=u,u=s,s=i,i=u);d-- >0;){if(u=Ek(o,l,n),u===c)return r[s]=o,r[i]=l,t(r);if(u>0)o=Math.floor(o/u)*u,l=Math.ceil(l/u)*u;else if(u<0)o=Math.ceil(o*u)/u,l=Math.floor(l*u)/u;else break;c=u}return e},e}function cx(){var e=BA();return e.copy=function(){return hg(e,cx())},$s.apply(e,arguments),nc(e)}function TW(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,ox),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return TW(e).unknown(t)},e=arguments.length?Array.from(e,ox):[0,1],nc(n)}function PW(e,t){e=e.slice();var n=0,r=e.length-1,s=e[n],i=e[r],o;return i<s&&(o=n,n=r,r=o,o=s,s=i,i=o),e[n]=t.floor(s),e[r]=t.ceil(i),e}function gR(e){return Math.log(e)}function vR(e){return Math.exp(e)}function YTe(e){return-Math.log(-e)}function XTe(e){return-Math.exp(-e)}function JTe(e){return isFinite(e)?+("1e"+e):e<0?0:e}function QTe(e){return e===10?JTe:e===Math.E?Math.exp:t=>Math.pow(e,t)}function ZTe(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}function yR(e){return(t,n)=>-e(-t,n)}function qA(e){const t=e(gR,vR),n=t.domain;let r=10,s,i;function o(){return s=ZTe(r),i=QTe(r),n()[0]<0?(s=yR(s),i=yR(i),e(YTe,XTe)):e(gR,vR),t}return t.base=function(l){return arguments.length?(r=+l,o()):r},t.domain=function(l){return arguments.length?(n(l),o()):n()},t.ticks=l=>{const c=n();let u=c[0],d=c[c.length-1];const h=d<u;h&&([u,d]=[d,u]);let f=s(u),m=s(d),g,v;const y=l==null?10:+l;let x=[];if(!(r%1)&&m-f<y){if(f=Math.floor(f),m=Math.ceil(m),u>0){for(;f<=m;++f)for(g=1;g<r;++g)if(v=f<0?g/i(-f):g*i(f),!(v<u)){if(v>d)break;x.push(v)}}else for(;f<=m;++f)for(g=r-1;g>=1;--g)if(v=f>0?g/i(-f):g*i(f),!(v<u)){if(v>d)break;x.push(v)}x.length*2<y&&(x=Ak(u,d,y))}else x=Ak(f,m,Math.min(m-f,y)).map(i);return h?x.reverse():x},t.tickFormat=(l,c)=>{if(l==null&&(l=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=ep(c)).precision==null&&(c.trim=!0),c=WA(c)),l===1/0)return c;const u=Math.max(1,r*l/t.ticks().length);return d=>{let h=d/i(Math.round(s(d)));return h*r<r-.5&&(h*=r),h<=u?c(d):""}},t.nice=()=>n(PW(n(),{floor:l=>i(Math.floor(s(l))),ceil:l=>i(Math.ceil(s(l)))})),t}function OW(){const e=qA(C0()).domain([1,10]);return e.copy=()=>hg(e,OW()).base(e.base()),$s.apply(e,arguments),e}function xR(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function bR(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function HA(e){var t=1,n=e(xR(t),bR(t));return n.constant=function(r){return arguments.length?e(xR(t=+r),bR(t)):t},nc(n)}function IW(){var e=HA(C0());return e.copy=function(){return hg(e,IW()).constant(e.constant())},$s.apply(e,arguments)}function wR(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function ePe(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function tPe(e){return e<0?-e*e:e*e}function KA(e){var t=e(ja,ja),n=1;function r(){return n===1?e(ja,ja):n===.5?e(ePe,tPe):e(wR(n),wR(1/n))}return t.exponent=function(s){return arguments.length?(n=+s,r()):n},nc(t)}function VA(){var e=KA(C0());return e.copy=function(){return hg(e,VA()).exponent(e.exponent())},$s.apply(e,arguments),e}function nPe(){return VA.apply(null,arguments).exponent(.5)}function jR(e){return Math.sign(e)*e*e}function rPe(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function RW(){var e=BA(),t=[0,1],n=!1,r;function s(i){var o=rPe(e(i));return isNaN(o)?r:n?Math.round(o):o}return s.invert=function(i){return e.invert(jR(i))},s.domain=function(i){return arguments.length?(e.domain(i),s):e.domain()},s.range=function(i){return arguments.length?(e.range((t=Array.from(i,ox)).map(jR)),s):t.slice()},s.rangeRound=function(i){return s.range(i).round(!0)},s.round=function(i){return arguments.length?(n=!!i,s):n},s.clamp=function(i){return arguments.length?(e.clamp(i),s):e.clamp()},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return RW(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},$s.apply(s,arguments),nc(s)}function MW(){var e=[],t=[],n=[],r;function s(){var o=0,l=Math.max(1,t.length);for(n=new Array(l-1);++o<l;)n[o-1]=lTe(e,o/l);return i}function i(o){return o==null||isNaN(o=+o)?r:t[ug(n,o)]}return i.invertExtent=function(o){var l=t.indexOf(o);return l<0?[NaN,NaN]:[l>0?n[l-1]:e[0],l<n.length?n[l]:e[e.length-1]]},i.domain=function(o){if(!arguments.length)return e.slice();e=[];for(let l of o)l!=null&&!isNaN(l=+l)&&e.push(l);return e.sort(Il),s()},i.range=function(o){return arguments.length?(t=Array.from(o),s()):t.slice()},i.unknown=function(o){return arguments.length?(r=o,i):r},i.quantiles=function(){return n.slice()},i.copy=function(){return MW().domain(e).range(t).unknown(r)},$s.apply(i,arguments)}function DW(){var e=0,t=1,n=1,r=[.5],s=[0,1],i;function o(c){return c!=null&&c<=c?s[ug(r,c,0,n)]:i}function l(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*t-(c-n)*e)/(n+1);return o}return o.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,l()):[e,t]},o.range=function(c){return arguments.length?(n=(s=Array.from(c)).length-1,l()):s.slice()},o.invertExtent=function(c){var u=s.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},o.unknown=function(c){return arguments.length&&(i=c),o},o.thresholds=function(){return r.slice()},o.copy=function(){return DW().domain([e,t]).range(s).unknown(i)},$s.apply(nc(o),arguments)}function LW(){var e=[.5],t=[0,1],n,r=1;function s(i){return i!=null&&i<=i?t[ug(e,i,0,r)]:n}return s.domain=function(i){return arguments.length?(e=Array.from(i),r=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(i){return arguments.length?(t=Array.from(i),r=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(i){var o=t.indexOf(i);return[e[o-1],e[o]]},s.unknown=function(i){return arguments.length?(n=i,s):n},s.copy=function(){return LW().domain(e).range(t).unknown(n)},$s.apply(s,arguments)}const zj=new Date,Wj=new Date;function Er(e,t,n,r){function s(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return s.floor=i=>(e(i=new Date(+i)),i),s.ceil=i=>(e(i=new Date(i-1)),t(i,1),e(i),i),s.round=i=>{const o=s(i),l=s.ceil(i);return i-o<l-i?o:l},s.offset=(i,o)=>(t(i=new Date(+i),o==null?1:Math.floor(o)),i),s.range=(i,o,l)=>{const c=[];if(i=s.ceil(i),l=l==null?1:Math.floor(l),!(i<o)||!(l>0))return c;let u;do c.push(u=new Date(+i)),t(i,l),e(i);while(u<i&&i<o);return c},s.filter=i=>Er(o=>{if(o>=o)for(;e(o),!i(o);)o.setTime(o-1)},(o,l)=>{if(o>=o)if(l<0)for(;++l<=0;)for(;t(o,-1),!i(o););else for(;--l>=0;)for(;t(o,1),!i(o););}),n&&(s.count=(i,o)=>(zj.setTime(+i),Wj.setTime(+o),e(zj),e(Wj),Math.floor(n(zj,Wj))),s.every=i=>(i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?s.filter(r?o=>r(o)%i===0:o=>s.count(0,o)%i===0):s)),s}const ux=Er(()=>{},(e,t)=>{e.setTime(+e+t)},(e,t)=>t-e);ux.every=e=>(e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Er(t=>{t.setTime(Math.floor(t/e)*e)},(t,n)=>{t.setTime(+t+n*e)},(t,n)=>(n-t)/e):ux);ux.range;const po=1e3,As=po*60,go=As*60,Ro=go*24,GA=Ro*7,_R=Ro*30,qj=Ro*365,Cc=Er(e=>{e.setTime(e-e.getMilliseconds())},(e,t)=>{e.setTime(+e+t*po)},(e,t)=>(t-e)/po,e=>e.getUTCSeconds());Cc.range;const YA=Er(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*po)},(e,t)=>{e.setTime(+e+t*As)},(e,t)=>(t-e)/As,e=>e.getMinutes());YA.range;const XA=Er(e=>{e.setUTCSeconds(0,0)},(e,t)=>{e.setTime(+e+t*As)},(e,t)=>(t-e)/As,e=>e.getUTCMinutes());XA.range;const JA=Er(e=>{e.setTime(e-e.getMilliseconds()-e.getSeconds()*po-e.getMinutes()*As)},(e,t)=>{e.setTime(+e+t*go)},(e,t)=>(t-e)/go,e=>e.getHours());JA.range;const QA=Er(e=>{e.setUTCMinutes(0,0,0)},(e,t)=>{e.setTime(+e+t*go)},(e,t)=>(t-e)/go,e=>e.getUTCHours());QA.range;const fg=Er(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*As)/Ro,e=>e.getDate()-1);fg.range;const A0=Er(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ro,e=>e.getUTCDate()-1);A0.range;const $W=Er(e=>{e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t)},(e,t)=>(t-e)/Ro,e=>Math.floor(e/Ro));$W.range;function xu(e){return Er(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,n)=>{t.setDate(t.getDate()+n*7)},(t,n)=>(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*As)/GA)}const E0=xu(0),dx=xu(1),aPe=xu(2),sPe=xu(3),oh=xu(4),iPe=xu(5),oPe=xu(6);E0.range;dx.range;aPe.range;sPe.range;oh.range;iPe.range;oPe.range;function bu(e){return Er(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCDate(t.getUTCDate()+n*7)},(t,n)=>(n-t)/GA)}const T0=bu(0),hx=bu(1),lPe=bu(2),cPe=bu(3),lh=bu(4),uPe=bu(5),dPe=bu(6);T0.range;hx.range;lPe.range;cPe.range;lh.range;uPe.range;dPe.range;const ZA=Er(e=>{e.setDate(1),e.setHours(0,0,0,0)},(e,t)=>{e.setMonth(e.getMonth()+t)},(e,t)=>t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12,e=>e.getMonth());ZA.range;const eE=Er(e=>{e.setUTCDate(1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCMonth(e.getUTCMonth()+t)},(e,t)=>t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12,e=>e.getUTCMonth());eE.range;const Mo=Er(e=>{e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t)},(e,t)=>t.getFullYear()-e.getFullYear(),e=>e.getFullYear());Mo.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Er(t=>{t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,n)=>{t.setFullYear(t.getFullYear()+n*e)});Mo.range;const Do=Er(e=>{e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t)},(e,t)=>t.getUTCFullYear()-e.getUTCFullYear(),e=>e.getUTCFullYear());Do.every=e=>!isFinite(e=Math.floor(e))||!(e>0)?null:Er(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,n)=>{t.setUTCFullYear(t.getUTCFullYear()+n*e)});Do.range;function FW(e,t,n,r,s,i){const o=[[Cc,1,po],[Cc,5,5*po],[Cc,15,15*po],[Cc,30,30*po],[i,1,As],[i,5,5*As],[i,15,15*As],[i,30,30*As],[s,1,go],[s,3,3*go],[s,6,6*go],[s,12,12*go],[r,1,Ro],[r,2,2*Ro],[n,1,GA],[t,1,_R],[t,3,3*_R],[e,1,qj]];function l(u,d,h){const f=d<u;f&&([u,d]=[d,u]);const m=h&&typeof h.range=="function"?h:c(u,d,h),g=m?m.range(u,+d+1):[];return f?g.reverse():g}function c(u,d,h){const f=Math.abs(d-u)/h,m=DA(([,,y])=>y).right(o,f);if(m===o.length)return e.every(Tk(u/qj,d/qj,h));if(m===0)return ux.every(Math.max(Tk(u,d,h),1));const[g,v]=o[f/o[m-1][2]<o[m][2]/f?m-1:m];return g.every(v)}return[l,c]}const[hPe,fPe]=FW(Do,eE,T0,$W,QA,XA),[mPe,pPe]=FW(Mo,ZA,E0,fg,JA,YA);function Hj(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function Kj(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function vf(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function gPe(e){var t=e.dateTime,n=e.date,r=e.time,s=e.periods,i=e.days,o=e.shortDays,l=e.months,c=e.shortMonths,u=yf(s),d=xf(s),h=yf(i),f=xf(i),m=yf(o),g=xf(o),v=yf(l),y=xf(l),x=yf(c),w=xf(c),b={a:R,A:C,b:D,B:E,c:null,d:ER,e:ER,f:FPe,g:YPe,G:JPe,H:DPe,I:LPe,j:$Pe,L:UW,m:UPe,M:BPe,p:F,q:I,Q:OR,s:IR,S:zPe,u:WPe,U:qPe,V:HPe,w:KPe,W:VPe,x:null,X:null,y:GPe,Y:XPe,Z:QPe,"%":PR},_={a:P,A:U,b:Z,B:X,c:null,d:TR,e:TR,f:n2e,g:h2e,G:m2e,H:ZPe,I:e2e,j:t2e,L:zW,m:r2e,M:a2e,p:K,q:ie,Q:OR,s:IR,S:s2e,u:i2e,U:o2e,V:l2e,w:c2e,W:u2e,x:null,X:null,y:d2e,Y:f2e,Z:p2e,"%":PR},k={a:A,A:N,b:L,B:M,c:B,d:CR,e:CR,f:OPe,g:NR,G:SR,H:AR,I:AR,j:APe,L:PPe,m:CPe,M:EPe,p:O,q:NPe,Q:RPe,s:MPe,S:TPe,u:wPe,U:jPe,V:_Pe,w:bPe,W:kPe,x:$,X:z,y:NR,Y:SR,Z:SPe,"%":IPe};b.x=j(n,b),b.X=j(r,b),b.c=j(t,b),_.x=j(n,_),_.X=j(r,_),_.c=j(t,_);function j(H,he){return function(me){var ae=[],Ne=-1,de=0,Q=H.length,fe,Be,je;for(me instanceof Date||(me=new Date(+me));++Ne<Q;)H.charCodeAt(Ne)===37&&(ae.push(H.slice(de,Ne)),(Be=kR[fe=H.charAt(++Ne)])!=null?fe=H.charAt(++Ne):Be=fe==="e"?" ":"0",(je=he[fe])&&(fe=je(me,Be)),ae.push(fe),de=Ne+1);return ae.push(H.slice(de,Ne)),ae.join("")}}function S(H,he){return function(me){var ae=vf(1900,void 0,1),Ne=T(ae,H,me+="",0),de,Q;if(Ne!=me.length)return null;if("Q"in ae)return new Date(ae.Q);if("s"in ae)return new Date(ae.s*1e3+("L"in ae?ae.L:0));if(he&&!("Z"in ae)&&(ae.Z=0),"p"in ae&&(ae.H=ae.H%12+ae.p*12),ae.m===void 0&&(ae.m="q"in ae?ae.q:0),"V"in ae){if(ae.V<1||ae.V>53)return null;"w"in ae||(ae.w=1),"Z"in ae?(de=Kj(vf(ae.y,0,1)),Q=de.getUTCDay(),de=Q>4||Q===0?hx.ceil(de):hx(de),de=A0.offset(de,(ae.V-1)*7),ae.y=de.getUTCFullYear(),ae.m=de.getUTCMonth(),ae.d=de.getUTCDate()+(ae.w+6)%7):(de=Hj(vf(ae.y,0,1)),Q=de.getDay(),de=Q>4||Q===0?dx.ceil(de):dx(de),de=fg.offset(de,(ae.V-1)*7),ae.y=de.getFullYear(),ae.m=de.getMonth(),ae.d=de.getDate()+(ae.w+6)%7)}else("W"in ae||"U"in ae)&&("w"in ae||(ae.w="u"in ae?ae.u%7:"W"in ae?1:0),Q="Z"in ae?Kj(vf(ae.y,0,1)).getUTCDay():Hj(vf(ae.y,0,1)).getDay(),ae.m=0,ae.d="W"in ae?(ae.w+6)%7+ae.W*7-(Q+5)%7:ae.w+ae.U*7-(Q+6)%7);return"Z"in ae?(ae.H+=ae.Z/100|0,ae.M+=ae.Z%100,Kj(ae)):Hj(ae)}}function T(H,he,me,ae){for(var Ne=0,de=he.length,Q=me.length,fe,Be;Ne<de;){if(ae>=Q)return-1;if(fe=he.charCodeAt(Ne++),fe===37){if(fe=he.charAt(Ne++),Be=k[fe in kR?he.charAt(Ne++):fe],!Be||(ae=Be(H,me,ae))<0)return-1}else if(fe!=me.charCodeAt(ae++))return-1}return ae}function O(H,he,me){var ae=u.exec(he.slice(me));return ae?(H.p=d.get(ae[0].toLowerCase()),me+ae[0].length):-1}function A(H,he,me){var ae=m.exec(he.slice(me));return ae?(H.w=g.get(ae[0].toLowerCase()),me+ae[0].length):-1}function N(H,he,me){var ae=h.exec(he.slice(me));return ae?(H.w=f.get(ae[0].toLowerCase()),me+ae[0].length):-1}function L(H,he,me){var ae=x.exec(he.slice(me));return ae?(H.m=w.get(ae[0].toLowerCase()),me+ae[0].length):-1}function M(H,he,me){var ae=v.exec(he.slice(me));return ae?(H.m=y.get(ae[0].toLowerCase()),me+ae[0].length):-1}function B(H,he,me){return T(H,t,he,me)}function $(H,he,me){return T(H,n,he,me)}function z(H,he,me){return T(H,r,he,me)}function R(H){return o[H.getDay()]}function C(H){return i[H.getDay()]}function D(H){return c[H.getMonth()]}function E(H){return l[H.getMonth()]}function F(H){return s[+(H.getHours()>=12)]}function I(H){return 1+~~(H.getMonth()/3)}function P(H){return o[H.getUTCDay()]}function U(H){return i[H.getUTCDay()]}function Z(H){return c[H.getUTCMonth()]}function X(H){return l[H.getUTCMonth()]}function K(H){return s[+(H.getUTCHours()>=12)]}function ie(H){return 1+~~(H.getUTCMonth()/3)}return{format:function(H){var he=j(H+="",b);return he.toString=function(){return H},he},parse:function(H){var he=S(H+="",!1);return he.toString=function(){return H},he},utcFormat:function(H){var he=j(H+="",_);return he.toString=function(){return H},he},utcParse:function(H){var he=S(H+="",!0);return he.toString=function(){return H},he}}}var kR={"-":"",_:" ",0:"0"},Dr=/^\s*\d+/,vPe=/^%/,yPe=/[\\^$*+?|[\]().{}]/g;function cn(e,t,n){var r=e<0?"-":"",s=(r?-e:e)+"",i=s.length;return r+(i<n?new Array(n-i+1).join(t)+s:s)}function xPe(e){return e.replace(yPe,"\\$&")}function yf(e){return new RegExp("^(?:"+e.map(xPe).join("|")+")","i")}function xf(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function bPe(e,t,n){var r=Dr.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function wPe(e,t,n){var r=Dr.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function jPe(e,t,n){var r=Dr.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function _Pe(e,t,n){var r=Dr.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function kPe(e,t,n){var r=Dr.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function SR(e,t,n){var r=Dr.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function NR(e,t,n){var r=Dr.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function SPe(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function NPe(e,t,n){var r=Dr.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function CPe(e,t,n){var r=Dr.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function CR(e,t,n){var r=Dr.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function APe(e,t,n){var r=Dr.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function AR(e,t,n){var r=Dr.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function EPe(e,t,n){var r=Dr.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function TPe(e,t,n){var r=Dr.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function PPe(e,t,n){var r=Dr.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function OPe(e,t,n){var r=Dr.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function IPe(e,t,n){var r=vPe.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function RPe(e,t,n){var r=Dr.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function MPe(e,t,n){var r=Dr.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function ER(e,t){return cn(e.getDate(),t,2)}function DPe(e,t){return cn(e.getHours(),t,2)}function LPe(e,t){return cn(e.getHours()%12||12,t,2)}function $Pe(e,t){return cn(1+fg.count(Mo(e),e),t,3)}function UW(e,t){return cn(e.getMilliseconds(),t,3)}function FPe(e,t){return UW(e,t)+"000"}function UPe(e,t){return cn(e.getMonth()+1,t,2)}function BPe(e,t){return cn(e.getMinutes(),t,2)}function zPe(e,t){return cn(e.getSeconds(),t,2)}function WPe(e){var t=e.getDay();return t===0?7:t}function qPe(e,t){return cn(E0.count(Mo(e)-1,e),t,2)}function BW(e){var t=e.getDay();return t>=4||t===0?oh(e):oh.ceil(e)}function HPe(e,t){return e=BW(e),cn(oh.count(Mo(e),e)+(Mo(e).getDay()===4),t,2)}function KPe(e){return e.getDay()}function VPe(e,t){return cn(dx.count(Mo(e)-1,e),t,2)}function GPe(e,t){return cn(e.getFullYear()%100,t,2)}function YPe(e,t){return e=BW(e),cn(e.getFullYear()%100,t,2)}function XPe(e,t){return cn(e.getFullYear()%1e4,t,4)}function JPe(e,t){var n=e.getDay();return e=n>=4||n===0?oh(e):oh.ceil(e),cn(e.getFullYear()%1e4,t,4)}function QPe(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+cn(t/60|0,"0",2)+cn(t%60,"0",2)}function TR(e,t){return cn(e.getUTCDate(),t,2)}function ZPe(e,t){return cn(e.getUTCHours(),t,2)}function e2e(e,t){return cn(e.getUTCHours()%12||12,t,2)}function t2e(e,t){return cn(1+A0.count(Do(e),e),t,3)}function zW(e,t){return cn(e.getUTCMilliseconds(),t,3)}function n2e(e,t){return zW(e,t)+"000"}function r2e(e,t){return cn(e.getUTCMonth()+1,t,2)}function a2e(e,t){return cn(e.getUTCMinutes(),t,2)}function s2e(e,t){return cn(e.getUTCSeconds(),t,2)}function i2e(e){var t=e.getUTCDay();return t===0?7:t}function o2e(e,t){return cn(T0.count(Do(e)-1,e),t,2)}function WW(e){var t=e.getUTCDay();return t>=4||t===0?lh(e):lh.ceil(e)}function l2e(e,t){return e=WW(e),cn(lh.count(Do(e),e)+(Do(e).getUTCDay()===4),t,2)}function c2e(e){return e.getUTCDay()}function u2e(e,t){return cn(hx.count(Do(e)-1,e),t,2)}function d2e(e,t){return cn(e.getUTCFullYear()%100,t,2)}function h2e(e,t){return e=WW(e),cn(e.getUTCFullYear()%100,t,2)}function f2e(e,t){return cn(e.getUTCFullYear()%1e4,t,4)}function m2e(e,t){var n=e.getUTCDay();return e=n>=4||n===0?lh(e):lh.ceil(e),cn(e.getUTCFullYear()%1e4,t,4)}function p2e(){return"+0000"}function PR(){return"%"}function OR(e){return+e}function IR(e){return Math.floor(+e/1e3)}var $u,qW,HW;g2e({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function g2e(e){return $u=gPe(e),qW=$u.format,$u.parse,HW=$u.utcFormat,$u.utcParse,$u}function v2e(e){return new Date(e)}function y2e(e){return e instanceof Date?+e:+new Date(+e)}function tE(e,t,n,r,s,i,o,l,c,u){var d=BA(),h=d.invert,f=d.domain,m=u(".%L"),g=u(":%S"),v=u("%I:%M"),y=u("%I %p"),x=u("%a %d"),w=u("%b %d"),b=u("%B"),_=u("%Y");function k(j){return(c(j)<j?m:l(j)<j?g:o(j)<j?v:i(j)<j?y:r(j)<j?s(j)<j?x:w:n(j)<j?b:_)(j)}return d.invert=function(j){return new Date(h(j))},d.domain=function(j){return arguments.length?f(Array.from(j,y2e)):f().map(v2e)},d.ticks=function(j){var S=f();return e(S[0],S[S.length-1],j??10)},d.tickFormat=function(j,S){return S==null?k:u(S)},d.nice=function(j){var S=f();return(!j||typeof j.range!="function")&&(j=t(S[0],S[S.length-1],j??10)),j?f(PW(S,j)):d},d.copy=function(){return hg(d,tE(e,t,n,r,s,i,o,l,c,u))},d}function x2e(){return $s.apply(tE(mPe,pPe,Mo,ZA,E0,fg,JA,YA,Cc,qW).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function b2e(){return $s.apply(tE(hPe,fPe,Do,eE,T0,A0,QA,XA,Cc,HW).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function P0(){var e=0,t=1,n,r,s,i,o=ja,l=!1,c;function u(h){return h==null||isNaN(h=+h)?c:o(s===0?.5:(h=(i(h)-n)*s,l?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([e,t]=h,n=i(e=+e),r=i(t=+t),s=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(h){return arguments.length?(l=!!h,u):l},u.interpolator=function(h){return arguments.length?(o=h,u):o};function d(h){return function(f){var m,g;return arguments.length?([m,g]=f,o=h(m,g),u):[o(0),o(1)]}}return u.range=d(Kh),u.rangeRound=d(UA),u.unknown=function(h){return arguments.length?(c=h,u):c},function(h){return i=h,n=h(e),r=h(t),s=n===r?0:1/(r-n),u}}function rc(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function KW(){var e=nc(P0()(ja));return e.copy=function(){return rc(e,KW())},Wo.apply(e,arguments)}function VW(){var e=qA(P0()).domain([1,10]);return e.copy=function(){return rc(e,VW()).base(e.base())},Wo.apply(e,arguments)}function GW(){var e=HA(P0());return e.copy=function(){return rc(e,GW()).constant(e.constant())},Wo.apply(e,arguments)}function nE(){var e=KA(P0());return e.copy=function(){return rc(e,nE()).exponent(e.exponent())},Wo.apply(e,arguments)}function w2e(){return nE.apply(null,arguments).exponent(.5)}function YW(){var e=[],t=ja;function n(r){if(r!=null&&!isNaN(r=+r))return t((ug(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let s of r)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Il),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,s)=>t(s/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(s,i)=>oTe(e,i/r))},n.copy=function(){return YW(t).domain(e)},Wo.apply(n,arguments)}function O0(){var e=0,t=.5,n=1,r=1,s,i,o,l,c,u=ja,d,h=!1,f;function m(v){return isNaN(v=+v)?f:(v=.5+((v=+d(v))-i)*(r*v<r*i?l:c),u(h?Math.max(0,Math.min(1,v)):v))}m.domain=function(v){return arguments.length?([e,t,n]=v,s=d(e=+e),i=d(t=+t),o=d(n=+n),l=s===i?0:.5/(i-s),c=i===o?0:.5/(o-i),r=i<s?-1:1,m):[e,t,n]},m.clamp=function(v){return arguments.length?(h=!!v,m):h},m.interpolator=function(v){return arguments.length?(u=v,m):u};function g(v){return function(y){var x,w,b;return arguments.length?([x,w,b]=y,u=ITe(v,[x,w,b]),m):[u(0),u(.5),u(1)]}}return m.range=g(Kh),m.rangeRound=g(UA),m.unknown=function(v){return arguments.length?(f=v,m):f},function(v){return d=v,s=v(e),i=v(t),o=v(n),l=s===i?0:.5/(i-s),c=i===o?0:.5/(o-i),r=i<s?-1:1,m}}function XW(){var e=nc(O0()(ja));return e.copy=function(){return rc(e,XW())},Wo.apply(e,arguments)}function JW(){var e=qA(O0()).domain([.1,1,10]);return e.copy=function(){return rc(e,JW()).base(e.base())},Wo.apply(e,arguments)}function QW(){var e=HA(O0());return e.copy=function(){return rc(e,QW()).constant(e.constant())},Wo.apply(e,arguments)}function rE(){var e=KA(O0());return e.copy=function(){return rc(e,rE()).exponent(e.exponent())},Wo.apply(e,arguments)}function j2e(){return rE.apply(null,arguments).exponent(.5)}const RR=Object.freeze(Object.defineProperty({__proto__:null,scaleBand:Xm,scaleDiverging:XW,scaleDivergingLog:JW,scaleDivergingPow:rE,scaleDivergingSqrt:j2e,scaleDivergingSymlog:QW,scaleIdentity:TW,scaleImplicit:Pk,scaleLinear:cx,scaleLog:OW,scaleOrdinal:LA,scalePoint:Zf,scalePow:VA,scaleQuantile:MW,scaleQuantize:DW,scaleRadial:RW,scaleSequential:KW,scaleSequentialLog:VW,scaleSequentialPow:nE,scaleSequentialQuantile:YW,scaleSequentialSqrt:w2e,scaleSequentialSymlog:GW,scaleSqrt:nPe,scaleSymlog:IW,scaleThreshold:LW,scaleTime:x2e,scaleUtc:b2e,tickFormat:EW},Symbol.toStringTag,{value:"Module"}));var _2e=$h;function k2e(e,t,n){for(var r=-1,s=e.length;++r<s;){var i=e[r],o=t(i);if(o!=null&&(l===void 0?o===o&&!_2e(o):n(o,l)))var l=o,c=i}return c}var ZW=k2e;function S2e(e,t){return e>t}var N2e=S2e,C2e=ZW,A2e=N2e,E2e=Hh;function T2e(e){return e&&e.length?C2e(e,E2e,A2e):void 0}var P2e=T2e;const I0=bn(P2e);function O2e(e,t){return e<t}var I2e=O2e,R2e=ZW,M2e=I2e,D2e=Hh;function L2e(e){return e&&e.length?R2e(e,D2e,M2e):void 0}var $2e=L2e;const R0=bn($2e);var F2e=vA,U2e=tc,B2e=oW,z2e=Xa;function W2e(e,t){var n=z2e(e)?F2e:B2e;return n(e,U2e(t))}var q2e=W2e,H2e=sW,K2e=q2e;function V2e(e,t){return H2e(K2e(e,t),1)}var G2e=V2e;const Y2e=bn(G2e);var X2e=OA;function J2e(e,t){return X2e(e,t)}var Q2e=J2e;const aE=bn(Q2e);var Vh=1e9,Z2e={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},iE,Kn=!0,Ms="[DecimalError] ",Fc=Ms+"Invalid argument: ",sE=Ms+"Exponent out of range: ",Gh=Math.floor,gc=Math.pow,eOe=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ss,Pr=1e7,zn=7,eq=9007199254740991,fx=Gh(eq/zn),gt={};gt.absoluteValue=gt.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};gt.comparedTo=gt.cmp=function(e){var t,n,r,s,i=this;if(e=new i.constructor(e),i.s!==e.s)return i.s||-e.s;if(i.e!==e.e)return i.e>e.e^i.s<0?1:-1;for(r=i.d.length,s=e.d.length,t=0,n=r<s?r:s;t<n;++t)if(i.d[t]!==e.d[t])return i.d[t]>e.d[t]^i.s<0?1:-1;return r===s?0:r>s^i.s<0?1:-1};gt.decimalPlaces=gt.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*zn;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};gt.dividedBy=gt.div=function(e){return ko(this,new this.constructor(e))};gt.dividedToIntegerBy=gt.idiv=function(e){var t=this,n=t.constructor;return Cn(ko(t,new n(e),0,1),n.precision)};gt.equals=gt.eq=function(e){return!this.cmp(e)};gt.exponent=function(){return vr(this)};gt.greaterThan=gt.gt=function(e){return this.cmp(e)>0};gt.greaterThanOrEqualTo=gt.gte=function(e){return this.cmp(e)>=0};gt.isInteger=gt.isint=function(){return this.e>this.d.length-2};gt.isNegative=gt.isneg=function(){return this.s<0};gt.isPositive=gt.ispos=function(){return this.s>0};gt.isZero=function(){return this.s===0};gt.lessThan=gt.lt=function(e){return this.cmp(e)<0};gt.lessThanOrEqualTo=gt.lte=function(e){return this.cmp(e)<1};gt.logarithm=gt.log=function(e){var t,n=this,r=n.constructor,s=r.precision,i=s+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(ss))throw Error(Ms+"NaN");if(n.s<1)throw Error(Ms+(n.s?"NaN":"-Infinity"));return n.eq(ss)?new r(0):(Kn=!1,t=ko(tp(n,i),tp(e,i),i),Kn=!0,Cn(t,s))};gt.minus=gt.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?rq(t,e):tq(t,(e.s=-e.s,e))};gt.modulo=gt.mod=function(e){var t,n=this,r=n.constructor,s=r.precision;if(e=new r(e),!e.s)throw Error(Ms+"NaN");return n.s?(Kn=!1,t=ko(n,e,0,1).times(e),Kn=!0,n.minus(t)):Cn(new r(n),s)};gt.naturalExponential=gt.exp=function(){return nq(this)};gt.naturalLogarithm=gt.ln=function(){return tp(this)};gt.negated=gt.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};gt.plus=gt.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?tq(t,e):rq(t,(e.s=-e.s,e))};gt.precision=gt.sd=function(e){var t,n,r,s=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Fc+e);if(t=vr(s)+1,r=s.d.length-1,n=r*zn+1,r=s.d[r],r){for(;r%10==0;r/=10)n--;for(r=s.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};gt.squareRoot=gt.sqrt=function(){var e,t,n,r,s,i,o,l=this,c=l.constructor;if(l.s<1){if(!l.s)return new c(0);throw Error(Ms+"NaN")}for(e=vr(l),Kn=!1,s=Math.sqrt(+l),s==0||s==1/0?(t=Mi(l.d),(t.length+e)%2==0&&(t+="0"),s=Math.sqrt(t),e=Gh((e+1)/2)-(e<0||e%2),s==1/0?t="5e"+e:(t=s.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new c(t)):r=new c(s.toString()),n=c.precision,s=o=n+3;;)if(i=r,r=i.plus(ko(l,i,o+2)).times(.5),Mi(i.d).slice(0,o)===(t=Mi(r.d)).slice(0,o)){if(t=t.slice(o-3,o+1),s==o&&t=="4999"){if(Cn(i,n+1,0),i.times(i).eq(l)){r=i;break}}else if(t!="9999")break;o+=4}return Kn=!0,Cn(r,n)};gt.times=gt.mul=function(e){var t,n,r,s,i,o,l,c,u,d=this,h=d.constructor,f=d.d,m=(e=new h(e)).d;if(!d.s||!e.s)return new h(0);for(e.s*=d.s,n=d.e+e.e,c=f.length,u=m.length,c<u&&(i=f,f=m,m=i,o=c,c=u,u=o),i=[],o=c+u,r=o;r--;)i.push(0);for(r=u;--r>=0;){for(t=0,s=c+r;s>r;)l=i[s]+m[r]*f[s-r-1]+t,i[s--]=l%Pr|0,t=l/Pr|0;i[s]=(i[s]+t)%Pr|0}for(;!i[--o];)i.pop();return t?++n:i.shift(),e.d=i,e.e=n,Kn?Cn(e,h.precision):e};gt.toDecimalPlaces=gt.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(Hi(e,0,Vh),t===void 0?t=r.rounding:Hi(t,0,8),Cn(n,e+vr(n)+1,t))};gt.toExponential=function(e,t){var n,r=this,s=r.constructor;return e===void 0?n=au(r,!0):(Hi(e,0,Vh),t===void 0?t=s.rounding:Hi(t,0,8),r=Cn(new s(r),e+1,t),n=au(r,!0,e+1)),n};gt.toFixed=function(e,t){var n,r,s=this,i=s.constructor;return e===void 0?au(s):(Hi(e,0,Vh),t===void 0?t=i.rounding:Hi(t,0,8),r=Cn(new i(s),e+vr(s)+1,t),n=au(r.abs(),!1,e+vr(r)+1),s.isneg()&&!s.isZero()?"-"+n:n)};gt.toInteger=gt.toint=function(){var e=this,t=e.constructor;return Cn(new t(e),vr(e)+1,t.rounding)};gt.toNumber=function(){return+this};gt.toPower=gt.pow=function(e){var t,n,r,s,i,o,l=this,c=l.constructor,u=12,d=+(e=new c(e));if(!e.s)return new c(ss);if(l=new c(l),!l.s){if(e.s<1)throw Error(Ms+"Infinity");return l}if(l.eq(ss))return l;if(r=c.precision,e.eq(ss))return Cn(l,r);if(t=e.e,n=e.d.length-1,o=t>=n,i=l.s,o){if((n=d<0?-d:d)<=eq){for(s=new c(ss),t=Math.ceil(r/zn+4),Kn=!1;n%2&&(s=s.times(l),DR(s.d,t)),n=Gh(n/2),n!==0;)l=l.times(l),DR(l.d,t);return Kn=!0,e.s<0?new c(ss).div(s):Cn(s,r)}}else if(i<0)throw Error(Ms+"NaN");return i=i<0&&e.d[Math.max(t,n)]&1?-1:1,l.s=1,Kn=!1,s=e.times(tp(l,r+u)),Kn=!0,s=nq(s),s.s=i,s};gt.toPrecision=function(e,t){var n,r,s=this,i=s.constructor;return e===void 0?(n=vr(s),r=au(s,n<=i.toExpNeg||n>=i.toExpPos)):(Hi(e,1,Vh),t===void 0?t=i.rounding:Hi(t,0,8),s=Cn(new i(s),e,t),n=vr(s),r=au(s,e<=n||n<=i.toExpNeg,e)),r};gt.toSignificantDigits=gt.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(Hi(e,1,Vh),t===void 0?t=r.rounding:Hi(t,0,8)),Cn(new r(n),e,t)};gt.toString=gt.valueOf=gt.val=gt.toJSON=gt[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=vr(e),n=e.constructor;return au(e,t<=n.toExpNeg||t>=n.toExpPos)};function tq(e,t){var n,r,s,i,o,l,c,u,d=e.constructor,h=d.precision;if(!e.s||!t.s)return t.s||(t=new d(e)),Kn?Cn(t,h):t;if(c=e.d,u=t.d,o=e.e,s=t.e,c=c.slice(),i=o-s,i){for(i<0?(r=c,i=-i,l=u.length):(r=u,s=o,l=c.length),o=Math.ceil(h/zn),l=o>l?o+1:l+1,i>l&&(i=l,r.length=1),r.reverse();i--;)r.push(0);r.reverse()}for(l=c.length,i=u.length,l-i<0&&(i=l,r=u,u=c,c=r),n=0;i;)n=(c[--i]=c[i]+u[i]+n)/Pr|0,c[i]%=Pr;for(n&&(c.unshift(n),++s),l=c.length;c[--l]==0;)c.pop();return t.d=c,t.e=s,Kn?Cn(t,h):t}function Hi(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Fc+e)}function Mi(e){var t,n,r,s=e.length-1,i="",o=e[0];if(s>0){for(i+=o,t=1;t<s;t++)r=e[t]+"",n=zn-r.length,n&&(i+=il(n)),i+=r;o=e[t],r=o+"",n=zn-r.length,n&&(i+=il(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return i+o}var ko=function(){function e(r,s){var i,o=0,l=r.length;for(r=r.slice();l--;)i=r[l]*s+o,r[l]=i%Pr|0,o=i/Pr|0;return o&&r.unshift(o),r}function t(r,s,i,o){var l,c;if(i!=o)c=i>o?1:-1;else for(l=c=0;l<i;l++)if(r[l]!=s[l]){c=r[l]>s[l]?1:-1;break}return c}function n(r,s,i){for(var o=0;i--;)r[i]-=o,o=r[i]<s[i]?1:0,r[i]=o*Pr+r[i]-s[i];for(;!r[0]&&r.length>1;)r.shift()}return function(r,s,i,o){var l,c,u,d,h,f,m,g,v,y,x,w,b,_,k,j,S,T,O=r.constructor,A=r.s==s.s?1:-1,N=r.d,L=s.d;if(!r.s)return new O(r);if(!s.s)throw Error(Ms+"Division by zero");for(c=r.e-s.e,S=L.length,k=N.length,m=new O(A),g=m.d=[],u=0;L[u]==(N[u]||0);)++u;if(L[u]>(N[u]||0)&&--c,i==null?w=i=O.precision:o?w=i+(vr(r)-vr(s))+1:w=i,w<0)return new O(0);if(w=w/zn+2|0,u=0,S==1)for(d=0,L=L[0],w++;(u<k||d)&&w--;u++)b=d*Pr+(N[u]||0),g[u]=b/L|0,d=b%L|0;else{for(d=Pr/(L[0]+1)|0,d>1&&(L=e(L,d),N=e(N,d),S=L.length,k=N.length),_=S,v=N.slice(0,S),y=v.length;y<S;)v[y++]=0;T=L.slice(),T.unshift(0),j=L[0],L[1]>=Pr/2&&++j;do d=0,l=t(L,v,S,y),l<0?(x=v[0],S!=y&&(x=x*Pr+(v[1]||0)),d=x/j|0,d>1?(d>=Pr&&(d=Pr-1),h=e(L,d),f=h.length,y=v.length,l=t(h,v,f,y),l==1&&(d--,n(h,S<f?T:L,f))):(d==0&&(l=d=1),h=L.slice()),f=h.length,f<y&&h.unshift(0),n(v,h,y),l==-1&&(y=v.length,l=t(L,v,S,y),l<1&&(d++,n(v,S<y?T:L,y))),y=v.length):l===0&&(d++,v=[0]),g[u++]=d,l&&v[0]?v[y++]=N[_]||0:(v=[N[_]],y=1);while((_++<k||v[0]!==void 0)&&w--)}return g[0]||g.shift(),m.e=c,Cn(m,o?i+vr(m)+1:i)}}();function nq(e,t){var n,r,s,i,o,l,c=0,u=0,d=e.constructor,h=d.precision;if(vr(e)>16)throw Error(sE+vr(e));if(!e.s)return new d(ss);for(t==null?(Kn=!1,l=h):l=t,o=new d(.03125);e.abs().gte(.1);)e=e.times(o),u+=5;for(r=Math.log(gc(2,u))/Math.LN10*2+5|0,l+=r,n=s=i=new d(ss),d.precision=l;;){if(s=Cn(s.times(e),l),n=n.times(++c),o=i.plus(ko(s,n,l)),Mi(o.d).slice(0,l)===Mi(i.d).slice(0,l)){for(;u--;)i=Cn(i.times(i),l);return d.precision=h,t==null?(Kn=!0,Cn(i,h)):i}i=o}}function vr(e){for(var t=e.e*zn,n=e.d[0];n>=10;n/=10)t++;return t}function Vj(e,t,n){if(t>e.LN10.sd())throw Kn=!0,n&&(e.precision=n),Error(Ms+"LN10 precision limit exceeded");return Cn(new e(e.LN10),t)}function il(e){for(var t="";e--;)t+="0";return t}function tp(e,t){var n,r,s,i,o,l,c,u,d,h=1,f=10,m=e,g=m.d,v=m.constructor,y=v.precision;if(m.s<1)throw Error(Ms+(m.s?"NaN":"-Infinity"));if(m.eq(ss))return new v(0);if(t==null?(Kn=!1,u=y):u=t,m.eq(10))return t==null&&(Kn=!0),Vj(v,u);if(u+=f,v.precision=u,n=Mi(g),r=n.charAt(0),i=vr(m),Math.abs(i)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)m=m.times(e),n=Mi(m.d),r=n.charAt(0),h++;i=vr(m),r>1?(m=new v("0."+n),i++):m=new v(r+"."+n.slice(1))}else return c=Vj(v,u+2,y).times(i+""),m=tp(new v(r+"."+n.slice(1)),u-f).plus(c),v.precision=y,t==null?(Kn=!0,Cn(m,y)):m;for(l=o=m=ko(m.minus(ss),m.plus(ss),u),d=Cn(m.times(m),u),s=3;;){if(o=Cn(o.times(d),u),c=l.plus(ko(o,new v(s),u)),Mi(c.d).slice(0,u)===Mi(l.d).slice(0,u))return l=l.times(2),i!==0&&(l=l.plus(Vj(v,u+2,y).times(i+""))),l=ko(l,new v(h),u),v.precision=y,t==null?(Kn=!0,Cn(l,y)):l;l=c,s+=2}}function MR(e,t){var n,r,s;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(s=t.length;t.charCodeAt(s-1)===48;)--s;if(t=t.slice(r,s),t){if(s-=r,n=n-r-1,e.e=Gh(n/zn),e.d=[],r=(n+1)%zn,n<0&&(r+=zn),r<s){for(r&&e.d.push(+t.slice(0,r)),s-=zn;r<s;)e.d.push(+t.slice(r,r+=zn));t=t.slice(r),r=zn-t.length}else r-=s;for(;r--;)t+="0";if(e.d.push(+t),Kn&&(e.e>fx||e.e<-fx))throw Error(sE+n)}else e.s=0,e.e=0,e.d=[0];return e}function Cn(e,t,n){var r,s,i,o,l,c,u,d,h=e.d;for(o=1,i=h[0];i>=10;i/=10)o++;if(r=t-o,r<0)r+=zn,s=t,u=h[d=0];else{if(d=Math.ceil((r+1)/zn),i=h.length,d>=i)return e;for(u=i=h[d],o=1;i>=10;i/=10)o++;r%=zn,s=r-zn+o}if(n!==void 0&&(i=gc(10,o-s-1),l=u/i%10|0,c=t<0||h[d+1]!==void 0||u%i,c=n<4?(l||c)&&(n==0||n==(e.s<0?3:2)):l>5||l==5&&(n==4||c||n==6&&(r>0?s>0?u/gc(10,o-s):0:h[d-1])%10&1||n==(e.s<0?8:7))),t<1||!h[0])return c?(i=vr(e),h.length=1,t=t-i-1,h[0]=gc(10,(zn-t%zn)%zn),e.e=Gh(-t/zn)||0):(h.length=1,h[0]=e.e=e.s=0),e;if(r==0?(h.length=d,i=1,d--):(h.length=d+1,i=gc(10,zn-r),h[d]=s>0?(u/gc(10,o-s)%gc(10,s)|0)*i:0),c)for(;;)if(d==0){(h[0]+=i)==Pr&&(h[0]=1,++e.e);break}else{if(h[d]+=i,h[d]!=Pr)break;h[d--]=0,i=1}for(r=h.length;h[--r]===0;)h.pop();if(Kn&&(e.e>fx||e.e<-fx))throw Error(sE+vr(e));return e}function rq(e,t){var n,r,s,i,o,l,c,u,d,h,f=e.constructor,m=f.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new f(e),Kn?Cn(t,m):t;if(c=e.d,h=t.d,r=t.e,u=e.e,c=c.slice(),o=u-r,o){for(d=o<0,d?(n=c,o=-o,l=h.length):(n=h,r=u,l=c.length),s=Math.max(Math.ceil(m/zn),l)+2,o>s&&(o=s,n.length=1),n.reverse(),s=o;s--;)n.push(0);n.reverse()}else{for(s=c.length,l=h.length,d=s<l,d&&(l=s),s=0;s<l;s++)if(c[s]!=h[s]){d=c[s]<h[s];break}o=0}for(d&&(n=c,c=h,h=n,t.s=-t.s),l=c.length,s=h.length-l;s>0;--s)c[l++]=0;for(s=h.length;s>o;){if(c[--s]<h[s]){for(i=s;i&&c[--i]===0;)c[i]=Pr-1;--c[i],c[s]+=Pr}c[s]-=h[s]}for(;c[--l]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(t.d=c,t.e=r,Kn?Cn(t,m):t):new f(0)}function au(e,t,n){var r,s=vr(e),i=Mi(e.d),o=i.length;return t?(n&&(r=n-o)>0?i=i.charAt(0)+"."+i.slice(1)+il(r):o>1&&(i=i.charAt(0)+"."+i.slice(1)),i=i+(s<0?"e":"e+")+s):s<0?(i="0."+il(-s-1)+i,n&&(r=n-o)>0&&(i+=il(r))):s>=o?(i+=il(s+1-o),n&&(r=n-s-1)>0&&(i=i+"."+il(r))):((r=s+1)<o&&(i=i.slice(0,r)+"."+i.slice(r)),n&&(r=n-o)>0&&(s+1===o&&(i+="."),i+=il(r))),e.s<0?"-"+i:i}function DR(e,t){if(e.length>t)return e.length=t,!0}function aq(e){var t,n,r;function s(i){var o=this;if(!(o instanceof s))return new s(i);if(o.constructor=s,i instanceof s){o.s=i.s,o.e=i.e,o.d=(i=i.d)?i.slice():i;return}if(typeof i=="number"){if(i*0!==0)throw Error(Fc+i);if(i>0)o.s=1;else if(i<0)i=-i,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(i===~~i&&i<1e7){o.e=0,o.d=[i];return}return MR(o,i.toString())}else if(typeof i!="string")throw Error(Fc+i);if(i.charCodeAt(0)===45?(i=i.slice(1),o.s=-1):o.s=1,eOe.test(i))MR(o,i);else throw Error(Fc+i)}if(s.prototype=gt,s.ROUND_UP=0,s.ROUND_DOWN=1,s.ROUND_CEIL=2,s.ROUND_FLOOR=3,s.ROUND_HALF_UP=4,s.ROUND_HALF_DOWN=5,s.ROUND_HALF_EVEN=6,s.ROUND_HALF_CEIL=7,s.ROUND_HALF_FLOOR=8,s.clone=aq,s.config=s.set=tOe,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return s.config(e),s}function tOe(e){if(!e||typeof e!="object")throw Error(Ms+"Object expected");var t,n,r,s=["precision",1,Vh,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<s.length;t+=3)if((r=e[n=s[t]])!==void 0)if(Gh(r)===r&&r>=s[t+1]&&r<=s[t+2])this[n]=r;else throw Error(Fc+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Fc+n+": "+r);return this}var iE=aq(Z2e);ss=new iE(1);const kn=iE;function nOe(e){return iOe(e)||sOe(e)||aOe(e)||rOe()}function rOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function aOe(e,t){if(e){if(typeof e=="string")return Mk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mk(e,t)}}function sOe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function iOe(e){if(Array.isArray(e))return Mk(e)}function Mk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var oOe=function(t){return t},sq={"@@functional/placeholder":!0},iq=function(t){return t===sq},LR=function(t){return function n(){return arguments.length===0||arguments.length===1&&iq(arguments.length<=0?void 0:arguments[0])?n:t.apply(void 0,arguments)}},lOe=function e(t,n){return t===1?n:LR(function(){for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];var o=s.filter(function(l){return l!==sq}).length;return o>=t?n.apply(void 0,s):e(t-o,LR(function(){for(var l=arguments.length,c=new Array(l),u=0;u<l;u++)c[u]=arguments[u];var d=s.map(function(h){return iq(h)?c.shift():h});return n.apply(void 0,nOe(d).concat(c))}))})},M0=function(t){return lOe(t.length,t)},Dk=function(t,n){for(var r=[],s=t;s<n;++s)r[s-t]=s;return r},cOe=M0(function(e,t){return Array.isArray(t)?t.map(e):Object.keys(t).map(function(n){return t[n]}).map(e)}),uOe=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];if(!n.length)return oOe;var s=n.reverse(),i=s[0],o=s.slice(1);return function(){return o.reduce(function(l,c){return c(l)},i.apply(void 0,arguments))}},Lk=function(t){return Array.isArray(t)?t.reverse():t.split("").reverse.join("")},oq=function(t){var n=null,r=null;return function(){for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return n&&i.every(function(l,c){return l===n[c]})||(n=i,r=t.apply(void 0,i)),r}};function dOe(e){var t;return e===0?t=1:t=Math.floor(new kn(e).abs().log(10).toNumber())+1,t}function hOe(e,t,n){for(var r=new kn(e),s=0,i=[];r.lt(t)&&s<1e5;)i.push(r.toNumber()),r=r.add(n),s++;return i}var fOe=M0(function(e,t,n){var r=+e,s=+t;return r+n*(s-r)}),mOe=M0(function(e,t,n){var r=t-+e;return r=r||1/0,(n-e)/r}),pOe=M0(function(e,t,n){var r=t-+e;return r=r||1/0,Math.max(0,Math.min(1,(n-e)/r))});const D0={rangeStep:hOe,getDigitCount:dOe,interpolateNumber:fOe,uninterpolateNumber:mOe,uninterpolateTruncation:pOe};function $k(e){return yOe(e)||vOe(e)||lq(e)||gOe()}function gOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function vOe(e){if(typeof Symbol<"u"&&Symbol.iterator in Object(e))return Array.from(e)}function yOe(e){if(Array.isArray(e))return Fk(e)}function np(e,t){return wOe(e)||bOe(e,t)||lq(e,t)||xOe()}function xOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lq(e,t){if(e){if(typeof e=="string")return Fk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fk(e,t)}}function Fk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bOe(e,t){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(e)))){var n=[],r=!0,s=!1,i=void 0;try{for(var o=e[Symbol.iterator](),l;!(r=(l=o.next()).done)&&(n.push(l.value),!(t&&n.length===t));r=!0);}catch(c){s=!0,i=c}finally{try{!r&&o.return!=null&&o.return()}finally{if(s)throw i}}return n}}function wOe(e){if(Array.isArray(e))return e}function cq(e){var t=np(e,2),n=t[0],r=t[1],s=n,i=r;return n>r&&(s=r,i=n),[s,i]}function uq(e,t,n){if(e.lte(0))return new kn(0);var r=D0.getDigitCount(e.toNumber()),s=new kn(10).pow(r),i=e.div(s),o=r!==1?.05:.1,l=new kn(Math.ceil(i.div(o).toNumber())).add(n).mul(o),c=l.mul(s);return t?c:new kn(Math.ceil(c))}function jOe(e,t,n){var r=1,s=new kn(e);if(!s.isint()&&n){var i=Math.abs(e);i<1?(r=new kn(10).pow(D0.getDigitCount(e)-1),s=new kn(Math.floor(s.div(r).toNumber())).mul(r)):i>1&&(s=new kn(Math.floor(e)))}else e===0?s=new kn(Math.floor((t-1)/2)):n||(s=new kn(Math.floor(e)));var o=Math.floor((t-1)/2),l=uOe(cOe(function(c){return s.add(new kn(c-o).mul(r)).toNumber()}),Dk);return l(0,t)}function dq(e,t,n,r){var s=arguments.length>4&&arguments[4]!==void 0?arguments[4]:0;if(!Number.isFinite((t-e)/(n-1)))return{step:new kn(0),tickMin:new kn(0),tickMax:new kn(0)};var i=uq(new kn(t).sub(e).div(n-1),r,s),o;e<=0&&t>=0?o=new kn(0):(o=new kn(e).add(t).div(2),o=o.sub(new kn(o).mod(i)));var l=Math.ceil(o.sub(e).div(i).toNumber()),c=Math.ceil(new kn(t).sub(o).div(i).toNumber()),u=l+c+1;return u>n?dq(e,t,n,r,s+1):(u<n&&(c=t>0?c+(n-u):c,l=t>0?l:l+(n-u)),{step:i,tickMin:o.sub(new kn(l).mul(i)),tickMax:o.add(new kn(c).mul(i))})}function _Oe(e){var t=np(e,2),n=t[0],r=t[1],s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:6,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=Math.max(s,2),l=cq([n,r]),c=np(l,2),u=c[0],d=c[1];if(u===-1/0||d===1/0){var h=d===1/0?[u].concat($k(Dk(0,s-1).map(function(){return 1/0}))):[].concat($k(Dk(0,s-1).map(function(){return-1/0})),[d]);return n>r?Lk(h):h}if(u===d)return jOe(u,s,i);var f=dq(u,d,o,i),m=f.step,g=f.tickMin,v=f.tickMax,y=D0.rangeStep(g,v.add(new kn(.1).mul(m)),m);return n>r?Lk(y):y}function kOe(e,t){var n=np(e,2),r=n[0],s=n[1],i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,o=cq([r,s]),l=np(o,2),c=l[0],u=l[1];if(c===-1/0||u===1/0)return[r,s];if(c===u)return[c];var d=Math.max(t,2),h=uq(new kn(u).sub(c).div(d-1),i,0),f=[].concat($k(D0.rangeStep(new kn(c),new kn(u).sub(new kn(.99).mul(h)),h)),[u]);return r>s?Lk(f):f}var SOe=oq(_Oe),NOe=oq(kOe),COe="Invariant failed";function su(e,t){throw new Error(COe)}var AOe=["offset","layout","width","dataKey","data","dataPointFormatter","xAxis","yAxis"];function ch(e){"@babel/helpers - typeof";return ch=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ch(e)}function mx(){return mx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},mx.apply(this,arguments)}function EOe(e,t){return IOe(e)||OOe(e,t)||POe(e,t)||TOe()}function TOe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function POe(e,t){if(e){if(typeof e=="string")return $R(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $R(e,t)}}function $R(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function OOe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function IOe(e){if(Array.isArray(e))return e}function ROe(e,t){if(e==null)return{};var n=MOe(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function MOe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function DOe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function LOe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,mq(r.key),r)}}function $Oe(e,t,n){return t&&LOe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function FOe(e,t,n){return t=px(t),UOe(e,hq()?Reflect.construct(t,n||[],px(e).constructor):t.apply(e,n))}function UOe(e,t){if(t&&(ch(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return BOe(e)}function BOe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function hq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(hq=function(){return!!e})()}function px(e){return px=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},px(e)}function zOe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Uk(e,t)}function Uk(e,t){return Uk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Uk(e,t)}function fq(e,t,n){return t=mq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function mq(e){var t=WOe(e,"string");return ch(t)=="symbol"?t:t+""}function WOe(e,t){if(ch(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ch(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var L0=function(e){function t(){return DOe(this,t),FOe(this,t,arguments)}return zOe(t,e),$Oe(t,[{key:"render",value:function(){var r=this.props,s=r.offset,i=r.layout,o=r.width,l=r.dataKey,c=r.data,u=r.dataPointFormatter,d=r.xAxis,h=r.yAxis,f=ROe(r,AOe),m=fn(f,!1);this.props.direction==="x"&&d.type!=="number"&&su();var g=c.map(function(v){var y=u(v,l),x=y.x,w=y.y,b=y.value,_=y.errorVal;if(!_)return null;var k=[],j,S;if(Array.isArray(_)){var T=EOe(_,2);j=T[0],S=T[1]}else j=S=_;if(i==="vertical"){var O=d.scale,A=w+s,N=A+o,L=A-o,M=O(b-j),B=O(b+S);k.push({x1:B,y1:N,x2:B,y2:L}),k.push({x1:M,y1:A,x2:B,y2:A}),k.push({x1:M,y1:N,x2:M,y2:L})}else if(i==="horizontal"){var $=h.scale,z=x+s,R=z-o,C=z+o,D=$(b-j),E=$(b+S);k.push({x1:R,y1:E,x2:C,y2:E}),k.push({x1:z,y1:D,x2:z,y2:E}),k.push({x1:R,y1:D,x2:C,y2:D})}return G.createElement(Ir,mx({className:"recharts-errorBar",key:"bar-".concat(k.map(function(F){return"".concat(F.x1,"-").concat(F.x2,"-").concat(F.y1,"-").concat(F.y2)}))},m),k.map(function(F){return G.createElement("line",mx({},F,{key:"line-".concat(F.x1,"-").concat(F.x2,"-").concat(F.y1,"-").concat(F.y2)}))}))});return G.createElement(Ir,{className:"recharts-errorBars"},g)}}])}(G.Component);fq(L0,"defaultProps",{stroke:"black",strokeWidth:1.5,width:5,offset:0,layout:"horizontal"});fq(L0,"displayName","ErrorBar");function rp(e){"@babel/helpers - typeof";return rp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},rp(e)}function FR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function lc(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?FR(Object(n),!0).forEach(function(r){qOe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):FR(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function qOe(e,t,n){return t=HOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function HOe(e){var t=KOe(e,"string");return rp(t)=="symbol"?t:t+""}function KOe(e,t){if(rp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(rp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var pq=function(t){var n=t.children,r=t.formattedGraphicalItems,s=t.legendWidth,i=t.legendContent,o=rs(n,Ss);if(!o)return null;var l=Ss.defaultProps,c=l!==void 0?lc(lc({},l),o.props):{},u;return o.props&&o.props.payload?u=o.props&&o.props.payload:i==="children"?u=(r||[]).reduce(function(d,h){var f=h.item,m=h.props,g=m.sectors||m.data||[];return d.concat(g.map(function(v){return{type:o.props.iconType||f.props.legendType,value:v.name,color:v.fill,payload:v}}))},[]):u=(r||[]).map(function(d){var h=d.item,f=h.type.defaultProps,m=f!==void 0?lc(lc({},f),h.props):{},g=m.dataKey,v=m.name,y=m.legendType,x=m.hide;return{inactive:x,dataKey:g,type:c.iconType||y||"square",color:oE(h),value:v||g,payload:m}}),lc(lc(lc({},c),Ss.getWithHeight(o,s)),{},{payload:u,item:o})};function ap(e){"@babel/helpers - typeof";return ap=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ap(e)}function UR(e){return XOe(e)||YOe(e)||GOe(e)||VOe()}function VOe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function GOe(e,t){if(e){if(typeof e=="string")return Bk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bk(e,t)}}function YOe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function XOe(e){if(Array.isArray(e))return Bk(e)}function Bk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function BR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function rr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?BR(Object(n),!0).forEach(function(r){Nd(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):BR(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Nd(e,t,n){return t=JOe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function JOe(e){var t=QOe(e,"string");return ap(t)=="symbol"?t:t+""}function QOe(e,t){if(ap(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ap(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ki(e,t,n){return mn(e)||mn(t)?n:Sr(t)?Os(e,t,n):qt(t)?t(e):n}function em(e,t,n,r){var s=Y2e(e,function(l){return Ki(l,t)});if(n==="number"){var i=s.filter(function(l){return tt(l)||parseFloat(l)});return i.length?[R0(i),I0(i)]:[1/0,-1/0]}var o=r?s.filter(function(l){return!mn(l)}):s;return o.map(function(l){return Sr(l)||l instanceof Date?l:""})}var ZOe=function(t){var n,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],s=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,o=-1,l=(n=r==null?void 0:r.length)!==null&&n!==void 0?n:0;if(l<=1)return 0;if(i&&i.axisType==="angleAxis"&&Math.abs(Math.abs(i.range[1]-i.range[0])-360)<=1e-6)for(var c=i.range,u=0;u<l;u++){var d=u>0?s[u-1].coordinate:s[l-1].coordinate,h=s[u].coordinate,f=u>=l-1?s[0].coordinate:s[u+1].coordinate,m=void 0;if(ri(h-d)!==ri(f-h)){var g=[];if(ri(f-h)===ri(c[1]-c[0])){m=f;var v=h+c[1]-c[0];g[0]=Math.min(v,(v+d)/2),g[1]=Math.max(v,(v+d)/2)}else{m=d;var y=f+c[1]-c[0];g[0]=Math.min(h,(y+h)/2),g[1]=Math.max(h,(y+h)/2)}var x=[Math.min(h,(m+h)/2),Math.max(h,(m+h)/2)];if(t>x[0]&&t<=x[1]||t>=g[0]&&t<=g[1]){o=s[u].index;break}}else{var w=Math.min(d,f),b=Math.max(d,f);if(t>(w+h)/2&&t<=(b+h)/2){o=s[u].index;break}}}else for(var _=0;_<l;_++)if(_===0&&t<=(r[_].coordinate+r[_+1].coordinate)/2||_>0&&_<l-1&&t>(r[_].coordinate+r[_-1].coordinate)/2&&t<=(r[_].coordinate+r[_+1].coordinate)/2||_===l-1&&t>(r[_].coordinate+r[_-1].coordinate)/2){o=r[_].index;break}return o},oE=function(t){var n,r=t,s=r.type.displayName,i=(n=t.type)!==null&&n!==void 0&&n.defaultProps?rr(rr({},t.type.defaultProps),t.props):t.props,o=i.stroke,l=i.fill,c;switch(s){case"Line":c=o;break;case"Area":case"Radar":c=o&&o!=="none"?o:l;break;default:c=l;break}return c},eIe=function(t){var n=t.barSize,r=t.totalSize,s=t.stackGroups,i=s===void 0?{}:s;if(!i)return{};for(var o={},l=Object.keys(i),c=0,u=l.length;c<u;c++)for(var d=i[l[c]].stackGroups,h=Object.keys(d),f=0,m=h.length;f<m;f++){var g=d[h[f]],v=g.items,y=g.cateAxisId,x=v.filter(function(S){return jo(S.type).indexOf("Bar")>=0});if(x&&x.length){var w=x[0].type.defaultProps,b=w!==void 0?rr(rr({},w),x[0].props):x[0].props,_=b.barSize,k=b[y];o[k]||(o[k]=[]);var j=mn(_)?n:_;o[k].push({item:x[0],stackList:x.slice(1),barSize:mn(j)?void 0:ru(j,r,0)})}}return o},tIe=function(t){var n=t.barGap,r=t.barCategoryGap,s=t.bandSize,i=t.sizeList,o=i===void 0?[]:i,l=t.maxBarSize,c=o.length;if(c<1)return null;var u=ru(n,s,0,!0),d,h=[];if(o[0].barSize===+o[0].barSize){var f=!1,m=s/c,g=o.reduce(function(_,k){return _+k.barSize||0},0);g+=(c-1)*u,g>=s&&(g-=(c-1)*u,u=0),g>=s&&m>0&&(f=!0,m*=.9,g=c*m);var v=(s-g)/2>>0,y={offset:v-u,size:0};d=o.reduce(function(_,k){var j={item:k.item,position:{offset:y.offset+y.size+u,size:f?m:k.barSize}},S=[].concat(UR(_),[j]);return y=S[S.length-1].position,k.stackList&&k.stackList.length&&k.stackList.forEach(function(T){S.push({item:T,position:y})}),S},h)}else{var x=ru(r,s,0,!0);s-2*x-(c-1)*u<=0&&(u=0);var w=(s-2*x-(c-1)*u)/c;w>1&&(w>>=0);var b=l===+l?Math.min(w,l):w;d=o.reduce(function(_,k,j){var S=[].concat(UR(_),[{item:k.item,position:{offset:x+(w+u)*j+(w-b)/2,size:b}}]);return k.stackList&&k.stackList.length&&k.stackList.forEach(function(T){S.push({item:T,position:S[S.length-1].position})}),S},h)}return d},nIe=function(t,n,r,s){var i=r.children,o=r.width,l=r.margin,c=o-(l.left||0)-(l.right||0),u=pq({children:i,legendWidth:c});if(u){var d=s||{},h=d.width,f=d.height,m=u.align,g=u.verticalAlign,v=u.layout;if((v==="vertical"||v==="horizontal"&&g==="middle")&&m!=="center"&&tt(t[m]))return rr(rr({},t),{},Nd({},m,t[m]+(h||0)));if((v==="horizontal"||v==="vertical"&&m==="center")&&g!=="middle"&&tt(t[g]))return rr(rr({},t),{},Nd({},g,t[g]+(f||0)))}return t},rIe=function(t,n,r){return mn(n)?!0:t==="horizontal"?n==="yAxis":t==="vertical"||r==="x"?n==="xAxis":r==="y"?n==="yAxis":!0},gq=function(t,n,r,s,i){var o=n.props.children,l=ci(o,L0).filter(function(u){return rIe(s,i,u.props.direction)});if(l&&l.length){var c=l.map(function(u){return u.props.dataKey});return t.reduce(function(u,d){var h=Ki(d,r);if(mn(h))return u;var f=Array.isArray(h)?[R0(h),I0(h)]:[h,h],m=c.reduce(function(g,v){var y=Ki(d,v,0),x=f[0]-Math.abs(Array.isArray(y)?y[0]:y),w=f[1]+Math.abs(Array.isArray(y)?y[1]:y);return[Math.min(x,g[0]),Math.max(w,g[1])]},[1/0,-1/0]);return[Math.min(m[0],u[0]),Math.max(m[1],u[1])]},[1/0,-1/0])}return null},aIe=function(t,n,r,s,i){var o=n.map(function(l){return gq(t,l,r,i,s)}).filter(function(l){return!mn(l)});return o&&o.length?o.reduce(function(l,c){return[Math.min(l[0],c[0]),Math.max(l[1],c[1])]},[1/0,-1/0]):null},vq=function(t,n,r,s,i){var o=n.map(function(c){var u=c.props.dataKey;return r==="number"&&u&&gq(t,c,u,s)||em(t,u,r,i)});if(r==="number")return o.reduce(function(c,u){return[Math.min(c[0],u[0]),Math.max(c[1],u[1])]},[1/0,-1/0]);var l={};return o.reduce(function(c,u){for(var d=0,h=u.length;d<h;d++)l[u[d]]||(l[u[d]]=!0,c.push(u[d]));return c},[])},yq=function(t,n){return t==="horizontal"&&n==="xAxis"||t==="vertical"&&n==="yAxis"||t==="centric"&&n==="angleAxis"||t==="radial"&&n==="radiusAxis"},xq=function(t,n,r,s){if(s)return t.map(function(c){return c.coordinate});var i,o,l=t.map(function(c){return c.coordinate===n&&(i=!0),c.coordinate===r&&(o=!0),c.coordinate});return i||l.push(n),o||l.push(r),l},vo=function(t,n,r){if(!t)return null;var s=t.scale,i=t.duplicateDomain,o=t.type,l=t.range,c=t.realScaleType==="scaleBand"?s.bandwidth()/2:2,u=(n||r)&&o==="category"&&s.bandwidth?s.bandwidth()/c:0;if(u=t.axisType==="angleAxis"&&(l==null?void 0:l.length)>=2?ri(l[0]-l[1])*2*u:u,n&&(t.ticks||t.niceTicks)){var d=(t.ticks||t.niceTicks).map(function(h){var f=i?i.indexOf(h):h;return{coordinate:s(f)+u,value:h,offset:u}});return d.filter(function(h){return!lg(h.coordinate)})}return t.isCategorical&&t.categoricalDomain?t.categoricalDomain.map(function(h,f){return{coordinate:s(h)+u,value:h,index:f,offset:u}}):s.ticks&&!r?s.ticks(t.tickCount).map(function(h){return{coordinate:s(h)+u,value:h,offset:u}}):s.domain().map(function(h,f){return{coordinate:s(h)+u,value:i?i[h]:h,index:f,offset:u}})},Gj=new WeakMap,uv=function(t,n){if(typeof n!="function")return t;Gj.has(t)||Gj.set(t,new WeakMap);var r=Gj.get(t);if(r.has(n))return r.get(n);var s=function(){t.apply(void 0,arguments),n.apply(void 0,arguments)};return r.set(n,s),s},sIe=function(t,n,r){var s=t.scale,i=t.type,o=t.layout,l=t.axisType;if(s==="auto")return o==="radial"&&l==="radiusAxis"?{scale:Xm(),realScaleType:"band"}:o==="radial"&&l==="angleAxis"?{scale:cx(),realScaleType:"linear"}:i==="category"&&n&&(n.indexOf("LineChart")>=0||n.indexOf("AreaChart")>=0||n.indexOf("ComposedChart")>=0&&!r)?{scale:Zf(),realScaleType:"point"}:i==="category"?{scale:Xm(),realScaleType:"band"}:{scale:cx(),realScaleType:"linear"};if(nu(s)){var c="scale".concat(b0(s));return{scale:(RR[c]||Zf)(),realScaleType:RR[c]?c:"point"}}return qt(s)?{scale:s}:{scale:Zf(),realScaleType:"point"}},zR=1e-4,iIe=function(t){var n=t.domain();if(!(!n||n.length<=2)){var r=n.length,s=t.range(),i=Math.min(s[0],s[1])-zR,o=Math.max(s[0],s[1])+zR,l=t(n[0]),c=t(n[r-1]);(l<i||l>o||c<i||c>o)&&t.domain([n[0],n[r-1]])}},oIe=function(t,n){if(!t)return null;for(var r=0,s=t.length;r<s;r++)if(t[r].item===n)return t[r].position;return null},lIe=function(t,n){if(!n||n.length!==2||!tt(n[0])||!tt(n[1]))return t;var r=Math.min(n[0],n[1]),s=Math.max(n[0],n[1]),i=[t[0],t[1]];return(!tt(t[0])||t[0]<r)&&(i[0]=r),(!tt(t[1])||t[1]>s)&&(i[1]=s),i[0]>s&&(i[0]=s),i[1]<r&&(i[1]=r),i},cIe=function(t){var n=t.length;if(!(n<=0))for(var r=0,s=t[0].length;r<s;++r)for(var i=0,o=0,l=0;l<n;++l){var c=lg(t[l][r][1])?t[l][r][0]:t[l][r][1];c>=0?(t[l][r][0]=i,t[l][r][1]=i+c,i=t[l][r][1]):(t[l][r][0]=o,t[l][r][1]=o+c,o=t[l][r][1])}},uIe=function(t){var n=t.length;if(!(n<=0))for(var r=0,s=t[0].length;r<s;++r)for(var i=0,o=0;o<n;++o){var l=lg(t[o][r][1])?t[o][r][0]:t[o][r][1];l>=0?(t[o][r][0]=i,t[o][r][1]=i+l,i=t[o][r][1]):(t[o][r][0]=0,t[o][r][1]=0)}},dIe={sign:cIe,expand:Nwe,none:th,silhouette:Cwe,wiggle:Awe,positive:uIe},hIe=function(t,n,r){var s=n.map(function(l){return l.props.dataKey}),i=dIe[r],o=Swe().keys(s).value(function(l,c){return+Ki(l,c,0)}).order(hk).offset(i);return o(t)},fIe=function(t,n,r,s,i,o){if(!t)return null;var l=o?n.reverse():n,c={},u=l.reduce(function(h,f){var m,g=(m=f.type)!==null&&m!==void 0&&m.defaultProps?rr(rr({},f.type.defaultProps),f.props):f.props,v=g.stackId,y=g.hide;if(y)return h;var x=g[r],w=h[x]||{hasStack:!1,stackGroups:{}};if(Sr(v)){var b=w.stackGroups[v]||{numericAxisId:r,cateAxisId:s,items:[]};b.items.push(f),w.hasStack=!0,w.stackGroups[v]=b}else w.stackGroups[x0("_stackId_")]={numericAxisId:r,cateAxisId:s,items:[f]};return rr(rr({},h),{},Nd({},x,w))},c),d={};return Object.keys(u).reduce(function(h,f){var m=u[f];if(m.hasStack){var g={};m.stackGroups=Object.keys(m.stackGroups).reduce(function(v,y){var x=m.stackGroups[y];return rr(rr({},v),{},Nd({},y,{numericAxisId:r,cateAxisId:s,items:x.items,stackedData:hIe(t,x.items,i)}))},g)}return rr(rr({},h),{},Nd({},f,m))},d)},mIe=function(t,n){var r=n.realScaleType,s=n.type,i=n.tickCount,o=n.originalDomain,l=n.allowDecimals,c=r||n.scale;if(c!=="auto"&&c!=="linear")return null;if(i&&s==="number"&&o&&(o[0]==="auto"||o[1]==="auto")){var u=t.domain();if(!u.length)return null;var d=SOe(u,i,l);return t.domain([R0(d),I0(d)]),{niceTicks:d}}if(i&&s==="number"){var h=t.domain(),f=NOe(h,i,l);return{niceTicks:f}}return null},WR=function(t){var n=t.axis,r=t.ticks,s=t.offset,i=t.bandSize,o=t.entry,l=t.index;if(n.type==="category")return r[l]?r[l].coordinate+s:null;var c=Ki(o,n.dataKey,n.domain[l]);return mn(c)?null:n.scale(c)-i/2+s},pIe=function(t){var n=t.numericAxis,r=n.scale.domain();if(n.type==="number"){var s=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return s<=0&&i>=0?0:i<0?i:s}return r[0]},gIe=function(t,n){var r,s=(r=t.type)!==null&&r!==void 0&&r.defaultProps?rr(rr({},t.type.defaultProps),t.props):t.props,i=s.stackId;if(Sr(i)){var o=n[i];if(o){var l=o.items.indexOf(t);return l>=0?o.stackedData[l]:null}}return null},vIe=function(t){return t.reduce(function(n,r){return[R0(r.concat([n[0]]).filter(tt)),I0(r.concat([n[1]]).filter(tt))]},[1/0,-1/0])},bq=function(t,n,r){return Object.keys(t).reduce(function(s,i){var o=t[i],l=o.stackedData,c=l.reduce(function(u,d){var h=vIe(d.slice(n,r+1));return[Math.min(u[0],h[0]),Math.max(u[1],h[1])]},[1/0,-1/0]);return[Math.min(c[0],s[0]),Math.max(c[1],s[1])]},[1/0,-1/0]).map(function(s){return s===1/0||s===-1/0?0:s})},qR=/^dataMin[\s]*-[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,HR=/^dataMax[\s]*\+[\s]*([0-9]+([.]{1}[0-9]+){0,1})$/,zk=function(t,n,r){if(qt(t))return t(n,r);if(!Array.isArray(t))return n;var s=[];if(tt(t[0]))s[0]=r?t[0]:Math.min(t[0],n[0]);else if(qR.test(t[0])){var i=+qR.exec(t[0])[1];s[0]=n[0]-i}else qt(t[0])?s[0]=t[0](n[0]):s[0]=n[0];if(tt(t[1]))s[1]=r?t[1]:Math.max(t[1],n[1]);else if(HR.test(t[1])){var o=+HR.exec(t[1])[1];s[1]=n[1]+o}else qt(t[1])?s[1]=t[1](n[1]):s[1]=n[1];return s},gx=function(t,n,r){if(t&&t.scale&&t.scale.bandwidth){var s=t.scale.bandwidth();if(!r||s>0)return s}if(t&&n&&n.length>=2){for(var i=RA(n,function(h){return h.coordinate}),o=1/0,l=1,c=i.length;l<c;l++){var u=i[l],d=i[l-1];o=Math.min((u.coordinate||0)-(d.coordinate||0),o)}return o===1/0?0:o}return r?void 0:0},KR=function(t,n,r){return!t||!t.length||aE(t,Os(r,"type.defaultProps.domain"))?n:t},wq=function(t,n){var r=t.type.defaultProps?rr(rr({},t.type.defaultProps),t.props):t.props,s=r.dataKey,i=r.name,o=r.unit,l=r.formatter,c=r.tooltipType,u=r.chartType,d=r.hide;return rr(rr({},fn(t,!1)),{},{dataKey:s,unit:o,formatter:l,name:i||s,color:oE(t),value:Ki(n,s),type:c,payload:n,chartType:u,hide:d})};function sp(e){"@babel/helpers - typeof";return sp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sp(e)}function VR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function GR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VR(Object(n),!0).forEach(function(r){yIe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VR(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function yIe(e,t,n){return t=xIe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function xIe(e){var t=bIe(e,"string");return sp(t)=="symbol"?t:t+""}function bIe(e,t){if(sp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(sp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var vx=Math.PI/180,wIe=function(t){return t*180/Math.PI},Kr=function(t,n,r,s){return{x:t+Math.cos(-vx*s)*r,y:n+Math.sin(-vx*s)*r}},jIe=function(t,n){var r=t.x,s=t.y,i=n.x,o=n.y;return Math.sqrt(Math.pow(r-i,2)+Math.pow(s-o,2))},_Ie=function(t,n){var r=t.x,s=t.y,i=n.cx,o=n.cy,l=jIe({x:r,y:s},{x:i,y:o});if(l<=0)return{radius:l};var c=(r-i)/l,u=Math.acos(c);return s>o&&(u=2*Math.PI-u),{radius:l,angle:wIe(u),angleInRadian:u}},kIe=function(t){var n=t.startAngle,r=t.endAngle,s=Math.floor(n/360),i=Math.floor(r/360),o=Math.min(s,i);return{startAngle:n-o*360,endAngle:r-o*360}},SIe=function(t,n){var r=n.startAngle,s=n.endAngle,i=Math.floor(r/360),o=Math.floor(s/360),l=Math.min(i,o);return t+l*360},YR=function(t,n){var r=t.x,s=t.y,i=_Ie({x:r,y:s},n),o=i.radius,l=i.angle,c=n.innerRadius,u=n.outerRadius;if(o<c||o>u)return!1;if(o===0)return!0;var d=kIe(n),h=d.startAngle,f=d.endAngle,m=l,g;if(h<=f){for(;m>f;)m-=360;for(;m<h;)m+=360;g=m>=h&&m<=f}else{for(;m>h;)m-=360;for(;m<f;)m+=360;g=m>=f&&m<=h}return g?GR(GR({},n),{},{radius:o,angle:SIe(m,n)}):null};function ip(e){"@babel/helpers - typeof";return ip=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ip(e)}var NIe=["offset"];function CIe(e){return PIe(e)||TIe(e)||EIe(e)||AIe()}function AIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EIe(e,t){if(e){if(typeof e=="string")return Wk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wk(e,t)}}function TIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function PIe(e){if(Array.isArray(e))return Wk(e)}function Wk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function OIe(e,t){if(e==null)return{};var n=IIe(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function IIe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function XR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function xr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?XR(Object(n),!0).forEach(function(r){RIe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):XR(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function RIe(e,t,n){return t=MIe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function MIe(e){var t=DIe(e,"string");return ip(t)=="symbol"?t:t+""}function DIe(e,t){if(ip(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ip(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function op(){return op=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},op.apply(this,arguments)}var LIe=function(t){var n=t.value,r=t.formatter,s=mn(t.children)?n:t.children;return qt(r)?r(s):s},$Ie=function(t,n){var r=ri(n-t),s=Math.min(Math.abs(n-t),360);return r*s},FIe=function(t,n,r){var s=t.position,i=t.viewBox,o=t.offset,l=t.className,c=i,u=c.cx,d=c.cy,h=c.innerRadius,f=c.outerRadius,m=c.startAngle,g=c.endAngle,v=c.clockWise,y=(h+f)/2,x=$Ie(m,g),w=x>=0?1:-1,b,_;s==="insideStart"?(b=m+w*o,_=v):s==="insideEnd"?(b=g-w*o,_=!v):s==="end"&&(b=g+w*o,_=v),_=x<=0?_:!_;var k=Kr(u,d,y,b),j=Kr(u,d,y,b+(_?1:-1)*359),S="M".concat(k.x,",").concat(k.y,`
    A`).concat(y,",").concat(y,",0,1,").concat(_?0:1,`,
    `).concat(j.x,",").concat(j.y),T=mn(t.id)?x0("recharts-radial-line-"):t.id;return G.createElement("text",op({},r,{dominantBaseline:"central",className:on("recharts-radial-bar-label",l)}),G.createElement("defs",null,G.createElement("path",{id:T,d:S})),G.createElement("textPath",{xlinkHref:"#".concat(T)},n))},UIe=function(t){var n=t.viewBox,r=t.offset,s=t.position,i=n,o=i.cx,l=i.cy,c=i.innerRadius,u=i.outerRadius,d=i.startAngle,h=i.endAngle,f=(d+h)/2;if(s==="outside"){var m=Kr(o,l,u+r,f),g=m.x,v=m.y;return{x:g,y:v,textAnchor:g>=o?"start":"end",verticalAnchor:"middle"}}if(s==="center")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"middle"};if(s==="centerTop")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"start"};if(s==="centerBottom")return{x:o,y:l,textAnchor:"middle",verticalAnchor:"end"};var y=(c+u)/2,x=Kr(o,l,y,f),w=x.x,b=x.y;return{x:w,y:b,textAnchor:"middle",verticalAnchor:"middle"}},BIe=function(t){var n=t.viewBox,r=t.parentViewBox,s=t.offset,i=t.position,o=n,l=o.x,c=o.y,u=o.width,d=o.height,h=d>=0?1:-1,f=h*s,m=h>0?"end":"start",g=h>0?"start":"end",v=u>=0?1:-1,y=v*s,x=v>0?"end":"start",w=v>0?"start":"end";if(i==="top"){var b={x:l+u/2,y:c-h*s,textAnchor:"middle",verticalAnchor:m};return xr(xr({},b),r?{height:Math.max(c-r.y,0),width:u}:{})}if(i==="bottom"){var _={x:l+u/2,y:c+d+f,textAnchor:"middle",verticalAnchor:g};return xr(xr({},_),r?{height:Math.max(r.y+r.height-(c+d),0),width:u}:{})}if(i==="left"){var k={x:l-y,y:c+d/2,textAnchor:x,verticalAnchor:"middle"};return xr(xr({},k),r?{width:Math.max(k.x-r.x,0),height:d}:{})}if(i==="right"){var j={x:l+u+y,y:c+d/2,textAnchor:w,verticalAnchor:"middle"};return xr(xr({},j),r?{width:Math.max(r.x+r.width-j.x,0),height:d}:{})}var S=r?{width:u,height:d}:{};return i==="insideLeft"?xr({x:l+y,y:c+d/2,textAnchor:w,verticalAnchor:"middle"},S):i==="insideRight"?xr({x:l+u-y,y:c+d/2,textAnchor:x,verticalAnchor:"middle"},S):i==="insideTop"?xr({x:l+u/2,y:c+f,textAnchor:"middle",verticalAnchor:g},S):i==="insideBottom"?xr({x:l+u/2,y:c+d-f,textAnchor:"middle",verticalAnchor:m},S):i==="insideTopLeft"?xr({x:l+y,y:c+f,textAnchor:w,verticalAnchor:g},S):i==="insideTopRight"?xr({x:l+u-y,y:c+f,textAnchor:x,verticalAnchor:g},S):i==="insideBottomLeft"?xr({x:l+y,y:c+d-f,textAnchor:w,verticalAnchor:m},S):i==="insideBottomRight"?xr({x:l+u-y,y:c+d-f,textAnchor:x,verticalAnchor:m},S):Fh(i)&&(tt(i.x)||Sc(i.x))&&(tt(i.y)||Sc(i.y))?xr({x:l+ru(i.x,u),y:c+ru(i.y,d),textAnchor:"end",verticalAnchor:"end"},S):xr({x:l+u/2,y:c+d/2,textAnchor:"middle",verticalAnchor:"middle"},S)},zIe=function(t){return"cx"in t&&tt(t.cx)};function sa(e){var t=e.offset,n=t===void 0?5:t,r=OIe(e,NIe),s=xr({offset:n},r),i=s.viewBox,o=s.position,l=s.value,c=s.children,u=s.content,d=s.className,h=d===void 0?"":d,f=s.textBreakAll;if(!i||mn(l)&&mn(c)&&!p.isValidElement(u)&&!qt(u))return null;if(p.isValidElement(u))return p.cloneElement(u,s);var m;if(qt(u)){if(m=p.createElement(u,s),p.isValidElement(m))return m}else m=LIe(s);var g=zIe(i),v=fn(s,!0);if(g&&(o==="insideStart"||o==="insideEnd"||o==="end"))return FIe(s,m,v);var y=g?UIe(s):BIe(s);return G.createElement(nx,op({className:on("recharts-label",h)},v,y,{breakAll:f}),m)}sa.displayName="Label";var jq=function(t){var n=t.cx,r=t.cy,s=t.angle,i=t.startAngle,o=t.endAngle,l=t.r,c=t.radius,u=t.innerRadius,d=t.outerRadius,h=t.x,f=t.y,m=t.top,g=t.left,v=t.width,y=t.height,x=t.clockWise,w=t.labelViewBox;if(w)return w;if(tt(v)&&tt(y)){if(tt(h)&&tt(f))return{x:h,y:f,width:v,height:y};if(tt(m)&&tt(g))return{x:m,y:g,width:v,height:y}}return tt(h)&&tt(f)?{x:h,y:f,width:0,height:0}:tt(n)&&tt(r)?{cx:n,cy:r,startAngle:i||s||0,endAngle:o||s||0,innerRadius:u||0,outerRadius:d||c||l||0,clockWise:x}:t.viewBox?t.viewBox:{}},WIe=function(t,n){return t?t===!0?G.createElement(sa,{key:"label-implicit",viewBox:n}):Sr(t)?G.createElement(sa,{key:"label-implicit",viewBox:n,value:t}):p.isValidElement(t)?t.type===sa?p.cloneElement(t,{key:"label-implicit",viewBox:n}):G.createElement(sa,{key:"label-implicit",content:t,viewBox:n}):qt(t)?G.createElement(sa,{key:"label-implicit",content:t,viewBox:n}):Fh(t)?G.createElement(sa,op({viewBox:n},t,{key:"label-implicit"})):null:null},qIe=function(t,n){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!t||!t.children&&r&&!t.label)return null;var s=t.children,i=jq(t),o=ci(s,sa).map(function(c,u){return p.cloneElement(c,{viewBox:n||i,key:"label-".concat(u)})});if(!r)return o;var l=WIe(t.label,n||i);return[l].concat(CIe(o))};sa.parseViewBox=jq;sa.renderCallByParent=qIe;function HIe(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var KIe=HIe;const VIe=bn(KIe);function lp(e){"@babel/helpers - typeof";return lp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lp(e)}var GIe=["valueAccessor"],YIe=["data","dataKey","clockWise","id","textBreakAll"];function XIe(e){return eRe(e)||ZIe(e)||QIe(e)||JIe()}function JIe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function QIe(e,t){if(e){if(typeof e=="string")return qk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qk(e,t)}}function ZIe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function eRe(e){if(Array.isArray(e))return qk(e)}function qk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yx(){return yx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yx.apply(this,arguments)}function JR(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function QR(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?JR(Object(n),!0).forEach(function(r){tRe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):JR(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function tRe(e,t,n){return t=nRe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function nRe(e){var t=rRe(e,"string");return lp(t)=="symbol"?t:t+""}function rRe(e,t){if(lp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(lp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function ZR(e,t){if(e==null)return{};var n=aRe(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function aRe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var sRe=function(t){return Array.isArray(t.value)?VIe(t.value):t.value};function ai(e){var t=e.valueAccessor,n=t===void 0?sRe:t,r=ZR(e,GIe),s=r.data,i=r.dataKey,o=r.clockWise,l=r.id,c=r.textBreakAll,u=ZR(r,YIe);return!s||!s.length?null:G.createElement(Ir,{className:"recharts-label-list"},s.map(function(d,h){var f=mn(i)?n(d,h):Ki(d&&d.payload,i),m=mn(l)?{}:{id:"".concat(l,"-").concat(h)};return G.createElement(sa,yx({},fn(d,!0),u,m,{parentViewBox:d.parentViewBox,value:f,textBreakAll:c,viewBox:sa.parseViewBox(mn(o)?d:QR(QR({},d),{},{clockWise:o})),key:"label-".concat(h),index:h}))}))}ai.displayName="LabelList";function iRe(e,t){return e?e===!0?G.createElement(ai,{key:"labelList-implicit",data:t}):G.isValidElement(e)||qt(e)?G.createElement(ai,{key:"labelList-implicit",data:t,content:e}):Fh(e)?G.createElement(ai,yx({data:t},e,{key:"labelList-implicit"})):null:null}function oRe(e,t){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!e||!e.children&&n&&!e.label)return null;var r=e.children,s=ci(r,ai).map(function(o,l){return p.cloneElement(o,{data:t,key:"labelList-".concat(l)})});if(!n)return s;var i=iRe(e.label,t);return[i].concat(XIe(s))}ai.renderCallByParent=oRe;function cp(e){"@babel/helpers - typeof";return cp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cp(e)}function Hk(){return Hk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Hk.apply(this,arguments)}function eM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function tM(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?eM(Object(n),!0).forEach(function(r){lRe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function lRe(e,t,n){return t=cRe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function cRe(e){var t=uRe(e,"string");return cp(t)=="symbol"?t:t+""}function uRe(e,t){if(cp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(cp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var dRe=function(t,n){var r=ri(n-t),s=Math.min(Math.abs(n-t),359.999);return r*s},dv=function(t){var n=t.cx,r=t.cy,s=t.radius,i=t.angle,o=t.sign,l=t.isExternal,c=t.cornerRadius,u=t.cornerIsExternal,d=c*(l?1:-1)+s,h=Math.asin(c/d)/vx,f=u?i:i+o*h,m=Kr(n,r,d,f),g=Kr(n,r,s,f),v=u?i-o*h:i,y=Kr(n,r,d*Math.cos(h*vx),v);return{center:m,circleTangency:g,lineTangency:y,theta:h}},_q=function(t){var n=t.cx,r=t.cy,s=t.innerRadius,i=t.outerRadius,o=t.startAngle,l=t.endAngle,c=dRe(o,l),u=o+c,d=Kr(n,r,i,o),h=Kr(n,r,i,u),f="M ".concat(d.x,",").concat(d.y,`
    A `).concat(i,",").concat(i,`,0,
    `).concat(+(Math.abs(c)>180),",").concat(+(o>u),`,
    `).concat(h.x,",").concat(h.y,`
  `);if(s>0){var m=Kr(n,r,s,o),g=Kr(n,r,s,u);f+="L ".concat(g.x,",").concat(g.y,`
            A `).concat(s,",").concat(s,`,0,
            `).concat(+(Math.abs(c)>180),",").concat(+(o<=u),`,
            `).concat(m.x,",").concat(m.y," Z")}else f+="L ".concat(n,",").concat(r," Z");return f},hRe=function(t){var n=t.cx,r=t.cy,s=t.innerRadius,i=t.outerRadius,o=t.cornerRadius,l=t.forceCornerRadius,c=t.cornerIsExternal,u=t.startAngle,d=t.endAngle,h=ri(d-u),f=dv({cx:n,cy:r,radius:i,angle:u,sign:h,cornerRadius:o,cornerIsExternal:c}),m=f.circleTangency,g=f.lineTangency,v=f.theta,y=dv({cx:n,cy:r,radius:i,angle:d,sign:-h,cornerRadius:o,cornerIsExternal:c}),x=y.circleTangency,w=y.lineTangency,b=y.theta,_=c?Math.abs(u-d):Math.abs(u-d)-v-b;if(_<0)return l?"M ".concat(g.x,",").concat(g.y,`
        a`).concat(o,",").concat(o,",0,0,1,").concat(o*2,`,0
        a`).concat(o,",").concat(o,",0,0,1,").concat(-o*2,`,0
      `):_q({cx:n,cy:r,innerRadius:s,outerRadius:i,startAngle:u,endAngle:d});var k="M ".concat(g.x,",").concat(g.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(m.x,",").concat(m.y,`
    A`).concat(i,",").concat(i,",0,").concat(+(_>180),",").concat(+(h<0),",").concat(x.x,",").concat(x.y,`
    A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(w.x,",").concat(w.y,`
  `);if(s>0){var j=dv({cx:n,cy:r,radius:s,angle:u,sign:h,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),S=j.circleTangency,T=j.lineTangency,O=j.theta,A=dv({cx:n,cy:r,radius:s,angle:d,sign:-h,isExternal:!0,cornerRadius:o,cornerIsExternal:c}),N=A.circleTangency,L=A.lineTangency,M=A.theta,B=c?Math.abs(u-d):Math.abs(u-d)-O-M;if(B<0&&o===0)return"".concat(k,"L").concat(n,",").concat(r,"Z");k+="L".concat(L.x,",").concat(L.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(N.x,",").concat(N.y,`
      A`).concat(s,",").concat(s,",0,").concat(+(B>180),",").concat(+(h>0),",").concat(S.x,",").concat(S.y,`
      A`).concat(o,",").concat(o,",0,0,").concat(+(h<0),",").concat(T.x,",").concat(T.y,"Z")}else k+="L".concat(n,",").concat(r,"Z");return k},fRe={cx:0,cy:0,innerRadius:0,outerRadius:0,startAngle:0,endAngle:0,cornerRadius:0,forceCornerRadius:!1,cornerIsExternal:!1},kq=function(t){var n=tM(tM({},fRe),t),r=n.cx,s=n.cy,i=n.innerRadius,o=n.outerRadius,l=n.cornerRadius,c=n.forceCornerRadius,u=n.cornerIsExternal,d=n.startAngle,h=n.endAngle,f=n.className;if(o<i||d===h)return null;var m=on("recharts-sector",f),g=o-i,v=ru(l,g,0,!0),y;return v>0&&Math.abs(d-h)<360?y=hRe({cx:r,cy:s,innerRadius:i,outerRadius:o,cornerRadius:Math.min(v,g/2),forceCornerRadius:c,cornerIsExternal:u,startAngle:d,endAngle:h}):y=_q({cx:r,cy:s,innerRadius:i,outerRadius:o,startAngle:d,endAngle:h}),G.createElement("path",Hk({},fn(n,!0),{className:m,d:y,role:"img"}))};function up(e){"@babel/helpers - typeof";return up=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},up(e)}function Kk(){return Kk=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Kk.apply(this,arguments)}function nM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function rM(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nM(Object(n),!0).forEach(function(r){mRe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function mRe(e,t,n){return t=pRe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function pRe(e){var t=gRe(e,"string");return up(t)=="symbol"?t:t+""}function gRe(e,t){if(up(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(up(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var aM={curveBasisClosed:mwe,curveBasisOpen:pwe,curveBasis:fwe,curveBumpX:Z0e,curveBumpY:ewe,curveLinearClosed:gwe,curveLinear:j0,curveMonotoneX:vwe,curveMonotoneY:ywe,curveNatural:xwe,curveStep:bwe,curveStepAfter:jwe,curveStepBefore:wwe},hv=function(t){return t.x===+t.x&&t.y===+t.y},bf=function(t){return t.x},wf=function(t){return t.y},vRe=function(t,n){if(qt(t))return t;var r="curve".concat(b0(t));return(r==="curveMonotone"||r==="curveBump")&&n?aM["".concat(r).concat(n==="vertical"?"Y":"X")]:aM[r]||j0},yRe=function(t){var n=t.type,r=n===void 0?"linear":n,s=t.points,i=s===void 0?[]:s,o=t.baseLine,l=t.layout,c=t.connectNulls,u=c===void 0?!1:c,d=vRe(r,l),h=u?i.filter(function(v){return hv(v)}):i,f;if(Array.isArray(o)){var m=u?o.filter(function(v){return hv(v)}):o,g=h.map(function(v,y){return rM(rM({},v),{},{base:m[y]})});return l==="vertical"?f=nv().y(wf).x1(bf).x0(function(v){return v.base.x}):f=nv().x(bf).y1(wf).y0(function(v){return v.base.y}),f.defined(hv).curve(d),f(g)}return l==="vertical"&&tt(o)?f=nv().y(wf).x1(bf).x0(o):tt(o)?f=nv().x(bf).y1(wf).y0(o):f=k8().x(bf).y(wf),f.defined(hv).curve(d),f(h)},sM=function(t){var n=t.className,r=t.points,s=t.path,i=t.pathRef;if((!r||!r.length)&&!s)return null;var o=r&&r.length?yRe(t):s;return p.createElement("path",Kk({},fn(t,!1),By(t),{className:on("recharts-curve",n),d:o,ref:i}))},Sq={exports:{}},xRe="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",bRe=xRe,wRe=bRe;function Nq(){}function Cq(){}Cq.resetWarningCache=Nq;var jRe=function(){function e(r,s,i,o,l,c){if(c!==wRe){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Cq,resetWarningCache:Nq};return n.PropTypes=n,n};Sq.exports=jRe();var _Re=Sq.exports;const vn=bn(_Re);var kRe=Object.getOwnPropertyNames,SRe=Object.getOwnPropertySymbols,NRe=Object.prototype.hasOwnProperty;function iM(e,t){return function(r,s,i){return e(r,s,i)&&t(r,s,i)}}function fv(e){return function(n,r,s){if(!n||!r||typeof n!="object"||typeof r!="object")return e(n,r,s);var i=s.cache,o=i.get(n),l=i.get(r);if(o&&l)return o===r&&l===n;i.set(n,r),i.set(r,n);var c=e(n,r,s);return i.delete(n),i.delete(r),c}}function oM(e){return kRe(e).concat(SRe(e))}var CRe=Object.hasOwn||function(e,t){return NRe.call(e,t)};function wu(e,t){return e===t||!e&&!t&&e!==e&&t!==t}var ARe="__v",ERe="__o",TRe="_owner",lM=Object.getOwnPropertyDescriptor,cM=Object.keys;function PRe(e,t,n){var r=e.length;if(t.length!==r)return!1;for(;r-- >0;)if(!n.equals(e[r],t[r],r,r,e,t,n))return!1;return!0}function ORe(e,t){return wu(e.getTime(),t.getTime())}function IRe(e,t){return e.name===t.name&&e.message===t.message&&e.cause===t.cause&&e.stack===t.stack}function RRe(e,t){return e===t}function uM(e,t,n){var r=e.size;if(r!==t.size)return!1;if(!r)return!0;for(var s=new Array(r),i=e.entries(),o,l,c=0;(o=i.next())&&!o.done;){for(var u=t.entries(),d=!1,h=0;(l=u.next())&&!l.done;){if(s[h]){h++;continue}var f=o.value,m=l.value;if(n.equals(f[0],m[0],c,h,e,t,n)&&n.equals(f[1],m[1],f[0],m[0],e,t,n)){d=s[h]=!0;break}h++}if(!d)return!1;c++}return!0}var MRe=wu;function DRe(e,t,n){var r=cM(e),s=r.length;if(cM(t).length!==s)return!1;for(;s-- >0;)if(!Aq(e,t,n,r[s]))return!1;return!0}function jf(e,t,n){var r=oM(e),s=r.length;if(oM(t).length!==s)return!1;for(var i,o,l;s-- >0;)if(i=r[s],!Aq(e,t,n,i)||(o=lM(e,i),l=lM(t,i),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function LRe(e,t){return wu(e.valueOf(),t.valueOf())}function $Re(e,t){return e.source===t.source&&e.flags===t.flags}function dM(e,t,n){var r=e.size;if(r!==t.size)return!1;if(!r)return!0;for(var s=new Array(r),i=e.values(),o,l;(o=i.next())&&!o.done;){for(var c=t.values(),u=!1,d=0;(l=c.next())&&!l.done;){if(!s[d]&&n.equals(o.value,l.value,o.value,l.value,e,t,n)){u=s[d]=!0;break}d++}if(!u)return!1}return!0}function FRe(e,t){var n=e.length;if(t.length!==n)return!1;for(;n-- >0;)if(e[n]!==t[n])return!1;return!0}function URe(e,t){return e.hostname===t.hostname&&e.pathname===t.pathname&&e.protocol===t.protocol&&e.port===t.port&&e.hash===t.hash&&e.username===t.username&&e.password===t.password}function Aq(e,t,n,r){return(r===TRe||r===ERe||r===ARe)&&(e.$$typeof||t.$$typeof)?!0:CRe(t,r)&&n.equals(e[r],t[r],r,r,e,t,n)}var BRe="[object Arguments]",zRe="[object Boolean]",WRe="[object Date]",qRe="[object Error]",HRe="[object Map]",KRe="[object Number]",VRe="[object Object]",GRe="[object RegExp]",YRe="[object Set]",XRe="[object String]",JRe="[object URL]",QRe=Array.isArray,hM=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,fM=Object.assign,ZRe=Object.prototype.toString.call.bind(Object.prototype.toString);function eMe(e){var t=e.areArraysEqual,n=e.areDatesEqual,r=e.areErrorsEqual,s=e.areFunctionsEqual,i=e.areMapsEqual,o=e.areNumbersEqual,l=e.areObjectsEqual,c=e.arePrimitiveWrappersEqual,u=e.areRegExpsEqual,d=e.areSetsEqual,h=e.areTypedArraysEqual,f=e.areUrlsEqual;return function(g,v,y){if(g===v)return!0;if(g==null||v==null)return!1;var x=typeof g;if(x!==typeof v)return!1;if(x!=="object")return x==="number"?o(g,v,y):x==="function"?s(g,v,y):!1;var w=g.constructor;if(w!==v.constructor)return!1;if(w===Object)return l(g,v,y);if(QRe(g))return t(g,v,y);if(hM!=null&&hM(g))return h(g,v,y);if(w===Date)return n(g,v,y);if(w===RegExp)return u(g,v,y);if(w===Map)return i(g,v,y);if(w===Set)return d(g,v,y);var b=ZRe(g);return b===WRe?n(g,v,y):b===GRe?u(g,v,y):b===HRe?i(g,v,y):b===YRe?d(g,v,y):b===VRe?typeof g.then!="function"&&typeof v.then!="function"&&l(g,v,y):b===JRe?f(g,v,y):b===qRe?r(g,v,y):b===BRe?l(g,v,y):b===zRe||b===KRe||b===XRe?c(g,v,y):!1}}function tMe(e){var t=e.circular,n=e.createCustomConfig,r=e.strict,s={areArraysEqual:r?jf:PRe,areDatesEqual:ORe,areErrorsEqual:IRe,areFunctionsEqual:RRe,areMapsEqual:r?iM(uM,jf):uM,areNumbersEqual:MRe,areObjectsEqual:r?jf:DRe,arePrimitiveWrappersEqual:LRe,areRegExpsEqual:$Re,areSetsEqual:r?iM(dM,jf):dM,areTypedArraysEqual:r?jf:FRe,areUrlsEqual:URe};if(n&&(s=fM({},s,n(s))),t){var i=fv(s.areArraysEqual),o=fv(s.areMapsEqual),l=fv(s.areObjectsEqual),c=fv(s.areSetsEqual);s=fM({},s,{areArraysEqual:i,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:c})}return s}function nMe(e){return function(t,n,r,s,i,o,l){return e(t,n,l)}}function rMe(e){var t=e.circular,n=e.comparator,r=e.createState,s=e.equals,i=e.strict;if(r)return function(c,u){var d=r(),h=d.cache,f=h===void 0?t?new WeakMap:void 0:h,m=d.meta;return n(c,u,{cache:f,equals:s,meta:m,strict:i})};if(t)return function(c,u){return n(c,u,{cache:new WeakMap,equals:s,meta:void 0,strict:i})};var o={cache:void 0,equals:s,meta:void 0,strict:i};return function(c,u){return n(c,u,o)}}var aMe=ac();ac({strict:!0});ac({circular:!0});ac({circular:!0,strict:!0});ac({createInternalComparator:function(){return wu}});ac({strict:!0,createInternalComparator:function(){return wu}});ac({circular:!0,createInternalComparator:function(){return wu}});ac({circular:!0,createInternalComparator:function(){return wu},strict:!0});function ac(e){e===void 0&&(e={});var t=e.circular,n=t===void 0?!1:t,r=e.createInternalComparator,s=e.createState,i=e.strict,o=i===void 0?!1:i,l=tMe(e),c=eMe(l),u=r?r(c):nMe(c);return rMe({circular:n,comparator:c,createState:s,equals:u,strict:o})}function sMe(e){typeof requestAnimationFrame<"u"&&requestAnimationFrame(e)}function mM(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,r=function s(i){n<0&&(n=i),i-n>t?(e(i),n=-1):sMe(s)};requestAnimationFrame(r)}function Vk(e){"@babel/helpers - typeof";return Vk=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vk(e)}function iMe(e){return uMe(e)||cMe(e)||lMe(e)||oMe()}function oMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function lMe(e,t){if(e){if(typeof e=="string")return pM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return pM(e,t)}}function pM(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function uMe(e){if(Array.isArray(e))return e}function dMe(){var e={},t=function(){return null},n=!1,r=function s(i){if(!n){if(Array.isArray(i)){if(!i.length)return;var o=i,l=iMe(o),c=l[0],u=l.slice(1);if(typeof c=="number"){mM(s.bind(null,u),c);return}s(c),mM(s.bind(null,u));return}Vk(i)==="object"&&(e=i,t(e)),typeof i=="function"&&i()}};return{stop:function(){n=!0},start:function(i){n=!1,r(i)},subscribe:function(i){return t=i,function(){t=function(){return null}}}}}function dp(e){"@babel/helpers - typeof";return dp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dp(e)}function gM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function vM(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?gM(Object(n),!0).forEach(function(r){Eq(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):gM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Eq(e,t,n){return t=hMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hMe(e){var t=fMe(e,"string");return dp(t)==="symbol"?t:String(t)}function fMe(e,t){if(dp(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(dp(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var mMe=function(t,n){return[Object.keys(t),Object.keys(n)].reduce(function(r,s){return r.filter(function(i){return s.includes(i)})})},pMe=function(t){return t},gMe=function(t){return t.replace(/([A-Z])/g,function(n){return"-".concat(n.toLowerCase())})},tm=function(t,n){return Object.keys(n).reduce(function(r,s){return vM(vM({},r),{},Eq({},s,t(s,n[s])))},{})},yM=function(t,n,r){return t.map(function(s){return"".concat(gMe(s)," ").concat(n,"ms ").concat(r)}).join(",")};function vMe(e,t){return bMe(e)||xMe(e,t)||Tq(e,t)||yMe()}function yMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function xMe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function bMe(e){if(Array.isArray(e))return e}function wMe(e){return kMe(e)||_Me(e)||Tq(e)||jMe()}function jMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Tq(e,t){if(e){if(typeof e=="string")return Gk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Gk(e,t)}}function _Me(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function kMe(e){if(Array.isArray(e))return Gk(e)}function Gk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var xx=1e-4,Pq=function(t,n){return[0,3*t,3*n-6*t,3*t-3*n+1]},Oq=function(t,n){return t.map(function(r,s){return r*Math.pow(n,s)}).reduce(function(r,s){return r+s})},xM=function(t,n){return function(r){var s=Pq(t,n);return Oq(s,r)}},SMe=function(t,n){return function(r){var s=Pq(t,n),i=[].concat(wMe(s.map(function(o,l){return o*l}).slice(1)),[0]);return Oq(i,r)}},bM=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var s=n[0],i=n[1],o=n[2],l=n[3];if(n.length===1)switch(n[0]){case"linear":s=0,i=0,o=1,l=1;break;case"ease":s=.25,i=.1,o=.25,l=1;break;case"ease-in":s=.42,i=0,o=1,l=1;break;case"ease-out":s=.42,i=0,o=.58,l=1;break;case"ease-in-out":s=0,i=0,o=.58,l=1;break;default:{var c=n[0].split("(");if(c[0]==="cubic-bezier"&&c[1].split(")")[0].split(",").length===4){var u=c[1].split(")")[0].split(",").map(function(y){return parseFloat(y)}),d=vMe(u,4);s=d[0],i=d[1],o=d[2],l=d[3]}}}var h=xM(s,o),f=xM(i,l),m=SMe(s,o),g=function(x){return x>1?1:x<0?0:x},v=function(x){for(var w=x>1?1:x,b=w,_=0;_<8;++_){var k=h(b)-w,j=m(b);if(Math.abs(k-w)<xx||j<xx)return f(b);b=g(b-k/j)}return f(b)};return v.isStepper=!1,v},NMe=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=t.stiff,r=n===void 0?100:n,s=t.damping,i=s===void 0?8:s,o=t.dt,l=o===void 0?17:o,c=function(d,h,f){var m=-(d-h)*r,g=f*i,v=f+(m-g)*l/1e3,y=f*l/1e3+d;return Math.abs(y-h)<xx&&Math.abs(v)<xx?[h,0]:[y,v]};return c.isStepper=!0,c.dt=l,c},CMe=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var s=n[0];if(typeof s=="string")switch(s){case"ease":case"ease-in-out":case"ease-out":case"ease-in":case"linear":return bM(s);case"spring":return NMe();default:if(s.split("(")[0]==="cubic-bezier")return bM(s)}return typeof s=="function"?s:null};function hp(e){"@babel/helpers - typeof";return hp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},hp(e)}function wM(e){return TMe(e)||EMe(e)||Iq(e)||AMe()}function AMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function EMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function TMe(e){if(Array.isArray(e))return Xk(e)}function jM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Br(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?jM(Object(n),!0).forEach(function(r){Yk(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):jM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Yk(e,t,n){return t=PMe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function PMe(e){var t=OMe(e,"string");return hp(t)==="symbol"?t:String(t)}function OMe(e,t){if(hp(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(hp(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IMe(e,t){return DMe(e)||MMe(e,t)||Iq(e,t)||RMe()}function RMe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Iq(e,t){if(e){if(typeof e=="string")return Xk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xk(e,t)}}function Xk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function MMe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function DMe(e){if(Array.isArray(e))return e}var bx=function(t,n,r){return t+(n-t)*r},Jk=function(t){var n=t.from,r=t.to;return n!==r},LMe=function e(t,n,r){var s=tm(function(i,o){if(Jk(o)){var l=t(o.from,o.to,o.velocity),c=IMe(l,2),u=c[0],d=c[1];return Br(Br({},o),{},{from:u,velocity:d})}return o},n);return r<1?tm(function(i,o){return Jk(o)?Br(Br({},o),{},{velocity:bx(o.velocity,s[i].velocity,r),from:bx(o.from,s[i].from,r)}):o},n):e(t,s,r-1)};const $Me=function(e,t,n,r,s){var i=mMe(e,t),o=i.reduce(function(y,x){return Br(Br({},y),{},Yk({},x,[e[x],t[x]]))},{}),l=i.reduce(function(y,x){return Br(Br({},y),{},Yk({},x,{from:e[x],velocity:0,to:t[x]}))},{}),c=-1,u,d,h=function(){return null},f=function(){return tm(function(x,w){return w.from},l)},m=function(){return!Object.values(l).filter(Jk).length},g=function(x){u||(u=x);var w=x-u,b=w/n.dt;l=LMe(n,l,b),s(Br(Br(Br({},e),t),f())),u=x,m()||(c=requestAnimationFrame(h))},v=function(x){d||(d=x);var w=(x-d)/r,b=tm(function(k,j){return bx.apply(void 0,wM(j).concat([n(w)]))},o);if(s(Br(Br(Br({},e),t),b)),w<1)c=requestAnimationFrame(h);else{var _=tm(function(k,j){return bx.apply(void 0,wM(j).concat([n(1)]))},o);s(Br(Br(Br({},e),t),_))}};return h=n.isStepper?g:v,function(){return requestAnimationFrame(h),function(){cancelAnimationFrame(c)}}};function uh(e){"@babel/helpers - typeof";return uh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},uh(e)}var FMe=["children","begin","duration","attributeName","easing","isActive","steps","from","to","canBegin","onAnimationEnd","shouldReAnimate","onAnimationReStart"];function UMe(e,t){if(e==null)return{};var n=BMe(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function BMe(e,t){if(e==null)return{};var n={},r=Object.keys(e),s,i;for(i=0;i<r.length;i++)s=r[i],!(t.indexOf(s)>=0)&&(n[s]=e[s]);return n}function Yj(e){return HMe(e)||qMe(e)||WMe(e)||zMe()}function zMe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function WMe(e,t){if(e){if(typeof e=="string")return Qk(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qk(e,t)}}function qMe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function HMe(e){if(Array.isArray(e))return Qk(e)}function Qk(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function _M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Ws(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?_M(Object(n),!0).forEach(function(r){If(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_M(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function If(e,t,n){return t=Rq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function KMe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function VMe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Rq(r.key),r)}}function GMe(e,t,n){return t&&VMe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function Rq(e){var t=YMe(e,"string");return uh(t)==="symbol"?t:String(t)}function YMe(e,t){if(uh(e)!=="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(uh(r)!=="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function XMe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zk(e,t)}function Zk(e,t){return Zk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},Zk(e,t)}function JMe(e){var t=QMe();return function(){var r=wx(e),s;if(t){var i=wx(this).constructor;s=Reflect.construct(r,arguments,i)}else s=r.apply(this,arguments);return eS(this,s)}}function eS(e,t){if(t&&(uh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return tS(e)}function tS(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function QMe(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function wx(e){return wx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},wx(e)}var zl=function(e){XMe(n,e);var t=JMe(n);function n(r,s){var i;KMe(this,n),i=t.call(this,r,s);var o=i.props,l=o.isActive,c=o.attributeName,u=o.from,d=o.to,h=o.steps,f=o.children,m=o.duration;if(i.handleStyleChange=i.handleStyleChange.bind(tS(i)),i.changeStyle=i.changeStyle.bind(tS(i)),!l||m<=0)return i.state={style:{}},typeof f=="function"&&(i.state={style:d}),eS(i);if(h&&h.length)i.state={style:h[0].style};else if(u){if(typeof f=="function")return i.state={style:u},eS(i);i.state={style:c?If({},c,u):u}}else i.state={style:{}};return i}return GMe(n,[{key:"componentDidMount",value:function(){var s=this.props,i=s.isActive,o=s.canBegin;this.mounted=!0,!(!i||!o)&&this.runAnimation(this.props)}},{key:"componentDidUpdate",value:function(s){var i=this.props,o=i.isActive,l=i.canBegin,c=i.attributeName,u=i.shouldReAnimate,d=i.to,h=i.from,f=this.state.style;if(l){if(!o){var m={style:c?If({},c,d):d};this.state&&f&&(c&&f[c]!==d||!c&&f!==d)&&this.setState(m);return}if(!(aMe(s.to,d)&&s.canBegin&&s.isActive)){var g=!s.canBegin||!s.isActive;this.manager&&this.manager.stop(),this.stopJSAnimation&&this.stopJSAnimation();var v=g||u?h:s.to;if(this.state&&f){var y={style:c?If({},c,v):v};(c&&f[c]!==v||!c&&f!==v)&&this.setState(y)}this.runAnimation(Ws(Ws({},this.props),{},{from:v,begin:0}))}}}},{key:"componentWillUnmount",value:function(){this.mounted=!1;var s=this.props.onAnimationEnd;this.unSubscribe&&this.unSubscribe(),this.manager&&(this.manager.stop(),this.manager=null),this.stopJSAnimation&&this.stopJSAnimation(),s&&s()}},{key:"handleStyleChange",value:function(s){this.changeStyle(s)}},{key:"changeStyle",value:function(s){this.mounted&&this.setState({style:s})}},{key:"runJSAnimation",value:function(s){var i=this,o=s.from,l=s.to,c=s.duration,u=s.easing,d=s.begin,h=s.onAnimationEnd,f=s.onAnimationStart,m=$Me(o,l,CMe(u),c,this.changeStyle),g=function(){i.stopJSAnimation=m()};this.manager.start([f,d,g,c,h])}},{key:"runStepAnimation",value:function(s){var i=this,o=s.steps,l=s.begin,c=s.onAnimationStart,u=o[0],d=u.style,h=u.duration,f=h===void 0?0:h,m=function(v,y,x){if(x===0)return v;var w=y.duration,b=y.easing,_=b===void 0?"ease":b,k=y.style,j=y.properties,S=y.onAnimationEnd,T=x>0?o[x-1]:y,O=j||Object.keys(k);if(typeof _=="function"||_==="spring")return[].concat(Yj(v),[i.runJSAnimation.bind(i,{from:T.style,to:k,duration:w,easing:_}),w]);var A=yM(O,w,_),N=Ws(Ws(Ws({},T.style),k),{},{transition:A});return[].concat(Yj(v),[N,w,S]).filter(pMe)};return this.manager.start([c].concat(Yj(o.reduce(m,[d,Math.max(f,l)])),[s.onAnimationEnd]))}},{key:"runAnimation",value:function(s){this.manager||(this.manager=dMe());var i=s.begin,o=s.duration,l=s.attributeName,c=s.to,u=s.easing,d=s.onAnimationStart,h=s.onAnimationEnd,f=s.steps,m=s.children,g=this.manager;if(this.unSubscribe=g.subscribe(this.handleStyleChange),typeof u=="function"||typeof m=="function"||u==="spring"){this.runJSAnimation(s);return}if(f.length>1){this.runStepAnimation(s);return}var v=l?If({},l,c):c,y=yM(Object.keys(v),o,u);g.start([d,i,Ws(Ws({},v),{},{transition:y}),o,h])}},{key:"render",value:function(){var s=this.props,i=s.children;s.begin;var o=s.duration;s.attributeName,s.easing;var l=s.isActive;s.steps,s.from,s.to,s.canBegin,s.onAnimationEnd,s.shouldReAnimate,s.onAnimationReStart;var c=UMe(s,FMe),u=p.Children.count(i),d=this.state.style;if(typeof i=="function")return i(d);if(!l||u===0||o<=0)return i;var h=function(m){var g=m.props,v=g.style,y=v===void 0?{}:v,x=g.className,w=p.cloneElement(m,Ws(Ws({},c),{},{style:Ws(Ws({},y),d),className:x}));return w};return u===1?h(p.Children.only(i)):G.createElement("div",null,p.Children.map(i,function(f){return h(f)}))}}]),n}(p.PureComponent);zl.displayName="Animate";zl.defaultProps={begin:0,duration:1e3,from:"",to:"",attributeName:"",easing:"ease",isActive:!0,canBegin:!0,steps:[],onAnimationEnd:function(){},onAnimationStart:function(){}};zl.propTypes={from:vn.oneOfType([vn.object,vn.string]),to:vn.oneOfType([vn.object,vn.string]),attributeName:vn.string,duration:vn.number,begin:vn.number,easing:vn.oneOfType([vn.string,vn.func]),steps:vn.arrayOf(vn.shape({duration:vn.number.isRequired,style:vn.object.isRequired,easing:vn.oneOfType([vn.oneOf(["ease","ease-in","ease-out","ease-in-out","linear"]),vn.func]),properties:vn.arrayOf("string"),onAnimationEnd:vn.func})),children:vn.oneOfType([vn.node,vn.func]),isActive:vn.bool,canBegin:vn.bool,onAnimationEnd:vn.func,shouldReAnimate:vn.bool,onAnimationStart:vn.func,onAnimationReStart:vn.func};function fp(e){"@babel/helpers - typeof";return fp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fp(e)}function jx(){return jx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},jx.apply(this,arguments)}function ZMe(e,t){return rDe(e)||nDe(e,t)||tDe(e,t)||eDe()}function eDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function tDe(e,t){if(e){if(typeof e=="string")return kM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return kM(e,t)}}function kM(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nDe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function rDe(e){if(Array.isArray(e))return e}function SM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function NM(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?SM(Object(n),!0).forEach(function(r){aDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):SM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function aDe(e,t,n){return t=sDe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function sDe(e){var t=iDe(e,"string");return fp(t)=="symbol"?t:t+""}function iDe(e,t){if(fp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(fp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CM=function(t,n,r,s,i){var o=Math.min(Math.abs(r)/2,Math.abs(s)/2),l=s>=0?1:-1,c=r>=0?1:-1,u=s>=0&&r>=0||s<0&&r<0?1:0,d;if(o>0&&i instanceof Array){for(var h=[0,0,0,0],f=0,m=4;f<m;f++)h[f]=i[f]>o?o:i[f];d="M".concat(t,",").concat(n+l*h[0]),h[0]>0&&(d+="A ".concat(h[0],",").concat(h[0],",0,0,").concat(u,",").concat(t+c*h[0],",").concat(n)),d+="L ".concat(t+r-c*h[1],",").concat(n),h[1]>0&&(d+="A ".concat(h[1],",").concat(h[1],",0,0,").concat(u,`,
        `).concat(t+r,",").concat(n+l*h[1])),d+="L ".concat(t+r,",").concat(n+s-l*h[2]),h[2]>0&&(d+="A ".concat(h[2],",").concat(h[2],",0,0,").concat(u,`,
        `).concat(t+r-c*h[2],",").concat(n+s)),d+="L ".concat(t+c*h[3],",").concat(n+s),h[3]>0&&(d+="A ".concat(h[3],",").concat(h[3],",0,0,").concat(u,`,
        `).concat(t,",").concat(n+s-l*h[3])),d+="Z"}else if(o>0&&i===+i&&i>0){var g=Math.min(o,i);d="M ".concat(t,",").concat(n+l*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(u,",").concat(t+c*g,",").concat(n,`
            L `).concat(t+r-c*g,",").concat(n,`
            A `).concat(g,",").concat(g,",0,0,").concat(u,",").concat(t+r,",").concat(n+l*g,`
            L `).concat(t+r,",").concat(n+s-l*g,`
            A `).concat(g,",").concat(g,",0,0,").concat(u,",").concat(t+r-c*g,",").concat(n+s,`
            L `).concat(t+c*g,",").concat(n+s,`
            A `).concat(g,",").concat(g,",0,0,").concat(u,",").concat(t,",").concat(n+s-l*g," Z")}else d="M ".concat(t,",").concat(n," h ").concat(r," v ").concat(s," h ").concat(-r," Z");return d},oDe=function(t,n){if(!t||!n)return!1;var r=t.x,s=t.y,i=n.x,o=n.y,l=n.width,c=n.height;if(Math.abs(l)>0&&Math.abs(c)>0){var u=Math.min(i,i+l),d=Math.max(i,i+l),h=Math.min(o,o+c),f=Math.max(o,o+c);return r>=u&&r<=d&&s>=h&&s<=f}return!1},lDe={x:0,y:0,width:0,height:0,radius:0,isAnimationActive:!1,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},lE=function(t){var n=NM(NM({},lDe),t),r=p.useRef(),s=p.useState(-1),i=ZMe(s,2),o=i[0],l=i[1];p.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var _=r.current.getTotalLength();_&&l(_)}catch{}},[]);var c=n.x,u=n.y,d=n.width,h=n.height,f=n.radius,m=n.className,g=n.animationEasing,v=n.animationDuration,y=n.animationBegin,x=n.isAnimationActive,w=n.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||h!==+h||d===0||h===0)return null;var b=on("recharts-rectangle",m);return w?G.createElement(zl,{canBegin:o>0,from:{width:d,height:h,x:c,y:u},to:{width:d,height:h,x:c,y:u},duration:v,animationEasing:g,isActive:w},function(_){var k=_.width,j=_.height,S=_.x,T=_.y;return G.createElement(zl,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:v,isActive:x,easing:g},G.createElement("path",jx({},fn(n,!0),{className:b,d:CM(S,T,k,j,f),ref:r})))}):G.createElement("path",jx({},fn(n,!0),{className:b,d:CM(c,u,d,h,f)}))};function nS(){return nS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},nS.apply(this,arguments)}var Mq=function(t){var n=t.cx,r=t.cy,s=t.r,i=t.className,o=on("recharts-dot",i);return n===+n&&r===+r&&s===+s?p.createElement("circle",nS({},fn(t,!1),By(t),{className:o,cx:n,cy:r,r:s})):null};function mp(e){"@babel/helpers - typeof";return mp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mp(e)}var cDe=["x","y","top","left","width","height","className"];function rS(){return rS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},rS.apply(this,arguments)}function AM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function uDe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?AM(Object(n),!0).forEach(function(r){dDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):AM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function dDe(e,t,n){return t=hDe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function hDe(e){var t=fDe(e,"string");return mp(t)=="symbol"?t:t+""}function fDe(e,t){if(mp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(mp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function mDe(e,t){if(e==null)return{};var n=pDe(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function pDe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var gDe=function(t,n,r,s,i,o){return"M".concat(t,",").concat(i,"v").concat(s,"M").concat(o,",").concat(n,"h").concat(r)},vDe=function(t){var n=t.x,r=n===void 0?0:n,s=t.y,i=s===void 0?0:s,o=t.top,l=o===void 0?0:o,c=t.left,u=c===void 0?0:c,d=t.width,h=d===void 0?0:d,f=t.height,m=f===void 0?0:f,g=t.className,v=mDe(t,cDe),y=uDe({x:r,y:i,top:l,left:u,width:h,height:m},v);return!tt(r)||!tt(i)||!tt(h)||!tt(m)||!tt(l)||!tt(u)?null:G.createElement("path",rS({},fn(y,!0),{className:on("recharts-cross",g),d:gDe(r,i,h,m,l,u)}))},yDe=G8,xDe=yDe(Object.getPrototypeOf,Object),bDe=xDe,wDe=Bo,jDe=bDe,_De=zo,kDe="[object Object]",SDe=Function.prototype,NDe=Object.prototype,Dq=SDe.toString,CDe=NDe.hasOwnProperty,ADe=Dq.call(Object);function EDe(e){if(!_De(e)||wDe(e)!=kDe)return!1;var t=jDe(e);if(t===null)return!0;var n=CDe.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Dq.call(n)==ADe}var TDe=EDe;const PDe=bn(TDe);var ODe=Bo,IDe=zo,RDe="[object Boolean]";function MDe(e){return e===!0||e===!1||IDe(e)&&ODe(e)==RDe}var DDe=MDe;const LDe=bn(DDe);function pp(e){"@babel/helpers - typeof";return pp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pp(e)}function _x(){return _x=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},_x.apply(this,arguments)}function $De(e,t){return zDe(e)||BDe(e,t)||UDe(e,t)||FDe()}function FDe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function UDe(e,t){if(e){if(typeof e=="string")return EM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return EM(e,t)}}function EM(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function BDe(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function zDe(e){if(Array.isArray(e))return e}function TM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function PM(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?TM(Object(n),!0).forEach(function(r){WDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):TM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function WDe(e,t,n){return t=qDe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qDe(e){var t=HDe(e,"string");return pp(t)=="symbol"?t:t+""}function HDe(e,t){if(pp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(pp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var OM=function(t,n,r,s,i){var o=r-s,l;return l="M ".concat(t,",").concat(n),l+="L ".concat(t+r,",").concat(n),l+="L ".concat(t+r-o/2,",").concat(n+i),l+="L ".concat(t+r-o/2-s,",").concat(n+i),l+="L ".concat(t,",").concat(n," Z"),l},KDe={x:0,y:0,upperWidth:0,lowerWidth:0,height:0,isUpdateAnimationActive:!1,animationBegin:0,animationDuration:1500,animationEasing:"ease"},VDe=function(t){var n=PM(PM({},KDe),t),r=p.useRef(),s=p.useState(-1),i=$De(s,2),o=i[0],l=i[1];p.useEffect(function(){if(r.current&&r.current.getTotalLength)try{var b=r.current.getTotalLength();b&&l(b)}catch{}},[]);var c=n.x,u=n.y,d=n.upperWidth,h=n.lowerWidth,f=n.height,m=n.className,g=n.animationEasing,v=n.animationDuration,y=n.animationBegin,x=n.isUpdateAnimationActive;if(c!==+c||u!==+u||d!==+d||h!==+h||f!==+f||d===0&&h===0||f===0)return null;var w=on("recharts-trapezoid",m);return x?G.createElement(zl,{canBegin:o>0,from:{upperWidth:0,lowerWidth:0,height:f,x:c,y:u},to:{upperWidth:d,lowerWidth:h,height:f,x:c,y:u},duration:v,animationEasing:g,isActive:x},function(b){var _=b.upperWidth,k=b.lowerWidth,j=b.height,S=b.x,T=b.y;return G.createElement(zl,{canBegin:o>0,from:"0px ".concat(o===-1?1:o,"px"),to:"".concat(o,"px 0px"),attributeName:"strokeDasharray",begin:y,duration:v,easing:g},G.createElement("path",_x({},fn(n,!0),{className:w,d:OM(S,T,_,k,j),ref:r})))}):G.createElement("g",null,G.createElement("path",_x({},fn(n,!0),{className:w,d:OM(c,u,d,h,f)})))},GDe=["option","shapeType","propTransformer","activeClassName","isActive"];function gp(e){"@babel/helpers - typeof";return gp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gp(e)}function YDe(e,t){if(e==null)return{};var n=XDe(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function XDe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function IM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function kx(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?IM(Object(n),!0).forEach(function(r){JDe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):IM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function JDe(e,t,n){return t=QDe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function QDe(e){var t=ZDe(e,"string");return gp(t)=="symbol"?t:t+""}function ZDe(e,t){if(gp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(gp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function eLe(e,t){return kx(kx({},t),e)}function tLe(e,t){return e==="symbols"}function RM(e){var t=e.shapeType,n=e.elementProps;switch(t){case"rectangle":return G.createElement(lE,n);case"trapezoid":return G.createElement(VDe,n);case"sector":return G.createElement(kq,n);case"symbols":if(tLe(t))return G.createElement(NA,n);break;default:return null}}function nLe(e){return p.isValidElement(e)?e.props:e}function rLe(e){var t=e.option,n=e.shapeType,r=e.propTransformer,s=r===void 0?eLe:r,i=e.activeClassName,o=i===void 0?"recharts-active-shape":i,l=e.isActive,c=YDe(e,GDe),u;if(p.isValidElement(t))u=p.cloneElement(t,kx(kx({},c),nLe(t)));else if(qt(t))u=t(c);else if(PDe(t)&&!LDe(t)){var d=s(t,c);u=G.createElement(RM,{shapeType:n,elementProps:d})}else{var h=c;u=G.createElement(RM,{shapeType:n,elementProps:h})}return l?G.createElement(Ir,{className:o},u):u}function $0(e,t){return t!=null&&"trapezoids"in e.props}function F0(e,t){return t!=null&&"sectors"in e.props}function vp(e,t){return t!=null&&"points"in e.props}function aLe(e,t){var n,r,s=e.x===(t==null||(n=t.labelViewBox)===null||n===void 0?void 0:n.x)||e.x===t.x,i=e.y===(t==null||(r=t.labelViewBox)===null||r===void 0?void 0:r.y)||e.y===t.y;return s&&i}function sLe(e,t){var n=e.endAngle===t.endAngle,r=e.startAngle===t.startAngle;return n&&r}function iLe(e,t){var n=e.x===t.x,r=e.y===t.y,s=e.z===t.z;return n&&r&&s}function oLe(e,t){var n;return $0(e,t)?n=aLe:F0(e,t)?n=sLe:vp(e,t)&&(n=iLe),n}function lLe(e,t){var n;return $0(e,t)?n="trapezoids":F0(e,t)?n="sectors":vp(e,t)&&(n="points"),n}function cLe(e,t){if($0(e,t)){var n;return(n=t.tooltipPayload)===null||n===void 0||(n=n[0])===null||n===void 0||(n=n.payload)===null||n===void 0?void 0:n.payload}if(F0(e,t)){var r;return(r=t.tooltipPayload)===null||r===void 0||(r=r[0])===null||r===void 0||(r=r.payload)===null||r===void 0?void 0:r.payload}return vp(e,t)?t.payload:{}}function uLe(e){var t=e.activeTooltipItem,n=e.graphicalItem,r=e.itemData,s=lLe(n,t),i=cLe(n,t),o=r.filter(function(c,u){var d=aE(i,c),h=n.props[s].filter(function(g){var v=oLe(n,t);return v(g,t)}),f=n.props[s].indexOf(h[h.length-1]),m=u===f;return d&&m}),l=r.indexOf(o[o.length-1]);return l}var dLe=Math.ceil,hLe=Math.max;function fLe(e,t,n,r){for(var s=-1,i=hLe(dLe((t-e)/(n||1)),0),o=Array(i);i--;)o[r?i:++s]=e,e+=n;return o}var mLe=fLe,pLe=fW,MM=1/0,gLe=17976931348623157e292;function vLe(e){if(!e)return e===0?e:0;if(e=pLe(e),e===MM||e===-MM){var t=e<0?-1:1;return t*gLe}return e===e?e:0}var Lq=vLe,yLe=mLe,xLe=N0,Xj=Lq;function bLe(e){return function(t,n,r){return r&&typeof r!="number"&&xLe(t,n,r)&&(n=r=void 0),t=Xj(t),n===void 0?(n=t,t=0):n=Xj(n),r=r===void 0?t<n?1:-1:Xj(r),yLe(t,n,r,e)}}var wLe=bLe,jLe=wLe,_Le=jLe(),kLe=_Le;const Sx=bn(kLe);function yp(e){"@babel/helpers - typeof";return yp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yp(e)}function DM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function LM(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?DM(Object(n),!0).forEach(function(r){$q(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):DM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function $q(e,t,n){return t=SLe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function SLe(e){var t=NLe(e,"string");return yp(t)=="symbol"?t:t+""}function NLe(e,t){if(yp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(yp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var CLe=["Webkit","Moz","O","ms"],ALe=function(t,n){var r=t.replace(/(\w)/,function(i){return i.toUpperCase()}),s=CLe.reduce(function(i,o){return LM(LM({},i),{},$q({},o+r,n))},{});return s[t]=n,s};function dh(e){"@babel/helpers - typeof";return dh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dh(e)}function Nx(){return Nx=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Nx.apply(this,arguments)}function $M(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Jj(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?$M(Object(n),!0).forEach(function(r){ts(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$M(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function ELe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function FM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Uq(r.key),r)}}function TLe(e,t,n){return t&&FM(e.prototype,t),n&&FM(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function PLe(e,t,n){return t=Cx(t),OLe(e,Fq()?Reflect.construct(t,n||[],Cx(e).constructor):t.apply(e,n))}function OLe(e,t){if(t&&(dh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ILe(e)}function ILe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Fq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Fq=function(){return!!e})()}function Cx(e){return Cx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Cx(e)}function RLe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&aS(e,t)}function aS(e,t){return aS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},aS(e,t)}function ts(e,t,n){return t=Uq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Uq(e){var t=MLe(e,"string");return dh(t)=="symbol"?t:t+""}function MLe(e,t){if(dh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(dh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var DLe=function(t){var n=t.data,r=t.startIndex,s=t.endIndex,i=t.x,o=t.width,l=t.travellerWidth;if(!n||!n.length)return{};var c=n.length,u=Zf().domain(Sx(0,c)).range([i,i+o-l]),d=u.domain().map(function(h){return u(h)});return{isTextActive:!1,isSlideMoving:!1,isTravellerMoving:!1,isTravellerFocused:!1,startX:u(r),endX:u(s),scale:u,scaleValues:d}},UM=function(t){return t.changedTouches&&!!t.changedTouches.length},hh=function(e){function t(n){var r;return ELe(this,t),r=PLe(this,t,[n]),ts(r,"handleDrag",function(s){r.leaveTimer&&(clearTimeout(r.leaveTimer),r.leaveTimer=null),r.state.isTravellerMoving?r.handleTravellerMove(s):r.state.isSlideMoving&&r.handleSlideDrag(s)}),ts(r,"handleTouchMove",function(s){s.changedTouches!=null&&s.changedTouches.length>0&&r.handleDrag(s.changedTouches[0])}),ts(r,"handleDragEnd",function(){r.setState({isTravellerMoving:!1,isSlideMoving:!1},function(){var s=r.props,i=s.endIndex,o=s.onDragEnd,l=s.startIndex;o==null||o({endIndex:i,startIndex:l})}),r.detachDragEndListener()}),ts(r,"handleLeaveWrapper",function(){(r.state.isTravellerMoving||r.state.isSlideMoving)&&(r.leaveTimer=window.setTimeout(r.handleDragEnd,r.props.leaveTimeOut))}),ts(r,"handleEnterSlideOrTraveller",function(){r.setState({isTextActive:!0})}),ts(r,"handleLeaveSlideOrTraveller",function(){r.setState({isTextActive:!1})}),ts(r,"handleSlideDragStart",function(s){var i=UM(s)?s.changedTouches[0]:s;r.setState({isTravellerMoving:!1,isSlideMoving:!0,slideMoveStartX:i.pageX}),r.attachDragEndListener()}),r.travellerDragStartHandlers={startX:r.handleTravellerDragStart.bind(r,"startX"),endX:r.handleTravellerDragStart.bind(r,"endX")},r.state={},r}return RLe(t,e),TLe(t,[{key:"componentWillUnmount",value:function(){this.leaveTimer&&(clearTimeout(this.leaveTimer),this.leaveTimer=null),this.detachDragEndListener()}},{key:"getIndex",value:function(r){var s=r.startX,i=r.endX,o=this.state.scaleValues,l=this.props,c=l.gap,u=l.data,d=u.length-1,h=Math.min(s,i),f=Math.max(s,i),m=t.getIndexInRange(o,h),g=t.getIndexInRange(o,f);return{startIndex:m-m%c,endIndex:g===d?d:g-g%c}}},{key:"getTextOfTick",value:function(r){var s=this.props,i=s.data,o=s.tickFormatter,l=s.dataKey,c=Ki(i[r],l,r);return qt(o)?o(c,r):c}},{key:"attachDragEndListener",value:function(){window.addEventListener("mouseup",this.handleDragEnd,!0),window.addEventListener("touchend",this.handleDragEnd,!0),window.addEventListener("mousemove",this.handleDrag,!0)}},{key:"detachDragEndListener",value:function(){window.removeEventListener("mouseup",this.handleDragEnd,!0),window.removeEventListener("touchend",this.handleDragEnd,!0),window.removeEventListener("mousemove",this.handleDrag,!0)}},{key:"handleSlideDrag",value:function(r){var s=this.state,i=s.slideMoveStartX,o=s.startX,l=s.endX,c=this.props,u=c.x,d=c.width,h=c.travellerWidth,f=c.startIndex,m=c.endIndex,g=c.onChange,v=r.pageX-i;v>0?v=Math.min(v,u+d-h-l,u+d-h-o):v<0&&(v=Math.max(v,u-o,u-l));var y=this.getIndex({startX:o+v,endX:l+v});(y.startIndex!==f||y.endIndex!==m)&&g&&g(y),this.setState({startX:o+v,endX:l+v,slideMoveStartX:r.pageX})}},{key:"handleTravellerDragStart",value:function(r,s){var i=UM(s)?s.changedTouches[0]:s;this.setState({isSlideMoving:!1,isTravellerMoving:!0,movingTravellerId:r,brushMoveStartX:i.pageX}),this.attachDragEndListener()}},{key:"handleTravellerMove",value:function(r){var s=this.state,i=s.brushMoveStartX,o=s.movingTravellerId,l=s.endX,c=s.startX,u=this.state[o],d=this.props,h=d.x,f=d.width,m=d.travellerWidth,g=d.onChange,v=d.gap,y=d.data,x={startX:this.state.startX,endX:this.state.endX},w=r.pageX-i;w>0?w=Math.min(w,h+f-m-u):w<0&&(w=Math.max(w,h-u)),x[o]=u+w;var b=this.getIndex(x),_=b.startIndex,k=b.endIndex,j=function(){var T=y.length-1;return o==="startX"&&(l>c?_%v===0:k%v===0)||l<c&&k===T||o==="endX"&&(l>c?k%v===0:_%v===0)||l>c&&k===T};this.setState(ts(ts({},o,u+w),"brushMoveStartX",r.pageX),function(){g&&j()&&g(b)})}},{key:"handleTravellerMoveKeyboard",value:function(r,s){var i=this,o=this.state,l=o.scaleValues,c=o.startX,u=o.endX,d=this.state[s],h=l.indexOf(d);if(h!==-1){var f=h+r;if(!(f===-1||f>=l.length)){var m=l[f];s==="startX"&&m>=u||s==="endX"&&m<=c||this.setState(ts({},s,m),function(){i.props.onChange(i.getIndex({startX:i.state.startX,endX:i.state.endX}))})}}}},{key:"renderBackground",value:function(){var r=this.props,s=r.x,i=r.y,o=r.width,l=r.height,c=r.fill,u=r.stroke;return G.createElement("rect",{stroke:u,fill:c,x:s,y:i,width:o,height:l})}},{key:"renderPanorama",value:function(){var r=this.props,s=r.x,i=r.y,o=r.width,l=r.height,c=r.data,u=r.children,d=r.padding,h=p.Children.only(u);return h?G.cloneElement(h,{x:s,y:i,width:o,height:l,margin:d,compact:!0,data:c}):null}},{key:"renderTravellerLayer",value:function(r,s){var i,o,l=this,c=this.props,u=c.y,d=c.travellerWidth,h=c.height,f=c.traveller,m=c.ariaLabel,g=c.data,v=c.startIndex,y=c.endIndex,x=Math.max(r,this.props.x),w=Jj(Jj({},fn(this.props,!1)),{},{x,y:u,width:d,height:h}),b=m||"Min value: ".concat((i=g[v])===null||i===void 0?void 0:i.name,", Max value: ").concat((o=g[y])===null||o===void 0?void 0:o.name);return G.createElement(Ir,{tabIndex:0,role:"slider","aria-label":b,"aria-valuenow":r,className:"recharts-brush-traveller",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.travellerDragStartHandlers[s],onTouchStart:this.travellerDragStartHandlers[s],onKeyDown:function(k){["ArrowLeft","ArrowRight"].includes(k.key)&&(k.preventDefault(),k.stopPropagation(),l.handleTravellerMoveKeyboard(k.key==="ArrowRight"?1:-1,s))},onFocus:function(){l.setState({isTravellerFocused:!0})},onBlur:function(){l.setState({isTravellerFocused:!1})},style:{cursor:"col-resize"}},t.renderTraveller(f,w))}},{key:"renderSlide",value:function(r,s){var i=this.props,o=i.y,l=i.height,c=i.stroke,u=i.travellerWidth,d=Math.min(r,s)+u,h=Math.max(Math.abs(s-r)-u,0);return G.createElement("rect",{className:"recharts-brush-slide",onMouseEnter:this.handleEnterSlideOrTraveller,onMouseLeave:this.handleLeaveSlideOrTraveller,onMouseDown:this.handleSlideDragStart,onTouchStart:this.handleSlideDragStart,style:{cursor:"move"},stroke:"none",fill:c,fillOpacity:.2,x:d,y:o,width:h,height:l})}},{key:"renderText",value:function(){var r=this.props,s=r.startIndex,i=r.endIndex,o=r.y,l=r.height,c=r.travellerWidth,u=r.stroke,d=this.state,h=d.startX,f=d.endX,m=5,g={pointerEvents:"none",fill:u};return G.createElement(Ir,{className:"recharts-brush-texts"},G.createElement(nx,Nx({textAnchor:"end",verticalAnchor:"middle",x:Math.min(h,f)-m,y:o+l/2},g),this.getTextOfTick(s)),G.createElement(nx,Nx({textAnchor:"start",verticalAnchor:"middle",x:Math.max(h,f)+c+m,y:o+l/2},g),this.getTextOfTick(i)))}},{key:"render",value:function(){var r=this.props,s=r.data,i=r.className,o=r.children,l=r.x,c=r.y,u=r.width,d=r.height,h=r.alwaysShowText,f=this.state,m=f.startX,g=f.endX,v=f.isTextActive,y=f.isSlideMoving,x=f.isTravellerMoving,w=f.isTravellerFocused;if(!s||!s.length||!tt(l)||!tt(c)||!tt(u)||!tt(d)||u<=0||d<=0)return null;var b=on("recharts-brush",i),_=G.Children.count(o)===1,k=ALe("userSelect","none");return G.createElement(Ir,{className:b,onMouseLeave:this.handleLeaveWrapper,onTouchMove:this.handleTouchMove,style:k},this.renderBackground(),_&&this.renderPanorama(),this.renderSlide(m,g),this.renderTravellerLayer(m,"startX"),this.renderTravellerLayer(g,"endX"),(v||y||x||w||h)&&this.renderText())}}],[{key:"renderDefaultTraveller",value:function(r){var s=r.x,i=r.y,o=r.width,l=r.height,c=r.stroke,u=Math.floor(i+l/2)-1;return G.createElement(G.Fragment,null,G.createElement("rect",{x:s,y:i,width:o,height:l,fill:c,stroke:"none"}),G.createElement("line",{x1:s+1,y1:u,x2:s+o-1,y2:u,fill:"none",stroke:"#fff"}),G.createElement("line",{x1:s+1,y1:u+2,x2:s+o-1,y2:u+2,fill:"none",stroke:"#fff"}))}},{key:"renderTraveller",value:function(r,s){var i;return G.isValidElement(r)?i=G.cloneElement(r,s):qt(r)?i=r(s):i=t.renderDefaultTraveller(s),i}},{key:"getDerivedStateFromProps",value:function(r,s){var i=r.data,o=r.width,l=r.x,c=r.travellerWidth,u=r.updateId,d=r.startIndex,h=r.endIndex;if(i!==s.prevData||u!==s.prevUpdateId)return Jj({prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:o},i&&i.length?DLe({data:i,width:o,x:l,travellerWidth:c,startIndex:d,endIndex:h}):{scale:null,scaleValues:null});if(s.scale&&(o!==s.prevWidth||l!==s.prevX||c!==s.prevTravellerWidth)){s.scale.range([l,l+o-c]);var f=s.scale.domain().map(function(m){return s.scale(m)});return{prevData:i,prevTravellerWidth:c,prevUpdateId:u,prevX:l,prevWidth:o,startX:s.scale(r.startIndex),endX:s.scale(r.endIndex),scaleValues:f}}return null}},{key:"getIndexInRange",value:function(r,s){for(var i=r.length,o=0,l=i-1;l-o>1;){var c=Math.floor((o+l)/2);r[c]>s?l=c:o=c}return s>=r[l]?l:o}}])}(p.PureComponent);ts(hh,"displayName","Brush");ts(hh,"defaultProps",{height:40,travellerWidth:5,gap:1,fill:"#fff",stroke:"#666",padding:{top:1,right:1,bottom:1,left:1},leaveTimeOut:1e3,alwaysShowText:!1});var LLe=IA;function $Le(e,t){var n;return LLe(e,function(r,s,i){return n=t(r,s,i),!n}),!!n}var FLe=$Le,ULe=U8,BLe=tc,zLe=FLe,WLe=Xa,qLe=N0;function HLe(e,t,n){var r=WLe(e)?ULe:zLe;return n&&qLe(e,t,n)&&(t=void 0),r(e,BLe(t))}var KLe=HLe;const VLe=bn(KLe);var Bi=function(t,n){var r=t.alwaysShow,s=t.ifOverflow;return r&&(s="extendDomain"),s===n},BM=lW;function GLe(e,t,n){t=="__proto__"&&BM?BM(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}var YLe=GLe,XLe=YLe,JLe=iW,QLe=tc;function ZLe(e,t){var n={};return t=QLe(t),JLe(e,function(r,s,i){XLe(n,s,t(r,s,i))}),n}var e$e=ZLe;const t$e=bn(e$e);function n$e(e,t){for(var n=-1,r=e==null?0:e.length;++n<r;)if(!t(e[n],n,e))return!1;return!0}var r$e=n$e,a$e=IA;function s$e(e,t){var n=!0;return a$e(e,function(r,s,i){return n=!!t(r,s,i),n}),n}var i$e=s$e,o$e=r$e,l$e=i$e,c$e=tc,u$e=Xa,d$e=N0;function h$e(e,t,n){var r=u$e(e)?o$e:l$e;return n&&d$e(e,t,n)&&(t=void 0),r(e,c$e(t))}var f$e=h$e;const Bq=bn(f$e);var m$e=["x","y"];function xp(e){"@babel/helpers - typeof";return xp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xp(e)}function sS(){return sS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},sS.apply(this,arguments)}function zM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function _f(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?zM(Object(n),!0).forEach(function(r){p$e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):zM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function p$e(e,t,n){return t=g$e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g$e(e){var t=v$e(e,"string");return xp(t)=="symbol"?t:t+""}function v$e(e,t){if(xp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(xp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function y$e(e,t){if(e==null)return{};var n=x$e(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function x$e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function b$e(e,t){var n=e.x,r=e.y,s=y$e(e,m$e),i="".concat(n),o=parseInt(i,10),l="".concat(r),c=parseInt(l,10),u="".concat(t.height||s.height),d=parseInt(u,10),h="".concat(t.width||s.width),f=parseInt(h,10);return _f(_f(_f(_f(_f({},t),s),o?{x:o}:{}),c?{y:c}:{}),{},{height:d,width:f,name:t.name,radius:t.radius})}function WM(e){return G.createElement(rLe,sS({shapeType:"rectangle",propTransformer:b$e,activeClassName:"recharts-active-bar"},e))}var w$e=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return function(r,s){if(typeof t=="number")return t;var i=tt(r)||Fbe(r);return i?t(r,s):(i||su(),n)}},j$e=["value","background"],zq;function fh(e){"@babel/helpers - typeof";return fh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fh(e)}function _$e(e,t){if(e==null)return{};var n=k$e(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function k$e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function Ax(){return Ax=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ax.apply(this,arguments)}function qM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function hr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?qM(Object(n),!0).forEach(function(r){wl(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function S$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function HM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,qq(r.key),r)}}function N$e(e,t,n){return t&&HM(e.prototype,t),n&&HM(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function C$e(e,t,n){return t=Ex(t),A$e(e,Wq()?Reflect.construct(t,n||[],Ex(e).constructor):t.apply(e,n))}function A$e(e,t){if(t&&(fh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return E$e(e)}function E$e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Wq(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Wq=function(){return!!e})()}function Ex(e){return Ex=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ex(e)}function T$e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&iS(e,t)}function iS(e,t){return iS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},iS(e,t)}function wl(e,t,n){return t=qq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qq(e){var t=P$e(e,"string");return fh(t)=="symbol"?t:t+""}function P$e(e,t){if(fh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(fh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Gn=function(e){function t(){var n;S$e(this,t);for(var r=arguments.length,s=new Array(r),i=0;i<r;i++)s[i]=arguments[i];return n=C$e(this,t,[].concat(s)),wl(n,"state",{isAnimationFinished:!1}),wl(n,"id",x0("recharts-bar-")),wl(n,"handleAnimationEnd",function(){var o=n.props.onAnimationEnd;n.setState({isAnimationFinished:!0}),o&&o()}),wl(n,"handleAnimationStart",function(){var o=n.props.onAnimationStart;n.setState({isAnimationFinished:!1}),o&&o()}),n}return T$e(t,e),N$e(t,[{key:"renderRectanglesStatically",value:function(r){var s=this,i=this.props,o=i.shape,l=i.dataKey,c=i.activeIndex,u=i.activeBar,d=fn(this.props,!1);return r&&r.map(function(h,f){var m=f===c,g=m?u:o,v=hr(hr(hr({},d),h),{},{isActive:m,option:g,index:f,dataKey:l,onAnimationStart:s.handleAnimationStart,onAnimationEnd:s.handleAnimationEnd});return G.createElement(Ir,Ax({className:"recharts-bar-rectangle"},zy(s.props,h,f),{key:"rectangle-".concat(h==null?void 0:h.x,"-").concat(h==null?void 0:h.y,"-").concat(h==null?void 0:h.value,"-").concat(f)}),G.createElement(WM,v))})}},{key:"renderRectanglesWithAnimation",value:function(){var r=this,s=this.props,i=s.data,o=s.layout,l=s.isAnimationActive,c=s.animationBegin,u=s.animationDuration,d=s.animationEasing,h=s.animationId,f=this.state.prevData;return G.createElement(zl,{begin:c,duration:u,isActive:l,easing:d,from:{t:0},to:{t:1},key:"bar-".concat(h),onAnimationEnd:this.handleAnimationEnd,onAnimationStart:this.handleAnimationStart},function(m){var g=m.t,v=i.map(function(y,x){var w=f&&f[x];if(w){var b=Du(w.x,y.x),_=Du(w.y,y.y),k=Du(w.width,y.width),j=Du(w.height,y.height);return hr(hr({},y),{},{x:b(g),y:_(g),width:k(g),height:j(g)})}if(o==="horizontal"){var S=Du(0,y.height),T=S(g);return hr(hr({},y),{},{y:y.y+y.height-T,height:T})}var O=Du(0,y.width),A=O(g);return hr(hr({},y),{},{width:A})});return G.createElement(Ir,null,r.renderRectanglesStatically(v))})}},{key:"renderRectangles",value:function(){var r=this.props,s=r.data,i=r.isAnimationActive,o=this.state.prevData;return i&&s&&s.length&&(!o||!aE(o,s))?this.renderRectanglesWithAnimation():this.renderRectanglesStatically(s)}},{key:"renderBackground",value:function(){var r=this,s=this.props,i=s.data,o=s.dataKey,l=s.activeIndex,c=fn(this.props.background,!1);return i.map(function(u,d){u.value;var h=u.background,f=_$e(u,j$e);if(!h)return null;var m=hr(hr(hr(hr(hr({},f),{},{fill:"#eee"},h),c),zy(r.props,u,d)),{},{onAnimationStart:r.handleAnimationStart,onAnimationEnd:r.handleAnimationEnd,dataKey:o,index:d,className:"recharts-bar-background-rectangle"});return G.createElement(WM,Ax({key:"background-bar-".concat(d),option:r.props.background,isActive:d===l},m))})}},{key:"renderErrorBar",value:function(r,s){if(this.props.isAnimationActive&&!this.state.isAnimationFinished)return null;var i=this.props,o=i.data,l=i.xAxis,c=i.yAxis,u=i.layout,d=i.children,h=ci(d,L0);if(!h)return null;var f=u==="vertical"?o[0].height/2:o[0].width/2,m=function(y,x){var w=Array.isArray(y.value)?y.value[1]:y.value;return{x:y.x,y:y.y,value:w,errorVal:Ki(y,x)}},g={clipPath:r?"url(#clipPath-".concat(s,")"):null};return G.createElement(Ir,g,h.map(function(v){return G.cloneElement(v,{key:"error-bar-".concat(s,"-").concat(v.props.dataKey),data:o,xAxis:l,yAxis:c,layout:u,offset:f,dataPointFormatter:m})}))}},{key:"render",value:function(){var r=this.props,s=r.hide,i=r.data,o=r.className,l=r.xAxis,c=r.yAxis,u=r.left,d=r.top,h=r.width,f=r.height,m=r.isAnimationActive,g=r.background,v=r.id;if(s||!i||!i.length)return null;var y=this.state.isAnimationFinished,x=on("recharts-bar",o),w=l&&l.allowDataOverflow,b=c&&c.allowDataOverflow,_=w||b,k=mn(v)?this.id:v;return G.createElement(Ir,{className:x},w||b?G.createElement("defs",null,G.createElement("clipPath",{id:"clipPath-".concat(k)},G.createElement("rect",{x:w?u:u-h/2,y:b?d:d-f/2,width:w?h:h*2,height:b?f:f*2}))):null,G.createElement(Ir,{className:"recharts-bar-rectangles",clipPath:_?"url(#clipPath-".concat(k,")"):null},g?this.renderBackground():null,this.renderRectangles()),this.renderErrorBar(_,k),(!m||y)&&ai.renderCallByParent(this.props,i))}}],[{key:"getDerivedStateFromProps",value:function(r,s){return r.animationId!==s.prevAnimationId?{prevAnimationId:r.animationId,curData:r.data,prevData:s.curData}:r.data!==s.curData?{curData:r.data}:null}}])}(p.PureComponent);zq=Gn;wl(Gn,"displayName","Bar");wl(Gn,"defaultProps",{xAxisId:0,yAxisId:0,legendType:"rect",minPointSize:0,hide:!1,data:[],layout:"vertical",activeBar:!1,isAnimationActive:!Ol.isSsr,animationBegin:0,animationDuration:400,animationEasing:"ease"});wl(Gn,"getComposedData",function(e){var t=e.props,n=e.item,r=e.barPosition,s=e.bandSize,i=e.xAxis,o=e.yAxis,l=e.xAxisTicks,c=e.yAxisTicks,u=e.stackedData,d=e.dataStartIndex,h=e.displayedData,f=e.offset,m=oIe(r,n);if(!m)return null;var g=t.layout,v=n.type.defaultProps,y=v!==void 0?hr(hr({},v),n.props):n.props,x=y.dataKey,w=y.children,b=y.minPointSize,_=g==="horizontal"?o:i,k=u?_.scale.domain():null,j=pIe({numericAxis:_}),S=ci(w,pW),T=h.map(function(O,A){var N,L,M,B,$,z;u?N=lIe(u[d+A],k):(N=Ki(O,x),Array.isArray(N)||(N=[j,N]));var R=w$e(b,zq.defaultProps.minPointSize)(N[1],A);if(g==="horizontal"){var C,D=[o.scale(N[0]),o.scale(N[1])],E=D[0],F=D[1];L=WR({axis:i,ticks:l,bandSize:s,offset:m.offset,entry:O,index:A}),M=(C=F??E)!==null&&C!==void 0?C:void 0,B=m.size;var I=E-F;if($=Number.isNaN(I)?0:I,z={x:L,y:o.y,width:B,height:o.height},Math.abs(R)>0&&Math.abs($)<Math.abs(R)){var P=ri($||R)*(Math.abs(R)-Math.abs($));M-=P,$+=P}}else{var U=[i.scale(N[0]),i.scale(N[1])],Z=U[0],X=U[1];if(L=Z,M=WR({axis:o,ticks:c,bandSize:s,offset:m.offset,entry:O,index:A}),B=X-Z,$=m.size,z={x:i.x,y:M,width:i.width,height:$},Math.abs(R)>0&&Math.abs(B)<Math.abs(R)){var K=ri(B||R)*(Math.abs(R)-Math.abs(B));B+=K}}return hr(hr(hr({},O),{},{x:L,y:M,width:B,height:$,value:u?N:N[1],payload:O,background:z},S&&S[A]&&S[A].props),{},{tooltipPayload:[wq(n,O)],tooltipPosition:{x:L+B/2,y:M+$/2}})});return hr({data:T,layout:g},f)});function bp(e){"@babel/helpers - typeof";return bp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bp(e)}function O$e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function KM(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,Hq(r.key),r)}}function I$e(e,t,n){return t&&KM(e.prototype,t),n&&KM(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function VM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Zs(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?VM(Object(n),!0).forEach(function(r){U0(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):VM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function U0(e,t,n){return t=Hq(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Hq(e){var t=R$e(e,"string");return bp(t)=="symbol"?t:t+""}function R$e(e,t){if(bp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var M$e=function(t,n,r,s,i){var o=t.width,l=t.height,c=t.layout,u=t.children,d=Object.keys(n),h={left:r.left,leftMirror:r.left,right:o-r.right,rightMirror:o-r.right,top:r.top,topMirror:r.top,bottom:l-r.bottom,bottomMirror:l-r.bottom},f=!!rs(u,Gn);return d.reduce(function(m,g){var v=n[g],y=v.orientation,x=v.domain,w=v.padding,b=w===void 0?{}:w,_=v.mirror,k=v.reversed,j="".concat(y).concat(_?"Mirror":""),S,T,O,A,N;if(v.type==="number"&&(v.padding==="gap"||v.padding==="no-gap")){var L=x[1]-x[0],M=1/0,B=v.categoricalDomain.sort(zbe);if(B.forEach(function(U,Z){Z>0&&(M=Math.min((U||0)-(B[Z-1]||0),M))}),Number.isFinite(M)){var $=M/L,z=v.layout==="vertical"?r.height:r.width;if(v.padding==="gap"&&(S=$*z/2),v.padding==="no-gap"){var R=ru(t.barCategoryGap,$*z),C=$*z/2;S=C-R-(C-R)/z*R}}}s==="xAxis"?T=[r.left+(b.left||0)+(S||0),r.left+r.width-(b.right||0)-(S||0)]:s==="yAxis"?T=c==="horizontal"?[r.top+r.height-(b.bottom||0),r.top+(b.top||0)]:[r.top+(b.top||0)+(S||0),r.top+r.height-(b.bottom||0)-(S||0)]:T=v.range,k&&(T=[T[1],T[0]]);var D=sIe(v,i,f),E=D.scale,F=D.realScaleType;E.domain(x).range(T),iIe(E);var I=mIe(E,Zs(Zs({},v),{},{realScaleType:F}));s==="xAxis"?(N=y==="top"&&!_||y==="bottom"&&_,O=r.left,A=h[j]-N*v.height):s==="yAxis"&&(N=y==="left"&&!_||y==="right"&&_,O=h[j]-N*v.width,A=r.top);var P=Zs(Zs(Zs({},v),I),{},{realScaleType:F,x:O,y:A,scale:E,width:s==="xAxis"?r.width:v.width,height:s==="yAxis"?r.height:v.height});return P.bandSize=gx(P,I),!v.hide&&s==="xAxis"?h[j]+=(N?-1:1)*P.height:v.hide||(h[j]+=(N?-1:1)*P.width),Zs(Zs({},m),{},U0({},g,P))},{})},Kq=function(t,n){var r=t.x,s=t.y,i=n.x,o=n.y;return{x:Math.min(r,i),y:Math.min(s,o),width:Math.abs(i-r),height:Math.abs(o-s)}},D$e=function(t){var n=t.x1,r=t.y1,s=t.x2,i=t.y2;return Kq({x:n,y:r},{x:s,y:i})},Vq=function(){function e(t){O$e(this,e),this.scale=t}return I$e(e,[{key:"domain",get:function(){return this.scale.domain}},{key:"range",get:function(){return this.scale.range}},{key:"rangeMin",get:function(){return this.range()[0]}},{key:"rangeMax",get:function(){return this.range()[1]}},{key:"bandwidth",get:function(){return this.scale.bandwidth}},{key:"apply",value:function(n){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=r.bandAware,i=r.position;if(n!==void 0){if(i)switch(i){case"start":return this.scale(n);case"middle":{var o=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+o}case"end":{var l=this.bandwidth?this.bandwidth():0;return this.scale(n)+l}default:return this.scale(n)}if(s){var c=this.bandwidth?this.bandwidth()/2:0;return this.scale(n)+c}return this.scale(n)}}},{key:"isInRange",value:function(n){var r=this.range(),s=r[0],i=r[r.length-1];return s<=i?n>=s&&n<=i:n>=i&&n<=s}}],[{key:"create",value:function(n){return new e(n)}}])}();U0(Vq,"EPS",1e-4);var cE=function(t){var n=Object.keys(t).reduce(function(r,s){return Zs(Zs({},r),{},U0({},s,Vq.create(t[s])))},{});return Zs(Zs({},n),{},{apply:function(s){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.bandAware,l=i.position;return t$e(s,function(c,u){return n[u].apply(c,{bandAware:o,position:l})})},isInRange:function(s){return Bq(s,function(i,o){return n[o].isInRange(i)})}})};function L$e(e){return(e%180+180)%180}var $$e=function(t){var n=t.width,r=t.height,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,i=L$e(s),o=i*Math.PI/180,l=Math.atan(r/n),c=o>l&&o<Math.PI-l?r/Math.sin(o):n/Math.cos(o);return Math.abs(c)},F$e=tc,U$e=cg,B$e=k0;function z$e(e){return function(t,n,r){var s=Object(t);if(!U$e(t)){var i=F$e(n);t=B$e(t),n=function(l){return i(s[l],l,s)}}var o=e(t,n,r);return o>-1?s[i?t[o]:o]:void 0}}var W$e=z$e,q$e=Lq;function H$e(e){var t=q$e(e),n=t%1;return t===t?n?t-n:t:0}var K$e=H$e,V$e=eW,G$e=tc,Y$e=K$e,X$e=Math.max;function J$e(e,t,n){var r=e==null?0:e.length;if(!r)return-1;var s=n==null?0:Y$e(n);return s<0&&(s=X$e(r+s,0)),V$e(e,G$e(t),s)}var Q$e=J$e,Z$e=W$e,e4e=Q$e,t4e=Z$e(e4e),n4e=t4e;const r4e=bn(n4e);var a4e=Wxe(function(e){return{x:e.left,y:e.top,width:e.width,height:e.height}},function(e){return["l",e.left,"t",e.top,"w",e.width,"h",e.height].join("")}),uE=p.createContext(void 0),dE=p.createContext(void 0),Gq=p.createContext(void 0),Yq=p.createContext({}),Xq=p.createContext(void 0),Jq=p.createContext(0),Qq=p.createContext(0),GM=function(t){var n=t.state,r=n.xAxisMap,s=n.yAxisMap,i=n.offset,o=t.clipPathId,l=t.children,c=t.width,u=t.height,d=a4e(i);return G.createElement(uE.Provider,{value:r},G.createElement(dE.Provider,{value:s},G.createElement(Yq.Provider,{value:i},G.createElement(Gq.Provider,{value:d},G.createElement(Xq.Provider,{value:o},G.createElement(Jq.Provider,{value:u},G.createElement(Qq.Provider,{value:c},l)))))))},s4e=function(){return p.useContext(Xq)},Zq=function(t){var n=p.useContext(uE);n==null&&su();var r=n[t];return r==null&&su(),r},i4e=function(){var t=p.useContext(uE);return hl(t)},o4e=function(){var t=p.useContext(dE),n=r4e(t,function(r){return Bq(r.domain,Number.isFinite)});return n||hl(t)},e9=function(t){var n=p.useContext(dE);n==null&&su();var r=n[t];return r==null&&su(),r},l4e=function(){var t=p.useContext(Gq);return t},c4e=function(){return p.useContext(Yq)},hE=function(){return p.useContext(Qq)},fE=function(){return p.useContext(Jq)};function mh(e){"@babel/helpers - typeof";return mh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},mh(e)}function u4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d4e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,n9(r.key),r)}}function h4e(e,t,n){return t&&d4e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function f4e(e,t,n){return t=Tx(t),m4e(e,t9()?Reflect.construct(t,n||[],Tx(e).constructor):t.apply(e,n))}function m4e(e,t){if(t&&(mh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return p4e(e)}function p4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function t9(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(t9=function(){return!!e})()}function Tx(e){return Tx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Tx(e)}function g4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&oS(e,t)}function oS(e,t){return oS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},oS(e,t)}function YM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function XM(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?YM(Object(n),!0).forEach(function(r){mE(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function mE(e,t,n){return t=n9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n9(e){var t=v4e(e,"string");return mh(t)=="symbol"?t:t+""}function v4e(e,t){if(mh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(mh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function y4e(e,t){return j4e(e)||w4e(e,t)||b4e(e,t)||x4e()}function x4e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function b4e(e,t){if(e){if(typeof e=="string")return JM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JM(e,t)}}function JM(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function w4e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function j4e(e){if(Array.isArray(e))return e}function lS(){return lS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},lS.apply(this,arguments)}var _4e=function(t,n){var r;return G.isValidElement(t)?r=G.cloneElement(t,n):qt(t)?r=t(n):r=G.createElement("line",lS({},n,{className:"recharts-reference-line-line"})),r},k4e=function(t,n,r,s,i,o,l,c,u){var d=i.x,h=i.y,f=i.width,m=i.height;if(r){var g=u.y,v=t.y.apply(g,{position:o});if(Bi(u,"discard")&&!t.y.isInRange(v))return null;var y=[{x:d+f,y:v},{x:d,y:v}];return c==="left"?y.reverse():y}if(n){var x=u.x,w=t.x.apply(x,{position:o});if(Bi(u,"discard")&&!t.x.isInRange(w))return null;var b=[{x:w,y:h+m},{x:w,y:h}];return l==="top"?b.reverse():b}if(s){var _=u.segment,k=_.map(function(j){return t.apply(j,{position:o})});return Bi(u,"discard")&&VLe(k,function(j){return!t.isInRange(j)})?null:k}return null};function S4e(e){var t=e.x,n=e.y,r=e.segment,s=e.xAxisId,i=e.yAxisId,o=e.shape,l=e.className,c=e.alwaysShow,u=s4e(),d=Zq(s),h=e9(i),f=l4e();if(!u||!f)return null;_o(c===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var m=cE({x:d.scale,y:h.scale}),g=Sr(t),v=Sr(n),y=r&&r.length===2,x=k4e(m,g,v,y,f,e.position,d.orientation,h.orientation,e);if(!x)return null;var w=y4e(x,2),b=w[0],_=b.x,k=b.y,j=w[1],S=j.x,T=j.y,O=Bi(e,"hidden")?"url(#".concat(u,")"):void 0,A=XM(XM({clipPath:O},fn(e,!0)),{},{x1:_,y1:k,x2:S,y2:T});return G.createElement(Ir,{className:on("recharts-reference-line",l)},_4e(o,A),sa.renderCallByParent(e,D$e({x1:_,y1:k,x2:S,y2:T})))}var pE=function(e){function t(){return u4e(this,t),f4e(this,t,arguments)}return g4e(t,e),h4e(t,[{key:"render",value:function(){return G.createElement(S4e,this.props)}}])}(G.Component);mE(pE,"displayName","ReferenceLine");mE(pE,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,fill:"none",stroke:"#ccc",fillOpacity:1,strokeWidth:1,position:"middle"});function cS(){return cS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cS.apply(this,arguments)}function ph(e){"@babel/helpers - typeof";return ph=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ph(e)}function QM(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function ZM(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?QM(Object(n),!0).forEach(function(r){B0(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):QM(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function N4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C4e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,a9(r.key),r)}}function A4e(e,t,n){return t&&C4e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function E4e(e,t,n){return t=Px(t),T4e(e,r9()?Reflect.construct(t,n||[],Px(e).constructor):t.apply(e,n))}function T4e(e,t){if(t&&(ph(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return P4e(e)}function P4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function r9(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(r9=function(){return!!e})()}function Px(e){return Px=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Px(e)}function O4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&uS(e,t)}function uS(e,t){return uS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},uS(e,t)}function B0(e,t,n){return t=a9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a9(e){var t=I4e(e,"string");return ph(t)=="symbol"?t:t+""}function I4e(e,t){if(ph(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(ph(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var R4e=function(t){var n=t.x,r=t.y,s=t.xAxis,i=t.yAxis,o=cE({x:s.scale,y:i.scale}),l=o.apply({x:n,y:r},{bandAware:!0});return Bi(t,"discard")&&!o.isInRange(l)?null:l},z0=function(e){function t(){return N4e(this,t),E4e(this,t,arguments)}return O4e(t,e),A4e(t,[{key:"render",value:function(){var r=this.props,s=r.x,i=r.y,o=r.r,l=r.alwaysShow,c=r.clipPathId,u=Sr(s),d=Sr(i);if(_o(l===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.'),!u||!d)return null;var h=R4e(this.props);if(!h)return null;var f=h.x,m=h.y,g=this.props,v=g.shape,y=g.className,x=Bi(this.props,"hidden")?"url(#".concat(c,")"):void 0,w=ZM(ZM({clipPath:x},fn(this.props,!0)),{},{cx:f,cy:m});return G.createElement(Ir,{className:on("recharts-reference-dot",y)},t.renderDot(v,w),sa.renderCallByParent(this.props,{x:f-o,y:m-o,width:2*o,height:2*o}))}}])}(G.Component);B0(z0,"displayName","ReferenceDot");B0(z0,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#fff",stroke:"#ccc",fillOpacity:1,strokeWidth:1});B0(z0,"renderDot",function(e,t){var n;return G.isValidElement(e)?n=G.cloneElement(e,t):qt(e)?n=e(t):n=G.createElement(Mq,cS({},t,{cx:t.cx,cy:t.cy,className:"recharts-reference-dot-dot"})),n});function dS(){return dS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},dS.apply(this,arguments)}function gh(e){"@babel/helpers - typeof";return gh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gh(e)}function eD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function tD(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?eD(Object(n),!0).forEach(function(r){W0(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eD(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function M4e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function D4e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,i9(r.key),r)}}function L4e(e,t,n){return t&&D4e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function $4e(e,t,n){return t=Ox(t),F4e(e,s9()?Reflect.construct(t,n||[],Ox(e).constructor):t.apply(e,n))}function F4e(e,t){if(t&&(gh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return U4e(e)}function U4e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function s9(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(s9=function(){return!!e})()}function Ox(e){return Ox=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Ox(e)}function B4e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&hS(e,t)}function hS(e,t){return hS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},hS(e,t)}function W0(e,t,n){return t=i9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i9(e){var t=z4e(e,"string");return gh(t)=="symbol"?t:t+""}function z4e(e,t){if(gh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(gh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var W4e=function(t,n,r,s,i){var o=i.x1,l=i.x2,c=i.y1,u=i.y2,d=i.xAxis,h=i.yAxis;if(!d||!h)return null;var f=cE({x:d.scale,y:h.scale}),m={x:t?f.x.apply(o,{position:"start"}):f.x.rangeMin,y:r?f.y.apply(c,{position:"start"}):f.y.rangeMin},g={x:n?f.x.apply(l,{position:"end"}):f.x.rangeMax,y:s?f.y.apply(u,{position:"end"}):f.y.rangeMax};return Bi(i,"discard")&&(!f.isInRange(m)||!f.isInRange(g))?null:Kq(m,g)},q0=function(e){function t(){return M4e(this,t),$4e(this,t,arguments)}return B4e(t,e),L4e(t,[{key:"render",value:function(){var r=this.props,s=r.x1,i=r.x2,o=r.y1,l=r.y2,c=r.className,u=r.alwaysShow,d=r.clipPathId;_o(u===void 0,'The alwaysShow prop is deprecated. Please use ifOverflow="extendDomain" instead.');var h=Sr(s),f=Sr(i),m=Sr(o),g=Sr(l),v=this.props.shape;if(!h&&!f&&!m&&!g&&!v)return null;var y=W4e(h,f,m,g,this.props);if(!y&&!v)return null;var x=Bi(this.props,"hidden")?"url(#".concat(d,")"):void 0;return G.createElement(Ir,{className:on("recharts-reference-area",c)},t.renderRect(v,tD(tD({clipPath:x},fn(this.props,!0)),y)),sa.renderCallByParent(this.props,y))}}])}(G.Component);W0(q0,"displayName","ReferenceArea");W0(q0,"defaultProps",{isFront:!1,ifOverflow:"discard",xAxisId:0,yAxisId:0,r:10,fill:"#ccc",fillOpacity:.5,stroke:"none",strokeWidth:1});W0(q0,"renderRect",function(e,t){var n;return G.isValidElement(e)?n=G.cloneElement(e,t):qt(e)?n=e(t):n=G.createElement(lE,dS({},t,{className:"recharts-reference-area-rect"})),n});function o9(e,t,n){if(t<1)return[];if(t===1&&n===void 0)return e;for(var r=[],s=0;s<e.length;s+=t)r.push(e[s]);return r}function q4e(e,t,n){var r={width:e.width+t.width,height:e.height+t.height};return $$e(r,n)}function H4e(e,t,n){var r=n==="width",s=e.x,i=e.y,o=e.width,l=e.height;return t===1?{start:r?s:i,end:r?s+o:i+l}:{start:r?s+o:i+l,end:r?s:i}}function Ix(e,t,n,r,s){if(e*t<e*r||e*t>e*s)return!1;var i=n();return e*(t-e*i/2-r)>=0&&e*(t+e*i/2-s)<=0}function K4e(e,t){return o9(e,t+1)}function V4e(e,t,n,r,s){for(var i=(r||[]).slice(),o=t.start,l=t.end,c=0,u=1,d=o,h=function(){var g=r==null?void 0:r[c];if(g===void 0)return{v:o9(r,u)};var v=c,y,x=function(){return y===void 0&&(y=n(g,v)),y},w=g.coordinate,b=c===0||Ix(e,w,x,d,l);b||(c=0,d=o,u+=1),b&&(d=w+e*(x()/2+s),c+=u)},f;u<=i.length;)if(f=h(),f)return f.v;return[]}function wp(e){"@babel/helpers - typeof";return wp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},wp(e)}function nD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function ra(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?nD(Object(n),!0).forEach(function(r){G4e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):nD(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function G4e(e,t,n){return t=Y4e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y4e(e){var t=X4e(e,"string");return wp(t)=="symbol"?t:t+""}function X4e(e,t){if(wp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(wp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function J4e(e,t,n,r,s){for(var i=(r||[]).slice(),o=i.length,l=t.start,c=t.end,u=function(f){var m=i[f],g,v=function(){return g===void 0&&(g=n(m,f)),g};if(f===o-1){var y=e*(m.coordinate+e*v()/2-c);i[f]=m=ra(ra({},m),{},{tickCoord:y>0?m.coordinate-y*e:m.coordinate})}else i[f]=m=ra(ra({},m),{},{tickCoord:m.coordinate});var x=Ix(e,m.tickCoord,v,l,c);x&&(c=m.tickCoord-e*(v()/2+s),i[f]=ra(ra({},m),{},{isShow:!0}))},d=o-1;d>=0;d--)u(d);return i}function Q4e(e,t,n,r,s,i){var o=(r||[]).slice(),l=o.length,c=t.start,u=t.end;if(i){var d=r[l-1],h=n(d,l-1),f=e*(d.coordinate+e*h/2-u);o[l-1]=d=ra(ra({},d),{},{tickCoord:f>0?d.coordinate-f*e:d.coordinate});var m=Ix(e,d.tickCoord,function(){return h},c,u);m&&(u=d.tickCoord-e*(h/2+s),o[l-1]=ra(ra({},d),{},{isShow:!0}))}for(var g=i?l-1:l,v=function(w){var b=o[w],_,k=function(){return _===void 0&&(_=n(b,w)),_};if(w===0){var j=e*(b.coordinate-e*k()/2-c);o[w]=b=ra(ra({},b),{},{tickCoord:j<0?b.coordinate-j*e:b.coordinate})}else o[w]=b=ra(ra({},b),{},{tickCoord:b.coordinate});var S=Ix(e,b.tickCoord,k,c,u);S&&(c=b.tickCoord+e*(k()/2+s),o[w]=ra(ra({},b),{},{isShow:!0}))},y=0;y<g;y++)v(y);return o}function gE(e,t,n){var r=e.tick,s=e.ticks,i=e.viewBox,o=e.minTickGap,l=e.orientation,c=e.interval,u=e.tickFormatter,d=e.unit,h=e.angle;if(!s||!s.length||!r)return[];if(tt(c)||Ol.isSsr)return K4e(s,typeof c=="number"&&tt(c)?c:0);var f=[],m=l==="top"||l==="bottom"?"width":"height",g=d&&m==="width"?Qf(d,{fontSize:t,letterSpacing:n}):{width:0,height:0},v=function(b,_){var k=qt(u)?u(b.value,_):b.value;return m==="width"?q4e(Qf(k,{fontSize:t,letterSpacing:n}),g,h):Qf(k,{fontSize:t,letterSpacing:n})[m]},y=s.length>=2?ri(s[1].coordinate-s[0].coordinate):1,x=H4e(i,y,m);return c==="equidistantPreserveStart"?V4e(y,x,v,s,o):(c==="preserveStart"||c==="preserveStartEnd"?f=Q4e(y,x,v,s,o,c==="preserveStartEnd"):f=J4e(y,x,v,s,o),f.filter(function(w){return w.isShow}))}var Z4e=["viewBox"],eFe=["viewBox"],tFe=["ticks"];function vh(e){"@babel/helpers - typeof";return vh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vh(e)}function ld(){return ld=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ld.apply(this,arguments)}function rD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function yr(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?rD(Object(n),!0).forEach(function(r){vE(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):rD(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Qj(e,t){if(e==null)return{};var n=nFe(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function nFe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function rFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function aD(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,c9(r.key),r)}}function aFe(e,t,n){return t&&aD(e.prototype,t),n&&aD(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function sFe(e,t,n){return t=Rx(t),iFe(e,l9()?Reflect.construct(t,n||[],Rx(e).constructor):t.apply(e,n))}function iFe(e,t){if(t&&(vh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return oFe(e)}function oFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l9(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(l9=function(){return!!e})()}function Rx(e){return Rx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Rx(e)}function lFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fS(e,t)}function fS(e,t){return fS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},fS(e,t)}function vE(e,t,n){return t=c9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c9(e){var t=cFe(e,"string");return vh(t)=="symbol"?t:t+""}function cFe(e,t){if(vh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(vh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Yh=function(e){function t(n){var r;return rFe(this,t),r=sFe(this,t,[n]),r.state={fontSize:"",letterSpacing:""},r}return lFe(t,e),aFe(t,[{key:"shouldComponentUpdate",value:function(r,s){var i=r.viewBox,o=Qj(r,Z4e),l=this.props,c=l.viewBox,u=Qj(l,eFe);return!kd(i,c)||!kd(o,u)||!kd(s,this.state)}},{key:"componentDidMount",value:function(){var r=this.layerReference;if(r){var s=r.getElementsByClassName("recharts-cartesian-axis-tick-value")[0];s&&this.setState({fontSize:window.getComputedStyle(s).fontSize,letterSpacing:window.getComputedStyle(s).letterSpacing})}}},{key:"getTickLineCoord",value:function(r){var s=this.props,i=s.x,o=s.y,l=s.width,c=s.height,u=s.orientation,d=s.tickSize,h=s.mirror,f=s.tickMargin,m,g,v,y,x,w,b=h?-1:1,_=r.tickSize||d,k=tt(r.tickCoord)?r.tickCoord:r.coordinate;switch(u){case"top":m=g=r.coordinate,y=o+ +!h*c,v=y-b*_,w=v-b*f,x=k;break;case"left":v=y=r.coordinate,g=i+ +!h*l,m=g-b*_,x=m-b*f,w=k;break;case"right":v=y=r.coordinate,g=i+ +h*l,m=g+b*_,x=m+b*f,w=k;break;default:m=g=r.coordinate,y=o+ +h*c,v=y+b*_,w=v+b*f,x=k;break}return{line:{x1:m,y1:v,x2:g,y2:y},tick:{x,y:w}}}},{key:"getTickTextAnchor",value:function(){var r=this.props,s=r.orientation,i=r.mirror,o;switch(s){case"left":o=i?"start":"end";break;case"right":o=i?"end":"start";break;default:o="middle";break}return o}},{key:"getTickVerticalAnchor",value:function(){var r=this.props,s=r.orientation,i=r.mirror,o="end";switch(s){case"left":case"right":o="middle";break;case"top":o=i?"start":"end";break;default:o=i?"end":"start";break}return o}},{key:"renderAxisLine",value:function(){var r=this.props,s=r.x,i=r.y,o=r.width,l=r.height,c=r.orientation,u=r.mirror,d=r.axisLine,h=yr(yr(yr({},fn(this.props,!1)),fn(d,!1)),{},{fill:"none"});if(c==="top"||c==="bottom"){var f=+(c==="top"&&!u||c==="bottom"&&u);h=yr(yr({},h),{},{x1:s,y1:i+f*l,x2:s+o,y2:i+f*l})}else{var m=+(c==="left"&&!u||c==="right"&&u);h=yr(yr({},h),{},{x1:s+m*o,y1:i,x2:s+m*o,y2:i+l})}return G.createElement("line",ld({},h,{className:on("recharts-cartesian-axis-line",Os(d,"className"))}))}},{key:"renderTicks",value:function(r,s,i){var o=this,l=this.props,c=l.tickLine,u=l.stroke,d=l.tick,h=l.tickFormatter,f=l.unit,m=gE(yr(yr({},this.props),{},{ticks:r}),s,i),g=this.getTickTextAnchor(),v=this.getTickVerticalAnchor(),y=fn(this.props,!1),x=fn(d,!1),w=yr(yr({},y),{},{fill:"none"},fn(c,!1)),b=m.map(function(_,k){var j=o.getTickLineCoord(_),S=j.line,T=j.tick,O=yr(yr(yr(yr({textAnchor:g,verticalAnchor:v},y),{},{stroke:"none",fill:u},x),T),{},{index:k,payload:_,visibleTicksCount:m.length,tickFormatter:h});return G.createElement(Ir,ld({className:"recharts-cartesian-axis-tick",key:"tick-".concat(_.value,"-").concat(_.coordinate,"-").concat(_.tickCoord)},zy(o.props,_,k)),c&&G.createElement("line",ld({},w,S,{className:on("recharts-cartesian-axis-tick-line",Os(c,"className"))})),d&&t.renderTickItem(d,O,"".concat(qt(h)?h(_.value,k):_.value).concat(f||"")))});return G.createElement("g",{className:"recharts-cartesian-axis-ticks"},b)}},{key:"render",value:function(){var r=this,s=this.props,i=s.axisLine,o=s.width,l=s.height,c=s.ticksGenerator,u=s.className,d=s.hide;if(d)return null;var h=this.props,f=h.ticks,m=Qj(h,tFe),g=f;return qt(c)&&(g=f&&f.length>0?c(this.props):c(m)),o<=0||l<=0||!g||!g.length?null:G.createElement(Ir,{className:on("recharts-cartesian-axis",u),ref:function(y){r.layerReference=y}},i&&this.renderAxisLine(),this.renderTicks(g,this.state.fontSize,this.state.letterSpacing),sa.renderCallByParent(this.props))}}],[{key:"renderTickItem",value:function(r,s,i){var o,l=on(s.className,"recharts-cartesian-axis-tick-value");return G.isValidElement(r)?o=G.cloneElement(r,yr(yr({},s),{},{className:l})):qt(r)?o=r(yr(yr({},s),{},{className:l})):o=G.createElement(nx,ld({},s,{className:"recharts-cartesian-axis-tick-value"}),i),o}}])}(p.Component);vE(Yh,"displayName","CartesianAxis");vE(Yh,"defaultProps",{x:0,y:0,width:0,height:0,viewBox:{x:0,y:0,width:0,height:0},orientation:"bottom",ticks:[],stroke:"#666",tickLine:!0,axisLine:!0,tick:!0,mirror:!1,minTickGap:5,tickSize:6,tickMargin:2,interval:"preserveEnd"});var uFe=["x1","y1","x2","y2","key"],dFe=["offset"];function iu(e){"@babel/helpers - typeof";return iu=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},iu(e)}function sD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function ia(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?sD(Object(n),!0).forEach(function(r){hFe(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sD(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function hFe(e,t,n){return t=fFe(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function fFe(e){var t=mFe(e,"string");return iu(t)=="symbol"?t:t+""}function mFe(e,t){if(iu(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(iu(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Ac(){return Ac=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Ac.apply(this,arguments)}function iD(e,t){if(e==null)return{};var n=pFe(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function pFe(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}var gFe=function(t){var n=t.fill;if(!n||n==="none")return null;var r=t.fillOpacity,s=t.x,i=t.y,o=t.width,l=t.height,c=t.ry;return G.createElement("rect",{x:s,y:i,ry:c,width:o,height:l,stroke:"none",fill:n,fillOpacity:r,className:"recharts-cartesian-grid-bg"})};function u9(e,t){var n;if(G.isValidElement(e))n=G.cloneElement(e,t);else if(qt(e))n=e(t);else{var r=t.x1,s=t.y1,i=t.x2,o=t.y2,l=t.key,c=iD(t,uFe),u=fn(c,!1);u.offset;var d=iD(u,dFe);n=G.createElement("line",Ac({},d,{x1:r,y1:s,x2:i,y2:o,fill:"none",key:l}))}return n}function vFe(e){var t=e.x,n=e.width,r=e.horizontal,s=r===void 0?!0:r,i=e.horizontalPoints;if(!s||!i||!i.length)return null;var o=i.map(function(l,c){var u=ia(ia({},e),{},{x1:t,y1:l,x2:t+n,y2:l,key:"line-".concat(c),index:c});return u9(s,u)});return G.createElement("g",{className:"recharts-cartesian-grid-horizontal"},o)}function yFe(e){var t=e.y,n=e.height,r=e.vertical,s=r===void 0?!0:r,i=e.verticalPoints;if(!s||!i||!i.length)return null;var o=i.map(function(l,c){var u=ia(ia({},e),{},{x1:l,y1:t,x2:l,y2:t+n,key:"line-".concat(c),index:c});return u9(s,u)});return G.createElement("g",{className:"recharts-cartesian-grid-vertical"},o)}function xFe(e){var t=e.horizontalFill,n=e.fillOpacity,r=e.x,s=e.y,i=e.width,o=e.height,l=e.horizontalPoints,c=e.horizontal,u=c===void 0?!0:c;if(!u||!t||!t.length)return null;var d=l.map(function(f){return Math.round(f+s-s)}).sort(function(f,m){return f-m});s!==d[0]&&d.unshift(0);var h=d.map(function(f,m){var g=!d[m+1],v=g?s+o-f:d[m+1]-f;if(v<=0)return null;var y=m%t.length;return G.createElement("rect",{key:"react-".concat(m),y:f,x:r,height:v,width:i,stroke:"none",fill:t[y],fillOpacity:n,className:"recharts-cartesian-grid-bg"})});return G.createElement("g",{className:"recharts-cartesian-gridstripes-horizontal"},h)}function bFe(e){var t=e.vertical,n=t===void 0?!0:t,r=e.verticalFill,s=e.fillOpacity,i=e.x,o=e.y,l=e.width,c=e.height,u=e.verticalPoints;if(!n||!r||!r.length)return null;var d=u.map(function(f){return Math.round(f+i-i)}).sort(function(f,m){return f-m});i!==d[0]&&d.unshift(0);var h=d.map(function(f,m){var g=!d[m+1],v=g?i+l-f:d[m+1]-f;if(v<=0)return null;var y=m%r.length;return G.createElement("rect",{key:"react-".concat(m),x:f,y:o,width:v,height:c,stroke:"none",fill:r[y],fillOpacity:s,className:"recharts-cartesian-grid-bg"})});return G.createElement("g",{className:"recharts-cartesian-gridstripes-vertical"},h)}var wFe=function(t,n){var r=t.xAxis,s=t.width,i=t.height,o=t.offset;return xq(gE(ia(ia(ia({},Yh.defaultProps),r),{},{ticks:vo(r,!0),viewBox:{x:0,y:0,width:s,height:i}})),o.left,o.left+o.width,n)},jFe=function(t,n){var r=t.yAxis,s=t.width,i=t.height,o=t.offset;return xq(gE(ia(ia(ia({},Yh.defaultProps),r),{},{ticks:vo(r,!0),viewBox:{x:0,y:0,width:s,height:i}})),o.top,o.top+o.height,n)},Fu={horizontal:!0,vertical:!0,horizontalPoints:[],verticalPoints:[],stroke:"#ccc",fill:"none",verticalFill:[],horizontalFill:[]};function mS(e){var t,n,r,s,i,o,l=hE(),c=fE(),u=c4e(),d=ia(ia({},e),{},{stroke:(t=e.stroke)!==null&&t!==void 0?t:Fu.stroke,fill:(n=e.fill)!==null&&n!==void 0?n:Fu.fill,horizontal:(r=e.horizontal)!==null&&r!==void 0?r:Fu.horizontal,horizontalFill:(s=e.horizontalFill)!==null&&s!==void 0?s:Fu.horizontalFill,vertical:(i=e.vertical)!==null&&i!==void 0?i:Fu.vertical,verticalFill:(o=e.verticalFill)!==null&&o!==void 0?o:Fu.verticalFill,x:tt(e.x)?e.x:u.left,y:tt(e.y)?e.y:u.top,width:tt(e.width)?e.width:u.width,height:tt(e.height)?e.height:u.height}),h=d.x,f=d.y,m=d.width,g=d.height,v=d.syncWithTicks,y=d.horizontalValues,x=d.verticalValues,w=i4e(),b=o4e();if(!tt(m)||m<=0||!tt(g)||g<=0||!tt(h)||h!==+h||!tt(f)||f!==+f)return null;var _=d.verticalCoordinatesGenerator||wFe,k=d.horizontalCoordinatesGenerator||jFe,j=d.horizontalPoints,S=d.verticalPoints;if((!j||!j.length)&&qt(k)){var T=y&&y.length,O=k({yAxis:b?ia(ia({},b),{},{ticks:T?y:b.ticks}):void 0,width:l,height:c,offset:u},T?!0:v);_o(Array.isArray(O),"horizontalCoordinatesGenerator should return Array but instead it returned [".concat(iu(O),"]")),Array.isArray(O)&&(j=O)}if((!S||!S.length)&&qt(_)){var A=x&&x.length,N=_({xAxis:w?ia(ia({},w),{},{ticks:A?x:w.ticks}):void 0,width:l,height:c,offset:u},A?!0:v);_o(Array.isArray(N),"verticalCoordinatesGenerator should return Array but instead it returned [".concat(iu(N),"]")),Array.isArray(N)&&(S=N)}return G.createElement("g",{className:"recharts-cartesian-grid"},G.createElement(gFe,{fill:d.fill,fillOpacity:d.fillOpacity,x:d.x,y:d.y,width:d.width,height:d.height,ry:d.ry}),G.createElement(vFe,Ac({},d,{offset:u,horizontalPoints:j,xAxis:w,yAxis:b})),G.createElement(yFe,Ac({},d,{offset:u,verticalPoints:S,xAxis:w,yAxis:b})),G.createElement(xFe,Ac({},d,{horizontalPoints:j})),G.createElement(bFe,Ac({},d,{verticalPoints:S})))}mS.displayName="CartesianGrid";function yh(e){"@babel/helpers - typeof";return yh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},yh(e)}function _Fe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function kFe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,f9(r.key),r)}}function SFe(e,t,n){return t&&kFe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function NFe(e,t,n){return t=Mx(t),CFe(e,d9()?Reflect.construct(t,n||[],Mx(e).constructor):t.apply(e,n))}function CFe(e,t){if(t&&(yh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return AFe(e)}function AFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d9(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(d9=function(){return!!e})()}function Mx(e){return Mx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Mx(e)}function EFe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&pS(e,t)}function pS(e,t){return pS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},pS(e,t)}function h9(e,t,n){return t=f9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f9(e){var t=TFe(e,"string");return yh(t)=="symbol"?t:t+""}function TFe(e,t){if(yh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(yh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function gS(){return gS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},gS.apply(this,arguments)}function PFe(e){var t=e.xAxisId,n=hE(),r=fE(),s=Zq(t);return s==null?null:p.createElement(Yh,gS({},s,{className:on("recharts-".concat(s.axisType," ").concat(s.axisType),s.className),viewBox:{x:0,y:0,width:n,height:r},ticksGenerator:function(o){return vo(o,!0)}}))}var pa=function(e){function t(){return _Fe(this,t),NFe(this,t,arguments)}return EFe(t,e),SFe(t,[{key:"render",value:function(){return p.createElement(PFe,this.props)}}])}(p.Component);h9(pa,"displayName","XAxis");h9(pa,"defaultProps",{allowDecimals:!0,hide:!1,orientation:"bottom",width:0,height:30,mirror:!1,xAxisId:0,tickCount:5,type:"category",padding:{left:0,right:0},allowDataOverflow:!1,scale:"auto",reversed:!1,allowDuplicatedCategory:!0});function xh(e){"@babel/helpers - typeof";return xh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xh(e)}function OFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function IFe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,g9(r.key),r)}}function RFe(e,t,n){return t&&IFe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function MFe(e,t,n){return t=Dx(t),DFe(e,m9()?Reflect.construct(t,n||[],Dx(e).constructor):t.apply(e,n))}function DFe(e,t){if(t&&(xh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return LFe(e)}function LFe(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m9(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(m9=function(){return!!e})()}function Dx(e){return Dx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Dx(e)}function $Fe(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&vS(e,t)}function vS(e,t){return vS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},vS(e,t)}function p9(e,t,n){return t=g9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g9(e){var t=FFe(e,"string");return xh(t)=="symbol"?t:t+""}function FFe(e,t){if(xh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(xh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function yS(){return yS=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},yS.apply(this,arguments)}var UFe=function(t){var n=t.yAxisId,r=hE(),s=fE(),i=e9(n);return i==null?null:p.createElement(Yh,yS({},i,{className:on("recharts-".concat(i.axisType," ").concat(i.axisType),i.className),viewBox:{x:0,y:0,width:r,height:s},ticksGenerator:function(l){return vo(l,!0)}}))},ga=function(e){function t(){return OFe(this,t),MFe(this,t,arguments)}return $Fe(t,e),RFe(t,[{key:"render",value:function(){return p.createElement(UFe,this.props)}}])}(p.Component);p9(ga,"displayName","YAxis");p9(ga,"defaultProps",{allowDuplicatedCategory:!0,allowDecimals:!0,hide:!1,orientation:"left",width:60,height:0,mirror:!1,yAxisId:0,tickCount:5,type:"number",padding:{top:0,bottom:0},allowDataOverflow:!1,scale:"auto",reversed:!1});function oD(e){return qFe(e)||WFe(e)||zFe(e)||BFe()}function BFe(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zFe(e,t){if(e){if(typeof e=="string")return xS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xS(e,t)}}function WFe(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function qFe(e){if(Array.isArray(e))return xS(e)}function xS(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var bS=function(t,n,r,s,i){var o=ci(t,pE),l=ci(t,z0),c=[].concat(oD(o),oD(l)),u=ci(t,q0),d="".concat(s,"Id"),h=s[0],f=n;if(c.length&&(f=c.reduce(function(v,y){if(y.props[d]===r&&Bi(y.props,"extendDomain")&&tt(y.props[h])){var x=y.props[h];return[Math.min(v[0],x),Math.max(v[1],x)]}return v},f)),u.length){var m="".concat(h,"1"),g="".concat(h,"2");f=u.reduce(function(v,y){if(y.props[d]===r&&Bi(y.props,"extendDomain")&&tt(y.props[m])&&tt(y.props[g])){var x=y.props[m],w=y.props[g];return[Math.min(v[0],x,w),Math.max(v[1],x,w)]}return v},f)}return i&&i.length&&(f=i.reduce(function(v,y){return tt(y)?[Math.min(v[0],y),Math.max(v[1],y)]:v},f)),f},v9={exports:{}};(function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(c,u,d){this.fn=c,this.context=u,this.once=d||!1}function i(c,u,d,h,f){if(typeof d!="function")throw new TypeError("The listener must be a function");var m=new s(d,h||c,f),g=n?n+u:u;return c._events[g]?c._events[g].fn?c._events[g]=[c._events[g],m]:c._events[g].push(m):(c._events[g]=m,c._eventsCount++),c}function o(c,u){--c._eventsCount===0?c._events=new r:delete c._events[u]}function l(){this._events=new r,this._eventsCount=0}l.prototype.eventNames=function(){var u=[],d,h;if(this._eventsCount===0)return u;for(h in d=this._events)t.call(d,h)&&u.push(n?h.slice(1):h);return Object.getOwnPropertySymbols?u.concat(Object.getOwnPropertySymbols(d)):u},l.prototype.listeners=function(u){var d=n?n+u:u,h=this._events[d];if(!h)return[];if(h.fn)return[h.fn];for(var f=0,m=h.length,g=new Array(m);f<m;f++)g[f]=h[f].fn;return g},l.prototype.listenerCount=function(u){var d=n?n+u:u,h=this._events[d];return h?h.fn?1:h.length:0},l.prototype.emit=function(u,d,h,f,m,g){var v=n?n+u:u;if(!this._events[v])return!1;var y=this._events[v],x=arguments.length,w,b;if(y.fn){switch(y.once&&this.removeListener(u,y.fn,void 0,!0),x){case 1:return y.fn.call(y.context),!0;case 2:return y.fn.call(y.context,d),!0;case 3:return y.fn.call(y.context,d,h),!0;case 4:return y.fn.call(y.context,d,h,f),!0;case 5:return y.fn.call(y.context,d,h,f,m),!0;case 6:return y.fn.call(y.context,d,h,f,m,g),!0}for(b=1,w=new Array(x-1);b<x;b++)w[b-1]=arguments[b];y.fn.apply(y.context,w)}else{var _=y.length,k;for(b=0;b<_;b++)switch(y[b].once&&this.removeListener(u,y[b].fn,void 0,!0),x){case 1:y[b].fn.call(y[b].context);break;case 2:y[b].fn.call(y[b].context,d);break;case 3:y[b].fn.call(y[b].context,d,h);break;case 4:y[b].fn.call(y[b].context,d,h,f);break;default:if(!w)for(k=1,w=new Array(x-1);k<x;k++)w[k-1]=arguments[k];y[b].fn.apply(y[b].context,w)}}return!0},l.prototype.on=function(u,d,h){return i(this,u,d,h,!1)},l.prototype.once=function(u,d,h){return i(this,u,d,h,!0)},l.prototype.removeListener=function(u,d,h,f){var m=n?n+u:u;if(!this._events[m])return this;if(!d)return o(this,m),this;var g=this._events[m];if(g.fn)g.fn===d&&(!f||g.once)&&(!h||g.context===h)&&o(this,m);else{for(var v=0,y=[],x=g.length;v<x;v++)(g[v].fn!==d||f&&!g[v].once||h&&g[v].context!==h)&&y.push(g[v]);y.length?this._events[m]=y.length===1?y[0]:y:o(this,m)}return this},l.prototype.removeAllListeners=function(u){var d;return u?(d=n?n+u:u,this._events[d]&&o(this,d)):(this._events=new r,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=n,l.EventEmitter=l,e.exports=l})(v9);var HFe=v9.exports;const KFe=bn(HFe);var Zj=new KFe,e_="recharts.syncMouseEvents";function jp(e){"@babel/helpers - typeof";return jp=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jp(e)}function VFe(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function GFe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,y9(r.key),r)}}function YFe(e,t,n){return t&&GFe(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function t_(e,t,n){return t=y9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y9(e){var t=XFe(e,"string");return jp(t)=="symbol"?t:t+""}function XFe(e,t){if(jp(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t);if(jp(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}var JFe=function(){function e(){VFe(this,e),t_(this,"activeIndex",0),t_(this,"coordinateList",[]),t_(this,"layout","horizontal")}return YFe(e,[{key:"setDetails",value:function(n){var r,s=n.coordinateList,i=s===void 0?null:s,o=n.container,l=o===void 0?null:o,c=n.layout,u=c===void 0?null:c,d=n.offset,h=d===void 0?null:d,f=n.mouseHandlerCallback,m=f===void 0?null:f;this.coordinateList=(r=i??this.coordinateList)!==null&&r!==void 0?r:[],this.container=l??this.container,this.layout=u??this.layout,this.offset=h??this.offset,this.mouseHandlerCallback=m??this.mouseHandlerCallback,this.activeIndex=Math.min(Math.max(this.activeIndex,0),this.coordinateList.length-1)}},{key:"focus",value:function(){this.spoofMouse()}},{key:"keyboardEvent",value:function(n){if(this.coordinateList.length!==0)switch(n.key){case"ArrowRight":{if(this.layout!=="horizontal")return;this.activeIndex=Math.min(this.activeIndex+1,this.coordinateList.length-1),this.spoofMouse();break}case"ArrowLeft":{if(this.layout!=="horizontal")return;this.activeIndex=Math.max(this.activeIndex-1,0),this.spoofMouse();break}}}},{key:"setIndex",value:function(n){this.activeIndex=n}},{key:"spoofMouse",value:function(){var n,r;if(this.layout==="horizontal"&&this.coordinateList.length!==0){var s=this.container.getBoundingClientRect(),i=s.x,o=s.y,l=s.height,c=this.coordinateList[this.activeIndex].coordinate,u=((n=window)===null||n===void 0?void 0:n.scrollX)||0,d=((r=window)===null||r===void 0?void 0:r.scrollY)||0,h=i+c+u,f=o+this.offset.top+l/2+d;this.mouseHandlerCallback({pageX:h,pageY:f})}}}])}();function QFe(e,t,n){if(n==="number"&&t===!0&&Array.isArray(e)){var r=e==null?void 0:e[0],s=e==null?void 0:e[1];if(r&&s&&tt(r)&&tt(s))return!0}return!1}function ZFe(e,t,n,r){var s=r/2;return{stroke:"none",fill:"#ccc",x:e==="horizontal"?t.x-s:n.left+.5,y:e==="horizontal"?n.top+.5:t.y-s,width:e==="horizontal"?r:n.width-1,height:e==="horizontal"?n.height-1:r}}function x9(e){var t=e.cx,n=e.cy,r=e.radius,s=e.startAngle,i=e.endAngle,o=Kr(t,n,r,s),l=Kr(t,n,r,i);return{points:[o,l],cx:t,cy:n,radius:r,startAngle:s,endAngle:i}}function e3e(e,t,n){var r,s,i,o;if(e==="horizontal")r=t.x,i=r,s=n.top,o=n.top+n.height;else if(e==="vertical")s=t.y,o=s,r=n.left,i=n.left+n.width;else if(t.cx!=null&&t.cy!=null)if(e==="centric"){var l=t.cx,c=t.cy,u=t.innerRadius,d=t.outerRadius,h=t.angle,f=Kr(l,c,u,h),m=Kr(l,c,d,h);r=f.x,s=f.y,i=m.x,o=m.y}else return x9(t);return[{x:r,y:s},{x:i,y:o}]}function _p(e){"@babel/helpers - typeof";return _p=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_p(e)}function lD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function mv(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?lD(Object(n),!0).forEach(function(r){t3e(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):lD(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function t3e(e,t,n){return t=n3e(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function n3e(e){var t=r3e(e,"string");return _p(t)=="symbol"?t:t+""}function r3e(e,t){if(_p(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(_p(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function a3e(e){var t,n,r=e.element,s=e.tooltipEventType,i=e.isActive,o=e.activeCoordinate,l=e.activePayload,c=e.offset,u=e.activeTooltipIndex,d=e.tooltipAxisBandSize,h=e.layout,f=e.chartName,m=(t=r.props.cursor)!==null&&t!==void 0?t:(n=r.type.defaultProps)===null||n===void 0?void 0:n.cursor;if(!r||!m||!i||!o||f!=="ScatterChart"&&s!=="axis")return null;var g,v=sM;if(f==="ScatterChart")g=o,v=vDe;else if(f==="BarChart")g=ZFe(h,o,c,d),v=lE;else if(h==="radial"){var y=x9(o),x=y.cx,w=y.cy,b=y.radius,_=y.startAngle,k=y.endAngle;g={cx:x,cy:w,startAngle:_,endAngle:k,innerRadius:b,outerRadius:b},v=kq}else g={points:e3e(h,o,c)},v=sM;var j=mv(mv(mv(mv({stroke:"#ccc",pointerEvents:"none"},c),g),fn(m,!1)),{},{payload:l,payloadIndex:u,className:on("recharts-tooltip-cursor",m.className)});return p.isValidElement(m)?p.cloneElement(m,j):p.createElement(v,j)}var s3e=["item"],i3e=["children","className","width","height","style","compact","title","desc"];function bh(e){"@babel/helpers - typeof";return bh=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bh(e)}function cd(){return cd=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},cd.apply(this,arguments)}function cD(e,t){return c3e(e)||l3e(e,t)||w9(e,t)||o3e()}function o3e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function l3e(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,o,l=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(c=(r=i.call(n)).done)&&(l.push(r.value),l.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}function c3e(e){if(Array.isArray(e))return e}function uD(e,t){if(e==null)return{};var n=u3e(e,t),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(s=0;s<i.length;s++)r=i[s],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function u3e(e,t){if(e==null)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}function d3e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function h3e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,j9(r.key),r)}}function f3e(e,t,n){return t&&h3e(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function m3e(e,t,n){return t=Lx(t),p3e(e,b9()?Reflect.construct(t,n||[],Lx(e).constructor):t.apply(e,n))}function p3e(e,t){if(t&&(bh(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return g3e(e)}function g3e(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b9(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(b9=function(){return!!e})()}function Lx(e){return Lx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(n){return n.__proto__||Object.getPrototypeOf(n)},Lx(e)}function v3e(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&wS(e,t)}function wS(e,t){return wS=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,s){return r.__proto__=s,r},wS(e,t)}function wh(e){return b3e(e)||x3e(e)||w9(e)||y3e()}function y3e(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function w9(e,t){if(e){if(typeof e=="string")return jS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return jS(e,t)}}function x3e(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function b3e(e){if(Array.isArray(e))return jS(e)}function jS(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dD(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function Pe(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?dD(Object(n),!0).forEach(function(r){Ct(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dD(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Ct(e,t,n){return t=j9(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function j9(e){var t=w3e(e,"string");return bh(t)=="symbol"?t:t+""}function w3e(e,t){if(bh(e)!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var r=n.call(e,t||"default");if(bh(r)!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var j3e={xAxis:["bottom","top"],yAxis:["left","right"]},_3e={width:"100%",height:"100%"},_9={x:0,y:0};function pv(e){return e}var k3e=function(t,n){return n==="horizontal"?t.x:n==="vertical"?t.y:n==="centric"?t.angle:t.radius},S3e=function(t,n,r,s){var i=n.find(function(d){return d&&d.index===r});if(i){if(t==="horizontal")return{x:i.coordinate,y:s.y};if(t==="vertical")return{x:s.x,y:i.coordinate};if(t==="centric"){var o=i.coordinate,l=s.radius;return Pe(Pe(Pe({},s),Kr(s.cx,s.cy,l,o)),{},{angle:o,radius:l})}var c=i.coordinate,u=s.angle;return Pe(Pe(Pe({},s),Kr(s.cx,s.cy,c,u)),{},{angle:u,radius:c})}return _9},H0=function(t,n){var r=n.graphicalItems,s=n.dataStartIndex,i=n.dataEndIndex,o=(r??[]).reduce(function(l,c){var u=c.props.data;return u&&u.length?[].concat(wh(l),wh(u)):l},[]);return o.length>0?o:t&&t.length&&tt(s)&&tt(i)?t.slice(s,i+1):[]};function k9(e){return e==="number"?[0,"auto"]:void 0}var _S=function(t,n,r,s){var i=t.graphicalItems,o=t.tooltipAxis,l=H0(n,t);return r<0||!i||!i.length||r>=l.length?null:i.reduce(function(c,u){var d,h=(d=u.props.data)!==null&&d!==void 0?d:n;h&&t.dataStartIndex+t.dataEndIndex!==0&&t.dataEndIndex-t.dataStartIndex>=r&&(h=h.slice(t.dataStartIndex,t.dataEndIndex+1));var f;if(o.dataKey&&!o.allowDuplicatedCategory){var m=h===void 0?l:h;f=tk(m,o.dataKey,s)}else f=h&&h[r]||l[r];return f?[].concat(wh(c),[wq(u,f)]):c},[])},hD=function(t,n,r,s){var i=s||{x:t.chartX,y:t.chartY},o=k3e(i,r),l=t.orderedTooltipTicks,c=t.tooltipAxis,u=t.tooltipTicks,d=ZOe(o,l,u,c);if(d>=0&&u){var h=u[d]&&u[d].value,f=_S(t,n,d,h),m=S3e(r,l,d,i);return{activeTooltipIndex:d,activeLabel:h,activePayload:f,activeCoordinate:m}}return null},N3e=function(t,n){var r=n.axes,s=n.graphicalItems,i=n.axisType,o=n.axisIdKey,l=n.stackGroups,c=n.dataStartIndex,u=n.dataEndIndex,d=t.layout,h=t.children,f=t.stackOffset,m=yq(d,i);return r.reduce(function(g,v){var y,x=v.type.defaultProps!==void 0?Pe(Pe({},v.type.defaultProps),v.props):v.props,w=x.type,b=x.dataKey,_=x.allowDataOverflow,k=x.allowDuplicatedCategory,j=x.scale,S=x.ticks,T=x.includeHidden,O=x[o];if(g[O])return g;var A=H0(t.data,{graphicalItems:s.filter(function(I){var P,U=o in I.props?I.props[o]:(P=I.type.defaultProps)===null||P===void 0?void 0:P[o];return U===O}),dataStartIndex:c,dataEndIndex:u}),N=A.length,L,M,B;QFe(x.domain,_,w)&&(L=zk(x.domain,null,_),m&&(w==="number"||j!=="auto")&&(B=em(A,b,"category")));var $=k9(w);if(!L||L.length===0){var z,R=(z=x.domain)!==null&&z!==void 0?z:$;if(b){if(L=em(A,b,w),w==="category"&&m){var C=Bbe(L);k&&C?(M=L,L=Sx(0,N)):k||(L=KR(R,L,v).reduce(function(I,P){return I.indexOf(P)>=0?I:[].concat(wh(I),[P])},[]))}else if(w==="category")k?L=L.filter(function(I){return I!==""&&!mn(I)}):L=KR(R,L,v).reduce(function(I,P){return I.indexOf(P)>=0||P===""||mn(P)?I:[].concat(wh(I),[P])},[]);else if(w==="number"){var D=aIe(A,s.filter(function(I){var P,U,Z=o in I.props?I.props[o]:(P=I.type.defaultProps)===null||P===void 0?void 0:P[o],X="hide"in I.props?I.props.hide:(U=I.type.defaultProps)===null||U===void 0?void 0:U.hide;return Z===O&&(T||!X)}),b,i,d);D&&(L=D)}m&&(w==="number"||j!=="auto")&&(B=em(A,b,"category"))}else m?L=Sx(0,N):l&&l[O]&&l[O].hasStack&&w==="number"?L=f==="expand"?[0,1]:bq(l[O].stackGroups,c,u):L=vq(A,s.filter(function(I){var P=o in I.props?I.props[o]:I.type.defaultProps[o],U="hide"in I.props?I.props.hide:I.type.defaultProps.hide;return P===O&&(T||!U)}),w,d,!0);if(w==="number")L=bS(h,L,O,i,S),R&&(L=zk(R,L,_));else if(w==="category"&&R){var E=R,F=L.every(function(I){return E.indexOf(I)>=0});F&&(L=E)}}return Pe(Pe({},g),{},Ct({},O,Pe(Pe({},x),{},{axisType:i,domain:L,categoricalDomain:B,duplicateDomain:M,originalDomain:(y=x.domain)!==null&&y!==void 0?y:$,isCategorical:m,layout:d})))},{})},C3e=function(t,n){var r=n.graphicalItems,s=n.Axis,i=n.axisType,o=n.axisIdKey,l=n.stackGroups,c=n.dataStartIndex,u=n.dataEndIndex,d=t.layout,h=t.children,f=H0(t.data,{graphicalItems:r,dataStartIndex:c,dataEndIndex:u}),m=f.length,g=yq(d,i),v=-1;return r.reduce(function(y,x){var w=x.type.defaultProps!==void 0?Pe(Pe({},x.type.defaultProps),x.props):x.props,b=w[o],_=k9("number");if(!y[b]){v++;var k;return g?k=Sx(0,m):l&&l[b]&&l[b].hasStack?(k=bq(l[b].stackGroups,c,u),k=bS(h,k,b,i)):(k=zk(_,vq(f,r.filter(function(j){var S,T,O=o in j.props?j.props[o]:(S=j.type.defaultProps)===null||S===void 0?void 0:S[o],A="hide"in j.props?j.props.hide:(T=j.type.defaultProps)===null||T===void 0?void 0:T.hide;return O===b&&!A}),"number",d),s.defaultProps.allowDataOverflow),k=bS(h,k,b,i)),Pe(Pe({},y),{},Ct({},b,Pe(Pe({axisType:i},s.defaultProps),{},{hide:!0,orientation:Os(j3e,"".concat(i,".").concat(v%2),null),domain:k,originalDomain:_,isCategorical:g,layout:d})))}return y},{})},A3e=function(t,n){var r=n.axisType,s=r===void 0?"xAxis":r,i=n.AxisComp,o=n.graphicalItems,l=n.stackGroups,c=n.dataStartIndex,u=n.dataEndIndex,d=t.children,h="".concat(s,"Id"),f=ci(d,i),m={};return f&&f.length?m=N3e(t,{axes:f,graphicalItems:o,axisType:s,axisIdKey:h,stackGroups:l,dataStartIndex:c,dataEndIndex:u}):o&&o.length&&(m=C3e(t,{Axis:i,graphicalItems:o,axisType:s,axisIdKey:h,stackGroups:l,dataStartIndex:c,dataEndIndex:u})),m},E3e=function(t){var n=hl(t),r=vo(n,!1,!0);return{tooltipTicks:r,orderedTooltipTicks:RA(r,function(s){return s.coordinate}),tooltipAxis:n,tooltipAxisBandSize:gx(n,r)}},fD=function(t){var n=t.children,r=t.defaultShowTooltip,s=rs(n,hh),i=0,o=0;return t.data&&t.data.length!==0&&(o=t.data.length-1),s&&s.props&&(s.props.startIndex>=0&&(i=s.props.startIndex),s.props.endIndex>=0&&(o=s.props.endIndex)),{chartX:0,chartY:0,dataStartIndex:i,dataEndIndex:o,activeTooltipIndex:-1,isTooltipActive:!!r}},T3e=function(t){return!t||!t.length?!1:t.some(function(n){var r=jo(n&&n.type);return r&&r.indexOf("Bar")>=0})},mD=function(t){return t==="horizontal"?{numericAxisName:"yAxis",cateAxisName:"xAxis"}:t==="vertical"?{numericAxisName:"xAxis",cateAxisName:"yAxis"}:t==="centric"?{numericAxisName:"radiusAxis",cateAxisName:"angleAxis"}:{numericAxisName:"angleAxis",cateAxisName:"radiusAxis"}},P3e=function(t,n){var r=t.props,s=t.graphicalItems,i=t.xAxisMap,o=i===void 0?{}:i,l=t.yAxisMap,c=l===void 0?{}:l,u=r.width,d=r.height,h=r.children,f=r.margin||{},m=rs(h,hh),g=rs(h,Ss),v=Object.keys(c).reduce(function(k,j){var S=c[j],T=S.orientation;return!S.mirror&&!S.hide?Pe(Pe({},k),{},Ct({},T,k[T]+S.width)):k},{left:f.left||0,right:f.right||0}),y=Object.keys(o).reduce(function(k,j){var S=o[j],T=S.orientation;return!S.mirror&&!S.hide?Pe(Pe({},k),{},Ct({},T,Os(k,"".concat(T))+S.height)):k},{top:f.top||0,bottom:f.bottom||0}),x=Pe(Pe({},y),v),w=x.bottom;m&&(x.bottom+=m.props.height||hh.defaultProps.height),g&&n&&(x=nIe(x,s,r,n));var b=u-x.left-x.right,_=d-x.top-x.bottom;return Pe(Pe({brushBottom:w},x),{},{width:Math.max(b,0),height:Math.max(_,0)})},O3e=function(t,n){if(n==="xAxis")return t[n].width;if(n==="yAxis")return t[n].height},I3e=function(t){var n=t.chartName,r=t.GraphicalChild,s=t.defaultTooltipEventType,i=s===void 0?"axis":s,o=t.validateTooltipEventTypes,l=o===void 0?["axis"]:o,c=t.axisComponents,u=t.legendContent,d=t.formatAxisMap,h=t.defaultProps,f=function(x,w){var b=w.graphicalItems,_=w.stackGroups,k=w.offset,j=w.updateId,S=w.dataStartIndex,T=w.dataEndIndex,O=x.barSize,A=x.layout,N=x.barGap,L=x.barCategoryGap,M=x.maxBarSize,B=mD(A),$=B.numericAxisName,z=B.cateAxisName,R=T3e(b),C=[];return b.forEach(function(D,E){var F=H0(x.data,{graphicalItems:[D],dataStartIndex:S,dataEndIndex:T}),I=D.type.defaultProps!==void 0?Pe(Pe({},D.type.defaultProps),D.props):D.props,P=I.dataKey,U=I.maxBarSize,Z=I["".concat($,"Id")],X=I["".concat(z,"Id")],K={},ie=c.reduce(function(rt,Je){var te=w["".concat(Je.axisType,"Map")],We=I["".concat(Je.axisType,"Id")];te&&te[We]||Je.axisType==="zAxis"||su();var Ue=te[We];return Pe(Pe({},rt),{},Ct(Ct({},Je.axisType,Ue),"".concat(Je.axisType,"Ticks"),vo(Ue)))},K),H=ie[z],he=ie["".concat(z,"Ticks")],me=_&&_[Z]&&_[Z].hasStack&&gIe(D,_[Z].stackGroups),ae=jo(D.type).indexOf("Bar")>=0,Ne=gx(H,he),de=[],Q=R&&eIe({barSize:O,stackGroups:_,totalSize:O3e(ie,z)});if(ae){var fe,Be,je=mn(U)?M:U,Ce=(fe=(Be=gx(H,he,!0))!==null&&Be!==void 0?Be:je)!==null&&fe!==void 0?fe:0;de=tIe({barGap:N,barCategoryGap:L,bandSize:Ce!==Ne?Ce:Ne,sizeList:Q[X],maxBarSize:je}),Ce!==Ne&&(de=de.map(function(rt){return Pe(Pe({},rt),{},{position:Pe(Pe({},rt.position),{},{offset:rt.position.offset-Ce/2})})}))}var Ze=D&&D.type&&D.type.getComposedData;Ze&&C.push({props:Pe(Pe({},Ze(Pe(Pe({},ie),{},{displayedData:F,props:x,dataKey:P,item:D,bandSize:Ne,barPosition:de,offset:k,stackedData:me,layout:A,dataStartIndex:S,dataEndIndex:T}))),{},Ct(Ct(Ct({key:D.key||"item-".concat(E)},$,ie[$]),z,ie[z]),"animationId",j)),childIndex:Zbe(D,x.children),item:D})}),C},m=function(x,w){var b=x.props,_=x.dataStartIndex,k=x.dataEndIndex,j=x.updateId;if(!UO({props:b}))return null;var S=b.children,T=b.layout,O=b.stackOffset,A=b.data,N=b.reverseStackOrder,L=mD(T),M=L.numericAxisName,B=L.cateAxisName,$=ci(S,r),z=fIe(A,$,"".concat(M,"Id"),"".concat(B,"Id"),O,N),R=c.reduce(function(I,P){var U="".concat(P.axisType,"Map");return Pe(Pe({},I),{},Ct({},U,A3e(b,Pe(Pe({},P),{},{graphicalItems:$,stackGroups:P.axisType===M&&z,dataStartIndex:_,dataEndIndex:k}))))},{}),C=P3e(Pe(Pe({},R),{},{props:b,graphicalItems:$}),w==null?void 0:w.legendBBox);Object.keys(R).forEach(function(I){R[I]=d(b,R[I],C,I.replace("Map",""),n)});var D=R["".concat(B,"Map")],E=E3e(D),F=f(b,Pe(Pe({},R),{},{dataStartIndex:_,dataEndIndex:k,updateId:j,graphicalItems:$,stackGroups:z,offset:C}));return Pe(Pe({formattedGraphicalItems:F,graphicalItems:$,offset:C,stackGroups:z},E),R)},g=function(y){function x(w){var b,_,k;return d3e(this,x),k=m3e(this,x,[w]),Ct(k,"eventEmitterSymbol",Symbol("rechartsEventEmitter")),Ct(k,"accessibilityManager",new JFe),Ct(k,"handleLegendBBoxUpdate",function(j){if(j){var S=k.state,T=S.dataStartIndex,O=S.dataEndIndex,A=S.updateId;k.setState(Pe({legendBBox:j},m({props:k.props,dataStartIndex:T,dataEndIndex:O,updateId:A},Pe(Pe({},k.state),{},{legendBBox:j}))))}}),Ct(k,"handleReceiveSyncEvent",function(j,S,T){if(k.props.syncId===j){if(T===k.eventEmitterSymbol&&typeof k.props.syncMethod!="function")return;k.applySyncEvent(S)}}),Ct(k,"handleBrushChange",function(j){var S=j.startIndex,T=j.endIndex;if(S!==k.state.dataStartIndex||T!==k.state.dataEndIndex){var O=k.state.updateId;k.setState(function(){return Pe({dataStartIndex:S,dataEndIndex:T},m({props:k.props,dataStartIndex:S,dataEndIndex:T,updateId:O},k.state))}),k.triggerSyncEvent({dataStartIndex:S,dataEndIndex:T})}}),Ct(k,"handleMouseEnter",function(j){var S=k.getMouseInfo(j);if(S){var T=Pe(Pe({},S),{},{isTooltipActive:!0});k.setState(T),k.triggerSyncEvent(T);var O=k.props.onMouseEnter;qt(O)&&O(T,j)}}),Ct(k,"triggeredAfterMouseMove",function(j){var S=k.getMouseInfo(j),T=S?Pe(Pe({},S),{},{isTooltipActive:!0}):{isTooltipActive:!1};k.setState(T),k.triggerSyncEvent(T);var O=k.props.onMouseMove;qt(O)&&O(T,j)}),Ct(k,"handleItemMouseEnter",function(j){k.setState(function(){return{isTooltipActive:!0,activeItem:j,activePayload:j.tooltipPayload,activeCoordinate:j.tooltipPosition||{x:j.cx,y:j.cy}}})}),Ct(k,"handleItemMouseLeave",function(){k.setState(function(){return{isTooltipActive:!1}})}),Ct(k,"handleMouseMove",function(j){j.persist(),k.throttleTriggeredAfterMouseMove(j)}),Ct(k,"handleMouseLeave",function(j){k.throttleTriggeredAfterMouseMove.cancel();var S={isTooltipActive:!1};k.setState(S),k.triggerSyncEvent(S);var T=k.props.onMouseLeave;qt(T)&&T(S,j)}),Ct(k,"handleOuterEvent",function(j){var S=Qbe(j),T=Os(k.props,"".concat(S));if(S&&qt(T)){var O,A;/.*touch.*/i.test(S)?A=k.getMouseInfo(j.changedTouches[0]):A=k.getMouseInfo(j),T((O=A)!==null&&O!==void 0?O:{},j)}}),Ct(k,"handleClick",function(j){var S=k.getMouseInfo(j);if(S){var T=Pe(Pe({},S),{},{isTooltipActive:!0});k.setState(T),k.triggerSyncEvent(T);var O=k.props.onClick;qt(O)&&O(T,j)}}),Ct(k,"handleMouseDown",function(j){var S=k.props.onMouseDown;if(qt(S)){var T=k.getMouseInfo(j);S(T,j)}}),Ct(k,"handleMouseUp",function(j){var S=k.props.onMouseUp;if(qt(S)){var T=k.getMouseInfo(j);S(T,j)}}),Ct(k,"handleTouchMove",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&k.throttleTriggeredAfterMouseMove(j.changedTouches[0])}),Ct(k,"handleTouchStart",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&k.handleMouseDown(j.changedTouches[0])}),Ct(k,"handleTouchEnd",function(j){j.changedTouches!=null&&j.changedTouches.length>0&&k.handleMouseUp(j.changedTouches[0])}),Ct(k,"handleDoubleClick",function(j){var S=k.props.onDoubleClick;if(qt(S)){var T=k.getMouseInfo(j);S(T,j)}}),Ct(k,"handleContextMenu",function(j){var S=k.props.onContextMenu;if(qt(S)){var T=k.getMouseInfo(j);S(T,j)}}),Ct(k,"triggerSyncEvent",function(j){k.props.syncId!==void 0&&Zj.emit(e_,k.props.syncId,j,k.eventEmitterSymbol)}),Ct(k,"applySyncEvent",function(j){var S=k.props,T=S.layout,O=S.syncMethod,A=k.state.updateId,N=j.dataStartIndex,L=j.dataEndIndex;if(j.dataStartIndex!==void 0||j.dataEndIndex!==void 0)k.setState(Pe({dataStartIndex:N,dataEndIndex:L},m({props:k.props,dataStartIndex:N,dataEndIndex:L,updateId:A},k.state)));else if(j.activeTooltipIndex!==void 0){var M=j.chartX,B=j.chartY,$=j.activeTooltipIndex,z=k.state,R=z.offset,C=z.tooltipTicks;if(!R)return;if(typeof O=="function")$=O(C,j);else if(O==="value"){$=-1;for(var D=0;D<C.length;D++)if(C[D].value===j.activeLabel){$=D;break}}var E=Pe(Pe({},R),{},{x:R.left,y:R.top}),F=Math.min(M,E.x+E.width),I=Math.min(B,E.y+E.height),P=C[$]&&C[$].value,U=_S(k.state,k.props.data,$),Z=C[$]?{x:T==="horizontal"?C[$].coordinate:F,y:T==="horizontal"?I:C[$].coordinate}:_9;k.setState(Pe(Pe({},j),{},{activeLabel:P,activeCoordinate:Z,activePayload:U,activeTooltipIndex:$}))}else k.setState(j)}),Ct(k,"renderCursor",function(j){var S,T=k.state,O=T.isTooltipActive,A=T.activeCoordinate,N=T.activePayload,L=T.offset,M=T.activeTooltipIndex,B=T.tooltipAxisBandSize,$=k.getTooltipEventType(),z=(S=j.props.active)!==null&&S!==void 0?S:O,R=k.props.layout,C=j.key||"_recharts-cursor";return G.createElement(a3e,{key:C,activeCoordinate:A,activePayload:N,activeTooltipIndex:M,chartName:n,element:j,isActive:z,layout:R,offset:L,tooltipAxisBandSize:B,tooltipEventType:$})}),Ct(k,"renderPolarAxis",function(j,S,T){var O=Os(j,"type.axisType"),A=Os(k.state,"".concat(O,"Map")),N=j.type.defaultProps,L=N!==void 0?Pe(Pe({},N),j.props):j.props,M=A&&A[L["".concat(O,"Id")]];return p.cloneElement(j,Pe(Pe({},M),{},{className:on(O,M.className),key:j.key||"".concat(S,"-").concat(T),ticks:vo(M,!0)}))}),Ct(k,"renderPolarGrid",function(j){var S=j.props,T=S.radialLines,O=S.polarAngles,A=S.polarRadius,N=k.state,L=N.radiusAxisMap,M=N.angleAxisMap,B=hl(L),$=hl(M),z=$.cx,R=$.cy,C=$.innerRadius,D=$.outerRadius;return p.cloneElement(j,{polarAngles:Array.isArray(O)?O:vo($,!0).map(function(E){return E.coordinate}),polarRadius:Array.isArray(A)?A:vo(B,!0).map(function(E){return E.coordinate}),cx:z,cy:R,innerRadius:C,outerRadius:D,key:j.key||"polar-grid",radialLines:T})}),Ct(k,"renderLegend",function(){var j=k.state.formattedGraphicalItems,S=k.props,T=S.children,O=S.width,A=S.height,N=k.props.margin||{},L=O-(N.left||0)-(N.right||0),M=pq({children:T,formattedGraphicalItems:j,legendWidth:L,legendContent:u});if(!M)return null;var B=M.item,$=uD(M,s3e);return p.cloneElement(B,Pe(Pe({},$),{},{chartWidth:O,chartHeight:A,margin:N,onBBoxUpdate:k.handleLegendBBoxUpdate}))}),Ct(k,"renderTooltip",function(){var j,S=k.props,T=S.children,O=S.accessibilityLayer,A=rs(T,or);if(!A)return null;var N=k.state,L=N.isTooltipActive,M=N.activeCoordinate,B=N.activePayload,$=N.activeLabel,z=N.offset,R=(j=A.props.active)!==null&&j!==void 0?j:L;return p.cloneElement(A,{viewBox:Pe(Pe({},z),{},{x:z.left,y:z.top}),active:R,label:$,payload:R?B:[],coordinate:M,accessibilityLayer:O})}),Ct(k,"renderBrush",function(j){var S=k.props,T=S.margin,O=S.data,A=k.state,N=A.offset,L=A.dataStartIndex,M=A.dataEndIndex,B=A.updateId;return p.cloneElement(j,{key:j.key||"_recharts-brush",onChange:uv(k.handleBrushChange,j.props.onChange),data:O,x:tt(j.props.x)?j.props.x:N.left,y:tt(j.props.y)?j.props.y:N.top+N.height+N.brushBottom-(T.bottom||0),width:tt(j.props.width)?j.props.width:N.width,startIndex:L,endIndex:M,updateId:"brush-".concat(B)})}),Ct(k,"renderReferenceElement",function(j,S,T){if(!j)return null;var O=k,A=O.clipPathId,N=k.state,L=N.xAxisMap,M=N.yAxisMap,B=N.offset,$=j.type.defaultProps||{},z=j.props,R=z.xAxisId,C=R===void 0?$.xAxisId:R,D=z.yAxisId,E=D===void 0?$.yAxisId:D;return p.cloneElement(j,{key:j.key||"".concat(S,"-").concat(T),xAxis:L[C],yAxis:M[E],viewBox:{x:B.left,y:B.top,width:B.width,height:B.height},clipPathId:A})}),Ct(k,"renderActivePoints",function(j){var S=j.item,T=j.activePoint,O=j.basePoint,A=j.childIndex,N=j.isRange,L=[],M=S.props.key,B=S.item.type.defaultProps!==void 0?Pe(Pe({},S.item.type.defaultProps),S.item.props):S.item.props,$=B.activeDot,z=B.dataKey,R=Pe(Pe({index:A,dataKey:z,cx:T.x,cy:T.y,r:4,fill:oE(S.item),strokeWidth:2,stroke:"#fff",payload:T.payload,value:T.value},fn($,!1)),By($));return L.push(x.renderActiveDot($,R,"".concat(M,"-activePoint-").concat(A))),O?L.push(x.renderActiveDot($,Pe(Pe({},R),{},{cx:O.x,cy:O.y}),"".concat(M,"-basePoint-").concat(A))):N&&L.push(null),L}),Ct(k,"renderGraphicChild",function(j,S,T){var O=k.filterFormatItem(j,S,T);if(!O)return null;var A=k.getTooltipEventType(),N=k.state,L=N.isTooltipActive,M=N.tooltipAxis,B=N.activeTooltipIndex,$=N.activeLabel,z=k.props.children,R=rs(z,or),C=O.props,D=C.points,E=C.isRange,F=C.baseLine,I=O.item.type.defaultProps!==void 0?Pe(Pe({},O.item.type.defaultProps),O.item.props):O.item.props,P=I.activeDot,U=I.hide,Z=I.activeBar,X=I.activeShape,K=!!(!U&&L&&R&&(P||Z||X)),ie={};A!=="axis"&&R&&R.props.trigger==="click"?ie={onClick:uv(k.handleItemMouseEnter,j.props.onClick)}:A!=="axis"&&(ie={onMouseLeave:uv(k.handleItemMouseLeave,j.props.onMouseLeave),onMouseEnter:uv(k.handleItemMouseEnter,j.props.onMouseEnter)});var H=p.cloneElement(j,Pe(Pe({},O.props),ie));function he(Je){return typeof M.dataKey=="function"?M.dataKey(Je.payload):null}if(K)if(B>=0){var me,ae;if(M.dataKey&&!M.allowDuplicatedCategory){var Ne=typeof M.dataKey=="function"?he:"payload.".concat(M.dataKey.toString());me=tk(D,Ne,$),ae=E&&F&&tk(F,Ne,$)}else me=D==null?void 0:D[B],ae=E&&F&&F[B];if(X||Z){var de=j.props.activeIndex!==void 0?j.props.activeIndex:B;return[p.cloneElement(j,Pe(Pe(Pe({},O.props),ie),{},{activeIndex:de})),null,null]}if(!mn(me))return[H].concat(wh(k.renderActivePoints({item:O,activePoint:me,basePoint:ae,childIndex:B,isRange:E})))}else{var Q,fe=(Q=k.getItemByXY(k.state.activeCoordinate))!==null&&Q!==void 0?Q:{graphicalItem:H},Be=fe.graphicalItem,je=Be.item,Ce=je===void 0?j:je,Ze=Be.childIndex,rt=Pe(Pe(Pe({},O.props),ie),{},{activeIndex:Ze});return[p.cloneElement(Ce,rt),null,null]}return E?[H,null,null]:[H,null]}),Ct(k,"renderCustomized",function(j,S,T){return p.cloneElement(j,Pe(Pe({key:"recharts-customized-".concat(T)},k.props),k.state))}),Ct(k,"renderMap",{CartesianGrid:{handler:pv,once:!0},ReferenceArea:{handler:k.renderReferenceElement},ReferenceLine:{handler:pv},ReferenceDot:{handler:k.renderReferenceElement},XAxis:{handler:pv},YAxis:{handler:pv},Brush:{handler:k.renderBrush,once:!0},Bar:{handler:k.renderGraphicChild},Line:{handler:k.renderGraphicChild},Area:{handler:k.renderGraphicChild},Radar:{handler:k.renderGraphicChild},RadialBar:{handler:k.renderGraphicChild},Scatter:{handler:k.renderGraphicChild},Pie:{handler:k.renderGraphicChild},Funnel:{handler:k.renderGraphicChild},Tooltip:{handler:k.renderCursor,once:!0},PolarGrid:{handler:k.renderPolarGrid,once:!0},PolarAngleAxis:{handler:k.renderPolarAxis},PolarRadiusAxis:{handler:k.renderPolarAxis},Customized:{handler:k.renderCustomized}}),k.clipPathId="".concat((b=w.id)!==null&&b!==void 0?b:x0("recharts"),"-clip"),k.throttleTriggeredAfterMouseMove=mW(k.triggeredAfterMouseMove,(_=w.throttleDelay)!==null&&_!==void 0?_:1e3/60),k.state={},k}return v3e(x,y),f3e(x,[{key:"componentDidMount",value:function(){var b,_;this.addListener(),this.accessibilityManager.setDetails({container:this.container,offset:{left:(b=this.props.margin.left)!==null&&b!==void 0?b:0,top:(_=this.props.margin.top)!==null&&_!==void 0?_:0},coordinateList:this.state.tooltipTicks,mouseHandlerCallback:this.triggeredAfterMouseMove,layout:this.props.layout}),this.displayDefaultTooltip()}},{key:"displayDefaultTooltip",value:function(){var b=this.props,_=b.children,k=b.data,j=b.height,S=b.layout,T=rs(_,or);if(T){var O=T.props.defaultIndex;if(!(typeof O!="number"||O<0||O>this.state.tooltipTicks.length-1)){var A=this.state.tooltipTicks[O]&&this.state.tooltipTicks[O].value,N=_S(this.state,k,O,A),L=this.state.tooltipTicks[O].coordinate,M=(this.state.offset.top+j)/2,B=S==="horizontal",$=B?{x:L,y:M}:{y:L,x:M},z=this.state.formattedGraphicalItems.find(function(C){var D=C.item;return D.type.name==="Scatter"});z&&($=Pe(Pe({},$),z.props.points[O].tooltipPosition),N=z.props.points[O].tooltipPayload);var R={activeTooltipIndex:O,isTooltipActive:!0,activeLabel:A,activePayload:N,activeCoordinate:$};this.setState(R),this.renderCursor(T),this.accessibilityManager.setIndex(O)}}}},{key:"getSnapshotBeforeUpdate",value:function(b,_){if(!this.props.accessibilityLayer)return null;if(this.state.tooltipTicks!==_.tooltipTicks&&this.accessibilityManager.setDetails({coordinateList:this.state.tooltipTicks}),this.props.layout!==b.layout&&this.accessibilityManager.setDetails({layout:this.props.layout}),this.props.margin!==b.margin){var k,j;this.accessibilityManager.setDetails({offset:{left:(k=this.props.margin.left)!==null&&k!==void 0?k:0,top:(j=this.props.margin.top)!==null&&j!==void 0?j:0}})}return null}},{key:"componentDidUpdate",value:function(b){rk([rs(b.children,or)],[rs(this.props.children,or)])||this.displayDefaultTooltip()}},{key:"componentWillUnmount",value:function(){this.removeListener(),this.throttleTriggeredAfterMouseMove.cancel()}},{key:"getTooltipEventType",value:function(){var b=rs(this.props.children,or);if(b&&typeof b.props.shared=="boolean"){var _=b.props.shared?"axis":"item";return l.indexOf(_)>=0?_:i}return i}},{key:"getMouseInfo",value:function(b){if(!this.container)return null;var _=this.container,k=_.getBoundingClientRect(),j=SEe(k),S={chartX:Math.round(b.pageX-j.left),chartY:Math.round(b.pageY-j.top)},T=k.width/_.offsetWidth||1,O=this.inRange(S.chartX,S.chartY,T);if(!O)return null;var A=this.state,N=A.xAxisMap,L=A.yAxisMap,M=this.getTooltipEventType(),B=hD(this.state,this.props.data,this.props.layout,O);if(M!=="axis"&&N&&L){var $=hl(N).scale,z=hl(L).scale,R=$&&$.invert?$.invert(S.chartX):null,C=z&&z.invert?z.invert(S.chartY):null;return Pe(Pe({},S),{},{xValue:R,yValue:C},B)}return B?Pe(Pe({},S),B):null}},{key:"inRange",value:function(b,_){var k=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,j=this.props.layout,S=b/k,T=_/k;if(j==="horizontal"||j==="vertical"){var O=this.state.offset,A=S>=O.left&&S<=O.left+O.width&&T>=O.top&&T<=O.top+O.height;return A?{x:S,y:T}:null}var N=this.state,L=N.angleAxisMap,M=N.radiusAxisMap;if(L&&M){var B=hl(L);return YR({x:S,y:T},B)}return null}},{key:"parseEventsOfWrapper",value:function(){var b=this.props.children,_=this.getTooltipEventType(),k=rs(b,or),j={};k&&_==="axis"&&(k.props.trigger==="click"?j={onClick:this.handleClick}:j={onMouseEnter:this.handleMouseEnter,onDoubleClick:this.handleDoubleClick,onMouseMove:this.handleMouseMove,onMouseLeave:this.handleMouseLeave,onTouchMove:this.handleTouchMove,onTouchStart:this.handleTouchStart,onTouchEnd:this.handleTouchEnd,onContextMenu:this.handleContextMenu});var S=By(this.props,this.handleOuterEvent);return Pe(Pe({},S),j)}},{key:"addListener",value:function(){Zj.on(e_,this.handleReceiveSyncEvent)}},{key:"removeListener",value:function(){Zj.removeListener(e_,this.handleReceiveSyncEvent)}},{key:"filterFormatItem",value:function(b,_,k){for(var j=this.state.formattedGraphicalItems,S=0,T=j.length;S<T;S++){var O=j[S];if(O.item===b||O.props.key===b.key||_===jo(O.item.type)&&k===O.childIndex)return O}return null}},{key:"renderClipPath",value:function(){var b=this.clipPathId,_=this.state.offset,k=_.left,j=_.top,S=_.height,T=_.width;return G.createElement("defs",null,G.createElement("clipPath",{id:b},G.createElement("rect",{x:k,y:j,height:S,width:T})))}},{key:"getXScales",value:function(){var b=this.state.xAxisMap;return b?Object.entries(b).reduce(function(_,k){var j=cD(k,2),S=j[0],T=j[1];return Pe(Pe({},_),{},Ct({},S,T.scale))},{}):null}},{key:"getYScales",value:function(){var b=this.state.yAxisMap;return b?Object.entries(b).reduce(function(_,k){var j=cD(k,2),S=j[0],T=j[1];return Pe(Pe({},_),{},Ct({},S,T.scale))},{}):null}},{key:"getXScaleByAxisId",value:function(b){var _;return(_=this.state.xAxisMap)===null||_===void 0||(_=_[b])===null||_===void 0?void 0:_.scale}},{key:"getYScaleByAxisId",value:function(b){var _;return(_=this.state.yAxisMap)===null||_===void 0||(_=_[b])===null||_===void 0?void 0:_.scale}},{key:"getItemByXY",value:function(b){var _=this.state,k=_.formattedGraphicalItems,j=_.activeItem;if(k&&k.length)for(var S=0,T=k.length;S<T;S++){var O=k[S],A=O.props,N=O.item,L=N.type.defaultProps!==void 0?Pe(Pe({},N.type.defaultProps),N.props):N.props,M=jo(N.type);if(M==="Bar"){var B=(A.data||[]).find(function(C){return oDe(b,C)});if(B)return{graphicalItem:O,payload:B}}else if(M==="RadialBar"){var $=(A.data||[]).find(function(C){return YR(b,C)});if($)return{graphicalItem:O,payload:$}}else if($0(O,j)||F0(O,j)||vp(O,j)){var z=uLe({graphicalItem:O,activeTooltipItem:j,itemData:L.data}),R=L.activeIndex===void 0?z:L.activeIndex;return{graphicalItem:Pe(Pe({},O),{},{childIndex:R}),payload:vp(O,j)?L.data[z]:O.props.data[z]}}}return null}},{key:"render",value:function(){var b=this;if(!UO(this))return null;var _=this.props,k=_.children,j=_.className,S=_.width,T=_.height,O=_.style,A=_.compact,N=_.title,L=_.desc,M=uD(_,i3e),B=fn(M,!1);if(A)return G.createElement(GM,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},G.createElement(sk,cd({},B,{width:S,height:T,title:N,desc:L}),this.renderClipPath(),zO(k,this.renderMap)));if(this.props.accessibilityLayer){var $,z;B.tabIndex=($=this.props.tabIndex)!==null&&$!==void 0?$:0,B.role=(z=this.props.role)!==null&&z!==void 0?z:"application",B.onKeyDown=function(C){b.accessibilityManager.keyboardEvent(C)},B.onFocus=function(){b.accessibilityManager.focus()}}var R=this.parseEventsOfWrapper();return G.createElement(GM,{state:this.state,width:this.props.width,height:this.props.height,clipPathId:this.clipPathId},G.createElement("div",cd({className:on("recharts-wrapper",j),style:Pe({position:"relative",cursor:"default",width:S,height:T},O)},R,{ref:function(D){b.container=D}}),G.createElement(sk,cd({},B,{width:S,height:T,title:N,desc:L,style:_3e}),this.renderClipPath(),zO(k,this.renderMap)),this.renderLegend(),this.renderTooltip()))}}])}(p.Component);Ct(g,"displayName",n),Ct(g,"defaultProps",Pe({layout:"horizontal",stackOffset:"none",barCategoryGap:"10%",barGap:4,margin:{top:5,right:5,bottom:5,left:5},reverseStackOrder:!1,syncMethod:"index"},h)),Ct(g,"getDerivedStateFromProps",function(y,x){var w=y.dataKey,b=y.data,_=y.children,k=y.width,j=y.height,S=y.layout,T=y.stackOffset,O=y.margin,A=x.dataStartIndex,N=x.dataEndIndex;if(x.updateId===void 0){var L=fD(y);return Pe(Pe(Pe({},L),{},{updateId:0},m(Pe(Pe({props:y},L),{},{updateId:0}),x)),{},{prevDataKey:w,prevData:b,prevWidth:k,prevHeight:j,prevLayout:S,prevStackOffset:T,prevMargin:O,prevChildren:_})}if(w!==x.prevDataKey||b!==x.prevData||k!==x.prevWidth||j!==x.prevHeight||S!==x.prevLayout||T!==x.prevStackOffset||!kd(O,x.prevMargin)){var M=fD(y),B={chartX:x.chartX,chartY:x.chartY,isTooltipActive:x.isTooltipActive},$=Pe(Pe({},hD(x,b,S)),{},{updateId:x.updateId+1}),z=Pe(Pe(Pe({},M),B),$);return Pe(Pe(Pe({},z),m(Pe({props:y},z),x)),{},{prevDataKey:w,prevData:b,prevWidth:k,prevHeight:j,prevLayout:S,prevStackOffset:T,prevMargin:O,prevChildren:_})}if(!rk(_,x.prevChildren)){var R,C,D,E,F=rs(_,hh),I=F&&(R=(C=F.props)===null||C===void 0?void 0:C.startIndex)!==null&&R!==void 0?R:A,P=F&&(D=(E=F.props)===null||E===void 0?void 0:E.endIndex)!==null&&D!==void 0?D:N,U=I!==A||P!==N,Z=!mn(b),X=Z&&!U?x.updateId:x.updateId+1;return Pe(Pe({updateId:X},m(Pe(Pe({props:y},x),{},{updateId:X,dataStartIndex:I,dataEndIndex:P}),x)),{},{prevChildren:_,dataStartIndex:I,dataEndIndex:P})}return null}),Ct(g,"renderActiveDot",function(y,x,w){var b;return p.isValidElement(y)?b=p.cloneElement(y,x):qt(y)?b=y(x):b=G.createElement(Mq,x),G.createElement(Ir,{className:"recharts-active-dot",key:w},b)});var v=p.forwardRef(function(x,w){return G.createElement(g,cd({},x,{ref:w}))});return v.displayName=g.displayName,v},bs=I3e({chartName:"BarChart",GraphicalChild:Gn,defaultTooltipEventType:"axis",validateTooltipEventTypes:["axis","item"],axisComponents:[{axisType:"xAxis",AxisComp:pa},{axisType:"yAxis",AxisComp:ga}],formatAxisMap:M$e});const R3e=[{name:"Resolved by Human",value:15},{name:"Resolved by AI",value:85}],Fr=["#60a5fa","#2563eb","#1d4ed8","#10b981","#f59e0b","#ef4444"],Pn=({label:e,description:t})=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{children:e}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:t})})]})]});function M3e(){p.useMemo(()=>Fr.slice(0,R3e.length),[]),Nr();const[e,t]=p.useState(""),[n,r]=p.useState(""),[s,i]=p.useState([]),[o,l]=p.useState(0),[c,u]=p.useState(0),[d,h]=p.useState({total:0,ai:0,rate:0,handover:0,handover_rate:0}),[f,m]=p.useState("all"),[g,v]=p.useState([]),[y,x]=p.useState([]),[w,b]=p.useState(!1),[_,k]=p.useState([]),[j,S]=p.useState([]),[T,O]=p.useState([]),[A,N]=p.useState({input:0,output:0,total:0}),[L,M]=p.useState([]),[B,$]=p.useState([]),[z,R]=p.useState([]),[C,D]=p.useState("all"),[E,F]=p.useState([]),[I,P]=p.useState(null),[U,Z]=p.useState(null),[X,K]=p.useState([]),[ie,H]=p.useState(null),[he,me]=p.useState(void 0),[ae,Ne]=p.useState(!1),de=te=>{if(!te||te.trim().length===0)return"(unspecified)";if(te.startsWith("other:"))return te.replace(/^other:/,"Other: ");switch(te){case"ambiguous":return"Ambiguous intent";case"payment":return"Payment-related";case"policy":return"Policy/compliance";default:return te}},Q=()=>{const te=new Date,We=n?new Date(n):te,Ue=e?new Date(e):new Date(te.getTime()-29*24*60*60*1e3),ue=new Date(Date.UTC(Ue.getUTCFullYear(),Ue.getUTCMonth(),Ue.getUTCDate(),0,0,0)),xe=new Date(Date.UTC(We.getUTCFullYear(),We.getUTCMonth(),We.getUTCDate()+1,0,0,0));return{start:ue.toISOString(),end:xe.toISOString()}},fe=async()=>{const{start:te,end:We}=Q(),{data:Ue}=await kt.rpc("get_channel_chat_counts",{p_from:te,p_to:We});i((Ue||[]).map(nt=>({provider:nt.provider,display_name:nt.display_name,thread_count:Number(nt.thread_count||0)})));const{data:ue}=await kt.rpc("get_response_time_stats",{p_from:te,p_to:We,p_channel:f!=="all"?f:null});if(ue&&ue.length>0){const nt=ue[0];l(Number(nt.ai_avg||0)),u(Number(nt.agent_avg||0))}const{data:xe,error:ce}=await kt.rpc("get_containment_and_handover",{p_from:te,p_to:We});if(!ce&&xe&&xe.length>0){const nt=xe[0];h({total:Number(nt.total_threads||0),ai:Number(nt.ai_resolved_count||0),rate:Number(nt.containment_rate||0),handover:Number(nt.handover_count||0),handover_rate:Number(nt.handover_rate||0)})}else if(ce&&ce.code==="PGRST202"){const{data:nt}=await kt.rpc("get_containment",{p_from:te,p_to:We});let vt=0,xt=0,wt=0,ht=0,_t=0;if(nt&&nt.length>0){const Oe=nt[0];vt=Number(Oe.total_threads||0),xt=Number(Oe.ai_resolved_count||0),wt=Number(Oe.rate||0)}const{data:Wt}=await kt.rpc("get_handover_stats",{p_from:te,p_to:We}),pe=(Wt||[]).reduce((Oe,W)=>Oe+Number(W.count||0),0);ht=pe,_t=vt>0?pe/vt:0,h({total:vt,ai:xt,rate:wt,handover:ht,handover_rate:_t})}const{data:qe}=await kt.rpc("get_chats_timeseries",{p_from:te,p_to:We,p_channel:f!=="all"?f:null});v((qe||[]).map(nt=>({bucket:nt.bucket,provider:nt.provider,count:Number(nt.count||0)})));const{data:Se}=await kt.rpc("get_handover_stats",{p_from:te,p_to:We});x((Se||[]).map(nt=>({reason:de(nt.reason)||"(unspecified)",count:Number(nt.count||0),total:Number(nt.total||0),rate:Number(nt.rate||0)})));try{const{data:nt}=await le.from("token_usage_logs").select("made_at, prompt_tokens, completion_tokens, total_tokens, model, channel_id").gte("made_at",te).lt("made_at",We).order("made_at",{ascending:!0}),vt={},xt={};let wt=0,ht=0,_t=0;for(const Oe of nt||[]){const W=new Date(Oe.made_at).toISOString().slice(0,10),q=Number(Oe.prompt_tokens||0),Y=Number(Oe.completion_tokens||0),ne=Number(Oe.total_tokens||q+Y);vt[W]||(vt[W]={input:0,output:0,total:0}),vt[W].input+=q,vt[W].output+=Y,vt[W].total+=ne;const _e=String(Oe.model||"unknown");xt[_e]=(xt[_e]||0)+ne,wt+=q,ht+=Y,_t+=ne}const Wt=Object.keys(vt).sort().map(Oe=>({day:Oe,...vt[Oe]})),pe=Object.entries(xt).sort((Oe,W)=>W[1]-Oe[1]).slice(0,8).map(([Oe,W])=>({model:Oe,tokens:W}));S(Wt),O(pe),N({input:wt,output:ht,total:_t})}catch{}try{const{data:nt}=await kt.rpc("get_handover_by_super_agent",{p_from:te,p_to:We});M((nt||[]).map(ht=>({super_agent_id:ht.super_agent_id,super_agent_name:ht.super_agent_name,human_resolved:Number(ht.human_resolved||0),ai_resolved:Number(ht.ai_resolved||0),handover_rate:Number(ht.handover_rate||0)})));const vt=C!=="all"?C:null,[{data:xt},{data:wt}]=await Promise.all([kt.rpc("get_handover_by_agent",{p_from:te,p_to:We,p_super_agent_id:vt}),kt.rpc("get_agent_kpis",{p_from:te,p_to:We,p_super_agent_id:vt})]);$((xt||[]).map(ht=>({agent_user_id:ht.agent_user_id,agent_name:ht.agent_name,super_agent_id:ht.super_agent_id,human_resolved:Number(ht.human_resolved||0),ai_resolved:Number(ht.ai_resolved||0),handover_rate:Number(ht.handover_rate||0)}))),R((wt||[]).map(ht=>({agent_user_id:ht.agent_user_id,agent_name:ht.agent_name,resolved_count:Number(ht.resolved_count||0),avg_resolution_minutes:ht.avg_resolution_minutes!=null?Number(ht.avg_resolution_minutes):null})))}catch{}},Be=async()=>{try{const{data:te,error:We}=await kt.rpc("get_database_stats_detailed");if(We){console.error("Error fetching database stats:",We);return}te&&(console.log("Database stats fetched:",te.length,"tables"),F(te.map(Se=>({tablename:Se.tablename,total_size_bytes:Number(Se.total_size_bytes||0),total_size_pretty:Se.total_size_pretty||"0 bytes",table_size_bytes:Number(Se.table_size_bytes||0),table_size_pretty:Se.table_size_pretty||"0 bytes",indexes_size_bytes:Number(Se.indexes_size_bytes||0),indexes_size_pretty:Se.indexes_size_pretty||"0 bytes",row_count:Number(Se.row_count||0),dead_rows:Number(Se.dead_rows||0),sequential_scans:Number(Se.sequential_scans||0),index_scans:Number(Se.index_scans||0),table_scan_ratio:Number(Se.table_scan_ratio||0),last_vacuum:Se.last_vacuum||null,last_autovacuum:Se.last_autovacuum||null,last_analyze:Se.last_analyze||null,last_autoanalyze:Se.last_autoanalyze||null,inserts:Number(Se.inserts||0),updates:Number(Se.updates||0),deletes:Number(Se.deletes||0),hot_updates:Number(Se.hot_updates||0)}))));const{data:Ue,error:ue}=await kt.rpc("get_database_overview");if(ue&&console.error("Error fetching database overview:",ue),Ue&&Ue.length>0){console.log("Database overview fetched:",Ue);const Se=Ue[0];P({total_size_bytes:Number(Se.total_size_bytes||0),total_size_pretty:Se.total_size_pretty||"0 bytes",data_size_bytes:Number(Se.data_size_bytes||0),data_size_pretty:Se.data_size_pretty||"0 bytes",indexes_size_bytes:Number(Se.indexes_size_bytes||0),indexes_size_pretty:Se.indexes_size_pretty||"0 bytes",total_tables:Number(Se.total_tables||0),total_rows:Number(Se.total_rows||0),total_indexes:Number(Se.total_indexes||0),total_sequences:Number(Se.total_sequences||0)})}const{data:xe}=await kt.rpc("get_database_memory_stats");if(xe&&xe.length>0){const Se=xe[0];Z({shared_buffers_hit:Number(Se.shared_buffers_hit||0),shared_buffers_read:Number(Se.shared_buffers_read||0),shared_buffers_hit_ratio:Number(Se.shared_buffers_hit_ratio||0),cache_hit_ratio:Number(Se.cache_hit_ratio||0),heap_hit_ratio:Number(Se.heap_hit_ratio||0),idx_scan_ratio:Number(Se.idx_scan_ratio||0),total_sequential_scans:Number(Se.total_sequential_scans||0),total_index_scans:Number(Se.total_index_scans||0)})}const{data:ce}=await kt.rpc("get_index_stats");ce&&K(ce.map(Se=>({tablename:Se.tablename,indexname:Se.indexname,index_size_bytes:Number(Se.index_size_bytes||0),index_size_pretty:Se.index_size_pretty||"0 bytes",index_scans:Number(Se.index_scans||0),index_tup_reads:Number(Se.index_tup_reads||0),index_tup_fetches:Number(Se.index_tup_fetches||0),idx_blks_hit:Number(Se.idx_blks_hit||0),idx_blks_read:Number(Se.idx_blks_read||0)})));const{data:qe}=await kt.rpc("get_database_activity");if(qe&&qe.length>0){const Se=qe[0];H({total_inserts:Number(Se.total_inserts||0),total_updates:Number(Se.total_updates||0),total_deletes:Number(Se.total_deletes||0),total_sequential_scans:Number(Se.total_sequential_scans||0),total_index_scans:Number(Se.total_index_scans||0),total_blocks_hit:Number(Se.total_blocks_hit||0),total_blocks_read:Number(Se.total_blocks_read||0),cache_hit_percentage:Number(Se.cache_hit_percentage||0)})}}catch(te){console.error("Failed to fetch database stats:",te),F([]),P(null),Z(null),K([]),H(null)}},je=te=>te.toISOString().slice(0,10),Ce=te=>{if(!te)return"";const We=new Date(te);return Number.isNaN(We.getTime())?"":We.toLocaleDateString(void 0,{day:"numeric",month:"short",year:"numeric"})},Ze=p.useMemo(()=>e&&n?`${Ce(e)}  ${Ce(n)}`:e?`From ${Ce(e)}`:n?`Until ${Ce(n)}`:"Select date range",[e,n]);p.useEffect(()=>{me(te=>{const We=e?new Date(e):void 0,Ue=n?new Date(n):void 0;if(!We&&!Ue)return te&&void 0;const ue=te!=null&&te.from?te.from.getTime():void 0,xe=te!=null&&te.to?te.to.getTime():void 0,ce=We?We.getTime():void 0,qe=Ue?Ue.getTime():void 0;return ue===ce&&xe===qe?te:{from:We,to:Ue}})},[e,n]);const rt=te=>{if(me(te),!te){t(""),r("");return}const We=te.from?je(te.from):"",Ue=te.to?je(te.to):"";t(We),r(Ue),te.from&&te.to&&Ne(!1)},Je=()=>{me(void 0),t(""),r(""),Ne(!1)};return p.useEffect(()=>{if(ae)return;(()=>{fe(),Be()})()},[e,n,f,ae]),a.jsxs("div",{className:"p-6 space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h1",{className:"text-2xl font-semibold",children:"Analytics"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"High-level KPIs for conversations, AI agents, and human agents."})]}),a.jsxs("div",{className:"flex items-end gap-3 flex-wrap",children:[a.jsxs("div",{className:"flex flex-col",children:[a.jsx("span",{className:"text-xs text-muted-foreground mb-1",children:"Date Range"}),a.jsxs(Ii,{open:ae,onOpenChange:Ne,children:[a.jsx(Ri,{asChild:!0,children:a.jsxs(se,{variant:"outline",className:`justify-start text-left font-normal h-9 w-[220px] ${!e&&!n?"text-muted-foreground":""}`,children:[a.jsx(Hc,{className:"mr-2 h-4 w-4"}),Ze]})}),a.jsxs(ni,{className:"w-auto min-w-[520px] p-0",align:"start",children:[a.jsx(Mm,{mode:"range",numberOfMonths:2,selected:he,defaultMonth:(he==null?void 0:he.from)??new Date,onSelect:rt,disabled:te=>te>new Date,initialFocus:!0}),a.jsxs("div",{className:"flex items-center justify-between border-t px-3 py-2",children:[a.jsx(se,{variant:"ghost",size:"sm",onClick:Je,children:"Clear"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(se,{variant:"outline",size:"sm",onClick:()=>Ne(!1),disabled:!(he!=null&&he.from)&&!(he!=null&&he.to),children:"Done"})})]})]})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-xs text-muted-foreground mb-1",children:"Channel"}),a.jsxs(tn,{value:f,onValueChange:async te=>{m(te);try{await en({action:"analytics.channel_filter",resource:"analytics",context:{channel:te}})}catch{}},children:[a.jsx(Jt,{className:"h-9 w-[180px]",children:a.jsx(Gt,{placeholder:"All"})}),a.jsxs(Qt,{children:[a.jsx(st,{value:"all",children:"All"}),a.jsx(st,{value:"whatsapp",children:"WhatsApp"}),a.jsx(st,{value:"web",children:"Web"}),a.jsx(st,{value:"telegram",children:"Telegram"})]})]})]}),a.jsx(se,{variant:"outline",className:"h-9",onClick:()=>{fe(),Be()},children:"Refresh"})]}),a.jsxs(Gc,{defaultValue:"conversation",className:"w-full mt-4",children:[a.jsxs(Fl,{className:"grid w-full max-w-2xl grid-cols-5 bg-muted/50 p-1",children:[a.jsx(_r,{value:"conversation",className:"data-[state=active]:bg-white data-[state=active]:text-black data-[state=inactive]:text-muted-foreground data-[state=inactive]:bg-transparent data-[state=inactive]:hover:bg-muted/30",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("span",{children:"Conversation"})}),a.jsx(ge,{children:a.jsx("p",{children:"Lihat analitik percakapan dan KPI"})})]})}),a.jsx(_r,{value:"ai-agent",className:"data-[state=active]:bg-white data-[state=active]:text-black data-[state=inactive]:text-muted-foreground data-[state=inactive]:bg-transparent data-[state=inactive]:hover:bg-muted/30",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("span",{children:"AI Agent"})}),a.jsx(ge,{children:a.jsx("p",{children:"Lihat metrik kinerja agen AI"})})]})}),a.jsx(_r,{value:"human-agent",className:"data-[state=active]:bg-white data-[state=active]:text-black data-[state=inactive]:text-muted-foreground data-[state=inactive]:bg-transparent data-[state=inactive]:hover:bg-muted/30",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("span",{children:"Human Agent"})}),a.jsx(ge,{children:a.jsx("p",{children:"Lihat metrik kinerja agen manusia"})})]})}),a.jsx(_r,{value:"database",className:"data-[state=active]:bg-white data-[state=active]:text-black data-[state=inactive]:text-muted-foreground data-[state=inactive]:bg-transparent data-[state=inactive]:hover:bg-muted/30",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("span",{children:"Database"})}),a.jsx(ge,{children:a.jsx("p",{children:"Lihat statistik penggunaan database dan ukuran tabel"})})]})})]}),a.jsxs(ir,{value:"conversation",className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Total Chats",description:"Jumlah total percakapan yang terjadi dalam periode yang dipilih"})})}),a.jsx(lt,{children:a.jsx("div",{className:"text-2xl font-semibold",children:d.total})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"AI Containment Rate",description:"Persentase percakapan yang berhasil diselesaikan oleh AI tanpa perlu intervensi manusia. Semakin tinggi semakin baik."})})}),a.jsxs(lt,{children:[a.jsxs("div",{className:"text-2xl font-semibold",children:[Math.round(d.rate*100),"%"]}),a.jsxs("div",{className:"text-sm text-muted-foreground",children:[d.ai," / ",d.total]}),a.jsx(se,{variant:"outline",className:"mt-2 h-8",onClick:async()=>{b(!0);const{start:te,end:We}=Q(),{data:Ue}=await kt.rpc("get_non_contained",{p_from:te,p_to:We,p_limit:100,p_offset:0});k(Ue||[])},children:"View non-contained"})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Handover Rate",description:"Persentase percakapan yang dialihkan dari AI ke agen manusia karena memerlukan intervensi manual"})})}),a.jsxs(lt,{children:[a.jsxs("div",{className:"text-2xl font-semibold",children:[Math.round(d.handover_rate*100),"%"]}),a.jsxs("div",{className:"text-sm text-muted-foreground",children:[d.handover," / ",d.total]})]})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Chats per Channel",description:"Distribusi jumlah percakapan berdasarkan saluran komunikasi (WhatsApp, Telegram, Web Chat, dll)"})})}),a.jsx(lt,{className:"h-64",children:a.jsx(xs,{width:"100%",height:"100%",children:a.jsxs(bs,{data:s.map(te=>({name:te.display_name||te.provider,count:te.thread_count})),children:[a.jsx(pa,{dataKey:"name"}),a.jsx(ga,{}),a.jsx(or,{}),a.jsx(Gn,{dataKey:"count",fill:Fr[2],radius:[4,4,0,0],children:a.jsx(ai,{dataKey:"count",position:"top"})})]})})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Chats Time Series (Asia/Jakarta)",description:"Grafik tren jumlah percakapan dari waktu ke waktu dalam zona waktu Asia/Jakarta, dikelompokkan berdasarkan saluran"})})}),a.jsx(lt,{className:"h-64",children:a.jsx(xs,{width:"100%",height:"100%",children:(()=>{const te=Array.from(new Set(g.map(ue=>ue.provider))),Ue=Array.from(new Set(g.map(ue=>ue.bucket))).sort().map(ue=>{var ce;const xe={bucket:new Date(ue).toLocaleDateString("en-US",{timeZone:"Asia/Jakarta"})};for(const qe of te)xe[qe]=((ce=g.find(Se=>Se.bucket===ue&&Se.provider===qe))==null?void 0:ce.count)||0;return xe});return a.jsxs(bs,{data:Ue,children:[a.jsx(pa,{dataKey:"bucket"}),a.jsx(ga,{}),a.jsx(or,{}),a.jsx(Ss,{}),te.map((ue,xe)=>a.jsx(Gn,{dataKey:ue,stackId:void 0,fill:Fr[xe%(Fr.length-1)+1]},ue))]})})()})})]})]}),a.jsxs(ir,{value:"ai-agent",className:"space-y-6",children:[a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"AI Token Usage (by day)",description:"Penggunaan token AI per hari, menunjukkan token input (prompt) dan output (completion). Token adalah unit penggunaan untuk menghitung biaya AI"})})}),a.jsxs(lt,{className:"h-64",children:[a.jsx(xs,{width:"100%",height:"100%",children:a.jsxs(bs,{data:j.map(te=>({day:new Date(te.day).toLocaleDateString("en-US",{timeZone:"Asia/Jakarta"}),input:te.input,output:te.output})),children:[a.jsx(pa,{dataKey:"day"}),a.jsx(ga,{}),a.jsx(or,{}),a.jsx(Ss,{}),a.jsx(Gn,{dataKey:"input",stackId:"tokens",fill:Fr[1],name:"Prompt tokens"}),a.jsx(Gn,{dataKey:"output",stackId:"tokens",fill:Fr[2],name:"Completion tokens"})]})}),a.jsxs("div",{className:"text-xs text-muted-foreground mt-2",children:["Total tokens: ",A.total.toLocaleString()," (input ",A.input.toLocaleString(),", output ",A.output.toLocaleString(),")"]})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Top Models by Tokens",description:"Model AI yang paling banyak menggunakan token, diurutkan berdasarkan total penggunaan. Membantu mengidentifikasi model mana yang paling banyak digunakan"})})}),a.jsx(lt,{className:"h-64",children:a.jsx(xs,{width:"100%",height:"100%",children:a.jsxs(bs,{data:T.map(te=>({name:te.model,tokens:te.tokens})),layout:"vertical",children:[a.jsx(pa,{type:"number"}),a.jsx(ga,{type:"category",dataKey:"name",width:160}),a.jsx(or,{}),a.jsx(Gn,{dataKey:"tokens",fill:Fr[4],radius:[0,4,4,0],children:a.jsx(ai,{dataKey:"tokens",position:"right"})})]})})})]})]}),a.jsxs(ir,{value:"human-agent",className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:"Super Agent"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Filter untuk melihat metrik agen yang berada di bawah super agent tertentu. Pilih 'All' untuk melihat semua agen"})})]})]}),a.jsxs(tn,{value:C,onValueChange:te=>D(te),children:[a.jsx(Jt,{className:"w-[220px] h-9",children:a.jsx(Gt,{placeholder:"All"})}),a.jsxs(Qt,{children:[a.jsx(st,{value:"all",children:"All"}),L.map(te=>a.jsx(st,{value:String(te.super_agent_id||"none"),children:te.super_agent_name||""},te.super_agent_id||"none"))]})]}),a.jsx(se,{variant:"outline",className:"h-9",onClick:fe,children:"Apply"})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Agent KPIs",description:"Key Performance Indicators untuk setiap agen manusia: jumlah percakapan yang diselesaikan dan waktu rata-rata penyelesaian (dalam menit)"})})}),a.jsx(lt,{className:"h-64",children:a.jsx(xs,{width:"100%",height:"100%",children:a.jsxs(bs,{data:z.map(te=>({name:te.agent_name||"",resolved:te.resolved_count,avgMin:Math.round(te.avg_resolution_minutes||0)})),children:[a.jsx(pa,{dataKey:"name"}),a.jsx(ga,{}),a.jsx(or,{}),a.jsx(Ss,{}),a.jsx(Gn,{dataKey:"resolved",name:"Resolved",fill:Fr[3],radius:[4,4,0,0]}),a.jsx(Gn,{dataKey:"avgMin",name:"Avg Resolution (min)",fill:Fr[5],radius:[4,4,0,0]})]})})})]})]}),a.jsxs(ir,{value:"database",className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Total Database Size",description:"Total ukuran database termasuk semua tabel, indeks, dan metadata dalam format yang mudah dibaca"})})}),a.jsxs(lt,{children:[a.jsx("div",{className:"text-2xl font-semibold",children:(I==null?void 0:I.total_size_pretty)||"Loading..."}),a.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Data: ",(I==null?void 0:I.data_size_pretty)||""," | Indexes: ",(I==null?void 0:I.indexes_size_pretty)||""]})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Total Tables",description:"Jumlah total tabel yang ada di database public schema"})})}),a.jsx(lt,{children:a.jsx("div",{className:"text-2xl font-semibold",children:(I==null?void 0:I.total_tables)||0})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Total Rows",description:"Jumlah total baris data di semua tabel database"})})}),a.jsx(lt,{children:a.jsx("div",{className:"text-2xl font-semibold",children:((I==null?void 0:I.total_rows)||0).toLocaleString()})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Total Indexes",description:"Jumlah total indeks yang ada di database. Indeks membantu mempercepat query"})})}),a.jsx(lt,{children:a.jsx("div",{className:"text-2xl font-semibold",children:(I==null?void 0:I.total_indexes)||0})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Cache Hit Ratio",description:"Persentase data yang ditemukan di cache memory. Semakin tinggi semakin baik (idealnya >95%). Menunjukkan efisiensi penggunaan memory"})})}),a.jsxs(lt,{children:[a.jsx("div",{className:"text-2xl font-semibold",children:U?`${(U.cache_hit_ratio*100).toFixed(2)}%`:"Loading..."}),a.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Hits: ",U?U.shared_buffers_hit.toLocaleString():""," | Reads: ",U?U.shared_buffers_read.toLocaleString():""]})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Index Scan Ratio",description:"Persentase scan yang menggunakan indeks dibanding sequential scan. Semakin tinggi semakin baik. Menunjukkan efektivitas indeks"})})}),a.jsxs(lt,{children:[a.jsx("div",{className:"text-2xl font-semibold",children:U?`${(U.idx_scan_ratio*100).toFixed(2)}%`:"Loading..."}),a.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Index: ",U?U.total_index_scans.toLocaleString():""," | Seq: ",U?U.total_sequential_scans.toLocaleString():""]})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Heap Hit Ratio",description:"Persentase hit pada heap (tabel data) di cache memory. Semakin tinggi semakin baik"})})}),a.jsx(lt,{children:a.jsx("div",{className:"text-2xl font-semibold",children:U?`${(U.heap_hit_ratio*100).toFixed(2)}%`:"Loading..."})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Total Inserts",description:"Jumlah total operasi INSERT yang pernah dilakukan di semua tabel"})})}),a.jsx(lt,{children:a.jsx("div",{className:"text-2xl font-semibold",children:((ie==null?void 0:ie.total_inserts)||0).toLocaleString()})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Total Updates",description:"Jumlah total operasi UPDATE yang pernah dilakukan di semua tabel"})})}),a.jsx(lt,{children:a.jsx("div",{className:"text-2xl font-semibold",children:((ie==null?void 0:ie.total_updates)||0).toLocaleString()})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Total Deletes",description:"Jumlah total operasi DELETE yang pernah dilakukan di semua tabel"})})}),a.jsx(lt,{children:a.jsx("div",{className:"text-2xl font-semibold",children:((ie==null?void 0:ie.total_deletes)||0).toLocaleString()})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Cache Hit %",description:"Persentase blok yang ditemukan di cache vs yang dibaca dari disk. Semakin tinggi semakin baik untuk performa"})})}),a.jsxs(lt,{children:[a.jsx("div",{className:"text-2xl font-semibold",children:ie?`${ie.cache_hit_percentage.toFixed(2)}%`:"Loading..."}),a.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Hits: ",ie?ie.total_blocks_hit.toLocaleString():""," | Reads: ",ie?ie.total_blocks_read.toLocaleString():""]})]})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Table Sizes",description:"Ukuran total (termasuk indeks) untuk setiap tabel diurutkan dari yang terbesar. Membantu mengidentifikasi tabel yang memakan banyak ruang"})})}),a.jsx(lt,{className:"h-64",children:E.length===0?a.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No data available"}):a.jsx(xs,{width:"100%",height:"100%",children:a.jsxs(bs,{data:E.slice(0,10).map(te=>({name:te.tablename,size:te.total_size_bytes/1024})),layout:"vertical",children:[a.jsx(pa,{type:"number"}),a.jsx(ga,{type:"category",dataKey:"name",width:160}),a.jsx(or,{formatter:te=>`${te.toFixed(2)} KB`,labelFormatter:te=>`Table: ${te}`}),a.jsx(Gn,{dataKey:"size",fill:Fr[1],radius:[0,4,4,0],children:a.jsx(ai,{dataKey:"size",position:"right",formatter:te=>`${te.toFixed(2)} KB`})})]})})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Row Counts by Table",description:"Jumlah baris data per tabel, diurutkan dari yang terbanyak. Menunjukkan tabel mana yang paling aktif menyimpan data"})})}),a.jsx(lt,{className:"h-64",children:E.filter(te=>te.row_count>0).length===0?a.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No data available"}):a.jsx(xs,{width:"100%",height:"100%",children:a.jsxs(bs,{data:E.filter(te=>te.row_count>0).slice(0,10).map(te=>({name:te.tablename,rows:te.row_count})),layout:"vertical",children:[a.jsx(pa,{type:"number"}),a.jsx(ga,{type:"category",dataKey:"name",width:160}),a.jsx(or,{}),a.jsx(Gn,{dataKey:"rows",fill:Fr[3],radius:[0,4,4,0],children:a.jsx(ai,{dataKey:"rows",position:"right"})})]})})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Index Sizes (Top 15)",description:"Ukuran setiap indeks diurutkan dari yang terbesar. Indeks besar mungkin perlu dioptimasi"})})}),a.jsx(lt,{className:"h-64",children:X.length===0?a.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No data available"}):a.jsx(xs,{width:"100%",height:"100%",children:a.jsxs(bs,{data:X.slice(0,15).map(te=>({name:`${te.tablename}.${te.indexname}`.substring(0,30),size:te.index_size_bytes/1024,scans:te.index_scans})),layout:"vertical",children:[a.jsx(pa,{type:"number"}),a.jsx(ga,{type:"category",dataKey:"name",width:200}),a.jsx(or,{formatter:(te,We)=>We==="size"?`${te.toFixed(2)} KB`:te.toLocaleString(),labelFormatter:te=>`Index: ${te}`}),a.jsx(Ss,{}),a.jsx(Gn,{dataKey:"size",name:"Size (KB)",fill:Fr[1],radius:[0,4,4,0]})]})})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Table Activity (Top 10)",description:"Jumlah operasi INSERT, UPDATE, dan DELETE per tabel. Menunjukkan tabel mana yang paling aktif"})})}),a.jsx(lt,{className:"h-64",children:E.filter(te=>te.inserts+te.updates+te.deletes>0).length===0?a.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No data available"}):a.jsx(xs,{width:"100%",height:"100%",children:a.jsxs(bs,{data:E.filter(te=>te.inserts+te.updates+te.deletes>0).slice(0,10).map(te=>({name:te.tablename,inserts:te.inserts,updates:te.updates,deletes:te.deletes})),layout:"vertical",children:[a.jsx(pa,{type:"number"}),a.jsx(ga,{type:"category",dataKey:"name",width:160}),a.jsx(or,{}),a.jsx(Ss,{}),a.jsx(Gn,{dataKey:"inserts",stackId:"activity",fill:Fr[2],name:"Inserts"}),a.jsx(Gn,{dataKey:"updates",stackId:"activity",fill:Fr[4],name:"Updates"}),a.jsx(Gn,{dataKey:"deletes",stackId:"activity",fill:Fr[5],name:"Deletes"})]})})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Table Scan Ratios",description:"Rasio sequential scan vs index scan per tabel. Sequential scan tinggi menunjukkan perlu indeks yang lebih baik"})})}),a.jsx(lt,{className:"h-64",children:E.filter(te=>te.sequential_scans+te.index_scans>0).length===0?a.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"No data available"}):a.jsx(xs,{width:"100%",height:"100%",children:a.jsxs(bs,{data:E.filter(te=>te.sequential_scans+te.index_scans>0).slice(0,10).map(te=>({name:te.tablename,seqRatio:Number((te.table_scan_ratio*100).toFixed(1)),idxRatio:Number(((1-te.table_scan_ratio)*100).toFixed(1))})),layout:"vertical",children:[a.jsx(pa,{type:"number",domain:[0,100]}),a.jsx(ga,{type:"category",dataKey:"name",width:160}),a.jsx(or,{formatter:te=>`${te}%`}),a.jsx(Ss,{}),a.jsx(Gn,{dataKey:"seqRatio",stackId:"scan",fill:Fr[5],name:"Seq Scan %"}),a.jsx(Gn,{dataKey:"idxRatio",stackId:"scan",fill:Fr[3],name:"Index Scan %"})]})})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Comprehensive Table Statistics",description:"Rincian lengkap setiap tabel: ukuran, baris, statistik scan, operasi DML, dan informasi maintenance"})})}),a.jsx(lt,{children:a.jsx("div",{className:"max-h-96 overflow-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-2 px-2 sticky left-0 bg-background",children:"Table"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Total Size"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Rows"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Dead Rows"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Inserts"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Updates"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Deletes"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Seq Scans"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Idx Scans"}),a.jsx("th",{className:"text-left py-2 px-2",children:"Last Vacuum"})]})}),a.jsx("tbody",{children:E.slice(0,25).map(te=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-2 px-2 font-medium sticky left-0 bg-background",children:te.tablename}),a.jsx("td",{className:"py-2 px-2 text-right text-muted-foreground",children:te.total_size_pretty}),a.jsx("td",{className:"py-2 px-2 text-right",children:te.row_count.toLocaleString()}),a.jsx("td",{className:"py-2 px-2 text-right text-muted-foreground",children:te.dead_rows>0?a.jsx("span",{className:"text-orange-600",children:te.dead_rows.toLocaleString()}):"0"}),a.jsx("td",{className:"py-2 px-2 text-right text-muted-foreground",children:te.inserts.toLocaleString()}),a.jsx("td",{className:"py-2 px-2 text-right text-muted-foreground",children:te.updates.toLocaleString()}),a.jsx("td",{className:"py-2 px-2 text-right text-muted-foreground",children:te.deletes.toLocaleString()}),a.jsx("td",{className:"py-2 px-2 text-right text-muted-foreground",children:te.sequential_scans.toLocaleString()}),a.jsx("td",{className:"py-2 px-2 text-right text-muted-foreground",children:te.index_scans.toLocaleString()}),a.jsx("td",{className:"py-2 px-2 text-left text-xs text-muted-foreground",children:te.last_vacuum?new Date(te.last_vacuum).toLocaleDateString():te.last_autovacuum?`Auto: ${new Date(te.last_autovacuum).toLocaleDateString()}`:"Never"})]},te.tablename))})]})})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:a.jsx(Pn,{label:"Index Statistics",description:"Statistik lengkap setiap indeks: ukuran, jumlah scan, dan performa cache. Membantu mengidentifikasi indeks yang tidak digunakan atau perlu dioptimasi"})})}),a.jsx(lt,{children:a.jsx("div",{className:"max-h-96 overflow-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-2 px-2 sticky left-0 bg-background",children:"Table"}),a.jsx("th",{className:"text-left py-2 px-2",children:"Index"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Size"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Scans"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Tuples Read"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Tuples Fetched"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Cache Hits"}),a.jsx("th",{className:"text-right py-2 px-2",children:"Cache Reads"})]})}),a.jsx("tbody",{children:X.slice(0,30).map((te,We)=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-2 px-2 font-medium sticky left-0 bg-background",children:te.tablename}),a.jsx("td",{className:"py-2 px-2 font-mono text-xs",children:te.indexname}),a.jsx("td",{className:"py-2 px-2 text-right text-muted-foreground",children:te.index_size_pretty}),a.jsx("td",{className:"py-2 px-2 text-right",children:te.index_scans.toLocaleString()}),a.jsx("td",{className:"py-2 px-2 text-right text-muted-foreground",children:te.index_tup_reads.toLocaleString()}),a.jsx("td",{className:"py-2 px-2 text-right text-muted-foreground",children:te.index_tup_fetches.toLocaleString()}),a.jsx("td",{className:"py-2 px-2 text-right text-muted-foreground",children:te.idx_blks_hit.toLocaleString()}),a.jsx("td",{className:"py-2 px-2 text-right text-muted-foreground",children:te.idx_blks_read.toLocaleString()})]},We))})]})})})]})]})]}),a.jsx(xn,{open:w,onOpenChange:b,children:a.jsxs(un,{className:"max-w-3xl",children:[a.jsx(dn,{children:a.jsx(hn,{children:"Non-contained Conversations"})}),a.jsx("div",{className:"max-h-80 overflow-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"text-left py-2",children:"Time"}),a.jsx("th",{className:"text-left py-2",children:"Contact"}),a.jsx("th",{className:"text-left py-2",children:"Handover Reason"}),a.jsx("th",{className:"text-left py-2",children:"Status"})]})}),a.jsx("tbody",{children:_.map(te=>a.jsxs("tr",{children:[a.jsx("td",{className:"py-1",children:new Date(te.created_at).toLocaleString()}),a.jsx("td",{className:"py-1",children:te.contact_name}),a.jsx("td",{className:"py-1",children:te.handover_reason||"(none)"}),a.jsx("td",{className:"py-1",children:te.status})]},te.id))})]})})]})})]})}var K0="Switch",[D3e,NUe]=Mr(K0),[L3e,$3e]=D3e(K0),S9=p.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:u,form:d,...h}=e,[f,m]=p.useState(null),g=Ot(t,b=>m(b)),v=p.useRef(!1),y=f?d||!!f.closest("form"):!0,[x,w]=Ha({prop:s,defaultProp:i??!1,onChange:u,caller:K0});return a.jsxs(L3e,{scope:n,checked:x,disabled:l,children:[a.jsx(ot.button,{type:"button",role:"switch","aria-checked":x,"aria-required":o,"data-state":E9(x),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:g,onClick:Ve(e.onClick,b=>{w(_=>!_),y&&(v.current=b.isPropagationStopped(),v.current||b.stopPropagation())})}),y&&a.jsx(A9,{control:f,bubbles:!v.current,name:r,value:c,checked:x,required:o,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});S9.displayName=K0;var N9="SwitchThumb",C9=p.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,s=$3e(N9,n);return a.jsx(ot.span,{"data-state":E9(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:t})});C9.displayName=N9;var F3e="SwitchBubbleInput",A9=p.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const o=p.useRef(null),l=Ot(o,i),c=DC(n),u=$N(t);return p.useEffect(()=>{const d=o.current;if(!d)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==n&&m){const g=new Event("click",{bubbles:r});m.call(d,n),d.dispatchEvent(g)}},[c,n,r]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:l,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});A9.displayName=F3e;function E9(e){return e?"checked":"unchecked"}var T9=S9,U3e=C9;const Di=p.forwardRef(({className:e,...t},n)=>a.jsx(T9,{className:Ie("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:n,children:a.jsx(U3e,{className:Ie("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Di.displayName=T9.displayName;var V0="Collapsible",[B3e,P9]=Mr(V0),[z3e,yE]=B3e(V0),O9=p.forwardRef((e,t)=>{const{__scopeCollapsible:n,open:r,defaultOpen:s,disabled:i,onOpenChange:o,...l}=e,[c,u]=Ha({prop:r,defaultProp:s??!1,onChange:o,caller:V0});return a.jsx(z3e,{scope:n,disabled:i,contentId:pr(),open:c,onOpenToggle:p.useCallback(()=>u(d=>!d),[u]),children:a.jsx(ot.div,{"data-state":jE(c),"data-disabled":i?"":void 0,...l,ref:t})})});O9.displayName=V0;var I9="CollapsibleTrigger",xE=p.forwardRef((e,t)=>{const{__scopeCollapsible:n,...r}=e,s=yE(I9,n);return a.jsx(ot.button,{type:"button","aria-controls":s.contentId,"aria-expanded":s.open||!1,"data-state":jE(s.open),"data-disabled":s.disabled?"":void 0,disabled:s.disabled,...r,ref:t,onClick:Ve(e.onClick,s.onOpenToggle)})});xE.displayName=I9;var bE="CollapsibleContent",wE=p.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=yE(bE,e.__scopeCollapsible);return a.jsx(Cr,{present:n||s.open,children:({present:i})=>a.jsx(W3e,{...r,ref:t,present:i})})});wE.displayName=bE;var W3e=p.forwardRef((e,t)=>{const{__scopeCollapsible:n,present:r,children:s,...i}=e,o=yE(bE,n),[l,c]=p.useState(r),u=p.useRef(null),d=Ot(t,u),h=p.useRef(0),f=h.current,m=p.useRef(0),g=m.current,v=o.open||l,y=p.useRef(v),x=p.useRef(void 0);return p.useEffect(()=>{const w=requestAnimationFrame(()=>y.current=!1);return()=>cancelAnimationFrame(w)},[]),sr(()=>{const w=u.current;if(w){x.current=x.current||{transitionDuration:w.style.transitionDuration,animationName:w.style.animationName},w.style.transitionDuration="0s",w.style.animationName="none";const b=w.getBoundingClientRect();h.current=b.height,m.current=b.width,y.current||(w.style.transitionDuration=x.current.transitionDuration,w.style.animationName=x.current.animationName),c(r)}},[o.open,r]),a.jsx(ot.div,{"data-state":jE(o.open),"data-disabled":o.disabled?"":void 0,id:o.contentId,hidden:!v,...i,ref:d,style:{"--radix-collapsible-content-height":f?`${f}px`:void 0,"--radix-collapsible-content-width":g?`${g}px`:void 0,...e.style},children:v&&s})});function jE(e){return e?"open":"closed"}var R9=O9,q3e=xE,H3e=wE;const pD=R9,gD=xE,vD=wE,M9=e=>{const[t,n]=p.useState(!0),[r,s]=p.useState(!1),[i,o]=p.useState(null),[l,c]=p.useState(null),u=async()=>{try{if(n(!0),c(null),e){const{data:m,error:g}=await le.from("ai_profiles").select("*").eq("id",e).single();if(g)throw g;m&&o(m)}else o(null)}catch(m){console.error("Error fetching AI profile:",m),c(m instanceof Error?m.message:"Failed to fetch profile")}finally{n(!1)}},d=async m=>{try{if(s(!0),c(null),i!=null&&i.id){const{error:g}=await le.from("ai_profiles").update(m).eq("id",i.id);try{await en({action:"ai_profile.update",resource:"ai_profile",resourceId:i.id,context:m})}catch{}if(g)throw g}else{const{data:g,error:v}=await le.from("ai_profiles").insert([{...m,org_id:"00000000-0000-0000-0000-000000000001"}]).select().single();if(v)throw v;g&&o(g);try{await en({action:"ai_profile.create",resource:"ai_profile",resourceId:(g==null?void 0:g.id)??null,context:m})}catch{}}await u()}catch(g){console.error("Error saving AI profile:",g),c(g instanceof Error?g.message:"Failed to save profile")}finally{s(!1)}},h=async m=>{try{n(!0),c(null);const{data:g,error:v}=await le.from("ai_profiles").select("*").eq("org_id",m||"00000000-0000-0000-0000-000000000001").order("created_at",{ascending:!1});if(v)throw v;return g}catch(g){return console.error("Error fetching AI profiles:",g),c(g instanceof Error?g.message:"Failed to fetch profiles"),[]}finally{n(!1)}},f=async m=>{try{s(!0),c(null);const{error:g}=await le.from("ai_profiles").delete().eq("id",m);try{await en({action:"ai_profile.delete",resource:"ai_profile",resourceId:m})}catch{}if(g)throw g}catch(g){throw console.error("Error deleting AI profile:",g),c(g instanceof Error?g.message:"Failed to delete profile"),g}finally{s(!1)}};return p.useEffect(()=>{e?u():n(!1)},[e]),{profile:i,loading:t,saving:r,error:l,fetchProfile:u,saveProfile:d,fetchAllProfiles:h,deleteProfile:f}},K3e={Conservative:.3,Balanced:.5,Creative:.7};function D9(e,t=.5){if(!e)return t;const n=e.trim();return K3e[n]??t}const V3e="00000000-0000-0000-0000-000000000001",G3e=({welcomeMessage:e,systemPrompt:t,modelDisplay:n,profile:r,profileId:s,modelName:i,temperature:o,transfer_conditions:l})=>{const c=r==null?void 0:r.response_temperature,u=c?D9(c,o||.5):o||.5,[d,h]=p.useState([]);p.useEffect(()=>{h([{id:"1",content:e||(r==null?void 0:r.welcome_message)||"Halo!  Selamat datang! Ada yang bisa saya bantu hari ini?",sender:"ai",timestamp:new Date}])},[e]);const[f,m]=p.useState(""),[g,v]=p.useState(!1),[y,x]=p.useState(!0),[w,b]=p.useState(""),[_,k]=p.useState(null),[j,S]=p.useState(!1),T=p.useRef(null),O=p.useRef(null);p.useEffect(()=>{(()=>{const z=Date.now(),R=Math.random().toString(36).substring(2,15),C=`session_${z}_${R}`;b(C),console.log("Generated session ID:",C)})()},[]);const A=()=>{O.current&&(O.current.scrollTop=O.current.scrollHeight)};p.useEffect(()=>{A()},[d]);const N=async()=>{if(!f.trim()&&!_||g)return;let $=null;if(_){S(!0);try{$=await sA(_.file)}catch(R){console.error("File upload error:",R),ze.error(`Upload failed: ${R.message}`),S(!1);return}S(!1),k(null)}$&&(f.trim()||`${$.fileName}`);const z={id:Date.now().toString(),content:$?$.url:f,sender:"user",timestamp:new Date,type:($==null?void 0:$.type)||"text"};h(R=>[...R,z]),m(""),v(!0);try{const R={message:f.trim()||($?`[${$.type==="image"?"Image":"File"}: ${$.fileName}]`:""),model:i,temperature:u,session_id:w,timestamp:new Date().toISOString(),ai_profile_id:(r==null?void 0:r.id)||s,...$&&{type:$.type,file_name:$.fileName,mime_type:$.mimeType}};console.log("Sending request to API:",R);const C=await Ns(Nn.ENDPOINTS.AI_AGENT.CHAT_TEST,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)});if(!C.ok)throw new Error(`HTTP error! status: ${C.status}`);const D=await C.json();console.log("API Response:",D);const E={id:(Date.now()+1).toString(),content:D.output||"Sorry, I couldn't process your message.",sender:"ai",timestamp:new Date};h(F=>[...F,E]),ze.success("Message sent successfully!"),x(!0)}catch(R){console.error("Error sending message:",R),ze.error("Failed to send message"),x(!1);const C={id:(Date.now()+1).toString(),content:"Sorry, I'm having trouble connecting right now. Please try again later.",sender:"ai",timestamp:new Date};h(D=>[...D,C])}finally{v(!1)}},L=$=>{$.key==="Enter"&&!$.shiftKey&&($.preventDefault(),N())},M=()=>{h([{id:"1",content:e||(r==null?void 0:r.welcome_message)||"Halo!  Selamat datang! Ada yang bisa saya bantu hari ini?",sender:"ai",timestamp:new Date}]),k(null),ze.info("Chat history cleared")},B=()=>{const $=Date.now(),z=Math.random().toString(36).substring(2,15),R=`session_${$}_${z}`;b(R),h([{id:"1",content:e||(r==null?void 0:r.welcome_message)||"Halo!  Selamat datang! Ada yang bisa saya bantu hari ini?",sender:"ai",timestamp:new Date}]),ze.success("Session refreshed! New session ID: "+R),console.log("New session ID:",R)};return a.jsxs(He,{className:"flex flex-col h-[600px] border-2 border-primary/20",children:[a.jsxs("div",{className:"flex items-center gap-3 p-4 border-b bg-primary/5",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-muted flex items-center justify-center",children:a.jsx(A4,{className:"w-4 h-4"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("span",{className:"font-medium",children:"AI Agent Chat"}),a.jsxs("div",{className:"text-xs text-muted-foreground",children:["Model: ",n,"  Temp: ",c||"Legacy"," (",u,a.jsx("span",{className:`ml-2 px-1 rounded text-xs ${y?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:y?"Connected":"Disconnected"})]}),w&&a.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Session: ",w.substring(0,20),"..."]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[g&&a.jsx(Ht,{className:"w-4 h-4 animate-spin"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"ghost",size:"sm",onClick:B,"aria-label":"Refresh session",children:a.jsx(ab,{className:"w-4 h-4"})})}),a.jsx(ge,{children:a.jsx("p",{children:"Segarkan sesi"})})]}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"ghost",size:"sm",onClick:M,"aria-label":"Clear chat history",children:a.jsx($4,{className:"w-4 h-4"})})}),a.jsx(ge,{children:a.jsx("p",{children:"Hapus riwayat chat"})})]})]})]}),a.jsxs("div",{ref:O,className:"flex-1 p-4 space-y-4 overflow-auto max-h-[400px]",children:[d.map($=>a.jsx("div",{className:`flex ${$.sender==="user"?"justify-end":"justify-start"}`,children:a.jsxs("div",{className:`max-w-[80%] p-3 rounded-lg ${$.sender==="user"?"bg-primary text-primary-foreground":"bg-muted"}`,children:[$.type&&$.type!=="text"&&a.jsx("div",{className:"mb-2",children:a.jsx(lA,{fileLink:$.content,type:$.type})}),a.jsx("p",{className:"text-sm whitespace-pre-wrap",children:$.content}),a.jsx("p",{className:"text-xs opacity-70 mt-1",children:$.timestamp.toLocaleTimeString()})]})},$.id)),g&&a.jsx("div",{className:"flex justify-start",children:a.jsx("div",{className:"bg-muted p-3 rounded-lg",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ht,{className:"w-4 h-4 animate-spin"}),a.jsx("span",{className:"text-sm",children:"AI is typing..."})]})})}),a.jsx("div",{ref:T})]}),a.jsxs("div",{className:"p-4 border-t bg-muted/30",children:[_&&a.jsx("div",{className:"mb-2",children:a.jsx(oA,{stagedFile:_,onRemove:()=>k(null),isUploading:j})}),a.jsxs("div",{className:"flex gap-2 items-start",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("div",{children:a.jsx(iA,{onFileStaged:k,disabled:g||j||!!_,className:"mt-2"})})}),a.jsx(ge,{children:a.jsx("p",{children:"Lampirkan file"})})]}),a.jsx("textarea",{value:f,onChange:$=>m($.target.value),onKeyPress:L,placeholder:_?"Add a caption (optional)...":"Type your message...",className:"flex-1 p-3 border rounded-lg text-sm resize-none focus:ring-2 focus:ring-primary/20",rows:2,disabled:g||j,title:g?"Please wait":void 0}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{size:"sm",onClick:N,disabled:!f.trim()&&!_||g||j,className:"px-4 mt-2",children:a.jsx(bm,{className:"w-4 h-4"})})}),a.jsx(ge,{children:a.jsx("p",{children:"Kirim pesan ke agen AI"})})]})]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center",children:"Press Enter to send, Shift+Enter for new line"})]})]})},Uu=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"Unknown",gv=e=>e==null?"Pricing on request":`${new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:e>=1?2:3}).format(e)} / 1M`,Y3e=({agentName:e,onBack:t,profileId:n,initialModelId:r})=>{var gn,Jr,Et,$n,Dt;const[s,i]=p.useState("general"),[o,l]=p.useState("text"),[c,u]=p.useState({behavior:!0,welcome:!0,transfer:!1}),[d,h]=p.useState(!n),f=J=>{u(Ae=>({...Ae,[J]:!Ae[J]}))},m=!n,{hasPermission:g,hasRole:v}=Nr(),{user:y}=Ar(),x=v==null?void 0:v("master_agent"),w=v==null?void 0:v("super_agent"),b=g("ai_agent_files.manage")||g("ai_agent_files.create")||!!x||!!w,_=(J,Ae,Fe)=>Number.isNaN(J)?Ae:Math.min(Fe,Math.max(Ae,J)),k=50,j=100,S=40,T=1e3,O=25,A=24*60,{profile:N,loading:L,saving:M,error:B,saveProfile:$}=M9(n),[z,R]=p.useState((N==null?void 0:N.super_agent_id)??null),[C,D]=p.useState([]),[E,F]=p.useState(!1),[I,P]=p.useState(null);p.useEffect(()=>{N!=null&&N.super_agent_id?R(N.super_agent_id):w&&(y!=null&&y.id)?R(y.id):N!=null&&N.super_agent_id||R(null)},[N==null?void 0:N.super_agent_id,w,y==null?void 0:y.id]),p.useEffect(()=>{if(m&&!z)try{const J=localStorage.getItem("ai.new.super_agent_id");J&&(R(J),localStorage.removeItem("ai.new.super_agent_id"))}catch{}},[m,z]),p.useEffect(()=>{let J=!1;return(async()=>{try{F(!0),P(null);const{data:Fe,error:mt}=await Wr.from("v_human_agents").select("user_id, agent_name, email, role_name").eq("org_id",(N==null?void 0:N.org_id)??V3e).ilike("role_name","%super%");if(mt)throw mt;if(J)return;const V=(Fe||[]).map(re=>({id:re.user_id,name:re.agent_name||re.email||String(re.user_id).slice(0,8)}));D(V),N!=null&&N.super_agent_id||(w&&(y!=null&&y.id)?R(y.id):V.length===1&&!w&&x&&R(V[0].id))}catch(Fe){J||P(Fe instanceof Error?Fe.message:"Failed to load super agents")}finally{J||F(!1)}})(),()=>{J=!0}},[N==null?void 0:N.org_id,N==null?void 0:N.super_agent_id,w,x,y==null?void 0:y.id]);const[U,Z]=p.useState(m?"You are a helpful AI assistant for customer service. Be friendly, professional, and helpful. Always respond in Indonesian unless the customer speaks in another language.":(N==null?void 0:N.system_prompt)||""),[X,K]=p.useState(m?"Halo!  Selamat datang! Ada yang bisa saya bantu hari ini?":(N==null?void 0:N.welcome_message)||""),[ie,H]=p.useState(m?`Transfer to human agent when:
- Customer requests to speak with a human
- Complex technical issues arise
- Customer is dissatisfied or angry
- Payment or billing issues
- Escalation is needed`:(N==null?void 0:N.transfer_conditions)||""),[he,me]=p.useState((N==null?void 0:N.stop_ai_after_handoff)??!0),[ae,Ne]=p.useState([]),[de,Q]=p.useState([]),[fe,Be]=p.useState(""),[je,Ce]=p.useState("");p.useState(()=>{const J=(N==null?void 0:N.temperature)??.3;return Math.max(0,Math.min(1,J))});const[Ze,rt]=p.useState(""),[Je,te]=p.useState(!!((N==null?void 0:N.enable_resolve)??!1)),[We,Ue]=p.useState(""),[ue,xe]=p.useState(()=>_((N==null?void 0:N.read_file_limit)??3,0,O)),[ce,qe]=p.useState((N==null?void 0:N.response_temperature)??"Balanced"),[Se,nt]=p.useState((N==null?void 0:N.message_await)??3),[vt,xt]=p.useState(""),[wt,ht]=p.useState(!!((N==null?void 0:N.enable_followup_message)??!1)),[_t,Wt]=p.useState(""),[pe,Oe]=p.useState(!!((N==null?void 0:N.enable_followup_assigned)??!1)),[W,q]=p.useState(""),[Y,ne]=p.useState(m?"":(N==null?void 0:N.followup_message)||""),[_e,Le]=p.useState(m?"":(N==null?void 0:N.guide_content)||""),be=J=>J.replace(/[^0-9]/g,""),ee=J=>{if(!J)return 0;const Ae=parseInt(J,10);return Number.isNaN(Ae)?0:Ae};p.useEffect(()=>{(async()=>{var Ae,Fe;try{const{data:mt,error:V}=await Wr.from("ai_models").select("*").eq("is_active",!0).order("display_name",{ascending:!0});if(V)throw V;const re=mt||[],ke=re.filter(we=>(we.display_name||"").toLowerCase()!=="fallback"),Re=re.filter(we=>(we.display_name||"").toLowerCase()==="fallback");Ne(ke),Q(Re);const De=(N==null?void 0:N.model_id)||r||"";fe||(De&&ke.some(we=>we.id===De)?Be(De):ke.length>0&&Be(((Ae=ke[0])==null?void 0:Ae.id)||"")),!je&&Re.length>0&&Ce(((Fe=Re[0])==null?void 0:Fe.id)||"")}catch(mt){console.error("Failed to load ai_models",mt)}})()},[N==null?void 0:N.id,r]),p.useEffect(()=>{!fe&&(N!=null&&N.model_id)&&ae.some(J=>J.id===N.model_id)&&Be(N.model_id)},[ae]),p.useEffect(()=>{if(!N)return;const J=N==null?void 0:N.auto_resolve_after_minutes;rt(typeof J=="number"&&!Number.isNaN(J)?J.toString():"0");const Ae=_((N==null?void 0:N.history_limit)??k,0,j);Ue(Ae.toString());const Fe=_((N==null?void 0:N.message_limit)??T,0,T);xt(Fe.toString());const mt=(N==null?void 0:N.followup_message_delay)??60;Wt(mt.toString());const V=(N==null?void 0:N.followup_delay_assigned)??60;q(V.toString())},[N==null?void 0:N.id]);const oe=ae.find(J=>J.id===fe)||null,Ee=p.useMemo(()=>{const J=oe==null?void 0:oe.max_context_tokens;return typeof J=="number"&&J>0?_(J,0,j):j},[oe==null?void 0:oe.max_context_tokens]);p.useEffect(()=>{if(!We)return;const J=parseInt(We,10);Number.isNaN(J)||J>Ee&&Ue(Ee.toString())},[We,Ee]);const Xe=J=>{const Ae=be(J);if(Ae===""){rt("");return}const Fe=_(parseInt(Ae,10),0,A);rt(Fe.toString())},$e=J=>{const Ae=be(J);if(Ae===""){Ue("");return}const Fe=_(parseInt(Ae,10),0,Ee);Ue(Fe.toString())},jt=J=>{const Ae=be(J);if(Ae===""){xt("");return}const Fe=_(parseInt(Ae,10),0,T);xt(Fe.toString())},[et,It]=p.useState([]),Rt=p.useRef(null),[En,Vn]=p.useState(!1),Ln=async()=>{const J=(N==null?void 0:N.id)??n;if(!J)throw new Error("Please save the AI Agent first before uploading files.");let Ae=(N==null?void 0:N.org_id)??null;if(!Ae){const{data:{user:Fe}}=await Wr.auth.getUser();if(Fe){const{data:mt}=await Wr.from("org_members").select("org_id").eq("user_id",Fe.id).limit(1).maybeSingle();Ae=(mt==null?void 0:mt.org_id)??null}}if(!Ae)throw new Error("Could not determine your organization. Please re-login or contact support.");return{orgId:Ae,profileId:J}},Yr=async(J,Ae)=>{try{if(!b)throw new Error("You do not have permission to upload agent files.");const Fe=((J==null?void 0:J.type)||"").toLowerCase()==="application/pdf",mt=((J==null?void 0:J.name)||"").toLowerCase().endsWith(".pdf");if(!Fe&&!mt)throw new Error("Only PDF files are supported");const{orgId:V,profileId:re}=await Ln();let ke="";try{if(typeof crypto<"u"&&crypto.subtle){const Aa=await J.arrayBuffer(),xi=await crypto.subtle.digest("SHA-256",Aa);ke=Array.from(new Uint8Array(xi)).map(mH=>mH.toString(16).padStart(2,"0")).join("")}else{console.warn("crypto.subtle not available, using fallback hash");const Aa=`${J.name}-${J.size}-${J.lastModified}-${Date.now()}`;let xi=5381;for(let gg=0;gg<Aa.length;gg++)xi=(xi<<5)+xi+Aa.charCodeAt(gg);ke=(Math.abs(xi)+Date.now()).toString(16).padStart(64,"0")}}catch(Aa){console.warn("Error computing hash, using standard fallback:",Aa),ke=`fallback-${Date.now()}-${Math.random().toString(36).substring(2)}`}const De=((J==null?void 0:J.name)||"file.pdf").replace(/[^a-zA-Z0-9_.-]/g,"").replace(/\.pdf$/i,""),we=`${ke}_${De}.pdf`,yt=`org_${V}/profile_${re}/${we}`,Pt=`${Oo}/storage/v1/object/ai-agent-files/${yt}`,Zt=crypto.randomUUID(),{error:Sn}=await Wr.from("files").insert({id:Zt,org_id:V,ai_profile_id:re,bucket:"ai-agent-files",path:yt,filename:J.name,mime_type:J.type||"application/pdf",byte_size:J.size,checksum:ke});if(Sn)throw console.error("Error inserting into public.files:",Sn),new Error("Failed to record file metadata");const Ji=new FormData;Ji.append("file",J);const Ho={"x-file-name":J.name||"file.pdf","x-file-url":Pt,"x-org-id":V,"x-profile-id":re,"x-file-hash":ke,"x-file-id":Zt},Tr=await fetch(Nn.buildUrl(Nn.ENDPOINTS.KNOWLEDGE.FILE_UPLOAD),{method:"POST",headers:Ho,body:Ji});if(!Tr.ok){let Aa=`Upload failed (${Tr.status})`;try{const xi=await Tr.json();Aa=(xi==null?void 0:xi.message)||Aa}catch{}throw new Error(Aa)}const Qr=await Tr.json().catch(()=>({})),Ko=(Qr==null?void 0:Qr.document_id)||(Qr==null?void 0:Qr.documentId)||void 0,ju=String((Qr==null?void 0:Qr.status)||"").toLowerCase();if(ju==="duplicate"){const Aa=new Error("duplicate");throw Aa.code="DUPLICATE_CONTENT",Aa}if(ju!=="success")throw new Error(`Upload webhook returned unexpected status: ${ju||"unknown"}`);let mg=null;const{error:_u}=await Wr.storage.from("ai-agent-files").upload(yt,J,{cacheControl:"31536000",contentType:"application/pdf",upsert:!1});if(_u&&!(typeof(_u==null?void 0:_u.message)=="string"&&/exists|duplicate|409/i.test(_u.message)))throw _u;const{data:pg,error:fH}=await Wr.storage.from("ai-agent-files").createSignedUrl(yt,60*60*24*7);return!fH&&(pg!=null&&pg.signedUrl)&&(mg=pg.signedUrl),{url:mg||"",filePath:yt,documentId:Ko,fileId:Zt}}catch(Fe){throw console.error("Error uploading file to Supabase:",Fe),new Error(`Failed to upload ${J.name}: ${(Fe==null?void 0:Fe.message)||"Unknown error"}`)}},Ca=async()=>{try{Vn(!0);const{orgId:J,profileId:Ae}=await Ln(),{data:Fe,error:mt}=await Wr.from("files").select("*").eq("ai_profile_id",Ae).order("created_at",{ascending:!1});if(mt)throw mt;const V=(Fe||[]).map(re=>({id:re.id,name:re.filename,size:re.byte_size||0,uploadedAt:re.created_at,status:"ready",url:"",filePath:re.path,isEnabled:re.is_enabled??!0}));await Promise.all(V.map(async re=>{if(re.filePath){const{data:ke}=await Wr.storage.from("ai-agent-files").createSignedUrl(re.filePath,604800);ke!=null&&ke.signedUrl&&(re.url=ke.signedUrl)}})),It(V)}catch(J){console.error("Failed to load knowledge files:",J)}finally{Vn(!1)}},cr=async(J,Ae)=>{if(It(Fe=>Fe.map(mt=>mt.id===J?{...mt,isEnabled:!Ae}:mt)),typeof J=="string")try{const{error:Fe}=await Wr.from("files").update({is_enabled:!Ae}).eq("id",J);if(Fe)throw Fe}catch{ze.error("Failed to update status"),It(mt=>mt.map(V=>V.id===J?{...V,isEnabled:Ae}:V))}};p.useEffect(()=>{o==="file"&&Ca()},[o,N==null?void 0:N.id,n]);const Tn=async J=>{const Ae=Array.from(J.target.files||[]);if(Ae.length===0)return;if(Ae.length>1){ze.error("Please upload one file at a time.");return}const Fe=Ae.filter(re=>re.type==="application/pdf"||re.name.toLowerCase().endsWith(".pdf"));if(Fe.length<Ae.length&&ze.error("Only PDF files are supported. Some files were skipped."),Fe.length===0){Rt.current&&(Rt.current.value="");return}try{await Ln()}catch(re){ze.error((re==null?void 0:re.message)||"Unable to upload at this time"),Rt.current&&(Rt.current.value="");return}const mt=new Date().toISOString(),V=Fe.map(re=>({id:Date.now()+Math.random(),name:re.name,size:re.size,uploadedAt:mt,status:"uploading"}));It(re=>[...V,...re]);for(let re=0;re<Fe.length;re++){const ke=Fe[re],Re=V[re];try{const{url:De,filePath:we,fileId:yt}=await Yr(ke,Re.id);It(Pt=>Pt.map(Zt=>Zt.id===Re.id?{...Zt,status:"ready",url:De,filePath:we,id:yt||Zt.id,isEnabled:!0}:Zt)),ze.success(`${ke.name} uploaded successfully!`)}catch(De){if(String((De==null?void 0:De.message)||"").toLowerCase().includes("duplicate")||(De==null?void 0:De.code)==="DUPLICATE_CONTENT"){It(we=>we.map(yt=>yt.id===Re.id?{...yt,status:"ready"}:yt)),setTimeout(()=>{var we,yt;(yt=(we=Ca())==null?void 0:we.catch)==null||yt.call(we,()=>{})},0),ze.info(`${ke.name} already exists. Skipped re-upload.`);continue}It(we=>we.map(yt=>yt.id===Re.id?{...yt,status:"failed"}:yt)),ze.error(De.message||`Failed to upload ${ke.name}`)}}Rt.current&&(Rt.current.value="")},pn=async J=>{J.preventDefault();const Ae=Array.from(J.dataTransfer.files||[]);if(Ae.length===0)return;if(Ae.length>1){ze.error("Please upload one file at a time.");return}const Fe=Ae.filter(re=>re.type==="application/pdf"||re.name.toLowerCase().endsWith(".pdf"));if(Fe.length<Ae.length&&ze.error("Only PDF files are supported. Some files were skipped."),Fe.length===0)return;try{await Ln()}catch(re){ze.error((re==null?void 0:re.message)||"Unable to upload at this time");return}const mt=new Date().toISOString(),V=Fe.map(re=>({id:Date.now()+Math.random(),name:re.name,size:re.size,uploadedAt:mt,status:"uploading"}));It(re=>[...V,...re]);for(let re=0;re<Fe.length;re++){const ke=Fe[re],Re=V[re];try{const{url:De,filePath:we}=await Yr(ke,Re.id);It(yt=>yt.map(Pt=>Pt.id===Re.id?{...Pt,status:"ready",url:De,filePath:we}:Pt)),ze.success(`${ke.name} uploaded successfully!`)}catch(De){It(we=>we.map(yt=>yt.id===Re.id?{...yt,status:"failed"}:yt)),ze.error(De.message||`Failed to upload ${ke.name}`)}}},ua=J=>{J.preventDefault()},Qn=async J=>{const Ae=et.find(Fe=>Fe.id===J);try{const{orgId:Fe,profileId:mt}=await Ln(),V=new URLSearchParams({org_id:Fe,profile_id:mt,file_key:(Ae==null?void 0:Ae.filePath)||"",file_id:String((Ae==null?void 0:Ae.id)||"")}),re=await fetch(`${Nn.buildUrl(Nn.ENDPOINTS.KNOWLEDGE.FILE_DELETE)}?${V.toString()}`,{method:"POST"});if(!re.ok){let De=`Delete failed (${re.status})`;try{const we=await re.json();De=(we==null?void 0:we.message)||De}catch{}throw new Error(De)}let ke={};try{ke=await re.json()}catch{}if(String((ke==null?void 0:ke.status)||"").toLowerCase()!=="deleted")throw new Error((ke==null?void 0:ke.message)||"Delete not confirmed by webhook");It(De=>De.filter(we=>we.id!==J)),ze.info(`${(Ae==null?void 0:Ae.name)||"File"} removed`)}catch(Fe){console.error("Error deleting file via webhook:",Fe),ze.error((Fe==null?void 0:Fe.message)||"Failed to delete file")}},ft=async J=>{try{const Ae=J.filePath;if(!Ae)throw new Error("Missing file path");const{data:Fe,error:mt}=await Wr.storage.from("ai-agent-files").createSignedUrl(Ae,60*60,{download:J.name||"file.pdf"});if(mt)throw mt;const V=(Fe==null?void 0:Fe.signedUrl)||J.url||"";if(!V)throw new Error("Unable to generate download link");const re=document.createElement("a");re.href=V,re.download=J.name||"",re.target="_blank",re.rel="noopener",document.body.appendChild(re),re.click(),re.remove()}catch(Ae){ze.error((Ae==null?void 0:Ae.message)||"Failed to download file")}},Ja=async()=>{const J=et.filter(Ae=>Ae.filePath);if(J.length>0)try{const{orgId:Ae,profileId:Fe}=await Ln();await Promise.all(J.map(async mt=>{try{const V=new URLSearchParams({org_id:Ae,profile_id:Fe,file_key:mt.filePath||"",file_id:String(mt.id||""),document_id:(mt==null?void 0:mt.documentId)||""}),re=await fetch(`${Nn.buildUrl(Nn.ENDPOINTS.KNOWLEDGE.FILE_DELETE)}?${V.toString()}`,{method:"POST"});if(re.ok){let ke={};try{ke=await re.json()}catch{}const Re=String((ke==null?void 0:ke.status)||"").toLowerCase();Re!=="deleted"&&console.warn("Delete webhook did not confirm deletion for",mt.filePath,Re)}else{let ke=`Delete failed (${re.status})`;try{const Re=await re.json();ke=(Re==null?void 0:Re.message)||ke}catch{}console.warn("Delete webhook failed for",mt.filePath,ke)}}catch(V){console.warn("Delete webhook error for",mt.filePath,V)}}))}catch(Ae){console.error("Error clearing files via webhook:",Ae)}It([]),ze.info("All files cleared")},[ur,Xr]=p.useState([{id:Date.now(),question:"",answer:""}]),[fs,Fs]=p.useState([{id:Date.now(),question:"",answer:""}]),Lr=()=>{const J={id:Date.now()+Math.random(),question:"",answer:""};Xr(Ae=>[J,...Ae]),Fs(Ae=>[JSON.parse(JSON.stringify(J)),...Ae])},qo=J=>{Xr(Ae=>Ae.filter(Fe=>Fe.id!==J)),Fs(Ae=>Ae.filter(Fe=>Fe.id!==J))},Us=(J,Ae,Fe)=>{Xr(mt=>mt.map(V=>V.id===J?{...V,[Ae]:Fe}:V))},da=J=>{const Ae=fs.find(V=>V.id===J.id),Fe=(J.question||"").trim(),mt=(J.answer||"").trim();return Ae?Fe!==(Ae.question||"").trim()||mt!==(Ae.answer||"").trim():Fe!==""||mt!==""},[Qa,ms]=p.useState([{id:1,prompt:"Hai! Ada yang bisa saya bantu lagi?",delay:60,expanded:!1},{id:2,prompt:"Jika ada pertanyaan lain, jangan ragu untuk bertanya!",delay:120,expanded:!1}]),yi=()=>{const J={id:Date.now(),prompt:"",delay:60,expanded:!1};ms([...Qa,J])},Te=J=>{ms(Qa.filter(Ae=>Ae.id!==J))},ut=(J,Ae,Fe)=>{ms(Qa.map(mt=>mt.id===J?{...mt,[Ae]:Fe}:mt))},bt=J=>{ms(Qa.map(Ae=>Ae.id===J?{...Ae,expanded:!Ae.expanded}:Ae))},Lt=()=>{if(N&&!m){Z(N.system_prompt||""),K(N.welcome_message||""),H(N.transfer_conditions||""),me(N.stop_ai_after_handoff),rt(String((N==null?void 0:N.auto_resolve_after_minutes)??0)),te(!!((N==null?void 0:N.enable_resolve)??!1)),Ue(String(_((N==null?void 0:N.history_limit)??k,0,j))),xe(_((N==null?void 0:N.read_file_limit)??3,0,O)),qe((N==null?void 0:N.response_temperature)??"Balanced"),nt((N==null?void 0:N.message_await)??3),xt(String(_((N==null?void 0:N.message_limit)??T,0,T))),ht(!!((N==null?void 0:N.enable_followup_message)??!1)),Wt(String((N==null?void 0:N.followup_message_delay)??60)),Oe(!!((N==null?void 0:N.enable_followup_assigned)??!1)),q(String((N==null?void 0:N.followup_delay_assigned)??60)),ne(N.followup_message||"");const J=N==null?void 0:N.qna;if(J&&Array.isArray(J)){const Ae=J.map((Fe,mt)=>({id:Date.now()+mt,question:Fe.q??Fe.question??"",answer:Fe.a??Fe.answer??""}));Xr(Ae),Fs(JSON.parse(JSON.stringify(Ae)))}Le((N==null?void 0:N.guide_content)||"")}};p.useEffect(()=>{Lt()},[N,m]),p.useEffect(()=>{m&&Fs(JSON.parse(JSON.stringify(ur)))},[]);const Nt=async()=>{if(!z){ze.error("Please assign a super agent before saving this AI agent.");return}const J=_(ee(Ze),0,A),Ae=_(ee(We),0,Ee),Fe=_(ee(vt),0,T),mt=ee(_t),V=ee(W),re=(()=>{const De=oe==null?void 0:oe.max_context_tokens;return typeof De=="number"&&De>0?Math.max(1,Math.floor(De/1e3)):S})(),ke=_(_((N==null?void 0:N.context_limit)??28,0,S),0,re),Re={system_prompt:U,welcome_message:X,transfer_conditions:ie,stop_ai_after_handoff:he,model_id:fe||null,name:e,auto_resolve_after_minutes:J,enable_resolve:Je,history_limit:Ae,read_file_limit:ue,context_limit:ke,response_temperature:ce,message_await:Se,message_limit:Fe,super_agent_id:z,enable_followup_message:wt,followup_message_delay:mt,enable_followup_assigned:pe,followup_delay_assigned:V,followup_message:Y,qna:ur.filter(De=>{var we,yt;return((we=De.question)==null?void 0:we.trim())||((yt=De.answer)==null?void 0:yt.trim())}).map(({question:De,answer:we})=>({q:De.trim(),a:we.trim()})),guide_content:_e};try{await $(Re),h(!1),ze.success(m?"AI agent created successfully!":"AI agent settings saved successfully!")}catch{ze.error(m?"Failed to create AI agent":"Failed to save AI agent settings")}},Zn=async()=>{try{await $({name:e,guide_content:_e}),ze.success("Knowledge text saved")}catch(J){ze.error((J==null?void 0:J.message)||"Failed to save knowledge text")}},$r=async()=>{try{await $({name:e,qna:ur.filter(J=>{var Ae,Fe;return((Ae=J.question)==null?void 0:Ae.trim())||((Fe=J.answer)==null?void 0:Fe.trim())}).map(({question:J,answer:Ae})=>({q:J.trim(),a:Ae.trim()}))}),Fs(JSON.parse(JSON.stringify(ur))),ze.success("Q&A saved")}catch(J){ze.error((J==null?void 0:J.message)||"Failed to save Q&A")}};return L&&!m?a.jsxs("div",{className:"flex items-center justify-center h-64",children:[a.jsx(Ht,{className:"w-8 h-8 animate-spin"}),a.jsx("span",{className:"ml-2",children:"Loading AI profile..."})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs(se,{variant:"ghost",size:"sm",onClick:t,className:"gap-2",children:[a.jsx(Rp,{className:"w-4 h-4"}),"Back"]})}),a.jsx(ge,{children:a.jsx("p",{children:"Kembali ke daftar agen AI"})})]}),a.jsx("h1",{className:"text-2xl font-bold",children:e}),m?a.jsx(At,{variant:"outline",className:"text-blue-600 border-blue-600",children:"New Agent"}):N&&a.jsxs(At,{variant:"secondary",children:["Last Updated: ",new Date(N.created_at).toLocaleDateString()]}),!L&&a.jsx("div",{className:"ml-auto flex items-center gap-2",children:d?a.jsxs(se,{variant:"ghost",size:"sm",onClick:()=>{m?t():(h(!1),Lt())},className:"gap-2",children:[a.jsx(xa,{className:"w-4 h-4"}),"Cancel"]}):a.jsxs(se,{variant:"outline",size:"sm",onClick:()=>h(!0),className:"gap-2",children:[a.jsx(QV,{className:"w-4 h-4"}),"Edit Settings"]})})]}),B&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("p",{className:"text-red-800 text-sm",children:["Error: ",B]})}),a.jsxs(Gc,{value:s,onValueChange:i,children:[a.jsxs(Fl,{className:"grid w-full grid-cols-2 bg-muted/60 p-1 rounded-lg",children:[a.jsx(_r,{value:"general",className:"data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=inactive]:text-muted-foreground data-[state=inactive]:hover:bg-muted/40 transition-colors",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(xo,{className:"w-4 h-4"}),a.jsx("span",{children:"General"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Konfigurasi pengaturan umum agen AI"})})]})}),a.jsx(_r,{value:"knowledge",className:"data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=inactive]:text-muted-foreground data-[state=inactive]:hover:bg-muted/40 transition-colors",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Rv,{className:"w-4 h-4"}),a.jsx("span",{children:"Knowledge Sources"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Kelola sumber pengetahuan dan pasangan T&J"})})]})})]}),a.jsx(ir,{value:"general",className:"space-y-6",children:a.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-5 gap-6",children:[a.jsxs("div",{className:"xl:col-span-3 space-y-4",children:[a.jsxs(He,{className:"p-6",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-muted flex items-center justify-center text-lg font-semibold",children:e.charAt(0)}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-semibold",children:e}),a.jsx("p",{className:"text-muted-foreground",children:m?"New AI Agent - Configure your settings below":(N==null?void 0:N.description)||"AI Agent"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:m?"Not saved yet":`Last Updated: ${N?new Date(N.created_at).toLocaleString():"Never"}`})]})]}),a.jsxs("div",{className:"space-y-2 pt-4",children:[a.jsx("span",{className:"text-sm font-medium",children:"Assigned Super Agent"}),E?a.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading super agents..."}):I?a.jsx("div",{className:"text-sm text-destructive",children:I}):w&&(y!=null&&y.id)?a.jsxs("div",{className:"inline-flex items-center gap-2 rounded-md bg-muted px-3 py-2 text-sm",children:[a.jsxs("span",{children:[" ",((gn=C.find(J=>J.id===y.id))==null?void 0:gn.name)||y.email||"You"]}),a.jsx(At,{variant:"secondary",children:"Your account"})]}):C.length===0?a.jsx("div",{className:"rounded-md border border-dashed border-muted-foreground/40 bg-muted/30 px-3 py-2 text-sm text-muted-foreground",children:"No super agents available. Create a super agent first before assigning this AI agent."}):a.jsxs(tn,{value:z||"",onValueChange:J=>R(J),disabled:!x||!d,children:[a.jsx(Jt,{className:"w-full",children:a.jsx(Gt,{placeholder:"Choose a super agent"})}),a.jsx(Qt,{className:"bg-background border z-50",children:C.map(J=>a.jsxs(st,{value:J.id,children:[" ",J.name]},J.id))})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Only the assigned super agent and their human agents can view and use this AI agent."})]})]}),a.jsx(He,{className:"p-4",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-start justify-between gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary",children:"AI Model"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Pilih model AI yang menentukan kecepatan dan kualitas respons."})})]})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose the balance between speed and intelligence for this agent."})]}),oe&&a.jsx(At,{variant:"secondary",className:"whitespace-nowrap",children:Uu(oe==null?void 0:oe.provider)})]}),a.jsxs(tn,{value:fe,onValueChange:Be,disabled:ae.length===0||!d,children:[a.jsx(Jt,{className:"w-full py-3",children:oe?a.jsx("span",{className:"flex w-full items-center gap-2 text-sm font-medium truncate pr-2",children:a.jsxs("span",{className:"truncate",children:[(oe==null?void 0:oe.display_name)||"Custom","  ",gv(oe==null?void 0:oe.cost_per_1m_tokens),"  ",Uu(oe==null?void 0:oe.provider)]})}):a.jsx(Gt,{placeholder:"Select an AI model"})}),a.jsx(Qt,{className:"bg-background border z-50",children:ae.map(J=>a.jsx(st,{value:J.id,children:a.jsxs("div",{className:"flex flex-col text-left",children:[a.jsxs("span",{className:"font-semibold leading-tight",children:[(J==null?void 0:J.display_name)||"Custom","  ",gv(J==null?void 0:J.cost_per_1m_tokens)]}),a.jsx("span",{className:"text-xs text-muted-foreground leading-tight",children:(J==null?void 0:J.description)||"No description available"}),a.jsxs("span",{className:"text-[11px] text-muted-foreground font-mono",children:[J==null?void 0:J.model_name,"  ",Uu(J==null?void 0:J.provider)]})]})},J.id))})]}),ae.length===0&&a.jsx("p",{className:"text-xs text-destructive mt-2",children:"No AI models available. Please contact your administrator."})]}),de.length>0&&a.jsxs("div",{className:"border-t pt-6",children:[a.jsxs("div",{className:"flex items-start justify-between gap-4 mb-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Fallback Model"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Model yang digunakan secara otomatis jika model utama tidak tersedia."})})]})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatic backup model used when primary model is unavailable."})]}),de.find(J=>J.id===je)&&a.jsx(At,{variant:"secondary",className:"whitespace-nowrap",children:Uu((Jr=de.find(J=>J.id===je))==null?void 0:Jr.provider)})]}),a.jsxs(tn,{value:je,onValueChange:Ce,disabled:de.length===0||!d,children:[a.jsx(Jt,{className:"w-full py-3",children:de.find(J=>J.id===je)?a.jsx("span",{className:"flex w-full items-center gap-2 text-sm font-medium truncate pr-2",children:a.jsxs("span",{className:"truncate",children:[((Et=de.find(J=>J.id===je))==null?void 0:Et.display_name)||"Custom","  ",gv(($n=de.find(J=>J.id===je))==null?void 0:$n.cost_per_1m_tokens),"  ",Uu((Dt=de.find(J=>J.id===je))==null?void 0:Dt.provider)]})}):a.jsx(Gt,{placeholder:"Select a fallback model"})}),a.jsx(Qt,{className:"bg-background border z-50",children:de.map(J=>a.jsx(st,{value:J.id,children:a.jsxs("div",{className:"flex flex-col text-left",children:[a.jsxs("span",{className:"font-semibold leading-tight",children:[(J==null?void 0:J.display_name)||"Custom","  ",gv(J==null?void 0:J.cost_per_1m_tokens)]}),a.jsx("span",{className:"text-xs text-muted-foreground leading-tight",children:(J==null?void 0:J.description)||"No description available"}),a.jsxs("span",{className:"text-[11px] text-muted-foreground font-mono",children:[J==null?void 0:J.model_name,"  ",Uu(J==null?void 0:J.provider)]})]})},J.id))})]})]})]})}),a.jsxs(He,{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>f("behavior"),children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary",children:"AI Agent Behavior"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Konfigurasi kepribadian dan perilaku agen AI untuk menentukan cara berinteraksi dengan pelanggan"})})]})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure AI personality and behavior"})]}),a.jsx(Ma,{className:`w-5 h-5 transition-transform ${c.behavior?"rotate-180":""}`})]}),c.behavior&&a.jsxs("div",{className:"mt-4 space-y-4",children:[a.jsx(qr,{className:"min-h-[120px]",value:U,onChange:J=>Z(J.target.value),disabled:!d,placeholder:m?"Define your AI's personality, behavior, and capabilities here...":"Enter system prompt..."}),a.jsxs("div",{className:"text-right text-xs text-muted-foreground",children:[U.length,"/15000"]})]})]}),a.jsxs(He,{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>f("welcome"),children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Welcome Message"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Pesan selamat datang yang dikirim otomatis kepada pelanggan saat memulai percakapan"})})]})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"First message sent to users"})]}),a.jsx(Ma,{className:`w-5 h-5 transition-transform ${c.welcome?"rotate-180":""}`})]}),c.welcome&&a.jsxs("div",{className:"mt-4 space-y-4",children:[a.jsx(qr,{className:"min-h-[80px]",value:X,onChange:J=>K(J.target.value),disabled:!d,placeholder:m?"This is the first message your AI will send to customers...":"Enter welcome message..."}),a.jsxs("div",{className:"text-right text-xs text-muted-foreground",children:[X.length,"/5000"]}),a.jsxs("div",{className:"pt-4 border-t space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{className:"space-y-0.5",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Auto Follow-up Message"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Kirim pesan otomatis kedua jika tidak ada aktivitas lebih lanjut dari kedua pihak setelah waktu tertentu."})})]})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically nudge users after inactivity (configure separately for Unassigned and Assigned threads)"})]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium text-primary",children:"Follow-up Template"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:'Contoh: "Halo, apakah ada yang bisa saya bantu lagi? Jika tidak ada, tiket ini akan saya tutup."'})})]})]}),a.jsx(qr,{className:"min-h-[80px]",value:Y,onChange:J=>ne(J.target.value),placeholder:"Enter follow-up message (shared for both Unassigned and Assigned)...",disabled:!d}),a.jsxs("div",{className:"text-right text-xs text-muted-foreground",children:[Y.length,"/5000"]})]}),a.jsxs("div",{className:"border rounded-lg p-4 space-y-4 bg-orange-50/30 dark:bg-orange-950/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Unassigned Threads"}),a.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-orange-100 dark:bg-orange-900/50 text-orange-700 dark:text-orange-300",children:"AI Handling"})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Trigger follow-up when AI is handling the conversation"})]}),a.jsx(Di,{checked:wt,onCheckedChange:ht,disabled:!d})]}),wt&&a.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-top-1 duration-200",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium text-primary",children:"Inactivity Timeout (seconds)"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Waktu dalam detik sebelum pesan tindak lanjut dikirim untuk percakapan Unassigned."})})]})]}),a.jsx(it,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"e.g. 120",value:_t,onChange:J=>Wt(be(J.target.value)),disabled:!d,className:"max-w-[200px]"})]})]}),a.jsxs("div",{className:"border rounded-lg p-4 space-y-4 bg-blue-50/30 dark:bg-blue-950/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Assigned Threads"}),a.jsx("span",{className:"text-xs px-2 py-0.5 rounded bg-blue-100 dark:bg-blue-900/50 text-blue-700 dark:text-blue-300",children:"Agent Handling"})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Trigger follow-up when a human agent is handling the conversation"})]}),a.jsx(Di,{checked:pe,onCheckedChange:Oe,disabled:!d})]}),pe&&a.jsxs("div",{className:"space-y-2 animate-in fade-in slide-in-from-top-1 duration-200",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium text-primary",children:"Inactivity Timeout (seconds)"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Waktu dalam detik sebelum pesan tindak lanjut dikirim untuk percakapan Assigned."})})]})]}),a.jsx(it,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"e.g. 300",value:W,onChange:J=>q(be(J.target.value)),disabled:!d,className:"max-w-[200px]"})]})]})]})]})]}),a.jsxs(He,{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>f("transfer"),children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Agent Transfer Conditions"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Kondisi yang menentukan kapan percakapan dialihkan dari agen AI ke agen manusia"})})]})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"When to transfer to human agents"})]}),a.jsx(Ma,{className:`w-5 h-5 transition-transform ${c.transfer?"rotate-180":""}`})]}),c.transfer&&a.jsxs("div",{className:"mt-4 space-y-4",children:[a.jsx(qr,{className:"min-h-[80px]",value:ie,onChange:J=>H(J.target.value),disabled:!d,placeholder:m?"Define when your AI should transfer the conversation to a human agent...":"Enter transfer conditions..."}),a.jsxs("div",{className:"text-right text-xs text-muted-foreground",children:[ie.length,"/750"]})]})]}),a.jsx(He,{className:"p-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Stop AI after Handoff"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Menghentikan agen AI mengirim pesan setelah percakapan dialihkan ke agen manusia"})})]})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Stop AI from sending messages after handoff"})]}),a.jsx(Di,{checked:he,onCheckedChange:me,disabled:!d})]})}),a.jsx(He,{className:"p-6",children:a.jsxs(pD,{defaultOpen:!1,children:[a.jsxs(gD,{className:"flex w-full items-center justify-between py-1 font-medium [&[data-state=open]>svg]:rotate-180",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary",children:"Additional Settings"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Pengaturan tambahan untuk konfigurasi lanjutan agen AI seperti batas riwayat, konteks, dan resolusi otomatis"})})]})]}),a.jsx(Ma,{className:"w-5 h-5 transition-transform"})]}),a.jsx(vD,{className:"mt-4 data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down overflow-hidden",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Enable auto-resolve"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Mengaktifkan resolusi otomatis percakapan setelah waktu tertentu tanpa respons pelanggan"})})]})]}),a.jsx("div",{className:"mt-2",children:a.jsx(Di,{checked:Je,onCheckedChange:te,disabled:!d})})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Auto-resolve timeout (minutes)"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Waktu dalam menit sebelum percakapan secara otomatis diselesaikan (0 = nonaktif)"})})]})]}),a.jsx(it,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"e.g. 30",value:Ze,onChange:J=>Xe(J.target.value),disabled:!Je||!d,className:`mt-1 ${!Je||!d?"opacity-60 cursor-not-allowed bg-muted/50":""}`}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:Je?"Set 0 to disable auto-resolve.":"Enable Auto-resolve to edit this value."})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Conversation History (messages)"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Batas maksimal jumlah pesan riwayat percakapan yang dapat diingat AI"})})]})]}),a.jsx(it,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:`Max ${Ee}`,value:We,onChange:J=>$e(J.target.value),disabled:!d,className:"mt-1"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:`Supports up to ${Ee} messages.`})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Creativity Preset"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Preset kreativitas AI: Conservative (akurat), Balanced (seimbang), Creative (kreatif)"})})]})]}),a.jsxs("select",{value:ce,onChange:J=>qe(J.target.value),disabled:!d,className:"w-full p-2 border rounded-lg mt-1",children:[a.jsx("option",{value:"Conservative",children:"Conservative"}),a.jsx("option",{value:"Balanced",children:"Balanced"}),a.jsx("option",{value:"Creative",children:"Creative"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"AI Message Cap"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Batas maksimal jumlah pesan yang dapat dikirim AI dalam satu percakapan"})})]})]}),a.jsx(it,{type:"text",inputMode:"numeric",pattern:"[0-9]*",placeholder:"e.g. 1000",value:vt,onChange:J=>jt(J.target.value),disabled:!d,className:"mt-1"})]})]})})]})}),d&&a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{className:"w-full",onClick:Nt,disabled:M,children:M?a.jsxs(a.Fragment,{children:[a.jsx(Ht,{className:"w-4 h-4 mr-2 animate-spin"}),m?"Creating...":"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(xo,{className:"w-4 h-4 mr-2"}),m?"Create AI Agent":"Save AI Settings"]})})}),a.jsx(ge,{children:a.jsx("p",{children:m?"Buat agen AI baru dengan pengaturan ini":"Simpan semua pengaturan saat ini"})})]})]}),a.jsx("div",{className:"xl:col-span-2",children:a.jsx(G3e,{welcomeMessage:X,systemPrompt:U,modelDisplay:(oe==null?void 0:oe.display_name)||(oe==null?void 0:oe.model_name)||"Not selected",profile:N,profileId:n,modelName:(oe==null?void 0:oe.model_name)||"",temperature:D9(ce),transfer_conditions:ie})})]})}),a.jsx(ir,{value:"knowledge",className:"space-y-6",children:a.jsx(He,{className:"p-6",children:a.jsxs(Gc,{value:o,onValueChange:l,className:"w-full",children:[a.jsxs(Fl,{className:"grid w-full grid-cols-3 mb-6",children:[a.jsxs(_r,{value:"text",className:"gap-2",children:[a.jsx(KV,{className:"w-4 h-4"}),"Text"]}),a.jsxs(_r,{value:"file",className:"gap-2",children:[a.jsx(gd,{className:"w-4 h-4"}),"File"]}),a.jsxs(_r,{value:"qa",className:"gap-2",children:[a.jsx(Ke,{className:"w-4 h-4"}),"Q&A"]})]}),a.jsxs(ir,{value:"text",className:"space-y-4",children:[a.jsx("div",{className:"space-y-4",children:a.jsxs("div",{children:[a.jsx("label",{className:"text-sm font-medium",children:"Knowledge Text Content"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1 mb-2",children:"Add custom knowledge text that your AI agent can reference when responding to customers."}),a.jsx(qr,{className:"min-h-[300px] font-mono text-sm",value:_e,onChange:J=>Le(J.target.value),placeholder:"Enter your knowledge content here...",disabled:!d})]})}),a.jsxs("div",{className:"flex items-center justify-between mt-2",children:[a.jsxs(se,{onClick:Zn,disabled:M,size:"sm",className:"gap-2",children:[a.jsx(JT,{className:"w-4 h-4"}),"Save Text"]}),a.jsxs("div",{className:"text-xs text-muted-foreground",children:[_e.length," Characters"]})]})]}),a.jsxs(ir,{value:"website",className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Provide Link"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Provide a link to the page you want the AI to learn from."})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(se,{variant:"default",size:"sm",className:"bg-muted text-foreground hover:bg-muted/80",children:"Batch Link"}),a.jsx(se,{variant:"outline",size:"sm",children:"Single Link"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Web Link Collector"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(it,{placeholder:"Link URL",className:"flex-1"}),a.jsx(se,{className:"bg-blue-600 hover:bg-blue-700",children:"Collect Link"})]}),a.jsxs("div",{className:"flex items-start gap-2 text-sm text-blue-600",children:[a.jsx("div",{className:"w-4 h-4 rounded-full bg-blue-600 flex items-center justify-center mt-0.5",children:a.jsx("span",{className:"text-white text-xs",children:"!"})}),a.jsxs("p",{children:["Start with URL and this tool will gather up to ",a.jsx("strong",{children:"30 unique"})," links from the site, excluding any files"]})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Trained Link"}),a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",id:"select-all",className:"rounded"}),a.jsx("label",{htmlFor:"select-all",className:"text-sm text-blue-600 cursor-pointer",children:"Select"})]}),a.jsx(it,{placeholder:"Search Links",className:"flex-1"})]})]})]}),a.jsxs(ir,{value:"file",className:"space-y-6",children:[a.jsxs("div",{onDrop:b&&d?pn:void 0,onDragOver:b&&d?ua:void 0,className:`border border-dashed rounded-lg p-6 text-center ${b&&d?"bg-muted/30":"bg-muted/50 opacity-70 cursor-not-allowed"}`,children:[a.jsx("input",{ref:Rt,type:"file",hidden:!0,onChange:Tn,disabled:!b||!d}),a.jsx(gd,{className:"w-10 h-10 mx-auto mb-3 text-muted-foreground"}),b&&d?a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-3",children:"Drag & drop a document here, or"}),a.jsx(se,{size:"sm",onClick:()=>{var J;return(J=Rt.current)==null?void 0:J.click()},disabled:!d,children:"Browse Files"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Supported: PDF"})]}):a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:d?"You don't have permission to upload files.":"Enter edit mode to manage files."}),d&&!b&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Requires permission: ai_agent_files.create"})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("h3",{className:"text-sm font-medium",children:["Uploaded Files (",et.length,")"]}),et.length>0&&d&&a.jsx(se,{variant:"ghost",size:"sm",onClick:Ja,className:"text-red-600 hover:text-red-700",disabled:!d,children:"Clear All"})]}),En?a.jsx("div",{className:"text-sm text-muted-foreground",children:"Loading files..."}):et.length===0?a.jsx("div",{className:"text-sm text-muted-foreground",children:"No files uploaded yet."}):a.jsx("div",{className:"border rounded-md divide-y",children:et.map(J=>a.jsxs("div",{className:"flex items-center justify-between p-3",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx(eh,{checked:J.isEnabled??!0,onCheckedChange:()=>cr(J.id,J.isEnabled??!0),disabled:!d}),a.jsx("div",{className:"w-8 h-8 rounded bg-muted flex items-center justify-center",children:a.jsx(gd,{className:"w-4 h-4"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("div",{className:"truncate text-sm font-medium",children:J.name}),a.jsxs("div",{className:"text-xs text-muted-foreground",children:[(J.size/1024).toFixed(1)," KB  ",new Date(J.uploadedAt).toLocaleString()]})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`text-xs px-2 py-0.5 rounded ${J.status==="ready"?"bg-green-100 text-green-700":J.status==="uploading"?"bg-blue-100 text-blue-700":J.status==="processing"?"bg-amber-100 text-amber-700":"bg-red-100 text-red-700"}`,children:J.status==="uploading"?a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ht,{className:"w-3 h-3 animate-spin"}),"uploading"]}):J.status}),a.jsx(se,{size:"sm",variant:"outline",onClick:()=>ft(J),disabled:J.status==="uploading",children:"Download"}),a.jsx(se,{size:"sm",variant:"ghost",className:"text-red-600 hover:text-red-700",onClick:()=>Qn(J.id),disabled:J.status==="uploading"||!d,children:a.jsx(xa,{className:"w-4 h-4"})})]})]},J.id))})]})]}),a.jsxs(ir,{value:"qa",className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Q&A Knowledge"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Add questionanswer pairs the AI can reference."})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(se,{size:"sm",variant:"outline",onClick:$r,disabled:M||!d,className:"gap-2",children:[a.jsx(JT,{className:"w-4 h-4"}),"Save Q&A"]}),a.jsxs(se,{size:"sm",onClick:()=>{l("qa"),Lr()},className:"gap-2",disabled:!d,children:[a.jsx(zi,{className:"w-4 h-4"}),"Add Pair"]})]})]}),ur.length===0?a.jsx("div",{className:"text-sm text-muted-foreground",children:"No Q&A pairs. Click Add Pair to create one."}):a.jsx("div",{className:"space-y-3",children:ur.map(J=>a.jsx(He,{className:"p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx(it,{placeholder:"Question",value:J.question,onChange:Ae=>Us(J.id,"question",Ae.target.value),disabled:!d}),a.jsx(qr,{placeholder:"Answer",className:"min-h-[80px]",value:J.answer,onChange:Ae=>Us(J.id,"answer",Ae.target.value),disabled:!d})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[da(J)&&a.jsx(se,{variant:"outline",size:"sm",onClick:async Ae=>{Ae.preventDefault(),Ae.stopPropagation(),l("qa");try{await $({name:e,qna:ur.filter(Fe=>{var mt,V;return((mt=Fe.question)==null?void 0:mt.trim())||((V=Fe.answer)==null?void 0:V.trim())}).map(({question:Fe,answer:mt})=>({q:Fe.trim(),a:mt.trim()}))}),Fs(JSON.parse(JSON.stringify(ur))),ze.success("Q&A saved")}catch(Fe){ze.error((Fe==null?void 0:Fe.message)||"Failed to save Q&A")}},children:"Save"}),a.jsx(se,{variant:"ghost",size:"sm",className:"text-red-600 hover:text-red-700",onClick:()=>qo(J.id),disabled:!d,children:a.jsx(xa,{className:"w-4 h-4"})})]})]})},J.id))})]}),a.jsx(ir,{value:"product",children:a.jsxs("div",{className:"text-center py-12 text-muted-foreground",children:[a.jsx(XV,{className:"w-12 h-12 mx-auto mb-4 opacity-50"}),a.jsx("p",{children:"Product knowledge and catalog integration"})]})})]})})}),a.jsx(ir,{value:"integrations",children:a.jsxs(He,{className:"p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Integrations"}),a.jsx("p",{className:"text-muted-foreground",children:"Set up integrations with external services."})]})}),a.jsx(ir,{value:"followups",className:"space-y-6",children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Followups"}),a.jsxs("div",{className:"space-y-2 text-sm text-muted-foreground",children:[a.jsxs("p",{children:["Tambahkan pesan Followup yang akan dikirim kepada ",a.jsx("span",{className:"text-blue-600",children:"pelanggan setelah jeda waktu tertentu"}),"."]}),a.jsx("p",{children:"Isi dengan prompt. Prompt adalah arahan yang AI akan pakai untuk menulis Followup sesuai dengan history chat dan knowledge anda."}),a.jsx("p",{children:"Anda juga bisa menulis kondisi Handoff to Agent anda di Prompt"}),a.jsx("p",{className:"text-blue-600",children:"Anda bisa mengirim gambar di followup. Klik disini untuk Upload gambar."})]})]}),a.jsx("div",{className:"space-y-4",children:Qa.map((J,Ae)=>a.jsx(He,{className:"p-4",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium",children:"Prompt:"}),a.jsx(se,{variant:"ghost",size:"sm",onClick:()=>Te(J.id),className:"text-red-500 hover:text-red-700 hover:bg-red-50",disabled:!d,children:a.jsx(xa,{className:"w-4 h-4"})})]}),a.jsx(qr,{value:J.prompt,onChange:Fe=>ut(J.id,"prompt",Fe.target.value),className:"min-h-[80px]",placeholder:"Enter followup message...",disabled:!d}),a.jsx("div",{className:"flex items-center gap-4",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-sm font-medium",children:"Delay (min):"}),a.jsx(it,{type:"number",value:J.delay,onChange:Fe=>ut(J.id,"delay",parseInt(Fe.target.value)||1),className:"w-20",min:"1",disabled:!d})]})}),a.jsxs(pD,{children:[a.jsxs(gD,{onClick:()=>bt(J.id),className:"flex items-center gap-2 text-sm font-medium hover:text-primary",children:[a.jsx(Ma,{className:`w-4 h-4 transition-transform ${J.expanded?"rotate-180":""}`}),"Options"]}),a.jsx(vD,{className:"pt-4 data-[state=closed]:animate-collapsible-up data-[state=open]:animate-collapsible-down overflow-hidden",children:a.jsx("div",{className:"text-sm text-muted-foreground",children:"Additional options for this followup message can be configured here."})})]})]})},J.id))}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs(se,{onClick:yi,className:"gap-2",disabled:!d,children:[a.jsx(zi,{className:"w-4 h-4"}),"Add Followup"]})}),a.jsx(ge,{children:a.jsx("p",{children:"Tambah pesan tindak lanjut baru"})})]}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{className:"bg-green-600 hover:bg-green-700",disabled:!d,children:"Save Followups"})}),a.jsx(ge,{children:a.jsx("p",{children:"Simpan semua pesan tindak lanjut"})})]})]})]})}),a.jsx(ir,{value:"evaluation",children:a.jsxs(He,{className:"p-6",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Evaluation"}),a.jsx("p",{className:"text-muted-foreground",children:"Review AI agent performance metrics."})]})})]})]})},vv=e=>e==null?"Pricing on request":`${new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",maximumFractionDigits:e>=1?2:3}).format(e)} / 1M`,Vu=e=>e?e.charAt(0).toUpperCase()+e.slice(1):"Unknown",yv="00000000-0000-0000-0000-000000000001",X3e=({agent:e,onSettings:t,onDelete:n})=>a.jsxs(He,{className:"p-6 text-center space-y-4 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-muted flex items-center justify-center text-xl font-semibold text-muted-foreground",children:e.initials}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-lg",children:e.name}),a.jsx("p",{className:"text-sm text-muted-foreground",children:e.creator}),e.description&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:e.description}),(e.modelName||e.provider)&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.modelName?`Model: ${e.modelName}`:null,e.modelName&&e.provider?"  ":"",e.provider?`Provider: ${Vu(e.provider)}`:null]}),a.jsxs("div",{className:"space-y-1 mt-1",children:[a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Created: ",new Date(e.created_at).toLocaleDateString()]}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Super Agent: ",e.superAgentName??"Unassigned"]})]})]})]}),a.jsxs("div",{className:"flex gap-2 justify-center",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(nn,{permission:"ai_profiles.update",children:a.jsxs(se,{variant:"outline",size:"sm",className:"gap-2",onClick:()=>t(e),children:[a.jsx(xo,{className:"w-4 h-4"}),"Settings"]})})}),a.jsx(ge,{children:a.jsx("p",{children:"Konfigurasi pengaturan agen AI"})})]}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(nn,{permission:"ai_profiles.delete",children:a.jsxs(se,{variant:"outline",size:"sm",className:"gap-2 text-destructive hover:text-destructive",onClick:()=>n(e.id),children:[a.jsx(xa,{className:"w-4 h-4"}),"Delete"]})})}),a.jsx(ge,{children:a.jsx("p",{children:"Hapus agen AI ini"})})]})]})]}),J3e=({onClick:e})=>a.jsx(He,{className:"p-6 text-center space-y-4 hover:shadow-md transition-shadow bg-blue-600 text-white cursor-pointer group",onClick:e,children:a.jsxs("div",{className:"flex flex-col items-center justify-center h-full space-y-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-full bg-white/20 flex items-center justify-center group-hover:bg-white/30 transition-colors",children:a.jsx(zi,{className:"w-8 h-8"})}),a.jsx("h3",{className:"font-semibold text-lg",children:"Create New"})]})}),Q3e=()=>{var Oe,W;const[e,t]=p.useState(null),[n,r]=p.useState([]),[s,i]=p.useState(!0),[o,l]=p.useState(!1),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(""),[g,v]=p.useState("customer-service"),[y,x]=p.useState([]),[w,b]=p.useState([]),[_,k]=p.useState(!1),[j,S]=p.useState(null),[T,O]=p.useState(""),[A,N]=p.useState(""),[L,M]=p.useState(""),[B,$]=p.useState(""),[z,R]=p.useState("all"),[C,D]=p.useState("all"),[E,F]=p.useState("newest"),[I,P]=p.useState(0),[U,Z]=p.useState(0),[X,K]=p.useState(null),[ie,H]=p.useState(null),[he,me]=p.useState(!1),ae=p.useRef(!0);Ar();const{mode:Ne,superAgentId:de,loading:Q,error:fe}=Qz(),{agents:Be}=Ql(),[je,Ce]=p.useState(!1),[Ze,rt]=p.useState(null),Je=Ne==="super"&&!!de,te=q=>q.replace(/[%_\\]/g,Y=>`\\${Y}`).replace(/'/g,"''"),We=p.useMemo(()=>{const q=new Map;return[...y,...w].forEach(Y=>{q.set(Y.id,Y)}),q},[y,w]),{deleteProfile:Ue}=M9(),ue=(q,Y,ne)=>({id:q.id,name:q.name,initials:q.name.split(" ").map(_e=>_e.charAt(0)).join("").toUpperCase().slice(0,2),creator:"Admin",description:q.description||void 0,created_at:q.created_at,model:(q==null?void 0:q.model_id)??null,modelName:(Y==null?void 0:Y.display_name)??(Y==null?void 0:Y.model_name)??null,provider:(Y==null?void 0:Y.provider)??null,superAgentId:(q==null?void 0:q.super_agent_id)??null,superAgentName:ne??null}),xe=p.useCallback(async()=>{if(!Q){if(Ne==="none"){Z(0),K(null);return}try{let q=le.from("ai_profiles").select("id",{count:"exact",head:!0}).eq("org_id",yv);if(Ne==="super"||Ne==="agent"){if(!de){Z(0),K(null);return}q=q.eq("super_agent_id",de)}const{count:Y}=await q;if(Z(Y||0),(Y||0)>0){let ne=le.from("ai_profiles").select("created_at").order("created_at",{ascending:!1}).limit(1).eq("org_id",yv);(Ne==="super"||Ne==="agent")&&de&&(ne=ne.eq("super_agent_id",de));const{data:_e}=await ne.maybeSingle();K(_e?new Date(_e.created_at):null)}else K(null)}catch(q){console.error("Error fetching AI agent stats:",q)}}},[Ne,de,Q]),ce=p.useCallback(async()=>{if(Q){i(!0);return}try{if(ae.current?i(!0):l(!0),u(null),Ne==="none"){ae.current=!1,r([]),P(0),i(!1),l(!1),u(fe??"Tidak ada agen AI yang tersedia untuk akun ini.");return}let q=le.from("ai_profiles").select("*, ai_models:ai_models!ai_profiles_model_id_fkey(id, display_name, model_name, provider)",{count:"exact"}).eq("org_id",yv);if(Ne==="super"||Ne==="agent"){if(!de){ae.current=!1,r([]),P(0),i(!1),l(!1),u(fe??"Tidak ada agen AI yang tersedia untuk akun ini.");return}q=q.eq("super_agent_id",de)}if(B){const oe=te(B);q=q.or(`name.ilike.%${oe}%,description.ilike.%${oe}%`)}C!=="all"&&(q=q.eq("model",C)),z!=="all"&&(z==="unknown"?q=q.or("model.is.null,ai_models.provider.is.null"):q=q.eq("ai_models.provider",z)),E==="az"?q=q.order("name",{ascending:!0,nullsFirst:!1}):E==="oldest"?q=q.order("created_at",{ascending:!0}):q=q.order("created_at",{ascending:!1});const{data:Y,error:ne,count:_e}=await q;if(ne)throw ne;const Le=Array.from(new Set(Y.map(oe=>oe==null?void 0:oe.super_agent_id).filter(oe=>!!oe)));let be=new Map;if(Le.length){const{data:oe}=await le.from("v_human_agents").select("user_id, agent_name, email").in("user_id",Le);oe==null||oe.forEach(Ee=>{const Xe=Ee.agent_name||Ee.email||String(Ee.user_id).slice(0,8);be.set(Ee.user_id,Xe)})}P(_e||0);const ee=(Y||[]).map(oe=>ue(oe,oe.ai_models||(oe.model?We.get(oe.model):void 0),be.get(oe.super_agent_id??"")??null));r(ee)}catch(q){console.error("Error fetching AI agents:",q),u("Failed to load AI agents"),ze.error("Failed to load AI agents"),r([]),P(0)}finally{ae.current?(ae.current=!1,i(!1)):l(!1)}},[B,C,z,E,We,Ne,de,Q,fe]);p.useEffect(()=>{Je&&de&&(rt(de),Ce(!1))},[Je,de]);const qe=p.useMemo(()=>{const q=new Set;return[...y,...w].forEach(Y=>{Y.provider&&q.add(Y.provider)}),q.add("unknown"),Array.from(q).sort((Y,ne)=>Y.localeCompare(ne))},[y,w]),Se=p.useMemo(()=>{const q=new Map;return[...y,...w].forEach(Y=>{q.set(Y.id,Y.display_name||Y.model_name||"Unnamed")}),Array.from(q.entries()).sort((Y,ne)=>Y[1].localeCompare(ne[1]))},[y,w]);p.useEffect(()=>{const q=setTimeout(()=>$(L.trim()),250);return()=>clearTimeout(q)},[L]),p.useEffect(()=>{ce()},[ce]),p.useEffect(()=>{xe()},[xe]),p.useEffect(()=>{z!=="all"&&!qe.includes(z)&&R("all")},[z,qe]),p.useEffect(()=>{C!=="all"&&!Se.some(([q])=>q===C)&&D("all")},[C,Se]);const nt=q=>{const Y=n.find(ne=>ne.id===q);Y&&H(Y)},vt=async()=>{if(ie)try{me(!0),await Ue(ie.id),await Promise.all([ce(),xe()]),ze.success(`"${ie.name}" has been deleted successfully`),H(null)}catch(q){console.error("Error deleting agent:",q),u("Failed to delete AI agent"),ze.error("Failed to delete AI agent")}finally{me(!1)}},xt=()=>{h(!0)},wt=async()=>{var q,Y;if(!f.trim()){ze.error("Please enter an AI agent name");return}if(!T){ze.error("Please select an AI model");return}if(!Ze){ze.error("Please choose a Super Agent");return}try{const{data:ne,error:_e}=await le.from("ai_profiles").insert([{org_id:yv,name:f.trim(),description:null,system_prompt:"",welcome_message:"",transfer_conditions:"",stop_ai_after_handoff:!0,model_id:T,super_agent_id:Ze}]).select("id, name, created_at, model_id, super_agent_id").single();if(_e)throw _e;if(!ne)throw new Error("No data returned from insert");const be={id:ne==null?void 0:ne.id,name:ne.name||f.trim(),initials:((ne==null?void 0:ne.name)||f.trim()).split(" ").map(ee=>ee.charAt(0)).join("").toUpperCase().slice(0,2),creator:"Admin",created_at:(ne==null?void 0:ne.created_at)||new Date().toISOString(),model:(ne==null?void 0:ne.model_id)||T,modelName:((q=y.find(ee=>ee.id===((ne==null?void 0:ne.model_id)||T)))==null?void 0:q.display_name)||void 0,provider:((Y=y.find(ee=>ee.id===((ne==null?void 0:ne.model_id)||T)))==null?void 0:Y.provider)||null,superAgentId:(ne==null?void 0:ne.super_agent_id)||Ze,superAgentName:void 0};t(be),h(!1),m(""),v("customer-service"),rt(null),ze.success("AI agent created successfully"),ce(),xe()}catch(ne){console.error("Create AI Agent failed:",ne),ze.error((ne==null?void 0:ne.message)||"Failed to create AI agent")}},ht=p.useRef(!1),_t=p.useCallback(async()=>{try{k(!0),S(null);const{data:q,error:Y}=await le.from("ai_models").select("id, display_name, model_name, provider, cost_per_1m_tokens, is_active").eq("is_active",!0).order("display_name",{ascending:!0});if(Y)throw Y;const ne=q||[],_e=ne.filter(be=>(be.display_name||"").toLowerCase()!=="fallback"),Le=ne.filter(be=>(be.display_name||"").toLowerCase()==="fallback");x(_e),b(Le),ht.current||(_e.length>0&&O(be=>be||_e[0].id),Le.length>0&&N(be=>be||Le[0].id),ht.current=!0)}catch(q){console.error("Error loading AI models:",q),S("Failed to load AI models"),ze.error("Failed to load AI models")}finally{k(!1)}},[]);if(p.useEffect(()=>{_t()},[_t]),p.useEffect(()=>{ce()},[]),e)return a.jsx(Y3e,{agentName:e.name,onBack:()=>{t(null),ce(),xe()},profileId:e.id==="new"?void 0:e.id,initialModelId:e.model||void 0});if(s)return a.jsxs("div",{className:"flex items-center justify-center h-64",children:[a.jsx(Ht,{className:"w-8 h-8 animate-spin"}),a.jsx("span",{className:"ml-2",children:"Loading AI agents..."})]});const Wt=n.length,pe=qe.length?qe:[];return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center space-y-2",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"AI Agents"}),a.jsxs("div",{className:"text-muted-foreground max-w-2xl mx-auto",children:[a.jsx("p",{children:"Ini adalah halaman di mana Anda dapat mengunjungi AI yang telah Anda buat sebelumnya."}),a.jsx("p",{children:"Jangan ragu untuk membuat perubahan dan membuat chatbot sebanyak yang Anda inginkan kapan saja!"})]})]}),c&&a.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[a.jsxs("p",{className:"text-red-800 text-sm",children:["Error: ",c]}),a.jsx(se,{variant:"outline",size:"sm",className:"mt-2",onClick:ce,children:"Retry"})]}),a.jsxs("div",{className:"grid gap-3 rounded-lg border bg-card p-4 md:flex md:items-center md:justify-between",children:[a.jsxs("div",{className:"relative w-full md:w-72",children:[a.jsx(oi,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),a.jsx(it,{value:L,onChange:q=>M(q.target.value),placeholder:"Search AI agents...",className:"pl-9"})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs(tn,{value:z,onValueChange:R,children:[a.jsx(Jt,{className:"w-[160px] bg-background border",children:a.jsx(Gt,{placeholder:"Provider"})}),a.jsxs(Qt,{className:"bg-background border z-50",children:[a.jsx(st,{value:"all",children:"All providers"}),pe.map(q=>a.jsx(st,{value:q,children:q==="unknown"?"Unknown":Vu(q)},q))]})]}),a.jsxs(tn,{value:C,onValueChange:D,children:[a.jsx(Jt,{className:"w-[160px] bg-background border",children:a.jsx(Gt,{placeholder:"AI model"})}),a.jsxs(Qt,{className:"bg-background border z-50",children:[a.jsx(st,{value:"all",children:"All models"}),Se.map(([q,Y])=>a.jsx(st,{value:q,children:Y},q))]})]}),a.jsxs(tn,{value:E,onValueChange:q=>F(q),children:[a.jsx(Jt,{className:"w-[150px] bg-background border",children:a.jsx(Gt,{placeholder:"Sort"})}),a.jsxs(Qt,{className:"bg-background border z-50",children:[a.jsx(st,{value:"newest",children:"Newest first"}),a.jsx(st,{value:"oldest",children:"Oldest first"}),a.jsx(st,{value:"az",children:"Name AZ"})]})]})]})]}),a.jsxs("div",{className:"text-sm text-muted-foreground",children:["Showing ",Wt," of ",U," agents"]}),o&&!s&&a.jsxs("div",{className:"flex items-center justify-center gap-2 text-sm text-muted-foreground",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin"}),a.jsx("span",{children:"Updating list"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs(He,{className:"p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-primary",children:U}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Total AI Agents"})]}),a.jsxs(He,{className:"p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:Wt}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Matching Filters"})]}),a.jsxs(He,{className:"p-4 text-center",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:X?X.toLocaleDateString():"N/A"}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Last Created"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[n.map(q=>a.jsx(X3e,{agent:q,onSettings:t,onDelete:nt},q.id)),a.jsx(nn,{permission:"ai_profiles.create",children:a.jsx(J3e,{onClick:xt})})]}),Wt===0&&!s&&U===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"w-24 h-24 mx-auto mb-4 rounded-full bg-muted flex items-center justify-center",children:a.jsx(zi,{className:"w-12 h-12 text-muted-foreground"})}),a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No AI Agents Yet"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first AI agent to get started with automated customer support."}),a.jsxs(se,{onClick:xt,children:[a.jsx(zi,{className:"w-4 h-4 mr-2"}),"Create Your First AI Agent"]})]}),Wt===0&&!s&&U>0&&a.jsx("div",{className:"rounded-lg border border-dashed p-6 text-center text-sm text-muted-foreground",children:"No AI agents match your current filters. Try adjusting the search or filter settings above."}),a.jsx(nn,{permission:"ai_profiles.create",children:a.jsx(xn,{open:d,onOpenChange:h,children:a.jsxs(un,{className:"sm:max-w-[425px]",children:[a.jsx(dn,{children:a.jsx(hn,{className:"text-xl font-semibold",children:"Create New AI Agent"})}),a.jsxs("div",{className:"space-y-6 pt-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Name"}),a.jsx(it,{placeholder:"Enter AI name",value:f,onChange:q=>m(q.target.value),className:"w-full"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Super Agent *"}),Je?a.jsx(it,{readOnly:!0,disabled:!0,value:((Oe=Be.find(q=>q.user_id===de))==null?void 0:Oe.display_name)||((W=Be.find(q=>q.user_id===de))==null?void 0:W.email)||de||"Current super agent",className:"w-full"}):a.jsxs(Ii,{open:je,onOpenChange:Ce,children:[a.jsx(Ri,{asChild:!0,children:a.jsx(se,{variant:"outline",role:"combobox",className:"w-full justify-between",children:(()=>{const q=Be.find(Y=>Y.primaryRole==="super_agent"&&Y.user_id===Ze);return(q==null?void 0:q.display_name)||(q==null?void 0:q.email)||Ze||"Choose a super agent"})()})}),a.jsx(ni,{className:"w-[360px] p-0",children:a.jsxs(Dm,{children:[a.jsx(Lm,{placeholder:"Search super agents..."}),a.jsx($m,{children:"No super agents found."}),a.jsx(Fm,{children:Be.filter(q=>q.primaryRole==="super_agent").map(q=>a.jsx(Um,{onSelect:()=>{rt(q.user_id),Ce(!1)},children:a.jsx("span",{className:"ml-2",children:q.display_name||q.email||q.user_id.slice(0,8)})},q.user_id))})]})})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Super agents can only create AI Agents for themselves."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Template"}),a.jsxs(tn,{value:g,onValueChange:v,children:[a.jsx(Jt,{className:"w-full",children:a.jsx(Gt,{placeholder:"Select a template"})}),a.jsx(Qt,{})]}),g==="customer-service"&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"and sales inquiries for your business."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"AI Model"}),a.jsxs(tn,{value:T,onValueChange:O,disabled:_||y.length===0,children:[a.jsx(Jt,{className:"w-full py-3",children:T?(()=>{const q=y.find(Y=>Y.id===T);return q?a.jsx("span",{className:"flex w-full items-center gap-2 text-sm font-medium truncate pr-2",children:a.jsxs("span",{className:"truncate",children:[q.display_name||"Custom","  ",vv(q.cost_per_1m_tokens),"  ",Vu(q.provider)]})}):a.jsx(Gt,{placeholder:_?"Loading models...":"Select an AI model"})})():a.jsx(Gt,{placeholder:_?"Loading models...":"Select an AI model"})}),a.jsx(Qt,{side:"bottom",align:"start",sideOffset:4,children:y.map(q=>a.jsx(st,{value:q.id,children:a.jsxs("div",{className:"flex flex-col text-left",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm font-medium",children:[a.jsx("span",{children:q.display_name||"Custom"}),a.jsx("span",{className:"text-muted-foreground",children:vv(q.cost_per_1m_tokens)})]}),a.jsx("span",{className:"text-xs text-muted-foreground leading-tight",children:q.description||"No description available"}),a.jsxs("span",{className:"text-[11px] font-mono text-muted-foreground",children:[q.model_name,"  ",Vu(q.provider)]})]})},q.id))})]}),j&&a.jsx("p",{className:"text-xs text-destructive",children:j})]}),w.length>0&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:"Fallback Model"}),a.jsxs(tn,{value:A,onValueChange:N,disabled:_||w.length===0,children:[a.jsx(Jt,{className:"w-full py-3",children:A?(()=>{const q=w.find(Y=>Y.id===A);return q?a.jsx("span",{className:"flex w-full items-center gap-2 text-sm font-medium truncate pr-2",children:a.jsxs("span",{className:"truncate",children:[q.display_name||"Custom","  ",vv(q.cost_per_1m_tokens),"  ",Vu(q.provider)]})}):a.jsx(Gt,{placeholder:_?"Loading models...":"Select a fallback model"})})():a.jsx(Gt,{placeholder:_?"Loading models...":"Select a fallback model"})}),a.jsx(Qt,{side:"bottom",align:"start",sideOffset:4,children:w.map(q=>a.jsx(st,{value:q.id,children:a.jsxs("div",{className:"flex flex-col text-left",children:[a.jsxs("div",{className:"flex items-center justify-between text-sm font-medium",children:[a.jsx("span",{children:q.display_name||"Custom"}),a.jsx("span",{className:"text-muted-foreground",children:vv(q.cost_per_1m_tokens)})]}),a.jsx("span",{className:"text-xs text-muted-foreground leading-tight",children:q.description||"No description available"}),a.jsxs("span",{className:"text-[11px] font-mono text-muted-foreground",children:[q.model_name,"  ",Vu(q.provider)]})]})},q.id))})]})]}),a.jsx(se,{onClick:wt,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",disabled:!f.trim()||!T||!Ze,children:"Create AI Agent"})]})]})})})]}),a.jsx(Hb,{open:!!ie,onOpenChange:q=>{!q&&!he&&H(null)},children:a.jsxs(Jp,{children:[a.jsxs(Qp,{children:[a.jsx(eg,{children:"Delete AI Agent?"}),a.jsx(tg,{children:ie?`Are you sure you want to delete "${ie.name}"? This action cannot be undone.`:"Are you sure you want to delete this AI agent?"})]}),a.jsxs(Zp,{children:[a.jsx(rg,{disabled:he,children:"Cancel"}),a.jsx(ng,{onClick:vt,disabled:he,className:"bg-destructive hover:bg-destructive/90 focus:ring-destructive/50",children:he?a.jsxs("span",{className:"flex items-center gap-2",children:[a.jsx(Ht,{className:"w-4 h-4 animate-spin"}),"Deleting..."]}):"Delete"})]})]})})]})},L9=({className:e,...t})=>a.jsx("nav",{role:"navigation","aria-label":"pagination",className:Ie("mx-auto flex w-full justify-center",e),...t});L9.displayName="Pagination";const $9=p.forwardRef(({className:e,...t},n)=>a.jsx("ul",{ref:n,className:Ie("flex flex-row items-center gap-1",e),...t}));$9.displayName="PaginationContent";const Kv=p.forwardRef(({className:e,...t},n)=>a.jsx("li",{ref:n,className:Ie("",e),...t}));Kv.displayName="PaginationItem";const _E=({className:e,isActive:t,size:n="icon",...r})=>a.jsx("a",{"aria-current":t?"page":void 0,className:Ie(Hd({variant:t?"outline":"ghost",size:n}),e),...r});_E.displayName="PaginationLink";const F9=({className:e,...t})=>a.jsxs(_E,{"aria-label":"Go to previous page",size:"default",className:Ie("gap-1 pl-2.5",e),...t,children:[a.jsx(NN,{className:"h-4 w-4"}),a.jsx("span",{children:"Previous"})]});F9.displayName="PaginationPrevious";const U9=({className:e,...t})=>a.jsxs(_E,{"aria-label":"Go to next page",size:"default",className:Ie("gap-1 pr-2.5",e),...t,children:[a.jsx("span",{children:"Next"}),a.jsx(Mp,{className:"h-4 w-4"})]});U9.displayName="PaginationNext";const Z3e=e=>e.replace(/\s/g,"").toLowerCase(),yD=()=>{const[e,t]=p.useState(!1),[n,r]=p.useState(!1),[s,i]=p.useState(!1),[o,l]=p.useState(null),[c,u]=p.useState(!1),[d,h]=p.useState({enabled:!1,perDay:0,perMonth:0,twoFA:!1}),[f,m]=p.useState("7d"),[g,v]=p.useState("7d"),[y,x]=p.useState(null),[w,b]=p.useState(!1),[_,k]=p.useState(null),[j,S]=p.useState({}),[T,O]=p.useState(!1),[A,N]=p.useState(null),[L,M]=p.useState({name:"",email:"",role:"agent"}),[B,$]=p.useState(!1),[z,R]=p.useState(!1),[C,D]=p.useState(null),[E,F]=p.useState(!1),[I,P]=p.useState(!1),[U,Z]=p.useState(null),{toast:X}=uu(),K=p.useRef(null),{hasPermission:ie,hasRole:H}=Nr();H(yn.MASTER_AGENT);const he=H(yn.SUPER_AGENT),me=[yn.MASTER_AGENT,yn.SUPER_AGENT],[ae,Ne]=p.useState([]),[de,Q]=p.useState([]),[fe,Be]=p.useState(0),[je,Ce]=p.useState(0),[Ze,rt]=p.useState(1),[Je,te]=p.useState(1),[We,Ue]=p.useState(10),[ue,xe]=p.useState(10),[ce,qe]=p.useState(!1),[Se,nt]=p.useState(!1),[vt,xt]=p.useState("active"),[wt,ht]=p.useState({}),[_t,Wt]=p.useState(null),[pe,Oe]=p.useState(""),[W,q]=p.useState(""),[Y,ne]=p.useState("all"),[_e,Le]=p.useState("all"),[be,ee]=p.useState("all"),oe=H(yn.SUPER_AGENT)&&!H(yn.MASTER_AGENT);p.useEffect(()=>{const Te=setTimeout(()=>q(pe.trim()),300);return()=>clearTimeout(Te)},[pe]),p.useEffect(()=>{he&&vt!=="active"&&xt("active")},[he,vt]),p.useEffect(()=>{!H(yn.MASTER_AGENT)&&L.role==="super_agent"&&M({...L,role:"agent"})},[H,L.role]);const Ee=Te=>Te.replace(/[%_\\]/g,ut=>`\\${ut}`).replace(/'/g,"''"),{onlineUsers:Xe}=S3(),$e=(Te,ut)=>{const bt=Xe[Te];return bt?bt.status==="idle"?{color:"bg-orange-500",label:"Idle"}:{color:"bg-green-500",label:"Online"}:ut?{color:"bg-gray-400",label:`Seen ${Yse(new Date(ut),{addSuffix:!0,locale:Tie})}`}:{color:"bg-gray-300",label:"Offline"}},jt=L.name.trim()&&L.email.trim()&&(L.role!=="agent"||C),{agents:et,loading:It,error:Rt,fetchAgents:En,createAgent:Vn,updateAgentStatus:Ln,updateAgentRole:Yr,deleteAgent:Ca,setEnable2FAFlagForCreate:cr}=Ql();p.useEffect(()=>{Rt&&Rt!==K.current&&(X({title:"Error",description:Rt,variant:"destructive"}),K.current=Rt),Rt||(K.current=null)},[Rt,X]);const Tn=Te=>{if(!Te)return null;const ut=String(Te).toLowerCase();return ut.includes("master")?"master_agent":ut.includes("super")?"super_agent":ut.includes("agent")?"agent":null},pn=async({invited:Te,page:ut,pageSize:bt,search:Lt,role:Nt,activeStatus:Zn,pendingStatus:$r})=>{try{Te?nt(!0):qe(!0);const gn=(ut-1)*bt,Jr=gn+bt-1;let Et=le.from("v_human_agents").select("*",{count:"exact"});const $n=Lt?Ee(Lt):"";if($n&&(Et=Et.or(`agent_name.ilike.%${$n}%,email.ilike.%${$n}%`)),Nt&&Nt!=="all"){const V=Nt==="master_agent"?"%master%":Nt==="super_agent"?"%super%":"%agent%";Et=Et.ilike("role_name",V)}const Dt=H(yn.MASTER_AGENT);if(H(yn.SUPER_AGENT)){if(!A){Te?nt(!1):qe(!1);return}try{let V=le.from("super_agent_members").select("agent_user_id").eq("super_agent_id",A);_t&&(V=V.eq("org_id",_t));const{data:re}=await V,ke=[A,...(re||[]).map(Re=>String(Re.agent_user_id)).filter(Boolean)];ke.length>0?Et=Et.in("user_id",ke):Et=Et.eq("user_id",A)}catch{Et=Et.eq("user_id",A)}}else if(!Dt){Te?(Q([]),Ce(0),nt(!1)):(Ne([]),Be(0),qe(!1));return}Te?$r==="expired"?Et=Et.eq("confirmation_status","expired"):$r==="invited"?Et=Et.or("confirmation_status.is.null,confirmation_status.eq.invited,confirmation_status.eq.pending"):Et=Et.or("confirmation_status.is.null,confirmation_status.neq.accepted"):(Et=Et.eq("confirmation_status","accepted"),Zn&&Zn!=="all"&&(Et=Et.eq("is_active",Zn==="active")));const{data:Ae,count:Fe,error:mt}=await Et.order("agent_name",{ascending:!0}).range(gn,Jr);if(mt)throw mt;if(Te)Q(Ae||[]),Ce(Fe||0);else{const V=Ae||[];Ne(V),Be(Fe||0);try{const re=V.filter(ke=>String((ke==null?void 0:ke.role_name)||"").toLowerCase()==="agent").map(ke=>ke.user_id);if(re.length>0){let ke=le.from("super_agent_members").select("agent_user_id, super_agent_id").in("agent_user_id",re);_t&&(ke=ke.eq("org_id",_t));const{data:Re}=await ke,De={};(Re||[]).forEach(we=>{we!=null&&we.agent_user_id&&(De[String(we.agent_user_id)]=String(we.super_agent_id||""))}),ht(De)}else ht({})}catch{ht({})}}}catch(gn){X({title:"Error",description:(gn==null?void 0:gn.message)||"Failed to fetch agents",variant:"destructive"}),Te?(Q([]),Ce(0)):(Ne([]),Be(0))}finally{Te?nt(!1):qe(!1)}};p.useEffect(()=>{pn({invited:!1,page:Ze,pageSize:We,search:W,role:Y,activeStatus:_e})},[Ze,We,W,Y,_e]),p.useEffect(()=>{Ze!==1&&rt(1)},[W,Y,_e]),p.useEffect(()=>{vt==="pending"&&pn({invited:!0,page:Je,pageSize:ue,search:W,role:Y,pendingStatus:be})},[vt,Je,ue,W,Y,be]),p.useEffect(()=>{vt==="pending"&&Je!==1&&te(1)},[W,Y,be,vt]);const ua=(Te,ut,bt,Lt,Nt,Zn,$r,gn,Jr)=>a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"rounded-lg border bg-card",children:[a.jsxs("div",{className:`grid gap-4 p-4 border-b bg-muted/50 font-medium text-sm ${gn?"grid-cols-[240px,1fr,220px,120px,160px]":"grid-cols-[240px,1fr,180px,120px,120px,120px,120px]"}`,children:[a.jsx("div",{children:"Agent Name"}),a.jsx("div",{children:"Email"}),a.jsx("div",{children:"Role"}),!gn&&a.jsx("div",{children:"Token Usage"}),!gn&&a.jsx("div",{children:"Presence"}),a.jsx("div",{children:"Status"}),a.jsx("div",{children:"Action"})]}),a.jsx("div",{className:"divide-y",children:ut?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[a.jsx(Ht,{className:"w-4 h-4 animate-spin"}),a.jsx("span",{children:"Loading agents..."})]})}):Te.length===0?a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsxs("div",{className:"text-center",children:[a.jsx(EN,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["No ",gn?"Pending":"Active"," Agents"]}),a.jsx("p",{className:"text-muted-foreground",children:gn?"Invited users will appear here until they sign in.":"Create your first agent to get started."})]})}):!gn&&Jr?(()=>{const Et=Re=>String(Re||"").toLowerCase(),$n=Re=>Et(Re.role_name).includes("master"),Dt=Re=>Et(Re.role_name).includes("super"),J=Re=>{const De=Et(Re.role_name);return De==="agent"||De==="agent_only"},Ae=Te.filter($n),Fe=Te.filter(Dt),mt=Te.filter(J),V=Object.fromEntries(Fe.map(Re=>[String(Re.user_id),Re])),re={},ke=[];for(const Re of mt){const De=Jr[String(Re.user_id)];De&&V[De]?(re[De]=re[De]||[]).push(Re):ke.push(Re)}return a.jsxs(a.Fragment,{children:[Ae.map(Re=>{const De="master_agent",we={user_id:String(Re.user_id),email:Re.email||"",display_name:Re.agent_name||Re.email||"Unknown",avatar_url:Re.avatar_url||null,timezone:null,created_at:"",roles:[De],primaryRole:De,status:Re.is_active?"Active":"Inactive",super_agent_id:null};return a.jsxs("div",{className:"grid grid-cols-[240px,1fr,180px,120px,120px,120px,120px] gap-4 p-4 items-center hover:bg-muted/30 transition-colors bg-blue-50/30 dark:bg-transparent",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Da,{className:"h-8 w-8",children:a.jsx(La,{className:"text-xs bg-blue-100 text-blue-700",children:Qa(we.display_name||"U")})}),a.jsx("span",{className:"font-medium text-blue-600 dark:text-blue-400",children:we.display_name})]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:we.email||""}),a.jsx("div",{className:"flex items-center h-8",children:a.jsx(At,{className:`text-xs ${ms(we.primaryRole)} leading-none h-6 px-2 inline-flex items-center`,children:"Master Agent"})}),a.jsx("div",{className:"text-sm text-muted-foreground",children:""}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`h-2 w-2 rounded-full ${$e(we.user_id,we.last_seen_at).color}`}),a.jsx("span",{className:"text-xs",children:$e(we.user_id,we.last_seen_at).label})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs(xc,{children:[a.jsx(bc,{asChild:!0,children:a.jsxs(se,{variant:"ghost",size:"sm",className:"gap-2 h-8",disabled:we.primaryRole==="master_agent",children:[a.jsx("div",{className:`h-2 w-2 rounded-full ${we.status==="Active"?"bg-green-500":"bg-gray-400"}`}),a.jsx("span",{className:"text-xs",children:we.status}),we.primaryRole!=="master_agent"&&a.jsx(Ma,{className:"h-3 w-3"})]})}),a.jsxs(ul,{className:"bg-background border z-50",children:[a.jsx(ma,{onClick:()=>da(we.user_id,"Active"),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),"Active"]})}),a.jsx(ma,{onClick:()=>da(we.user_id,"Inactive"),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),"Inactive"]})})]})]})}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(nn,{permission:"users_profile.update_token_limit",roleBypass:me,children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-yellow-500 hover:bg-yellow-600 text-white",onClick:()=>Ja(we),title:"Edit limits",children:a.jsx(Ia,{className:"h-4 w-4"})})}),H(yn.MASTER_AGENT)&&a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-emerald-600 hover:bg-emerald-700 text-white",onClick:()=>qo(we),title:"View token usage",children:a.jsx(af,{className:"h-4 w-4"})}),yi(we)&&a.jsx(nn,{permission:"super_agents.delete",children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-red-600 hover:bg-red-700 text-white",onClick:()=>{Z(we),F(!0)},children:a.jsx(xa,{className:"h-4 w-4"})})})]})]},`master-${Re.user_id}`)}),Fe.map(Re=>{const De="super_agent",we={user_id:String(Re.user_id),email:Re.email||"",display_name:Re.agent_name||Re.email||"Unknown",avatar_url:Re.avatar_url||null,timezone:null,created_at:"",roles:[De],primaryRole:De,status:Re.is_active?"Active":"Inactive",super_agent_id:null},yt=re[String(Re.user_id)]||[];return a.jsxs("div",{className:"",children:[a.jsxs("div",{className:"grid grid-cols-[240px,1fr,180px,120px,120px,120px,120px] gap-4 p-4 items-center hover:bg-muted/30 transition-colors bg-green-50/30 dark:bg-transparent",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Da,{className:"h-8 w-8",children:a.jsx(La,{className:"text-xs bg-green-100 text-green-700",children:Qa(we.display_name||"U")})}),a.jsx("span",{className:"font-medium text-green-600 dark:text-green-400",children:we.display_name})]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:we.email||""}),a.jsx("div",{className:"flex items-center h-8",children:a.jsx(At,{className:`text-xs ${ms(we.primaryRole)} leading-none h-6 px-2 inline-flex items-center`,children:"Super Agent"})}),a.jsx("div",{className:"text-sm font-medium",children:T?"":(j[we.user_id]??0).toLocaleString()}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`h-2 w-2 rounded-full ${$e(we.user_id,we.last_seen_at).color}`}),a.jsx("span",{className:"text-xs",children:$e(we.user_id,we.last_seen_at).label})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs(xc,{children:[a.jsx(bc,{asChild:!0,children:a.jsxs(se,{variant:"ghost",size:"sm",className:"gap-2 h-8",disabled:we.primaryRole==="master_agent",children:[a.jsx("div",{className:`h-2 w-2 rounded-full ${we.status==="Active"?"bg-green-500":"bg-gray-400"}`}),a.jsx("span",{className:"text-xs",children:we.status}),we.primaryRole!=="master_agent"&&a.jsx(Ma,{className:"h-3 w-3"})]})}),a.jsxs(ul,{className:"bg-background border z-50",children:[a.jsx(ma,{onClick:()=>da(we.user_id,"Active"),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),"Active"]})}),a.jsx(ma,{onClick:()=>da(we.user_id,"Inactive"),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),"Inactive"]})})]})]})}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(nn,{permission:"users_profile.update_token_limit",roleBypass:me,children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-yellow-500 hover:bg-yellow-600 text-white",onClick:()=>Ja(we),title:"Edit limits",children:a.jsx(Ia,{className:"h-4 w-4"})})}),H(yn.MASTER_AGENT)&&a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-emerald-600 hover:bg-emerald-700 text-white",onClick:()=>qo(we),title:"View token usage",children:a.jsx(af,{className:"h-4 w-4"})}),yi(we)&&a.jsx(nn,{permission:"super_agents.delete",children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-red-600 hover:bg-red-700 text-white",onClick:()=>{Z(we),F(!0)},children:a.jsx(xa,{className:"h-4 w-4"})})})]})]}),yt.map(Pt=>{const Zt="agent",Sn={user_id:String(Pt.user_id),email:Pt.email||"",display_name:Pt.agent_name||Pt.email||"Unknown",avatar_url:Pt.avatar_url||null,timezone:null,created_at:"",roles:[Zt],primaryRole:Zt,status:Pt.is_active?"Active":"Inactive",super_agent_id:we.user_id};return a.jsxs("div",{className:"grid grid-cols-[240px,1fr,180px,120px,120px,120px,120px] gap-4 p-4 items-center hover:bg-muted/30 transition-colors bg-gray-50/30 dark:bg-transparent pl-12",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-6 h-6 flex items-center justify-center",children:a.jsx("div",{className:"w-4 h-4 border-l-2 border-b-2 border-gray-300 rounded-bl"})}),a.jsx(Da,{className:"h-8 w-8",children:a.jsx(La,{className:"text-xs bg-gray-100 text-gray-700",children:Qa(Sn.display_name||"U")})}),a.jsx("span",{className:"font-medium text-gray-600 dark:text-gray-300",children:Sn.display_name})]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:Sn.email||""}),a.jsx("div",{className:"flex items-center h-8",children:a.jsx(At,{className:`text-xs ${ms(Sn.primaryRole)} leading-none h-6 px-2 inline-flex items-center`,children:"Agent"})}),a.jsx("div",{className:"text-sm text-muted-foreground",children:""}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`h-2 w-2 rounded-full ${$e(Sn.user_id,Sn.last_seen_at).color}`}),a.jsx("span",{className:"text-xs",children:$e(Sn.user_id,Sn.last_seen_at).label})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs(xc,{children:[a.jsx(bc,{asChild:!0,children:a.jsxs(se,{variant:"ghost",size:"sm",className:"gap-2 h-8",disabled:Sn.primaryRole==="master_agent",children:[a.jsx("div",{className:`h-2 w-2 rounded-full ${Sn.status==="Active"?"bg-green-500":"bg-gray-400"}`}),a.jsx("span",{className:"text-xs",children:Sn.status}),Sn.primaryRole!=="master_agent"&&a.jsx(Ma,{className:"h-3 w-3"})]})}),a.jsxs(ul,{className:"bg-background border z-50",children:[a.jsx(ma,{onClick:()=>da(Sn.user_id,"Active"),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),"Active"]})}),a.jsx(ma,{onClick:()=>da(Sn.user_id,"Inactive"),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),"Inactive"]})})]})]})}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(nn,{permission:"users_profile.update_token_limit",roleBypass:me,children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-yellow-500 hover:bg-yellow-600 text-white",onClick:()=>Ja(Sn),title:"Edit limits",children:a.jsx(Ia,{className:"h-4 w-4"})})}),H(yn.MASTER_AGENT)&&a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-emerald-600 hover:bg-emerald-700 text-white",onClick:()=>qo(Sn),title:"View token usage",children:a.jsx(af,{className:"h-4 w-4"})}),yi(Sn)&&a.jsx(nn,{permission:"super_agents.delete",children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-red-600 hover:bg-red-700 text-white",onClick:()=>{Z(Sn),F(!0)},children:a.jsx(xa,{className:"h-4 w-4"})})})]})]},`agent-${Pt.user_id}`)})]},`super-${Re.user_id}`)}),ke.map(Re=>{const De="agent",we={user_id:String(Re.user_id),email:Re.email||"",display_name:Re.agent_name||Re.email||"Unknown",avatar_url:Re.avatar_url||null,timezone:null,created_at:"",roles:[De],primaryRole:De,status:Re.is_active?"Active":"Inactive",super_agent_id:null};return a.jsxs("div",{className:"grid grid-cols-[240px,1fr,180px,120px,120px,120px,120px] gap-4 p-4 items-center hover:bg-muted/30 transition-colors bg-orange-50/30 dark:bg-transparent",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Da,{className:"h-8 w-8",children:a.jsx(La,{className:"text-xs bg-orange-100 text-orange-700",children:Qa(we.display_name||"U")})}),a.jsx("span",{className:"font-medium text-orange-600 dark:text-orange-400",children:we.display_name})]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:we.email||""}),a.jsx("div",{className:"flex items-center h-8",children:a.jsx(At,{className:`text-xs ${ms(we.primaryRole)} leading-none h-6 px-2 inline-flex items-center`,children:"Agent (Unassigned)"})}),a.jsx("div",{className:"text-sm text-muted-foreground",children:""}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`h-2 w-2 rounded-full ${$e(we.user_id,we.last_seen_at).color}`}),a.jsx("span",{className:"text-xs",children:$e(we.user_id,we.last_seen_at).label})]}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsxs(xc,{children:[a.jsx(bc,{asChild:!0,children:a.jsxs(se,{variant:"ghost",size:"sm",className:"gap-2 h-8",disabled:we.primaryRole==="master_agent",children:[a.jsx("div",{className:`h-2 w-2 rounded-full ${we.status==="Active"?"bg-green-500":"bg-gray-400"}`}),a.jsx("span",{className:"text-xs",children:we.status}),we.primaryRole!=="master_agent"&&a.jsx(Ma,{className:"h-3 w-3"})]})}),a.jsxs(ul,{className:"bg-background border z-50",children:[a.jsx(ma,{onClick:()=>da(we.user_id,"Active"),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),"Active"]})}),a.jsx(ma,{onClick:()=>da(we.user_id,"Inactive"),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),"Inactive"]})})]})]})}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(nn,{permission:"users_profile.update_token_limit",roleBypass:me,children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-yellow-500 hover:bg-yellow-600 text-white",onClick:()=>Ja(we),title:"Edit limits",children:a.jsx(Ia,{className:"h-4 w-4"})})}),H(yn.MASTER_AGENT)&&a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-emerald-600 hover:bg-emerald-700 text-white",onClick:()=>qo(we),title:"View token usage",children:a.jsx(af,{className:"h-4 w-4"})}),yi(we)&&a.jsx(nn,{permission:"super_agents.delete",children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-red-600 hover:bg-red-700 text-white",onClick:()=>{Z(we),F(!0)},children:a.jsx(xa,{className:"h-4 w-4"})})})]})]},`unassigned-${Re.user_id}`)})]})})():Te.map(Et=>{const $n=Tn(Et.role_name),Dt={user_id:String(Et.user_id),email:Et.email||"",display_name:Et.agent_name||Et.email||"Unknown",avatar_url:Et.avatar_url||null,timezone:null,created_at:"",roles:$n?[$n]:[],primaryRole:$n,status:Et.is_active?"Active":"Inactive",super_agent_id:null},J=String(Et.confirmation_status||"").toLowerCase()==="expired";return a.jsxs("div",{className:`grid gap-4 p-4 items-center hover:bg-muted/30 transition-colors ${gn?"grid-cols-[240px,1fr,220px,120px,160px]":"grid-cols-[240px,1fr,180px,120px,120px,120px,120px]"}`,children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Da,{className:"h-8 w-8",children:a.jsx(La,{className:"text-xs",children:Qa(Dt.display_name||"U")})}),a.jsx("span",{className:"font-medium",children:Dt.display_name})]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:Dt.email||""}),a.jsx("div",{className:"flex items-center h-8",children:a.jsx(At,{className:`text-xs ${ms(Dt.primaryRole)} leading-none h-6 px-2 inline-flex items-center`,children:Dt.primaryRole==="master_agent"?"Master Agent":Dt.primaryRole==="super_agent"?"Super Agent":"Agent"})}),!gn&&a.jsx("div",{className:"text-sm text-muted-foreground",children:""}),!gn&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:`h-2 w-2 rounded-full ${$e(Dt.user_id,Dt.last_seen_at).color}`}),a.jsx("span",{className:"text-xs",children:$e(Dt.user_id,Dt.last_seen_at).label})]}),a.jsx("div",{className:"flex items-center gap-2",children:gn?a.jsx(At,{className:`text-xs leading-none h-6 px-2 inline-flex items-center ${J?"bg-red-100 text-red-700":"bg-amber-100 text-amber-700"}`,children:J?"Expired":"Invited"}):a.jsxs(xc,{children:[a.jsx(bc,{asChild:!0,children:a.jsxs(se,{variant:"ghost",size:"sm",className:"gap-2 h-8",disabled:Dt.primaryRole==="master_agent",children:[a.jsx("div",{className:`h-2 w-2 rounded-full ${Dt.status==="Active"?"bg-green-500":"bg-gray-400"}`}),a.jsx("span",{className:"text-xs",children:Dt.status}),Dt.primaryRole!=="master_agent"&&a.jsx(Ma,{className:"h-3 w-3"})]})}),a.jsxs(ul,{className:"bg-background border z-50",children:[a.jsx(ma,{onClick:()=>da(Dt.user_id,"Active"),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),"Active"]})}),a.jsx(ma,{onClick:()=>da(Dt.user_id,"Inactive"),children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-400"}),"Inactive"]})})]})]})}),a.jsxs("div",{className:"flex items-center gap-1",children:[!gn&&a.jsx(nn,{permission:"users_profile.update_token_limit",roleBypass:me,children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-yellow-500 hover:bg-yellow-600 text-white",onClick:()=>Ja(Dt),title:"Edit limits",children:a.jsx(Ia,{className:"h-4 w-4"})})}),H(yn.MASTER_AGENT)&&!gn&&a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-emerald-600 hover:bg-emerald-700 text-white",onClick:()=>qo(Dt),title:"View token usage",children:a.jsx(af,{className:"h-4 w-4"})}),gn?a.jsxs(a.Fragment,{children:[J&&a.jsx(nn,{permission:"super_agents.create",children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-blue-600 hover:bg-blue-700 text-white",onClick:async()=>{try{await le.functions.invoke("admin-create-user",{body:{email:Dt.email,full_name:Dt.display_name,role:Dt.primaryRole||"agent",reinvite:!0}}),X({title:"Reinvite sent",description:`${Dt.email}`}),pn({invited:!0,page:Lt,pageSize:Nt})}catch(Ae){X({title:"Error",description:(Ae==null?void 0:Ae.message)||"Failed to reinvite",variant:"destructive"})}},title:"Reinvite user",children:a.jsx($4,{className:"h-4 w-4"})})}),yi(Dt)&&a.jsx(nn,{permission:"super_agents.delete",children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-red-600 hover:bg-red-700 text-white",onClick:()=>{Z(Dt),F(!0)},children:a.jsx(xa,{className:"h-4 w-4"})})})]}):yi(Dt)&&a.jsx(nn,{permission:"super_agents.delete",children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-red-600 hover:bg-red-700 text-white",onClick:()=>{Z(Dt),F(!0)},children:a.jsx(xa,{className:"h-4 w-4"})})})]})]},Et.user_id)})})]}),a.jsxs("div",{className:"flex items-center justify-between gap-2",children:[a.jsx("div",{className:"text-sm text-muted-foreground",children:bt>0?a.jsxs("span",{children:["Showing ",Math.min((Lt-1)*Nt+1,bt),"",Math.min(Lt*Nt,bt)," of ",bt]}):a.jsx("span",{children:"0 results"})}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[a.jsx(Qe,{className:"text-sm text-muted-foreground",children:"Rows"}),a.jsxs(tn,{value:String(Nt),onValueChange:Et=>$r(Number(Et)),children:[a.jsx(Jt,{className:"h-8 w-[100px] bg-background border",children:a.jsx(Gt,{})}),a.jsxs(Qt,{className:"bg-background border z-50",children:[a.jsx(st,{value:"10",children:"10"}),a.jsx(st,{value:"20",children:"20"}),a.jsx(st,{value:"50",children:"50"})]})]})]}),a.jsx(L9,{children:a.jsxs($9,{children:[a.jsx(Kv,{children:a.jsx(F9,{className:Lt<=1?"pointer-events-none opacity-50":"",onClick:()=>Lt>1&&Zn(Lt-1),href:"#"})}),a.jsx(Kv,{children:a.jsxs("span",{className:"text-sm text-muted-foreground px-2",children:["Page ",Lt," of ",Math.max(1,Math.ceil((bt||0)/Math.max(1,Nt)))]})}),a.jsx(Kv,{children:a.jsx(U9,{className:Lt>=Math.max(1,Math.ceil((bt||0)/Math.max(1,Nt)))?"pointer-events-none opacity-50":"",onClick:()=>Lt<Math.max(1,Math.ceil((bt||0)/Math.max(1,Nt)))&&Zn(Lt+1),href:"#"})})]})})]})]})]}),Qn=async()=>{var Te,ut;if(!L.name||!L.email){X({title:"Error",description:"Please fill in all required fields",variant:"destructive"});return}if(L.role==="agent"&&!C){X({title:"Error",description:"Please select a Super Agent for this agent",variant:"destructive"});return}try{R(!0),cr(B);let bt=_t||null;if(!bt)try{const{data:Nt}=await le.auth.getUser(),{data:Zn}=await le.from("org_members").select("org_id").eq("user_id",((Te=Nt==null?void 0:Nt.user)==null?void 0:Te.id)||"").limit(1);bt=((ut=Zn==null?void 0:Zn[0])==null?void 0:ut.org_id)||null}catch{}const Lt=await Vn({full_name:L.name,email:L.email,role:L.role,super_agent_id:L.role==="agent"&&C||null,org_id:bt});M({name:"",email:"",role:"agent"}),D(null),$(!1),t(!1),X({title:"Success",description:"Agent created successfully"})}catch(bt){X({title:"Error",description:bt instanceof Error?bt.message:"Failed to create agent",variant:"destructive"})}finally{R(!1)}},ft=async Te=>{var ut,bt,Lt;try{if((U==null?void 0:U.primaryRole)==="master_agent"||(Lt=(bt=(ut=ae.find(Nt=>String(Nt.user_id)===Te))==null?void 0:ut.role_name)==null?void 0:bt.toLowerCase)!=null&&Lt.call(bt).includes("master")){X({title:"Error",description:"Master agent tidak dapat dihapus.",variant:"destructive"}),F(!1),Z(null);return}P(!0),await Ca(Te),X({title:"Success",description:"Agent deleted successfully"}),F(!1),Z(null),vt==="pending"?de.length<=1&&Je>1?te(Nt=>Math.max(1,Nt-1)):await pn({invited:!0,page:Je,pageSize:ue,search:W,role:Y,pendingStatus:be}):ae.length<=1&&Ze>1?rt(Nt=>Math.max(1,Nt-1)):await pn({invited:!1,page:Ze,pageSize:We,search:W,role:Y,activeStatus:_e})}catch(Nt){X({title:"Error",description:Nt instanceof Error?Nt.message:"Failed to delete agent",variant:"destructive"})}finally{P(!1)}},Ja=async Te=>{try{l(Te);const{data:ut,error:bt}=await le.from("users_profile").select("token_limit_enabled, max_tokens_per_day, max_tokens_per_month, is_2fa_email_enabled").eq("user_id",Te.user_id).maybeSingle();if(bt)throw bt;h({enabled:!!(ut!=null&&ut.token_limit_enabled),perDay:Number((ut==null?void 0:ut.max_tokens_per_day)??0),perMonth:Number((ut==null?void 0:ut.max_tokens_per_month)??0),twoFA:!!(ut!=null&&ut.is_2fa_email_enabled)}),r(!0)}catch(ut){X({title:"Error",description:(ut==null?void 0:ut.message)||"Failed to load token limits",variant:"destructive"})}},ur=async()=>{if(o)try{u(!0);const{error:Te}=await le.from("users_profile").update({token_limit_enabled:d.enabled,max_tokens_per_day:Math.max(0,Math.floor(d.perDay||0)),max_tokens_per_month:Math.max(0,Math.floor(d.perMonth||0)),is_2fa_email_enabled:d.twoFA}).eq("user_id",o.user_id);if(Te)throw Te;X({title:"Saved",description:"Token limits updated."}),r(!1)}catch(Te){X({title:"Error",description:(Te==null?void 0:Te.message)||"Failed to save token limits",variant:"destructive"})}finally{u(!1)}},Xr=Te=>{const ut=new Date;let bt;if(Te==="this_month")bt=new Date(Date.UTC(ut.getUTCFullYear(),ut.getUTCMonth(),1,0,0,0));else{const Nt=Te==="7d"?7:30;bt=new Date(Date.UTC(ut.getUTCFullYear(),ut.getUTCMonth(),ut.getUTCDate(),0,0,0)),bt.setUTCDate(bt.getUTCDate()-(Nt-1))}const Lt=ut;return{start:bt.toISOString(),end:Lt.toISOString()}},fs=async Te=>{try{O(!0);const ut=Lr.filter(Nt=>Nt.primaryRole==="super_agent").map(Nt=>Nt.user_id);if(ut.length===0){S({});return}let bt={};if(Te==="all")try{const{data:Nt}=await le.from("v_super_agent_token_usage").select("super_agent_id,total_tokens");for(const Zn of Nt||[]){const $r=String(Zn.super_agent_id||"");$r&&(bt[$r]=Number(Zn.total_tokens||0))}}catch{}else{const{start:Nt,end:Zn}=Xr(Te),{data:$r}=await le.from("token_usage_logs").select("id,channel_id,total_tokens,made_at").gte("made_at",Nt).lt("made_at",Zn),gn=Array.from(new Set(($r||[]).map($n=>$n.channel_id).filter(Boolean)));let Jr={};if(gn.length>0){const{data:$n}=await le.from("channels").select("id,super_agent_id").in("id",gn);Jr=Object.fromEntries(($n||[]).map(Dt=>[String(Dt.id),String(Dt.super_agent_id||"")]))}const Et=new Set;for(const $n of $r||[]){const Dt=String($n.id);if(Et.has(Dt))continue;Et.add(Dt);const J=String($n.channel_id||""),Ae=J&&Jr[J]||"";Ae&&(bt[Ae]=(bt[Ae]||0)+Number($n.total_tokens||0))}}const Lt={};for(const Nt of ut)Lt[Nt]=bt[Nt]||0;S(Lt)}catch(ut){X({title:"Error",description:(ut==null?void 0:ut.message)||"Failed to load usage",variant:"destructive"})}finally{O(!1)}};p.useEffect(()=>{et.length>0&&fs(f)},[et,f]),p.useEffect(()=>{(async()=>{var Te,ut;try{const{data:bt}=await le.auth.getUser();N(((Te=bt==null?void 0:bt.user)==null?void 0:Te.id)||null);try{const{data:Lt}=await le.from("org_members").select("org_id").eq("user_id",((ut=bt==null?void 0:bt.user)==null?void 0:ut.id)||"").limit(1).maybeSingle();Wt((Lt==null?void 0:Lt.org_id)||null)}catch{}}catch{}})()},[]),p.useEffect(()=>{A&&(pn({invited:!1,page:Ze,pageSize:We}),vt==="pending"&&pn({invited:!0,page:Je,pageSize:ue}))},[A]);const Fs=()=>H(yn.MASTER_AGENT)?et:H(yn.SUPER_AGENT)?A?et.filter(Te=>Te.primaryRole==="super_agent"&&Te.user_id===A||Te.primaryRole==="agent"&&Te.super_agent_id===A):[]:[],Lr=p.useMemo(()=>Fs(),[et,H,A]),qo=async Te=>{l(Te),i(!0),await Us(Te.user_id,g)},Us=async(Te,ut)=>{var bt;try{b(!0);const{start:Lt,end:Nt}=Xr(ut),Zn=((bt=et.find(re=>re.user_id===Te))==null?void 0:bt.super_agent_id)||null,$r=Zn?et.filter(re=>re.primaryRole==="agent"&&re.super_agent_id===Zn).map(re=>re.user_id):[Te],{data:gn}=await le.from("threads").select("id").in("assignee_user_id",$r).gte("created_at",Lt).lt("created_at",Nt),Jr=(gn||[]).map(re=>re.id),[Et,$n]=await Promise.all([Jr.length>0?le.from("token_usage_logs").select("id,total_tokens").in("thread_id",Jr).gte("made_at",Lt).lt("made_at",Nt):Promise.resolve({data:[]}),le.from("token_usage_logs").select("id,total_tokens").in("user_id",$r).gte("made_at",Lt).lt("made_at",Nt)]),Dt=new Set;let J=0;for(const re of[...Et.data||[],...$n.data||[]]){const ke=String(re.id);Dt.has(ke)||(Dt.add(ke),J+=Number(re.total_tokens||0))}x(J);const[Ae,Fe,mt,V]=await Promise.all([le.from("threads").select("id",{count:"exact",head:!0}).gte("created_at",Lt).lt("created_at",Nt).eq("assignee_user_id",Te),le.from("threads").select("id",{count:"exact",head:!0}).gte("created_at",Lt).lt("created_at",Nt).eq("assigned_by_user_id",Te),le.from("threads").select("id",{count:"exact",head:!0}).gte("created_at",Lt).lt("created_at",Nt).eq("resolved_by_user_id",Te),le.from("threads").select("id",{count:"exact",head:!0}).gte("created_at",Lt).lt("created_at",Nt).eq("assignee_user_id",Te).not("ai_handoff_at","is",null)]);k({assignedTo:Ae.count||0,assignedBy:Fe.count||0,resolvedBy:mt.count||0,handoverFromAI:V.count||0})}catch(Lt){x(null),k(null),X({title:"Error",description:(Lt==null?void 0:Lt.message)||"Failed to load usage",variant:"destructive"})}finally{b(!1)}},da=async(Te,ut)=>{try{const{error:bt}=await le.from("users_profile").update({is_active:ut==="Active"}).eq("user_id",Te);if(bt)throw bt;X({title:"Success",description:`Status changed to ${ut}`}),await En()}catch(bt){X({title:"Error",description:(bt==null?void 0:bt.message)||"Failed to change status",variant:"destructive"})}},Qa=Te=>Te.split(" ").map(ut=>ut[0]).join("").toUpperCase().slice(0,2),ms=Te=>Te==="master_agent"?"bg-blue-100 text-blue-700":Te==="super_agent"?"bg-emerald-100 text-emerald-700":"bg-gray-100 text-gray-700",yi=Te=>!(!Te||Te.primaryRole==="master_agent"||oe&&A&&Te.user_id===A);return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Human Agent Settings"}),a.jsx("p",{className:"text-muted-foreground",children:"Manage your human agents"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"hidden md:flex items-center gap-2",children:[a.jsx(Qe,{className:"text-sm text-muted-foreground",children:"Usage"}),a.jsxs(tn,{value:f,onValueChange:async Te=>{const ut=Te;m(ut);try{await fs(ut)}catch{}},children:[a.jsx(Jt,{className:"h-8 w-[160px] bg-background border",children:a.jsx(Gt,{placeholder:"Range"})}),a.jsxs(Qt,{className:"bg-background border z-50",children:[a.jsx(st,{value:"all",children:"All time"}),a.jsx(st,{value:"7d",children:"Last 7 days"}),a.jsx(st,{value:"30d",children:"Last 30 days"}),a.jsx(st,{value:"this_month",children:"This month"})]})]})]}),!he&&a.jsx(nn,{permission:"users_profile.create",fallback:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("span",{children:a.jsxs(se,{className:"gap-2 bg-blue-600 text-white",disabled:!0,children:[a.jsx(zi,{className:"h-4 w-4"}),"Create Agent"]})})}),a.jsx(ge,{children:a.jsx("p",{children:"You do not have permission to create agents."})})]}),children:a.jsxs(xn,{open:e,onOpenChange:t,children:[a.jsx(vC,{asChild:!0,children:a.jsxs(se,{className:"gap-2 bg-blue-600 hover:bg-blue-700 text-white",children:[a.jsx(zi,{className:"h-4 w-4"}),"Create Agent"]})}),a.jsxs(un,{className:"sm:max-w-md bg-background border",children:[a.jsx(dn,{children:a.jsx(hn,{children:"Create New Agent"})}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"agent-name",children:["Agent Name ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(it,{id:"agent-name",value:L.name,onChange:Te=>M({...L,name:Te.target.value}),placeholder:"Enter agent name"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"agent-email",children:["Email ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx(it,{id:"agent-email",type:"email",value:L.email,onChange:Te=>M({...L,email:Z3e(Te.target.value)}),onKeyDown:Te=>{Te.key===" "&&Te.preventDefault()},placeholder:"Enter email address"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{htmlFor:"agent-phone",children:"Phone (Optional)"}),a.jsx(it,{id:"agent-phone",type:"tel",value:L.phone||"",onChange:Te=>M({...L,phone:Te.target.value}),placeholder:"Enter phone number"})]}),a.jsxs("div",{className:"flex items-center gap-2 pt-1",children:[a.jsx(eh,{id:"agent-2fa",checked:B,onCheckedChange:Te=>$(!!Te)}),a.jsx(Qe,{htmlFor:"agent-2fa",className:"text-sm",children:"Enable email 2FA for this agent"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qe,{htmlFor:"agent-role",children:"Role"}),!H(yn.MASTER_AGENT)&&a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Hanya Master Agent yang dapat membuat Super Agent"})})]})]}),a.jsxs(tn,{value:L.role,onValueChange:Te=>M({...L,role:Te}),children:[a.jsx(Jt,{className:"bg-background border",children:a.jsx(Gt,{})}),a.jsxs(Qt,{className:"bg-background border z-50",children:[a.jsx(st,{value:"agent",children:"Agent"}),H(yn.MASTER_AGENT)&&a.jsx(st,{value:"super_agent",children:"Super Agent"})]})]})]}),L.role==="agent"&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{children:["Attach to Super Agent ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsxs(tn,{value:C||"",onValueChange:Te=>D(Te),children:[a.jsx(Jt,{className:"bg-background border",children:a.jsx(Gt,{placeholder:"Select Super Agent"})}),a.jsx(Qt,{className:"bg-background border z-50",children:et.filter(Te=>Te.primaryRole==="super_agent").map(Te=>a.jsx(st,{value:Te.user_id,children:Te.display_name||Te.email},Te.user_id))})]})]}),a.jsxs("div",{className:"text-sm text-muted-foreground",children:[a.jsxs("p",{children:["Fields marked with ",a.jsx("span",{className:"text-red-500",children:"*"})," are required."]}),L.role==="agent"&&a.jsx("p",{className:"mt-1",children:"Agents must be attached to a Super Agent."})]}),a.jsxs("div",{className:"flex gap-2 pt-4",children:[a.jsx(se,{onClick:Qn,className:"flex-1 bg-blue-600 hover:bg-blue-700 text-white",disabled:z||!jt,children:z?a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin"}),"Creating..."]}):"Create Agent"}),a.jsx(se,{variant:"outline",onClick:()=>t(!1),className:"flex-1",disabled:z,children:"Cancel"})]})]})]})]})})]})]}),a.jsxs("div",{className:"grid gap-3 rounded-lg border bg-card p-4 md:flex md:items-center md:justify-between",children:[a.jsxs("div",{className:"relative w-full md:w-64",children:[a.jsx(oi,{className:"pointer-events-none absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),a.jsx(it,{value:pe,onChange:Te=>Oe(Te.target.value),placeholder:"Search name or email",className:"pl-9"})]}),!he&&a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs(tn,{value:Y,onValueChange:Te=>ne(Te),children:[a.jsx(Jt,{className:"w-[150px] bg-background border",children:a.jsx(Gt,{placeholder:"Role"})}),a.jsxs(Qt,{className:"bg-background border z-50",children:[a.jsx(st,{value:"all",children:"All roles"}),a.jsx(st,{value:"master_agent",children:"Master Agent"}),a.jsx(st,{value:"super_agent",children:"Super Agent"}),a.jsx(st,{value:"agent",children:"Agent"})]})]}),vt==="pending"?a.jsxs(tn,{value:be,onValueChange:Te=>ee(Te),children:[a.jsx(Jt,{className:"w-[150px] bg-background border",children:a.jsx(Gt,{placeholder:"Invitation status"})}),a.jsxs(Qt,{className:"bg-background border z-50",children:[a.jsx(st,{value:"all",children:"All invitations"}),a.jsx(st,{value:"invited",children:"Invited"}),a.jsx(st,{value:"expired",children:"Expired"})]})]}):a.jsxs(tn,{value:_e,onValueChange:Te=>Le(Te),children:[a.jsx(Jt,{className:"w-[150px] bg-background border",children:a.jsx(Gt,{placeholder:"Status"})}),a.jsxs(Qt,{className:"bg-background border z-50",children:[a.jsx(st,{value:"all",children:"All statuses"}),a.jsx(st,{value:"active",children:"Active"}),a.jsx(st,{value:"inactive",children:"Inactive"})]})]})]})]}),a.jsxs(Gc,{value:vt,onValueChange:Te=>xt(Te),className:"space-y-6",children:[a.jsxs(Fl,{className:`grid w-full max-w-md ${he?"grid-cols-1":"grid-cols-2"}`,children:[a.jsxs(_r,{value:"active",className:"gap-2",children:[a.jsx(eG,{className:"h-4 w-4"}),"Active"]}),!he&&a.jsxs(_r,{value:"pending",className:"gap-2",children:[a.jsx(tG,{className:"h-4 w-4"}),"Pending"]})]}),a.jsx(ir,{value:"active",className:"space-y-4",children:ua(ae,ce||It,fe,Ze,We,rt,Ue,!1,wt)}),!he&&a.jsx(ir,{value:"pending",className:"space-y-4",children:ua(de,Se,je,Je,ue,te,xe,!0)})]}),a.jsx(xn,{open:E,onOpenChange:Te=>{I||F(Te)},children:a.jsxs(un,{className:"sm:max-w-md bg-background border",children:[a.jsx(dn,{children:a.jsx(hn,{children:"Delete Agent"})}),a.jsxs("div",{className:"space-y-3 py-2",children:[a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Are you sure you want to permanently delete ",(U==null?void 0:U.display_name)||"this agent","? This will remove their profile and role assignments. This action cannot be undone."]}),a.jsxs("div",{className:"rounded-md border p-3 bg-muted/30 text-sm",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-muted-foreground",children:"Name:"})," ",(U==null?void 0:U.display_name)||""]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-muted-foreground",children:"Email:"})," ",(U==null?void 0:U.email)||""]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-muted-foreground",children:"Role:"})," ",(U==null?void 0:U.primaryRole)||""]})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsx(se,{variant:"destructive",className:"flex-1",onClick:()=>U&&ft(U.user_id),disabled:I,children:I?a.jsxs("span",{className:"inline-flex items-center gap-2",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete"}),a.jsx(se,{variant:"outline",className:"flex-1",onClick:()=>F(!1),disabled:I,children:"Cancel"})]})]})]})}),a.jsx(xn,{open:n,onOpenChange:r,children:a.jsxs(un,{className:"sm:max-w-md bg-background border",children:[a.jsx(dn,{children:a.jsxs(hn,{children:["Token Limits",o?`  ${o.display_name||o.email}`:""]})}),a.jsxs("div",{className:"space-y-4 py-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(Qe,{className:"text-sm font-medium",children:"Enable Limits"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Block token-consuming actions when exceeded."})]}),a.jsx(Di,{checked:d.enabled,onCheckedChange:Te=>h({...d,enabled:!!Te})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(Qe,{className:"text-sm font-medium",children:"Require Email 2FA"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"User must enter a one-time code at sign-in."})]}),a.jsx(Di,{checked:d.twoFA,onCheckedChange:Te=>h({...d,twoFA:!!Te})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{htmlFor:"limit-day",children:"Max Tokens / Day"}),a.jsx(it,{id:"limit-day",type:"number",min:0,placeholder:"0",value:d.perDay===0?"":d.perDay,onChange:Te=>h({...d,perDay:Number(Te.target.value||"0")})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{htmlFor:"limit-month",children:"Max Tokens / Month"}),a.jsx(it,{id:"limit-month",type:"number",min:0,placeholder:"0",value:d.perMonth===0?"":d.perMonth,onChange:Te=>h({...d,perMonth:Number(Te.target.value||"0")})})]})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{onClick:ur,disabled:c,className:"flex-1 bg-green-600 hover:bg-green-700 text-white",children:"Save"})}),a.jsx(ge,{children:a.jsx("p",{children:"Simpan batas token"})})]}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"outline",onClick:()=>r(!1),className:"flex-1",children:"Cancel"})}),a.jsx(ge,{children:a.jsx("p",{children:"Batal"})})]})]})]})]})}),a.jsx(xn,{open:s,onOpenChange:i,children:a.jsxs(un,{className:"sm:max-w-md bg-background border",children:[a.jsx(dn,{children:a.jsxs(hn,{children:["Token Usage",o?`  ${o.display_name||o.email}`:""]})}),a.jsxs("div",{className:"space-y-4 py-2",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{children:"Timeframe"}),a.jsxs(tn,{value:g,onValueChange:async Te=>{const ut=Te;v(ut),o&&await Us(o.user_id,ut)},children:[a.jsx(Jt,{className:"bg-background border",children:a.jsx(Gt,{})}),a.jsxs(Qt,{className:"bg-background border z-50",children:[a.jsx(st,{value:"7d",children:"Last 7 days"}),a.jsx(st,{value:"30d",children:"Last 30 days"}),a.jsx(st,{value:"this_month",children:"This month"})]})]})]}),a.jsxs("div",{className:"rounded-md border p-4",children:[a.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Tokens"}),a.jsx("div",{className:"text-2xl font-bold",children:w?"":(y==null?void 0:y.toLocaleString())??0})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:"rounded-md border p-3",children:[a.jsx("div",{className:"text-sm text-muted-foreground",children:"Assigned To Agent"}),a.jsx("div",{className:"text-xl font-semibold",children:(_==null?void 0:_.assignedTo)??0})]}),a.jsxs("div",{className:"rounded-md border p-3",children:[a.jsx("div",{className:"text-sm text-muted-foreground",children:"Takeovers Initiated"}),a.jsx("div",{className:"text-xl font-semibold",children:(_==null?void 0:_.assignedBy)??0})]}),a.jsxs("div",{className:"rounded-md border p-3",children:[a.jsx("div",{className:"text-sm text-muted-foreground",children:"Resolved by Agent"}),a.jsx("div",{className:"text-xl font-semibold",children:(_==null?void 0:_.resolvedBy)??0})]}),a.jsxs("div",{className:"rounded-md border p-3",children:[a.jsx("div",{className:"text-sm text-muted-foreground",children:"AIAgent Handovers"}),a.jsx("div",{className:"text-xl font-semibold",children:(_==null?void 0:_.handoverFromAI)??0})]})]}),a.jsx("div",{className:"flex justify-end",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"outline",onClick:()=>i(!1),children:"Close"})}),a.jsx(ge,{children:a.jsx("p",{children:"Tutup"})})]})})]})]})})]})},e5e=e=>e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()),xD=e=>e==="read_own"?"Own":e==="read_all"?"All":e==="read_channel_owned"?"My Channels":e==="read_collaborator"?"Collaborator":e==="read"?"Read":e.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase()),t5e=({permissions:e,assignedPermissionIds:t,onToggle:n,isReadOnly:r=!1,className:s})=>{const[i,o]=p.useState(""),[l,c]=p.useState({}),[u,d]=p.useState(new Set),h=p.useMemo(()=>{const x={};return e.forEach(w=>{x[w.resource]||(x[w.resource]={}),x[w.resource][w.action]=w}),x},[e]),f=p.useMemo(()=>{const x=i.toLowerCase().trim();return x?Object.keys(id).filter(w=>w.toLowerCase().includes(x)?!0:id[w].some(_=>_.toLowerCase().includes(x))):Object.keys(id)},[i]),m=async(x,w)=>{if(!(r||u.has(x)))try{d(b=>new Set(b).add(x)),await n(x,w)}catch(b){console.error("Failed to toggle permission",b)}finally{d(b=>{const _=new Set(b);return _.delete(x),_})}},g=async(x,w)=>{if(r||l[x])return;const b=w.map(j=>{var S;return(S=h[x])==null?void 0:S[j]}).filter(j=>!!j);if(b.length===0)return;const k=!b.every(j=>t.includes(j.id));c(j=>({...j,[x]:!0}));try{const j=w.filter(M=>M==="read"||M.startsWith("read_")),S=b.filter(M=>!j.includes(M.action)),T=b.filter(M=>j.includes(M.action)),A=["read_own","read_channel_owned","read_collaborator","read_all","read"].findLast(M=>T.some(B=>B.action===M))||null,N=[];if(k){for(const M of S)t.includes(M.id)||N.push(n(M.id,!0));for(const M of T){const B=A?M.action===A:!1;t.includes(M.id)!==B&&N.push(n(M.id,B))}}else for(const M of[...S,...T])t.includes(M.id)&&N.push(n(M.id,!1));const L=5;for(let M=0;M<N.length;M+=L)await Promise.all(N.slice(M,M+L))}catch(j){console.error(`Failed to bulk toggle for ${x}`,j)}finally{c(j=>({...j,[x]:!1}))}},v=(x,w,b,_=!1)=>{var A;const k=(A=h[x])==null?void 0:A[w];if(!k)return null;const j=t.includes(k.id),S=cte(w),T=u.has(k.id)||l[x],O=b||xD(w);return a.jsxs("div",{className:Ie("flex items-center justify-between p-2 rounded-md transition-colors text-sm",j?"bg-primary/5":"hover:bg-muted/50",S&&j&&"bg-red-50 dark:bg-red-950/20"),children:[a.jsx("div",{className:"flex items-center gap-2 flex-1",children:a.jsxs(Qe,{htmlFor:k.id,className:Ie("cursor-pointer font-medium flex items-center gap-2",S?"text-red-600 dark:text-red-400":"text-foreground"),children:[O,S&&_&&a.jsx(oo,{className:"h-3 w-3 text-red-500"})]})}),a.jsx(Di,{id:k.id,checked:j,onCheckedChange:N=>m(k.id,N),disabled:r||T,className:Ie(S&&j&&"data-[state=checked]:bg-red-500")})]},w)},y=(x,w)=>{const b=w.filter(T=>T==="read"||T.startsWith("read_"));if(b.length===0)return null;const k=["read_own","read_channel_owned","read_collaborator","read_all","read"].filter(T=>b.includes(T)),j=k.findLast(T=>{var A,N;const O=(N=(A=h[x])==null?void 0:A[T])==null?void 0:N.id;return O?t.includes(O):!1})||null,S=async T=>{var A,N;if(r)return;const O=[];for(const L of k){const M=(A=h[x])==null?void 0:A[L];if(!M)continue;const B=t.includes(M.id),$=T===L;B!==$&&O.push(n(M.id,$))}if(T===null)for(const L of k){const M=(N=h[x])==null?void 0:N[L];if(!M)continue;t.includes(M.id)&&O.push(n(M.id,!1))}await Promise.all(O)};return a.jsx("div",{className:"space-y-2",children:a.jsxs("div",{className:"inline-flex flex-wrap items-center gap-1 rounded-md border p-1 bg-muted/30",children:[a.jsx(se,{size:"sm",variant:j===null?"default":"ghost",className:Ie("h-7 text-xs"),onClick:()=>S(null),disabled:r,children:"None"}),k.map(T=>{const O=xD(T),A=x==="threads"&&(T==="read_channel_owned"||T==="read_collaborator")||x==="messages"&&T==="read_collaborator",N=x==="threads"&&T==="read_channel_owned"?"Can view threads that belong to channels assigned to this agent.":x==="threads"&&T==="read_collaborator"?"Can view threads where the user is directly involved (assignee, creator, resolver, or collaborator).":x==="messages"&&T==="read_collaborator"?"Can view messages in threads where the user is involved as collaborator or assignee.":"",L=a.jsx(se,{size:"sm",variant:j===T?"default":"ghost",className:Ie("h-7 text-xs"),onClick:()=>S(T),disabled:r,children:O},T);return A?a.jsx(o1,{children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:L}),a.jsx(ge,{side:"top",children:a.jsx("div",{className:"max-w-xs text-xs",children:N})})]})},T):L})]})})};return a.jsxs("div",{className:Ie("space-y-6",s),children:[a.jsx("div",{className:"sticky top-0 z-10 bg-background/95 backdrop-blur pb-4 pt-2",children:a.jsxs("div",{className:"relative max-w-md",children:[a.jsx(oi,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),a.jsx(it,{placeholder:"Search resources or actions...",value:i,onChange:x=>o(x.target.value),className:"pl-9 bg-background"})]})}),a.jsxs("div",{className:"columns-1 md:columns-2 xl:columns-3 gap-6 space-y-6",children:[f.map(x=>{const w=id[x],b=w.map(N=>{var L;return(L=h[x])==null?void 0:L[N]}).filter(Boolean);if(b.length===0)return null;const _=b.every(N=>t.includes(N==null?void 0:N.id)),k=l[x],j=w.filter(N=>{const L=Bw(N);return["create","update","delete"].includes(L)}),S=w.filter(N=>Bw(N)==="read"),T=w.filter(N=>Bw(N)==="special"),O=S.filter(N=>N==="read"||N.startsWith("read_")),A=S.filter(N=>!O.includes(N));return a.jsx("div",{className:"break-inside-avoid mb-6",children:a.jsxs(He,{className:Ie("h-full border-t-4 shadow-sm",_?"border-t-primary":"border-t-muted"),children:[a.jsx(dt,{className:"pb-3 bg-muted/30 pt-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(ct,{className:"text-base font-semibold flex items-center gap-2",children:[x==="security"?a.jsx(xm,{className:"h-4 w-4 text-orange-500"}):x==="analytics"?a.jsx(oi,{className:"h-4 w-4 text-blue-500"}):a.jsx(bo,{className:"h-4 w-4 text-muted-foreground"}),e5e(x)]}),!r&&a.jsx(se,{variant:"ghost",size:"sm",className:"h-7 text-xs text-muted-foreground hover:text-primary",onClick:()=>g(x,w),disabled:k,children:k?"...":_?"Unselect All":"Select All"})]})}),a.jsxs(lt,{className:"pt-4 space-y-4",children:[j.length>0&&a.jsxs("div",{className:"space-y-1",children:[a.jsx("h4",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider mb-2",children:"Manage"}),a.jsx("div",{className:"grid gap-1",children:j.map(N=>v(x,N,x==="admin_panel"&&N==="update"?"Update Settings":void 0))})]}),S.length>0&&a.jsxs("div",{className:Ie(j.length>0&&"pt-2 border-t"),children:[a.jsx("div",{className:"flex items-center justify-between mb-2 mt-2",children:a.jsx("h4",{className:"text-xs font-semibold text-muted-foreground uppercase tracking-wider flex items-center gap-1",children:"Access Level"})}),O.length>0&&y(x,w),A.length>0&&a.jsx("div",{className:"mt-2 grid gap-1",children:A.map(N=>v(x,N))})]}),T.length>0&&a.jsxs("div",{className:Ie((j.length>0||S.length>0)&&"pt-2 border-t"),children:[a.jsx("h4",{className:"text-xs font-semibold text-orange-600/80 dark:text-orange-400/80 uppercase tracking-wider mb-2 mt-2 flex items-center gap-1",children:"Special Actions"}),a.jsx("div",{className:"grid gap-1",children:T.map(N=>{const M=v(x,N,x==="alerts"&&N==="ack"?"Acknowledge":x==="messages"&&N==="send"?"Send":void 0,!0);return x==="alerts"&&N==="ack"&&M?a.jsx(o1,{children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("div",{children:M})}),a.jsx(ge,{side:"top",children:a.jsx("div",{className:"max-w-xs text-xs",children:"Mark alerts as acknowledged on behalf of this role."})})]})},N):M})})]})]})]})},x)}),f.length===0&&a.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-center border-2 border-dashed rounded-lg",children:[a.jsx(oi,{className:"h-10 w-10 text-muted-foreground mb-3"}),a.jsx("h3",{className:"text-lg font-medium",children:"No matching permissions"}),a.jsx("p",{className:"text-muted-foreground text-sm",children:"Try adjusting your search terms."})]})]})]})},n5e=()=>{const[e,t]=p.useState([]),[n,r]=p.useState([]),[s,i]=p.useState([]),[o,l]=p.useState(!0),[c,u]=p.useState(null),[d,h]=p.useState("roles"),{toast:f}=uu(),{refreshRBAC:m,hasPermission:g,hasRole:v}=Nr(),[y,x]=p.useState({}),[w,b]=p.useState(!1),[_,k]=p.useState(null),[j,S]=p.useState(""),[T,O]=p.useState(""),[A,N]=p.useState(!1),[L,M]=p.useState(!1),[B,$]=p.useState(null),[z,R]=p.useState(!1),C=(c==null?void 0:c.name)==="master_agent",D=g("roles.create"),E=g("roles.update"),F=g("roles.delete"),I=g("roles.update"),P=g("roles.update"),U=async()=>{try{l(!0);const{data:Q,error:fe}=await le.from("roles").select("*").order("name");if(fe)throw fe;t(Q||[]);const{data:Be,error:je}=await le.from("permissions").select("*").order("resource",{ascending:!0});if(je)throw je;r(Be||[]);const{data:Ce,error:Ze}=await le.from("role_permissions").select("*");if(Ze)throw Ze;i(Ce||[])}catch(Q){console.error("Error fetching RBAC data:",Q),f({title:"Error",description:"Failed to fetch permissions data",variant:"destructive"})}finally{l(!1)}};p.useEffect(()=>{U()},[]);const Z=()=>{k(null),S(""),O(""),b(!0)},X=Q=>{k(Q),S(Q.name),O(Q.description),b(!0)},K=async()=>{try{if(N(!0),_){if(!E){f({title:"Forbidden",description:"You do not have permission to update roles",variant:"destructive"});return}const{error:Q}=await le.from("roles").update({name:j,description:T}).eq("id",_.id);if(Q)throw Q;try{await en({action:"roles.update",resource:"roles",resourceId:_.id,context:{name:j}})}catch{}f({title:"Saved",description:"Role updated"})}else{if(!D){f({title:"Forbidden",description:"You do not have permission to create roles",variant:"destructive"});return}const{data:Q,error:fe}=await le.from("roles").insert([{name:j,description:T}]).select("id").single();if(fe)throw fe;try{await en({action:"roles.create",resource:"roles",resourceId:(Q==null?void 0:Q.id)??null,context:{name:j}})}catch{}f({title:"Created",description:"Role created"})}b(!1),await U()}catch{f({title:"Error",description:"Failed to save role",variant:"destructive"})}finally{N(!1)}},ie=async Q=>{try{if(!F){f({title:"Forbidden",description:"You do not have permission to delete roles",variant:"destructive"});return}x(Be=>({...Be,[Q.id]:!0})),R(!0),await le.from("role_permissions").delete().eq("role_id",Q.id),await le.from("user_roles").delete().eq("role_id",Q.id);const{error:fe}=await le.from("roles").delete().eq("id",Q.id);if(fe)throw fe;try{await en({action:"roles.delete",resource:"roles",resourceId:Q.id})}catch{}f({title:"Deleted",description:"Role deleted"}),M(!1),$(null),await U()}catch{f({title:"Error",description:"Failed to delete role",variant:"destructive"})}finally{x(fe=>({...fe,[Q.id]:!1})),R(!1)}},H=(Q,fe)=>s.some(Be=>Be.role_id===Q&&Be.permission_id===fe),he=p.useRef(null),me=()=>{he.current&&clearTimeout(he.current),he.current=setTimeout(()=>{m().catch(()=>{})},250)},ae=async(Q,fe)=>{try{const Be=H(Q,fe),je=`${Q}:${fe}`;if(x(Ce=>({...Ce,[je]:!0})),Be){if(!P){f({title:"Forbidden",description:"You do not have permission to revoke role permissions",variant:"destructive"});return}const{error:Ce}=await le.rpc("revoke_role_permission",{p_role:Q,p_perm:fe});if(Ce)throw Ce;i(Ze=>Ze.filter(rt=>!(rt.role_id===Q&&rt.permission_id===fe)));try{await en({action:"rbac.revoke",resource:"rbac",context:{role_id:Q,permission_id:fe}})}catch{}}else{if(!I){f({title:"Forbidden",description:"You do not have permission to grant role permissions",variant:"destructive"});return}const{error:Ce}=await le.rpc("grant_role_permission",{p_role:Q,p_perm:fe});if(Ce)throw Ce;i(Ze=>[...Ze,{role_id:Q,permission_id:fe}]);try{await en({action:"rbac.grant",resource:"rbac",context:{role_id:Q,permission_id:fe}})}catch{}}me(),f({title:"Success",description:`Permission ${Be?"removed from":"added to"} role`})}catch(Be){console.error("Error updating role permission:",Be),f({title:"Error",description:"Failed to update permission",variant:"destructive"})}finally{const Be=`${Q}:${fe}`;x(je=>({...je,[Be]:!1}))}},Ne=Q=>s.filter(Be=>Be.role_id===Q).length,de=Q=>Q.replace("_"," ").toUpperCase();return o?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Role Permissions"}),a.jsx("p",{className:"text-muted-foreground",children:"Manage role permissions"})]}),a.jsx(nn,{permission:"roles.create",children:a.jsxs(se,{onClick:Z,children:[a.jsx(zi,{className:"h-4 w-4 mr-2"})," New Role"]})})]}),a.jsx("div",{className:"flex items-center justify-center py-8",children:a.jsxs("div",{className:"text-center",children:[a.jsx(bo,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4 animate-pulse"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading roles..."})]})})]}):d==="roles"?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"Role Permissions"}),a.jsx("p",{className:"text-muted-foreground",children:"Manage role permissions"})]}),a.jsxs(se,{onClick:Z,disabled:!D,title:D?void 0:"No permission: roles.create",children:[a.jsx(zi,{className:"h-4 w-4 mr-2"})," New Role"]})]}),a.jsxs(He,{className:"pt-2",children:[a.jsxs(dt,{children:[a.jsx(ct,{children:"Roles"}),a.jsx(Ts,{children:"Click on a role to manage its permissions"})]}),a.jsx(lt,{children:a.jsxs(Zb,{children:[a.jsx(e0,{children:a.jsxs(mo,{children:[a.jsx(tr,{children:"Role Name"}),a.jsx(tr,{children:"Description"}),a.jsx(tr,{children:"Permissions"}),a.jsx(tr,{children:"Actions"})]})}),a.jsx(t0,{children:e.map(Q=>a.jsxs(mo,{children:[a.jsx(qn,{className:"font-medium",children:a.jsx(At,{variant:"outline",children:de(Q.name)})}),a.jsx(qn,{children:Q.description}),a.jsx(qn,{children:a.jsxs(At,{variant:"secondary",children:[Ne(Q.id)," permissions"]})}),a.jsx(qn,{children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(nn,{permission:"roles.read",children:a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs(se,{variant:"outline",size:"sm",onClick:()=>{u(Q),h("configure")},children:[a.jsx(xo,{className:"h-4 w-4 mr-2"}),"Configure"]})}),a.jsx(ge,{children:a.jsx("p",{children:"Konfigurasi aturan akses untuk peran ini"})})]})}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(nn,{permission:"roles.update",children:a.jsx(se,{size:"sm",className:"h-8 w-8 p-0 bg-yellow-500 hover:bg-yellow-600 text-white",onClick:()=>X(Q),"aria-label":"Edit role",children:a.jsx(Ia,{className:"h-4 w-4"})})})}),a.jsx(ge,{children:a.jsx("p",{children:"Edit peran ini"})})]}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(nn,{permission:"roles.delete",children:a.jsx(se,{size:"sm",onClick:()=>{$(Q),M(!0)},disabled:!!y[Q.id],className:"h-8 w-8 p-0 bg-red-600 hover:bg-red-700 text-white","aria-label":"Delete role",children:a.jsx(xa,{className:"h-4 w-4"})})})}),a.jsx(ge,{children:a.jsx("p",{children:"Hapus peran ini"})})]})]})})]},Q.id))})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs(He,{children:[a.jsxs(dt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(ct,{className:"text-sm font-medium",children:"Total Roles"}),a.jsx(bo,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsx(lt,{children:a.jsx("div",{className:"text-2xl font-bold",children:e.length})})]}),a.jsxs(He,{children:[a.jsxs(dt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(ct,{className:"text-sm font-medium",children:"Total Permissions"}),a.jsx(xo,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsx(lt,{children:a.jsx("div",{className:"text-2xl font-bold",children:n.length})})]}),a.jsxs(He,{children:[a.jsxs(dt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx(ct,{className:"text-sm font-medium",children:"Resources"}),a.jsx(xo,{className:"h-4 w-4 text-muted-foreground"})]}),a.jsxs(lt,{children:[a.jsx("div",{className:"text-2xl font-bold",children:new Set(n.map(Q=>Q.resource)).size}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Unique resources"})]})]})]}),a.jsx(nn,{permission:"roles.update",children:a.jsx(xn,{open:w,onOpenChange:b,children:a.jsxs(un,{children:[a.jsx(dn,{children:a.jsx(hn,{children:_?"Edit Role":"Create Role"})}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Qe,{htmlFor:"rname",children:"Name"}),a.jsx(it,{id:"rname",value:j,onChange:Q=>S(Q.target.value),placeholder:"e.g. Super Agent"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(Qe,{htmlFor:"rdesc",children:"Description"}),a.jsx(it,{id:"rdesc",value:T,onChange:Q=>O(Q.target.value),placeholder:"Optional"})]}),a.jsxs("div",{className:"pt-2 flex justify-end gap-2",children:[a.jsx(se,{variant:"outline",onClick:()=>b(!1),children:"Cancel"}),a.jsx(se,{onClick:K,disabled:A||!j.trim()||(_?!E:!D),title:_?E?void 0:"No permission: roles.update":D?void 0:"No permission: roles.create",children:A?"Saving":"Save"})]})]})]})})}),a.jsx(nn,{permission:"roles.delete",children:a.jsx(xn,{open:L,onOpenChange:M,children:a.jsxs(un,{children:[a.jsxs(dn,{children:[a.jsx(hn,{children:"Delete Role"}),a.jsxs(Hr,{children:["This will permanently delete the role",B?` "${de(B.name)}"`:""," and all its permissions."]})]}),a.jsxs("div",{className:"pt-2 flex justify-end gap-2",children:[a.jsx(se,{variant:"outline",onClick:()=>M(!1),disabled:z,children:"Cancel"}),a.jsx(se,{variant:"destructive",onClick:()=>B&&ie(B),disabled:z||!F,title:F?void 0:"No permission: roles.delete",children:z?"Deleting":"Delete"})]})]})})})]}):d==="configure"&&c?a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-center justify-between",children:a.jsxs("div",{children:[a.jsx(se,{variant:"ghost",onClick:()=>h("roles"),className:"mb-2",children:" Back to Roles"}),a.jsxs("h1",{className:"text-2xl font-bold tracking-tight",children:["Configure ",de(c.name)]}),a.jsx("p",{className:"text-muted-foreground",children:c.description})]})}),C&&a.jsx(He,{children:a.jsxs(dt,{children:[a.jsx(ct,{children:"Root Role"}),a.jsx(Ts,{children:"Master Agent is a root role with full privileges across the system."})]})}),a.jsxs("div",{className:"py-4",children:[a.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Full Permission Matrix"}),a.jsx(t5e,{permissions:n,assignedPermissionIds:s.filter(Q=>Q.role_id===c.id).map(Q=>Q.permission_id),onToggle:async(Q,fe)=>{H(c.id,Q)!==fe&&await ae(c.id,Q)},isReadOnly:!I&&!P})]})]}):null},r5e={maxSize:100,dedupeWindow:1e3,batchWindow:100,maxBatchSize:10};class a5e{constructor(t={}){Kt(this,"queue",[]);Kt(this,"processing",!1);Kt(this,"pendingRequests",new Map);Kt(this,"config");this.config={...r5e,...t}}async enqueue(t,n={operation:"read"}){const{operation:r="read",endpoint:s,priority:i=0,dedupeKey:o}=n,l=o||this.generateDedupeKey(t,s),c=this.pendingRequests.get(l);if(c)return c;if(this.queue.length>=this.config.maxSize){this.queue.sort((g,v)=>v.priority-g.priority);const m=this.queue.pop();m&&m.reject(new Error("Request queue full"))}let u,d;const h=new Promise((m,g)=>{u=m,d=g});this.pendingRequests.set(l,h);const f={id:l,fn:t,priority:i,timestamp:Date.now(),operation:r,endpoint:s,resolve:u,reject:d};return this.queue.push(f),this.queue.sort((m,g)=>g.priority-m.priority),this.processQueue(),h.finally(()=>{this.pendingRequests.delete(l)}),h}async processQueue(){if(!(this.processing||this.queue.length===0)){this.processing=!0;try{for(;this.queue.length>0;){const t=this.getBatch();if(t.length===1){const n=t[0];try{const r=await n.fn();n.resolve(r)}catch(r){n.reject(r)}}else await Promise.allSettled(t.map(async n=>{try{const r=await n.fn();n.resolve(r)}catch(r){n.reject(r)}}))}}finally{this.processing=!1}}}getBatch(){if(this.queue.length===0)return[];const t=Date.now(),n=[],r=this.queue[0];for(let s=0;s<this.queue.length&&n.length<this.config.maxBatchSize;s++){const i=this.queue[s],o=t-i.timestamp;i.operation===r.operation&&o<=this.config.batchWindow&&(!r.endpoint||i.endpoint===r.endpoint)&&n.push(i)}return n.forEach(s=>{const i=this.queue.findIndex(o=>o.id===s.id);i>=0&&this.queue.splice(i,1)}),n}generateDedupeKey(t,n){return`${t.toString()}:${n||""}`.slice(0,100)}debounce(t,n=300,r={}){return new Promise((s,i)=>{let o=null,l=Date.now();const c=async()=>{try{const d=await this.enqueue(t,{...r,dedupeKey:`debounce:${r.endpoint||"default"}`});s(d)}catch(d){i(d)}},u=()=>{o&&clearTimeout(o),o=setTimeout(()=>{Date.now()-l>=n?c():u()},n)};u()})}getStats(){return{queueLength:this.queue.length,pendingRequests:this.pendingRequests.size,processing:this.processing}}clear(){this.queue.forEach(t=>{t.reject(new Error("Queue cleared"))}),this.queue=[],this.pendingRequests.clear()}}const bD=new a5e,wD=["#60a5fa","#2563eb","#1d4ed8","#10b981","#f59e0b","#ef4444"],ys=({label:e,description:t})=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{children:e}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-4 w-4 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:t})})]})]});function s5e(){const[e,t]=p.useState(an.getStats()),[n,r]=p.useState(null),[s,i]=p.useState(bD.getStats()),[o,l]=p.useState(fo.getStats()),[c,u]=p.useState(0),{hasPermission:d}=Nr(),[h,f]=p.useState(!1),[m,g]=p.useState(!1),[v,y]=p.useState(!1),[x,w]=p.useState(!1),[b,_]=p.useState(!1),[k,j]=p.useState(!1),[S,T]=p.useState(!1),[O,A]=p.useState(!1),[N,L]=p.useState(""),[M,B]=p.useState(an.getConfig()),[$,z]=p.useState(an.getConfig()),[R,C]=p.useState(zt.getConfig()),[D,E]=p.useState(zt.getConfig()),F=W=>Number.isFinite(W)?W.toFixed(3).replace(/\.?0+$/,""):"",[I,P]=p.useState(()=>F(zt.getConfig().minMultiplier)),[U,Z]=p.useState(()=>F(zt.getConfig().maxMultiplier)),[X,K]=p.useState({read:zt.getMultiplier("read"),write:zt.getMultiplier("write"),rpc:zt.getMultiplier("rpc"),auth:zt.getMultiplier("auth")});d("admin_panel.update"),p.useEffect(()=>{const W=setInterval(()=>{t(an.getStats()),i(bD.getStats()),l(fo.getStats()),B(an.getConfig()),C(zt.getConfig()),K({read:zt.getMultiplier("read"),write:zt.getMultiplier("write"),rpc:zt.getMultiplier("rpc"),auth:zt.getMultiplier("auth")})},1e3),q=()=>{t(an.getStats()),u(Y=>Y+1)};return an.on("stateChange",q),an.on("failure",q),an.on("success",q),ie(),()=>{clearInterval(W),an.off(q)}},[]);const ie=async()=>{try{const W=await y3();r(W)}catch(W){console.error("Failed to load metrics:",W)}},H=W=>{switch(W){case hc.CLOSED:return"bg-green-100 text-green-800 border-green-200";case hc.OPEN:return"bg-red-100 text-red-800 border-red-200";case hc.HALF_OPEN:return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},he=W=>{switch(W){case hc.CLOSED:return a.jsx(Ef,{className:"h-5 w-5 text-green-600"});case hc.OPEN:return a.jsx(oo,{className:"h-5 w-5 text-red-600"});case hc.HALF_OPEN:return a.jsx(HT,{className:"h-5 w-5 text-yellow-600"});default:return null}},me=()=>{f(!0)},ae=()=>{an.reset(),t(an.getStats()),u(W=>W+1),f(!1),L(" Circuit breaker berhasil direset!"),T(!0)},Ne=()=>{g(!0)},de=()=>{an.open(),t(an.getStats()),u(W=>W+1),g(!1),L(" Circuit breaker telah dibuka! Semua request database akan diblokir."),T(!0)},Q=()=>{y(!0)},fe=async()=>{try{await Em.forceFlush(),y(!1),L(" Metrik berhasil dikirim ke database!"),T(!0)}catch(W){y(!1),L(" Gagal mengirim metrik: "+(W instanceof Error?W.message:"Unknown error")),A(!0)}},Be=()=>{z(an.getConfig()),w(!0)},je=()=>{an.updateConfig($),B(an.getConfig()),w(!1),L(" Konfigurasi circuit breaker berhasil diperbarui!"),T(!0)},Ce=()=>{const W=zt.getConfig();E(W),P(F(W.minMultiplier)),Z(F(W.maxMultiplier)),_(!0)},Ze=()=>{zt.updateConfig(D),C(zt.getConfig()),K({read:zt.getMultiplier("read"),write:zt.getMultiplier("write"),rpc:zt.getMultiplier("rpc"),auth:zt.getMultiplier("auth")}),_(!1),L(" Konfigurasi adaptive rate limiter berhasil diperbarui!"),T(!0)},rt=e.totalRequests>0?((e.totalRequests-e.failures)/e.totalRequests*100).toFixed(1):"0",Je=D.baseConfig.read.limit,te=D.baseConfig.write.limit,We=D.baseConfig.rpc.limit,Ue=D.baseConfig.auth.limit,ue=D.minMultiplier,xe=D.maxMultiplier,ce=D.healthyLatencyThreshold,qe=D.stressLatencyThreshold,Se=D.adjustmentInterval,nt=Number.isFinite(Je)&&Je>=10&&Je<=1e3,vt=Number.isFinite(te)&&te>=5&&te<=500,xt=Number.isFinite(We)&&We>=5&&We<=200,wt=Number.isFinite(Ue)&&Ue>=2&&Ue<=100,ht=Number.isFinite(ue)&&ue>=.1&&ue<=1,_t=Number.isFinite(xe)&&xe>=1&&xe<=5,Wt=Number.isFinite(ce)&&ce>=50&&ce<=1e3,pe=Number.isFinite(qe)&&qe>=500&&qe<=1e4,Oe=Number.isFinite(Se)&&Se>=1e4&&Se<=6e5;return Array.from({length:10},(W,q)=>({time:new Date(Date.now()-(9-q)*6e4).toLocaleTimeString(),requests:Math.floor(Math.random()*50)+10,failures:Math.floor(Math.random()*5)})),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-semibold",children:"Circuit Breaker Status"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Monitor database protection and performance"})]}),a.jsxs(se,{variant:"outline",size:"sm",onClick:ie,children:[a.jsx(ab,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{className:"text-sm font-medium",children:a.jsx(ys,{label:"Circuit State",description:"Status circuit breaker saat ini: CLOSED (normal, semua request diizinkan), OPEN (terhenti, memblokir semua request untuk melindungi database), atau HALF_OPEN (testing, mencoba menghubungkan kembali)"})})}),a.jsxs(lt,{children:[a.jsxs("div",{className:`flex items-center gap-3 px-3 py-2 rounded-md border ${H(e.state)}`,children:[he(e.state),a.jsx("span",{className:"font-semibold",children:e.state})]}),a.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Changed: ",new Date(e.stateChangedAt).toLocaleTimeString()]})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{className:"text-sm font-medium",children:a.jsx(ys,{label:"Success Rate",description:"Persentase request database yang berhasil dari total request. Indikator kesehatan sistem - semakin tinggi semakin baik. Nilai rendah menunjukkan masalah potensial dengan database atau koneksi"})})}),a.jsxs(lt,{children:[a.jsxs("div",{className:"text-2xl font-semibold",children:[rt,"%"]}),a.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.totalRequests-e.failures," / ",e.totalRequests," requests"]})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{className:"text-sm font-medium",children:a.jsx(ys,{label:"Total Requests",description:"Jumlah total request database yang telah diproses sejak circuit breaker diinisialisasi. Termasuk request yang berhasil dan gagal"})})}),a.jsxs(lt,{children:[a.jsx("div",{className:"text-2xl font-semibold",children:e.totalRequests.toLocaleString()}),a.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.failures," failures, ",e.successes," successes"]})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{className:"text-sm font-medium",children:a.jsx(ys,{label:"Last Activity",description:"Waktu terakhir request database berhasil atau gagal. Membantu mengidentifikasi kapan masalah terakhir terjadi atau kapan sistem terakhir berfungsi normal"})})}),a.jsxs(lt,{children:[a.jsx("div",{className:"text-sm",children:e.lastSuccessTime?a.jsxs("div",{children:[a.jsx("span",{className:"text-green-600",children:"Last Success:"}),a.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(e.lastSuccessTime).toLocaleTimeString()})]}):null}),a.jsx("div",{className:"text-sm mt-2",children:e.lastFailureTime?a.jsxs("div",{children:[a.jsx("span",{className:"text-red-600",children:"Last Failure:"}),a.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(e.lastFailureTime).toLocaleTimeString()})]}):null})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{className:"text-sm font-medium flex items-center gap-2",children:[a.jsx(eP,{className:"h-4 w-4"}),a.jsx(ys,{label:"Request Queue",description:"Antrian request database yang menunggu untuk diproses. Membantu menangani beban tinggi dengan mengatur prioritas dan menghindari duplikasi request"})]})}),a.jsx(lt,{children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("span",{className:"text-sm flex items-center gap-1",children:["Queue Length:",a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Jumlah total request dalam antrian, termasuk yang menunggu dan sedang diproses"})})]}),a.jsx("span",{className:"font-semibold",children:s.queueLength})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("span",{className:"text-sm flex items-center gap-1",children:["Pending Requests:",a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Jumlah request yang menunggu untuk diproses, belum dieksekusi"})})]}),a.jsx("span",{className:"font-semibold",children:s.pendingRequests})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("span",{className:"text-sm flex items-center gap-1",children:["Processing:",a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Status apakah queue sedang memproses request atau idle"})})]}),a.jsx(At,{variant:s.processing?"default":"secondary",children:s.processing?"Yes":"No"})]})]})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{className:"text-sm font-medium flex items-center gap-2",children:[a.jsx(bo,{className:"h-4 w-4"}),a.jsx(ys,{label:"Rate Limiter (Adaptive)",description:"Sistem pembatas kecepatan request adaptif yang secara otomatis menyesuaikan limit berdasarkan kondisi sistem. Melindungi database dari traffic spike dan overload"})]})}),a.jsxs(lt,{children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("span",{className:"text-sm flex items-center gap-1",children:["Reads Limit:",a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})]})}),a.jsx(ge,{children:a.jsxs("p",{children:["Batas maksimal request baca data per menit (dinamis: ",zt.getEffectiveLimit("read")," request/menit, ",(X.read*100).toFixed(0),"% dari base ",R.baseConfig.read.limit,"). Limit menyesuaikan otomatis berdasarkan kondisi sistem"]})})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("span",{className:"font-semibold",children:[zt.getEffectiveLimit("read"),"/min"]}),a.jsxs("span",{className:"text-xs text-muted-foreground ml-1",children:["(",(X.read*100).toFixed(0),"%)"]})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("span",{className:"text-sm flex items-center gap-1",children:["Writes Limit:",a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})]})}),a.jsx(ge,{children:a.jsxs("p",{children:["Batas maksimal request tulis data per menit (dinamis: ",zt.getEffectiveLimit("write")," request/menit, ",(X.write*100).toFixed(0),"% dari base ",R.baseConfig.write.limit,"). Lebih ketat dari reads karena write lebih berisiko terhadap database"]})})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("span",{className:"font-semibold",children:[zt.getEffectiveLimit("write"),"/min"]}),a.jsxs("span",{className:"text-xs text-muted-foreground ml-1",children:["(",(X.write*100).toFixed(0),"%)"]})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("span",{className:"text-sm flex items-center gap-1",children:["RPC Limit:",a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})]})}),a.jsx(ge,{children:a.jsxs("p",{children:["Batas maksimal panggilan fungsi database (RPC) per menit (dinamis: ",zt.getEffectiveLimit("rpc")," request/menit, ",(X.rpc*100).toFixed(0),"% dari base ",R.baseConfig.rpc.limit,"). Fungsi database biasanya lebih berat dari query biasa"]})})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("span",{className:"font-semibold",children:[zt.getEffectiveLimit("rpc"),"/min"]}),a.jsxs("span",{className:"text-xs text-muted-foreground ml-1",children:["(",(X.rpc*100).toFixed(0),"%)"]})]})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("span",{className:"text-sm flex items-center gap-1",children:["Auth Limit:",a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})]})}),a.jsx(ge,{children:a.jsxs("p",{children:["Batas maksimal operasi autentikasi per menit (dinamis: ",zt.getEffectiveLimit("auth")," request/menit, ",(X.auth*100).toFixed(0),"% dari base ",R.baseConfig.auth.limit,")"]})})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("span",{className:"font-semibold",children:[zt.getEffectiveLimit("auth"),"/min"]}),a.jsxs("span",{className:"text-xs text-muted-foreground ml-1",children:["(",(X.auth*100).toFixed(0),"%)"]})]})]})]}),a.jsx("div",{className:"mt-3 pt-3 border-t text-xs text-muted-foreground",children:a.jsx("p",{children:" Limit berubah otomatis berdasarkan response time dan error rate sistem"})})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{className:"text-sm font-medium flex items-center gap-2",children:[a.jsx(Nw,{className:"h-4 w-4"}),a.jsx(ys,{label:"Cache",description:"Sistem penyimpanan sementara untuk hasil query database. Mengurangi beban database dengan menyimpan hasil yang sering digunakan dan meningkatkan kecepatan response"})]})}),a.jsx(lt,{children:a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("span",{className:"text-sm flex items-center gap-1",children:["Cached Entries:",a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Jumlah hasil query yang saat ini tersimpan di cache. Semakin banyak semakin baik untuk performa, selama tidak melebihi batas maksimal"})})]}),a.jsx("span",{className:"font-semibold",children:o.size})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsxs("span",{className:"text-sm flex items-center gap-1",children:["Max Size:",a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})]})}),a.jsx(ge,{children:a.jsx("p",{children:"Batas maksimal jumlah entry yang bisa disimpan di cache. Setelah mencapai limit, entry lama akan dihapus (LRU policy)"})})]}),a.jsx("span",{className:"font-semibold",children:o.maxSize})]}),a.jsx(se,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:()=>{fo.clear(),l(fo.getStats())},children:"Clear Cache"})]})})]})]}),n&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{className:"text-sm font-medium",children:a.jsx(ys,{label:"Operations by Type",description:"Distribusi operasi database berdasarkan jenis (read, write, RPC, auth). Membantu memahami pola penggunaan database dan mengidentifikasi jenis operasi yang paling banyak digunakan"})})}),a.jsx(lt,{className:"h-64",children:a.jsx(xs,{width:"100%",height:"100%",children:a.jsxs(bs,{data:Object.entries(n.operationsByType||{}).map(([W,q])=>({type:W,count:q})),children:[a.jsx(mS,{strokeDasharray:"3 3"}),a.jsx(pa,{dataKey:"type"}),a.jsx(ga,{}),a.jsx(or,{}),a.jsx(Gn,{dataKey:"count",fill:wD[1]})]})})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{className:"text-sm font-medium",children:a.jsx(ys,{label:"Circuit Breaker States",description:"Distribusi status circuit breaker saat operasi database dilakukan. Menunjukkan berapa banyak operasi yang terjadi pada setiap state (CLOSED, OPEN, HALF_OPEN)"})})}),a.jsx(lt,{className:"h-64",children:a.jsx(xs,{width:"100%",height:"100%",children:a.jsxs(bs,{data:Object.entries(n.circuitBreakerStates||{}).map(([W,q])=>({state:W,count:q})),children:[a.jsx(mS,{strokeDasharray:"3 3"}),a.jsx(pa,{dataKey:"state"}),a.jsx(ga,{}),a.jsx(or,{}),a.jsx(Gn,{dataKey:"count",fill:wD[3]})]})})})]})]}),a.jsxs(nn,{permission:"admin_panel.update",children:[a.jsxs(He,{className:"mb-4",children:[a.jsx(dt,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(ct,{className:"text-sm font-medium",children:a.jsx(ys,{label:"Limit Configuration",description:"Konfigurasi threshold dan timeout untuk circuit breaker. Klik Edit untuk mengubah nilai-nilai ini"})}),a.jsxs(se,{variant:"outline",size:"sm",onClick:Be,children:[a.jsx(Ia,{className:"h-4 w-4 mr-2"}),"Edit"]})]})}),a.jsx(lt,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Failure Threshold"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsxs("p",{children:["Buka circuit setelah ",M.failureThreshold," kegagalan"]})})]})]}),a.jsx(it,{value:M.failureThreshold,disabled:!0,className:"font-mono"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Buka circuit setelah ",M.failureThreshold," kegagalan"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Reset Timeout (ms)"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsxs("p",{children:["Tunggu ",(M.resetTimeout/1e3).toFixed(0),"s sebelum uji pemulihan"]})})]})]}),a.jsx(it,{value:M.resetTimeout,disabled:!0,className:"font-mono"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Tunggu ",(M.resetTimeout/1e3).toFixed(0),"s sebelum uji pemulihan"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Success Threshold"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsxs("p",{children:["Tutup circuit setelah ",M.successThreshold," sukses"]})})]})]}),a.jsx(it,{value:M.successThreshold,disabled:!0,className:"font-mono"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Tutup circuit setelah ",M.successThreshold," sukses"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Monitoring Period (ms)"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsxs("p",{children:["Jendela waktu: ",(M.monitoringPeriod/1e3).toFixed(0),"s"]})})]})]}),a.jsx(it,{value:M.monitoringPeriod,disabled:!0,className:"font-mono"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Jendela waktu: ",(M.monitoringPeriod/1e3).toFixed(0),"s"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Request Timeout (ms)"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsxs("p",{children:["Timeout request: ",(M.timeout/1e3).toFixed(0),"s"]})})]})]}),a.jsx(it,{value:M.timeout,disabled:!0,className:"font-mono"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Timeout request: ",(M.timeout/1e3).toFixed(0),"s"]})]})]})})]}),a.jsxs(He,{className:"mb-4",children:[a.jsx(dt,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(ct,{className:"text-sm font-medium",children:a.jsx(ys,{label:"Adaptive Rate Limiter Configuration",description:"Konfigurasi untuk adaptive rate limiter yang secara otomatis menyesuaikan limit berdasarkan kondisi sistem. Menangani traffic spike dengan lebih baik"})}),a.jsxs(se,{variant:"outline",size:"sm",onClick:Ce,children:[a.jsx(Ia,{className:"h-4 w-4 mr-2"}),"Edit"]})]})}),a.jsxs(lt,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Reads Base Limit"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Limit dasar untuk operasi read. Limit aktual akan disesuaikan secara otomatis berdasarkan kondisi sistem"})})]})]}),a.jsx(it,{value:R.baseConfig.read.limit,disabled:!0,className:"font-mono"}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"text-muted-foreground",children:"Effective:"}),a.jsxs("span",{className:"font-semibold",children:[zt.getEffectiveLimit("read"),"/min"]}),a.jsxs("span",{className:"text-green-600",children:["(",(X.read*100).toFixed(0),"%)"]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Writes Base Limit"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Limit dasar untuk operasi write. Limit aktual akan disesuaikan secara otomatis berdasarkan kondisi sistem"})})]})]}),a.jsx(it,{value:R.baseConfig.write.limit,disabled:!0,className:"font-mono"}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"text-muted-foreground",children:"Effective:"}),a.jsxs("span",{className:"font-semibold",children:[zt.getEffectiveLimit("write"),"/min"]}),a.jsxs("span",{className:"text-green-600",children:["(",(X.write*100).toFixed(0),"%)"]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"RPC Base Limit"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Limit dasar untuk operasi RPC. Limit aktual akan disesuaikan secara otomatis berdasarkan kondisi sistem"})})]})]}),a.jsx(it,{value:R.baseConfig.rpc.limit,disabled:!0,className:"font-mono"}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"text-muted-foreground",children:"Effective:"}),a.jsxs("span",{className:"font-semibold",children:[zt.getEffectiveLimit("rpc"),"/min"]}),a.jsxs("span",{className:"text-green-600",children:["(",(X.rpc*100).toFixed(0),"%)"]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Auth Base Limit"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Limit dasar untuk operasi autentikasi. Limit aktual akan disesuaikan secara otomatis berdasarkan kondisi sistem"})})]})]}),a.jsx(it,{value:R.baseConfig.auth.limit,disabled:!0,className:"font-mono"}),a.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[a.jsx("span",{className:"text-muted-foreground",children:"Effective:"}),a.jsxs("span",{className:"font-semibold",children:[zt.getEffectiveLimit("auth"),"/min"]}),a.jsxs("span",{className:"text-green-600",children:["(",(X.auth*100).toFixed(0),"%)"]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 pt-4 border-t",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Min Multiplier"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Multiplier minimum (misal: 0.5 = 50% dari base limit). Digunakan saat sistem dalam kondisi stres"})})]})]}),a.jsx(it,{value:R.minMultiplier,disabled:!0,className:"font-mono"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Minimum: ",(R.minMultiplier*100).toFixed(0),"% dari base"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Max Multiplier"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Multiplier maksimum (misal: 2.0 = 200% dari base limit). Digunakan saat sistem dalam kondisi sehat"})})]})]}),a.jsx(it,{value:R.maxMultiplier,disabled:!0,className:"font-mono"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Maximum: ",(R.maxMultiplier*100).toFixed(0),"% dari base"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Healthy Latency Threshold (ms)"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Response time di bawah ini dianggap sehat. Sistem akan meningkatkan limit (min: 50ms, max: 1000ms)"})})]})]}),a.jsx(it,{value:R.healthyLatencyThreshold,disabled:!0,className:"font-mono"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[(R.healthyLatencyThreshold/1e3).toFixed(1)," seconds"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Stress Latency Threshold (ms)"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Response time di atas ini dianggap stres. Sistem akan menurunkan limit (min: 500ms, max: 10000ms)"})})]})]}),a.jsx(it,{value:R.stressLatencyThreshold,disabled:!0,className:"font-mono"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[(R.stressLatencyThreshold/1e3).toFixed(1)," seconds"]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qe,{className:"text-xs text-muted-foreground",children:"Adjustment Interval (ms)"}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Frekuensi pengecekan dan penyesuaian limit (dalam milliseconds)"})})]})]}),a.jsx(it,{value:R.adjustmentInterval,disabled:!0,className:"font-mono"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Setiap ",(R.adjustmentInterval/1e3).toFixed(0)," detik"]})]})]}),a.jsx("div",{className:"mt-4 bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800 rounded-lg p-3",children:a.jsxs("p",{className:"text-xs text-green-700 dark:text-green-300",children:[" ",a.jsx("strong",{children:"Status:"})," Adaptive rate limiter aktif dan melindungi database. Limit akan otomatis menyesuaikan berdasarkan metrik sistem (response time, error rate)."]})})]})]}),a.jsx(He,{className:"mb-4 bg-blue-50 dark:bg-blue-950/10 border-blue-200 dark:border-blue-800",children:a.jsx(dt,{children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsxs(ct,{className:"text-sm font-medium flex items-center gap-2 text-blue-700 dark:text-blue-300",children:[a.jsx(Rv,{className:"h-5 w-5"}),"Dokumentasi Circuit Breaker"]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Pelajari cara kerja circuit breaker dan apa yang harus dilakukan jika terjadi masalah"})]}),a.jsxs(se,{variant:"outline",size:"sm",onClick:()=>j(!0),children:[a.jsx(Rv,{className:"h-4 w-4 mr-2"}),"Lihat Dokumentasi Circuit Breaker"]})]})})}),a.jsxs(He,{className:"border-red-200 dark:border-red-800",children:[a.jsx(dt,{children:a.jsxs(ct,{className:"text-sm font-medium flex items-center gap-2 text-red-600 dark:text-red-400",children:[a.jsx(P4,{className:"h-5 w-5"}),a.jsx(ys,{label:"Danger Zone",description:"Tindakan berbahaya yang dapat mempengaruhi seluruh aplikasi. Gunakan dengan sangat hati-hati!"})]})}),a.jsxs(lt,{children:[a.jsxs("div",{className:"flex flex-wrap gap-3",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"outline",onClick:me,children:"Reset Circuit Breaker"})}),a.jsx(ge,{children:a.jsx("p",{children:"Reset semua statistik dan state circuit breaker ke kondisi awal. Menghapus riwayat kegagalan dan mengembalikan state ke CLOSED"})})]}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"destructive",onClick:Ne,children:"Manually Open Circuit"})}),a.jsx(ge,{children:a.jsx("p",{children:"Paksa buka circuit breaker secara manual. Akan MEMBLOKIR SEMUA REQUEST DATABASE dan menyebabkan aplikasi berhenti berfungsi. Gunakan hanya dalam keadaan darurat!"})})]}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(se,{variant:"outline",onClick:Q,children:"Flush Metrics"})}),a.jsx(ge,{children:a.jsx("p",{children:"Kirim semua metrik yang tertunda ke database secara paksa. Tidak berbahaya, hanya memperbarui data metrik di Supabase"})})]})]}),a.jsx("div",{className:"mt-4 bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:a.jsxs("p",{className:"text-xs text-red-700 dark:text-red-300 font-semibold",children:[" ",a.jsx("strong",{children:"PERINGATAN KRITIS:"})," Tindakan di zona ini dapat menghentikan seluruh aplikasi dan memblokir semua operasi database. Gunakan dengan sangat hati-hati dan hanya jika benar-benar diperlukan!"]})})]})]})]}),a.jsx(xn,{open:h,onOpenChange:f,children:a.jsxs(un,{className:"max-w-md",children:[a.jsxs(dn,{children:[a.jsxs(hn,{className:"flex items-center gap-2",children:[a.jsx(oo,{className:"h-5 w-5 text-orange-500"}),"Reset Circuit Breaker"]}),a.jsx(Hr,{children:"Apakah Anda yakin ingin mereset circuit breaker?"})]}),a.jsx("div",{className:"py-4",children:a.jsxs("div",{className:"bg-orange-50 dark:bg-orange-950/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4 space-y-2",children:[a.jsx("p",{className:"font-semibold text-sm text-orange-800 dark:text-orange-200",children:"Tindakan ini akan:"}),a.jsxs("ul",{className:"text-sm text-orange-700 dark:text-orange-300 space-y-1 list-disc list-inside",children:[a.jsx("li",{children:"Menghapus semua statistik circuit breaker"}),a.jsx("li",{children:"Mereset state ke CLOSED"}),a.jsx("li",{children:"Menghapus riwayat kegagalan"})]}),a.jsx("p",{className:"text-xs text-orange-600 dark:text-orange-400 mt-3 font-semibold",children:" Tindakan ini TIDAK DAPAT DIBATALKAN!"})]})}),a.jsxs(Pa,{children:[a.jsx(se,{variant:"outline",onClick:()=>f(!1),children:"Batal"}),a.jsx(se,{variant:"default",onClick:ae,children:"Reset"})]})]})}),a.jsx(xn,{open:m,onOpenChange:g,children:a.jsxs(un,{className:"max-w-md",children:[a.jsxs(dn,{children:[a.jsxs(hn,{className:"flex items-center gap-2",children:[a.jsx(oo,{className:"h-5 w-5 text-red-500"}),"Buka Circuit Breaker Secara Manual"]}),a.jsx(Hr,{children:"PERINGATAN KRITIS: Tindakan ini sangat berbahaya!"})]}),a.jsx("div",{className:"py-4",children:a.jsxs("div",{className:"bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800 rounded-lg p-4 space-y-2",children:[a.jsx("p",{className:"font-semibold text-sm text-red-800 dark:text-red-200",children:"Tindakan ini akan:"}),a.jsxs("ul",{className:"text-sm text-red-700 dark:text-red-300 space-y-1 list-disc list-inside",children:[a.jsx("li",{children:a.jsx("strong",{children:"MENGHENTIKAN SEMUA REQUEST DATABASE"})}),a.jsx("li",{children:"Memblokir semua operasi aplikasi"}),a.jsx("li",{children:"Menyebabkan error pada semua fitur yang membutuhkan database"})]}),a.jsxs("div",{className:"mt-3 bg-yellow-50 dark:bg-yellow-950/20 border border-yellow-200 dark:border-yellow-800 rounded p-2",children:[a.jsx("p",{className:"text-xs text-yellow-700 dark:text-yellow-300 font-semibold",children:" APLIKASI AKAN BERHENTI BERFUNGSI!"}),a.jsx("p",{className:"text-xs text-yellow-600 dark:text-yellow-400 mt-1",children:"Gunakan hanya dalam keadaan darurat atau untuk testing."})]})]})}),a.jsxs(Pa,{children:[a.jsx(se,{variant:"outline",onClick:()=>g(!1),children:"Batal"}),a.jsx(se,{variant:"destructive",onClick:de,children:"Buka Circuit"})]})]})}),a.jsx(xn,{open:v,onOpenChange:y,children:a.jsxs(un,{className:"max-w-md",children:[a.jsxs(dn,{children:[a.jsxs(hn,{className:"flex items-center gap-2",children:[a.jsx(Nw,{className:"h-5 w-5 text-blue-500"}),"Kirim Metrik ke Database"]}),a.jsx(Hr,{children:"Apakah Anda yakin ingin mengirim semua metrik yang tertunda?"})]}),a.jsx("div",{className:"py-4",children:a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4 space-y-2",children:[a.jsx("p",{className:"font-semibold text-sm text-blue-800 dark:text-blue-200",children:"Tindakan ini akan:"}),a.jsxs("ul",{className:"text-sm text-blue-700 dark:text-blue-300 space-y-1 list-disc list-inside",children:[a.jsx("li",{children:"Mengirim semua metrik yang tersimpan di memori ke Supabase"}),a.jsx("li",{children:"Memperbarui tabel circuit_breaker_metrics"}),a.jsx("li",{children:"Menghapus metrik dari antrian lokal"})]})]})}),a.jsxs(Pa,{children:[a.jsx(se,{variant:"outline",onClick:()=>y(!1),children:"Batal"}),a.jsx(se,{variant:"default",onClick:fe,children:"Kirim Metrik"})]})]})}),a.jsx(xn,{open:S,onOpenChange:T,children:a.jsxs(un,{className:"max-w-md",children:[a.jsx(dn,{children:a.jsxs(hn,{className:"flex items-center gap-2",children:[a.jsx(Ef,{className:"h-5 w-5 text-green-500"}),"Berhasil"]})}),a.jsx("div",{className:"py-4",children:a.jsx("p",{className:"text-sm",children:N})}),a.jsx(Pa,{children:a.jsx(se,{variant:"default",onClick:()=>T(!1),children:"Tutup"})})]})}),a.jsx(xn,{open:k,onOpenChange:j,children:a.jsxs(un,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(dn,{children:[a.jsxs(hn,{className:"flex items-center gap-2",children:[a.jsx(Rv,{className:"h-5 w-5 text-blue-500"}),"Dokumentasi Circuit Breaker"]}),a.jsx(Hr,{children:"Panduan lengkap tentang cara kerja circuit breaker dan langkah-langkah troubleshooting"})]}),a.jsxs("div",{className:"py-4 space-y-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[a.jsx(bo,{className:"h-5 w-5 text-blue-600"}),"Apa itu Circuit Breaker?"]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 space-y-2",children:[a.jsxs("p",{className:"text-sm",children:[a.jsx("strong",{children:"Circuit Breaker"})," adalah mekanisme perlindungan yang mencegah kegagalan sistem database merambat ke seluruh aplikasi. Seperti sekring listrik, circuit breaker akan memutuskan koneksi sementara ketika mendeteksi terlalu banyak kegagalan, sehingga memberikan waktu untuk sistem pulih dan mencegah beban berlebih."]}),a.jsxs("ul",{className:"text-sm list-disc list-inside space-y-1 text-muted-foreground",children:[a.jsx("li",{children:"Melindungi database dari beban berlebih dan kegagalan cascade"}),a.jsx("li",{children:"Mengurangi risiko aplikasi crash saat database bermasalah"}),a.jsx("li",{children:"Memberikan waktu recovery otomatis untuk sistem"}),a.jsx("li",{children:"Monitoring dan pelaporan metrik untuk analisis"})]})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[a.jsx(Ia,{className:"h-5 w-5 text-blue-600"}),"Penjelasan Detail Setiap Input Circuit Breaker"]}),a.jsx("div",{className:"space-y-4",children:a.jsx("div",{className:"bg-purple-50 dark:bg-purple-950/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4",children:a.jsxs("div",{className:"text-sm space-y-4 text-muted-foreground",children:[a.jsxs("div",{children:[a.jsx("strong",{className:"text-purple-700 dark:text-purple-300 text-base",children:"1. Failure Threshold (Ambang Kegagalan)"}),a.jsx("p",{className:"mt-1 mb-2",children:"Jumlah maksimal kegagalan yang dapat terjadi dalam jendela waktu monitoring sebelum circuit breaker terbuka (OPEN)."}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded p-3",children:a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Failure Threshold: ",M.failureThreshold]}),a.jsxs("p",{className:"text-xs mt-1",children:[a.jsx("br",{})," Default: 5 kegagalan (range: 1 - 100)",a.jsx("br",{})," Sistem akan menghitung jumlah kegagalan dalam jendela waktu ",(M.monitoringPeriod/1e3).toFixed(0)," detik",a.jsx("br",{})," Jika mencapai ",M.failureThreshold," kegagalan atau lebih  Circuit breaker akan ",a.jsx("strong",{children:"OPEN"})," (blokir semua request)",a.jsx("br",{})," ",a.jsx("strong",{children:"Mengapa penting?"})," Mencegah kegagalan cascade dengan memblokir request sebelum sistem benar-benar crash",a.jsx("br",{})," ",a.jsx("strong",{children:"Tips:"}),a.jsx("br",{}),"- Nilai terlalu rendah (1-3): Circuit breaker terlalu sensitif, sering terbuka karena error sementara",a.jsx("br",{}),"- Nilai terlalu tinggi (20+): Circuit breaker kurang responsif, database bisa overload sebelum terbuka",a.jsx("br",{}),"- Rekomendasi: 5-10 untuk aplikasi production, 3-5 untuk aplikasi kritis",a.jsx("br",{})," ",a.jsx("strong",{children:"Contoh:"})," Jika threshold = ",M.failureThreshold,", dan terjadi ",M.failureThreshold," timeout/error dalam ",(M.monitoringPeriod/1e3).toFixed(0)," detik terakhir  Circuit OPEN"]})]})})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-purple-700 dark:text-purple-300 text-base",children:"2. Reset Timeout (Waktu Tunggu Reset)"}),a.jsx("p",{className:"mt-1 mb-2",children:"Waktu yang harus ditunggu setelah circuit breaker OPEN sebelum mencoba uji pemulihan (transisi ke HALF_OPEN)."}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded p-3",children:a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Reset Timeout: ",(M.resetTimeout/1e3).toFixed(0)," detik (",M.resetTimeout,"ms)"]}),a.jsxs("p",{className:"text-xs mt-1",children:[a.jsx("br",{})," Default: 30 detik (30000ms, range: 5s - 600s)",a.jsx("br",{})," Setelah circuit OPEN, sistem akan menunggu ",M.resetTimeout/1e3," detik sebelum mencoba uji pemulihan",a.jsx("br",{})," Setelah timeout, circuit breaker akan transisi ke ",a.jsx("strong",{children:"HALF_OPEN"})," (mengizinkan beberapa request terbatas untuk testing)",a.jsx("br",{})," ",a.jsx("strong",{children:"Mengapa penting?"})," Memberi waktu database untuk recovery sebelum mengizinkan request lagi",a.jsx("br",{})," ",a.jsx("strong",{children:"Tips:"}),a.jsx("br",{}),"- Nilai terlalu pendek (5-10s): Tidak cukup waktu untuk recovery, circuit langsung terbuka lagi",a.jsx("br",{}),"- Nilai terlalu panjang (300s+): Aplikasi terlalu lama tidak bisa digunakan",a.jsx("br",{}),"- Rekomendasi: 30-60 detik untuk masalah network sementara, 60-120 detik untuk masalah database serius",a.jsx("br",{})," ",a.jsx("strong",{children:"Contoh:"})," Circuit OPEN  Tunggu ",M.resetTimeout/1e3," detik  Uji dengan ",M.successThreshold," request terbatas  Jika semua sukses, kembali CLOSED"]})]})})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-purple-700 dark:text-purple-300 text-base",children:"3. Success Threshold (Ambang Keberhasilan)"}),a.jsx("p",{className:"mt-1 mb-2",children:"Jumlah minimal request yang harus berhasil berturut-turut dalam fase HALF_OPEN sebelum circuit breaker kembali CLOSED."}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded p-3",children:a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Success Threshold: ",M.successThreshold]}),a.jsxs("p",{className:"text-xs mt-1",children:[a.jsx("br",{})," Default: 2 sukses berturut-turut (range: 1 - 10)",a.jsx("br",{})," Setelah circuit HALF_OPEN (uji pemulihan), sistem akan mengizinkan beberapa request terbatas",a.jsx("br",{})," Jika ",M.successThreshold," request berhasil berturut-turut  Circuit breaker akan ",a.jsx("strong",{children:"CLOSED"})," (kembali normal)",a.jsx("br",{})," Jika ada 1 request gagal  Circuit breaker kembali ",a.jsx("strong",{children:"OPEN"})," (tunggu reset timeout lagi)",a.jsx("br",{})," ",a.jsx("strong",{children:"Mengapa penting?"})," Memastikan sistem benar-benar pulih sebelum mengizinkan semua request",a.jsx("br",{})," ",a.jsx("strong",{children:"Tips:"}),a.jsx("br",{}),"- Nilai terlalu rendah (1): Terlalu mudah kembali CLOSED, bisa langsung OPEN lagi",a.jsx("br",{}),"- Nilai terlalu tinggi (5+): Terlalu lama di HALF_OPEN, memperlambat recovery",a.jsx("br",{}),"- Rekomendasi: 2-3 untuk aplikasi production",a.jsx("br",{})," ",a.jsx("strong",{children:"Contoh:"})," Circuit HALF_OPEN  Request 1 sukses  Request 2 sukses (",M.successThreshold," tercapai)  Circuit CLOSED"]})]})})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-purple-700 dark:text-purple-300 text-base",children:"4. Monitoring Period (Jendela Waktu Monitoring)"}),a.jsx("p",{className:"mt-1 mb-2",children:"Jendela waktu (sliding window) untuk menghitung jumlah kegagalan. Hanya kegagalan dalam jendela waktu ini yang dihitung untuk menentukan apakah circuit harus terbuka."}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded p-3",children:a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Monitoring Period: ",(M.monitoringPeriod/1e3).toFixed(0)," detik (",M.monitoringPeriod,"ms)"]}),a.jsxs("p",{className:"text-xs mt-1",children:[a.jsx("br",{})," Default: 10 detik (10000ms, range: 5s - 300s)",a.jsx("br",{})," Sistem hanya menghitung kegagalan yang terjadi dalam ",(M.monitoringPeriod/1e3).toFixed(0)," detik terakhir",a.jsx("br",{})," Kegagalan yang lebih lama dari ",(M.monitoringPeriod/1e3).toFixed(0)," detik tidak dihitung (expired)",a.jsx("br",{})," ",a.jsx("strong",{children:"Mengapa penting?"})," Mencegah kegagalan lama mempengaruhi keputusan saat ini, fokus pada kondisi terbaru",a.jsx("br",{})," ",a.jsx("strong",{children:"Tips:"}),a.jsx("br",{}),"- Nilai terlalu pendek (5s): Terlalu fokus pada kondisi saat ini, tidak melihat tren",a.jsx("br",{}),"- Nilai terlalu panjang (60s+): Kegagalan lama masih mempengaruhi, recovery lebih lambat",a.jsx("br",{}),"- Rekomendasi: 10-30 detik untuk balance antara responsivitas dan stabilitas",a.jsx("br",{})," ",a.jsx("strong",{children:"Contoh:"})," Jika monitoring period = ",(M.monitoringPeriod/1e3).toFixed(0),"s, dan terjadi ",M.failureThreshold," kegagalan dalam ",(M.monitoringPeriod/1e3).toFixed(0)," detik terakhir  Circuit OPEN. Kegagalan yang lebih dari ",(M.monitoringPeriod/1e3).toFixed(0)," detik tidak dihitung."]})]})})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-purple-700 dark:text-purple-300 text-base",children:"5. Request Timeout (Waktu Maksimal Request)"}),a.jsx("p",{className:"mt-1 mb-2",children:"Waktu maksimal yang diizinkan untuk setiap request database. Request yang melebihi timeout ini akan dianggap gagal dan dibatalkan."}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded p-3",children:a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Request Timeout: ",(M.timeout/1e3).toFixed(0)," detik (",M.timeout,"ms)"]}),a.jsxs("p",{className:"text-xs mt-1",children:[a.jsx("br",{})," Default: 10 detik (10000ms, range: 1s - 60s)",a.jsx("br",{})," Setiap request database akan dibatalkan jika melebihi ",(M.timeout/1e3).toFixed(0)," detik dan dianggap gagal",a.jsx("br",{})," Timeout ini diterapkan sebelum request mencapai database (client-side timeout)",a.jsx("br",{})," ",a.jsx("strong",{children:"Mengapa penting?"})," Mencegah request yang hang/tidak merespons menumpuk dan membebani sistem",a.jsx("br",{})," ",a.jsx("strong",{children:"Tips:"}),a.jsx("br",{}),"- Nilai terlalu pendek (1-3s): Request normal bisa dianggap gagal, false positive tinggi",a.jsx("br",{}),"- Nilai terlalu panjang (30s+): Request hang akan menunggu terlalu lama, resource terbuang",a.jsx("br",{}),"- Rekomendasi:",a.jsx("br",{})," Read queries: 5-10 detik",a.jsx("br",{})," Write queries: 10-15 detik",a.jsx("br",{})," RPC/complex queries: 15-30 detik",a.jsx("br",{})," ",a.jsx("strong",{children:"Contoh:"})," Request dimulai  Jika belum selesai dalam ",(M.timeout/1e3).toFixed(0)," detik  Request dibatalkan  Dianggap gagal  Dihitung untuk failure threshold"]})]})})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-purple-700 dark:text-purple-300 text-base",children:"6. Cara Kerja Bersama-Sama"}),a.jsx("p",{className:"mt-1 mb-2",children:"Semua parameter ini bekerja bersama untuk melindungi database dengan cara yang terkoordinasi."}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded p-3",children:a.jsxs("div",{className:"text-xs space-y-2",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Alur Lengkap:"}),a.jsxs("ol",{className:"list-decimal list-inside ml-2 mt-1 space-y-1",children:[a.jsxs("li",{children:["Request masuk  Sistem cek ",a.jsx("strong",{children:"Request Timeout"})," (max ",(M.timeout/1e3).toFixed(0),"s)"]}),a.jsx("li",{children:"Request dieksekusi  Jika melebihi timeout  Dianggap gagal"}),a.jsxs("li",{children:["Kegagalan dicatat dalam ",a.jsx("strong",{children:"Monitoring Period"})," (",(M.monitoringPeriod/1e3).toFixed(0),"s terakhir)"]}),a.jsx("li",{children:"Sistem hitung total kegagalan dalam jendela waktu"}),a.jsxs("li",{children:["Jika mencapai ",a.jsx("strong",{children:"Failure Threshold"})," (",M.failureThreshold," kegagalan)  Circuit OPEN"]}),a.jsxs("li",{children:["Tunggu ",a.jsx("strong",{children:"Reset Timeout"})," (",(M.resetTimeout/1e3).toFixed(0),"s)  Transisi ke HALF_OPEN"]}),a.jsxs("li",{children:["Uji dengan beberapa request  Jika ",a.jsx("strong",{children:"Success Threshold"})," (",M.successThreshold," sukses) tercapai  CLOSED"]}),a.jsx("li",{children:"Jika gagal dalam HALF_OPEN  Kembali OPEN, tunggu reset timeout lagi"})]})]}),a.jsx("div",{className:"bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800 rounded p-2 mt-2",children:a.jsxs("p",{className:"text-green-700 dark:text-green-300",children:[a.jsx("strong",{children:" Contoh Skenario:"}),a.jsx("br",{}),"1. 5 request gagal (timeout) dalam 10 detik  Threshold tercapai (",M.failureThreshold,")",a.jsx("br",{}),"2. Circuit OPEN  Semua request diblokir",a.jsx("br",{}),"3. Tunggu ",M.resetTimeout/1e3," detik  Database punya waktu recovery",a.jsx("br",{}),"4. Circuit HALF_OPEN  Uji dengan 2 request",a.jsx("br",{}),"5. Kedua request sukses (",M.successThreshold,")  Circuit CLOSED  Kembali normal"]})})]})})]})]})})})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[a.jsx(eP,{className:"h-5 w-5 text-blue-600"}),"Bagaimana Circuit Breaker Bekerja?"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-sm mb-2 text-blue-800 dark:text-blue-200",children:"Tiga Status Circuit Breaker:"}),a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(Ef,{className:"h-5 w-5 text-green-600 mt-0.5"}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-green-700 dark:text-green-300",children:"CLOSED (Tertutup)"}),a.jsx("p",{className:"text-muted-foreground",children:"Status normal. Semua request database diizinkan. Circuit breaker memantau setiap request dan menghitung kegagalan dalam jendela waktu tertentu."})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(oo,{className:"h-5 w-5 text-red-600 mt-0.5"}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-red-700 dark:text-red-300",children:"OPEN (Terbuka)"}),a.jsxs("p",{className:"text-muted-foreground",children:["Circuit breaker mendeteksi terlalu banyak kegagalan ( ",M.failureThreshold," dalam ",(M.monitoringPeriod/1e3).toFixed(0)," detik). Semua request database diblokir untuk melindungi sistem. Status ini akan bertahan selama ",M.resetTimeout/1e3," detik sebelum mencoba uji pemulihan."]})]})]}),a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(HT,{className:"h-5 w-5 text-yellow-600 mt-0.5"}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-yellow-700 dark:text-yellow-300",children:"HALF_OPEN (Setengah Terbuka)"}),a.jsxs("p",{className:"text-muted-foreground",children:["Fase uji pemulihan. Setelah ",M.resetTimeout/1e3," detik di status OPEN, circuit breaker mengizinkan beberapa request terbatas untuk mengecek apakah sistem sudah pulih. Jika ",M.successThreshold," request berhasil berturut-turut, kembali ke CLOSED. Jika gagal, kembali ke OPEN."]})]})]})]})]}),a.jsxs("div",{className:"bg-purple-50 dark:bg-purple-950/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-sm mb-2 text-purple-800 dark:text-purple-200",children:"Alur Kerja:"}),a.jsxs("div",{className:"text-sm space-y-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-mono bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"1."}),a.jsx("span",{children:"Request database masuk  Circuit breaker memeriksa status"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-mono bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"2."}),a.jsx("span",{children:"Jika CLOSED  Request diizinkan dan dimonitor"})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-mono bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"3."}),a.jsxs("span",{children:["Jika terjadi kegagalan  Dihitung dalam jendela waktu ",(M.monitoringPeriod/1e3).toFixed(0)," detik"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-mono bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"4."}),a.jsxs("span",{children:["Jika  ",M.failureThreshold," kegagalan  Beralih ke OPEN (blokir semua request)"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-mono bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"5."}),a.jsxs("span",{children:["Tunggu ",M.resetTimeout/1e3," detik  Beralih ke HALF_OPEN (uji pemulihan)"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-mono bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"6."}),a.jsxs("span",{children:["Jika ",M.successThreshold," sukses  Kembali ke CLOSED. Jika gagal  Kembali ke OPEN"]})]})]})]})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[a.jsx(oo,{className:"h-5 w-5 text-orange-600"}),"Apa yang Harus Dilakukan Jika Circuit Breaker Terbuka (OPEN)?"]}),a.jsx("div",{className:"bg-orange-50 dark:bg-orange-950/20 border border-orange-200 dark:border-orange-800 rounded-lg p-4 space-y-3",children:a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{children:[a.jsx("strong",{className:"text-orange-800 dark:text-orange-200",children:"1. Jangan Panik - Ini Tindakan Perlindungan Otomatis"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:"Circuit breaker terbuka adalah mekanisme perlindungan yang bekerja secara otomatis. Aplikasi sengaja memblokir request untuk mencegah database crash."})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-orange-800 dark:text-orange-200",children:"2. Identifikasi Penyebab Masalah"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:"Periksa kemungkinan penyebab:"}),a.jsxs("ul",{className:"list-disc list-inside ml-4 text-muted-foreground mt-1",children:[a.jsx("li",{children:"Database server sedang down atau overload"}),a.jsx("li",{children:"Koneksi network bermasalah"}),a.jsx("li",{children:"Query database terlalu lambat (timeout)"}),a.jsx("li",{children:"Terlalu banyak request bersamaan (adaptive rate limiter sedang mengurangi limit)"}),a.jsx("li",{children:"Masalah pada Supabase (jika menggunakan Supabase)"})]})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-orange-800 dark:text-orange-200",children:"3. Periksa Metrik dan Log"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:'Lihat bagian "Metrics Charts" untuk memahami:'}),a.jsxs("ul",{className:"list-disc list-inside ml-4 text-muted-foreground mt-1",children:[a.jsx("li",{children:"Jenis operasi yang paling banyak gagal (read/write/RPC)"}),a.jsx("li",{children:"Error category yang dominan (network/timeout/database)"}),a.jsx("li",{children:"Response time rata-rata sebelum circuit terbuka"})]})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-orange-800 dark:text-orange-200",children:"4. Tunggu Pemulihan Otomatis"}),a.jsxs("p",{className:"text-muted-foreground mt-1",children:["Circuit breaker akan otomatis mencoba uji pemulihan setelah ",M.resetTimeout/1e3," detik. Jika sistem sudah pulih, akan kembali ke status CLOSED secara otomatis."]})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-orange-800 dark:text-orange-200",children:"5. Tindakan Manual (Jika Diperlukan)"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:"Jika masalah berlanjut setelah beberapa siklus recovery:"}),a.jsxs("ul",{className:"list-disc list-inside ml-4 text-muted-foreground mt-1",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Reset Circuit Breaker:"})," Hapus statistik dan mulai fresh (gunakan dengan hati-hati)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Periksa Status Database:"})," Pastikan database server berjalan normal"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Hubungi Tim DevOps/Database:"})," Jika masalah bersifat infrastruktur"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Review Query Performance:"})," Optimalkan query yang lambat"]})]})]})]})})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[a.jsx(bo,{className:"h-5 w-5 text-purple-600"}),"Adaptive Rate Limiter: Menangani Traffic Spike"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-purple-50 dark:bg-purple-950/20 border border-purple-200 dark:border-purple-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-sm mb-2 text-purple-800 dark:text-purple-200",children:"Apa itu Adaptive Rate Limiter?"}),a.jsxs("p",{className:"text-sm text-muted-foreground mb-3",children:[a.jsx("strong",{children:"Adaptive Rate Limiter"})," adalah sistem pembatas kecepatan yang secara otomatis menyesuaikan limit berdasarkan kondisi sistem database. Berbeda dengan rate limiter statis yang memiliki limit tetap, adaptive rate limiter akan:"]}),a.jsxs("ul",{className:"text-sm list-disc list-inside space-y-1 text-muted-foreground",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Meningkatkan limit"})," saat sistem dalam kondisi sehat (response time rendah, error rate rendah)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Menurunkan limit"})," saat sistem dalam kondisi stres (response time tinggi, error rate tinggi)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Melindungi database"})," dari traffic spike dan overload dengan penyesuaian otomatis"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Mengurangi false positives"})," dengan memberikan waktu recovery sebelum circuit breaker terbuka"]})]})]}),a.jsxs("div",{className:"bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-sm mb-2 text-green-800 dark:text-green-200",children:"Bagaimana Menangani Traffic Spike?"}),a.jsxs("div",{className:"text-sm space-y-3",children:[a.jsxs("div",{children:[a.jsx("strong",{className:"text-green-700 dark:text-green-300",children:"1. Deteksi Traffic Spike"}),a.jsxs("p",{className:"text-muted-foreground mt-1",children:["Saat traffic spike terjadi, database mulai lambat (response time meningkat) atau terjadi error rate tinggi. Adaptive rate limiter memantau metrik ini setiap ",R.adjustmentInterval/1e3," detik dari tabel ",a.jsx("code",{className:"bg-gray-100 dark:bg-gray-800 px-1 rounded",children:"circuit_breaker_metrics"})," di Supabase."]})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-green-700 dark:text-green-300",children:"2. Penyesuaian Otomatis"}),a.jsxs("div",{className:"mt-2 space-y-2",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-2",children:[a.jsxs("strong",{className:"text-xs",children:["Sistem Sehat (Response Time < ",R.healthyLatencyThreshold,"ms, Error < 5%):"]}),a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" Limit meningkat hingga ",(R.maxMultiplier*100).toFixed(0),"% dari base limit",a.jsx("br",{})," Contoh: Reads base ",R.baseConfig.read.limit,"/min dapat naik hingga ",Math.round(R.baseConfig.read.limit*R.maxMultiplier),"/min"]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-2",children:[a.jsxs("strong",{className:"text-xs",children:["Sistem Stres (Response Time > ",R.stressLatencyThreshold,"ms atau Error > 20%):"]}),a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[" Limit menurun hingga ",(R.minMultiplier*100).toFixed(0),"% dari base limit",a.jsx("br",{})," Contoh: Reads base ",R.baseConfig.read.limit,"/min dapat turun hingga ",Math.round(R.baseConfig.read.limit*R.minMultiplier),"/min",a.jsx("br",{})," Memberi waktu recovery untuk database tanpa langsung memicu circuit breaker OPEN"]})]})]})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-green-700 dark:text-green-300",children:"3. Skenario Traffic Spike"}),a.jsxs("div",{className:"mt-2 space-y-2 text-xs",children:[a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-mono bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"A."}),a.jsxs("div",{children:[a.jsx("strong",{children:"Spike Normal (Dapat Dihandle):"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:"Request melonjak  Rate limiter dengan limit adaptif menangani sebagian request  Jika masih dalam batas, semua diizinkan  Jika melebihi, request diblokir dengan HTTP 429"})]})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-mono bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"B."}),a.jsxs("div",{children:[a.jsx("strong",{children:"Spike Besar (Database Mulai Lambat):"}),a.jsxs("p",{className:"text-muted-foreground mt-1",children:["Response time naik di atas ",R.stressLatencyThreshold,"ms  Adaptive limiter turunkan limit secara bertahap  Memberi waktu database pulih  Mencegah circuit breaker langsung OPEN"]})]})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-mono bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"C."}),a.jsxs("div",{children:[a.jsx("strong",{children:"DDoS/Attack:"}),a.jsxs("p",{className:"text-muted-foreground mt-1",children:["Ribuan request masuk  Adaptive limiter turunkan limit drastis (hingga ",(R.minMultiplier*100).toFixed(0),"%)  Sebagian besar request diblokir  Database terlindungi  Circuit breaker OPEN sebagai last resort jika masih gagal"]})]})]})]})]})]})]}),a.jsxs("div",{className:"bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-sm mb-3 text-red-800 dark:text-red-200",children:" Input Konfigurasi untuk Traffic Spike & DDoS Protection"}),a.jsxs("div",{className:"text-sm space-y-3 text-muted-foreground",children:[a.jsxs("div",{children:[a.jsx("strong",{className:"text-red-700 dark:text-red-300 text-base",children:"Input Utama untuk Perlindungan:"}),a.jsxs("div",{className:"mt-2 space-y-3",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-3 border-l-4 border-red-500",children:[a.jsx("strong",{className:"text-sm text-red-700 dark:text-red-300",children:"1. Min Multiplier (PALING PENTING untuk DDoS)"}),a.jsxs("p",{className:"text-xs mt-1",children:[" ",a.jsx("strong",{children:"Input ini:"})," Min Multiplier = ",(R.minMultiplier*100).toFixed(0),"% (range: 0.1 - 1.0)",a.jsx("br",{})," ",a.jsx("strong",{children:"Fungsi:"})," Menentukan seberapa rendah limit dapat turun saat sistem diserang",a.jsx("br",{})," ",a.jsx("strong",{children:"Untuk DDoS:"}),a.jsx("br",{}),"- Nilai rendah (0.1-0.3) = Limit turun drastis  90-70% request diblokir  ",a.jsx("strong",{children:"SANGAT EFEKTIF"}),a.jsx("br",{}),"- Nilai sedang (0.4-0.6) = Limit turun sedang  60-40% request diblokir  ",a.jsx("strong",{children:"EFEKTIF"}),a.jsx("br",{}),"- Nilai tinggi (0.7-1.0) = Limit turun sedikit  30-0% request diblokir  ",a.jsx("strong",{children:"KURANG EFEKTIF"}),a.jsx("br",{})," ",a.jsx("strong",{children:"Rekomendasi DDoS:"})," 0.1 - 0.3 (10-30% dari base limit)",a.jsx("br",{})," ",a.jsx("strong",{children:"Contoh:"})," Base Reads = ",R.baseConfig.read.limit,"/min, Min Multiplier = ",R.minMultiplier,"  Limit minimum = ",Math.round(R.baseConfig.read.limit*R.minMultiplier),"/min saat diserang"]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-3 border-l-4 border-orange-500",children:[a.jsx("strong",{className:"text-sm text-orange-700 dark:text-orange-300",children:"2. Stress Latency Threshold (Deteksi Serangan)"}),a.jsxs("p",{className:"text-xs mt-1",children:[" ",a.jsx("strong",{children:"Input ini:"})," Stress Latency Threshold = ",R.stressLatencyThreshold,"ms (range: 500ms - 10000ms)",a.jsx("br",{})," ",a.jsx("strong",{children:"Fungsi:"})," Mendeteksi kapan sistem mulai stres/overload akibat traffic spike",a.jsx("br",{})," ",a.jsx("strong",{children:"Untuk DDoS:"}),a.jsx("br",{}),"- Nilai rendah (500-1000ms) = Deteksi cepat saat serangan  Limit turun cepat  ",a.jsx("strong",{children:"EFEKTIF"}),a.jsx("br",{}),"- Nilai sedang (1000-2000ms) = Deteksi sedang  ",a.jsx("strong",{children:"SEIMBANG"}),a.jsx("br",{}),"- Nilai tinggi (3000ms+) = Deteksi lambat  Database bisa crash dulu  ",a.jsx("strong",{children:"KURANG EFEKTIF"}),a.jsx("br",{})," ",a.jsx("strong",{children:"Rekomendasi DDoS:"})," 500-1000ms (deteksi cepat)",a.jsx("br",{})," ",a.jsx("strong",{children:"Contoh:"})," Saat DDoS, response time naik cepat  Jika ",">"," ",R.stressLatencyThreshold,"ms  Sistem langsung turunkan limit"]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-3 border-l-4 border-yellow-500",children:[a.jsx("strong",{className:"text-sm text-yellow-700 dark:text-yellow-300",children:"3. Base Limits (Garis Pertahanan Awal)"}),a.jsxs("p",{className:"text-xs mt-1",children:[" ",a.jsx("strong",{children:"Input ini:"})," Base Limits untuk Reads/Writes/RPC/Auth",a.jsx("br",{})," ",a.jsx("strong",{children:"Fungsi:"})," Limit dasar sebelum penyesuaian adaptif",a.jsx("br",{})," ",a.jsx("strong",{children:"Untuk DDoS:"}),a.jsx("br",{}),"- Base limit rendah = Kurang request yang diizinkan  Lebih aman tapi bisa blokir user normal",a.jsx("br",{}),"- Base limit tinggi = Lebih banyak request diizinkan  Lebih toleran tapi kurang proteksi",a.jsx("br",{})," ",a.jsx("strong",{children:"Rekomendasi DDoS:"}),a.jsx("br",{}),"- Reads: 50-100/min (default: ",R.baseConfig.read.limit,"/min)",a.jsx("br",{}),"- Writes: 20-30/min (default: ",R.baseConfig.write.limit,"/min)",a.jsx("br",{}),"- RPC: 10-20/min (default: ",R.baseConfig.rpc.limit,"/min)",a.jsx("br",{}),"- Auth: 5-10/min (default: ",R.baseConfig.auth.limit,"/min)",a.jsx("br",{})," ",a.jsx("strong",{children:"Penting:"})," Base limit ini akan dikalikan dengan min multiplier saat serangan, jadi limit efektif minimum = base  min multiplier"]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-3 border-l-4 border-blue-500",children:[a.jsx("strong",{className:"text-sm text-blue-700 dark:text-blue-300",children:"4. Adjustment Interval (Kecepatan Respons)"}),a.jsxs("p",{className:"text-xs mt-1",children:[" ",a.jsx("strong",{children:"Input ini:"})," Adjustment Interval = ",R.adjustmentInterval/1e3,"s (range: 10s - 600s)",a.jsx("br",{})," ",a.jsx("strong",{children:"Fungsi:"})," Seberapa sering sistem memeriksa kondisi dan menyesuaikan limit",a.jsx("br",{})," ",a.jsx("strong",{children:"Untuk DDoS:"}),a.jsx("br",{}),"- Interval pendek (10-30s) = Respons cepat  Limit turun cepat saat serangan  ",a.jsx("strong",{children:"SANGAT EFEKTIF"}),a.jsx("br",{}),"- Interval sedang (30-60s) = Respons seimbang  ",a.jsx("strong",{children:"EFEKTIF"}),a.jsx("br",{}),"- Interval panjang (60s+) = Respons lambat  Serangan bisa damage dulu  ",a.jsx("strong",{children:"KURANG EFEKTIF"}),a.jsx("br",{})," ",a.jsx("strong",{children:"Rekomendasi DDoS:"})," 10-30 detik (respons cepat)",a.jsx("br",{})," ",a.jsx("strong",{children:"Catatan:"})," Interval terlalu pendek (","<"," 10s) bisa menyebabkan limit berubah-ubah terlalu sering"]})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-3 border-l-4 border-purple-500",children:[a.jsx("strong",{className:"text-sm text-purple-700 dark:text-purple-300",children:"5. Circuit Breaker Failure Threshold (Last Resort)"}),a.jsxs("p",{className:"text-xs mt-1",children:[" ",a.jsx("strong",{children:"Input ini:"})," Failure Threshold = ",M.failureThreshold," (range: 1-100)",a.jsx("br",{})," ",a.jsx("strong",{children:"Fungsi:"})," Jika adaptive rate limiter tidak cukup, circuit breaker akan OPEN dan blokir SEMUA request",a.jsx("br",{})," ",a.jsx("strong",{children:"Untuk DDoS:"}),a.jsx("br",{}),"- Nilai rendah (3-5) = Circuit terbuka cepat  Semua request diblokir  ",a.jsx("strong",{children:"SANGAT PROTEKTIF"}),a.jsx("br",{}),"- Nilai sedang (5-10) = Balance  ",a.jsx("strong",{children:"SEIMBANG"}),a.jsx("br",{}),"- Nilai tinggi (10+) = Circuit lambat terbuka  Database bisa crash dulu  ",a.jsx("strong",{children:"KURANG PROTEKTIF"}),a.jsx("br",{})," ",a.jsx("strong",{children:"Rekomendasi DDoS:"})," 3-5 kegagalan dalam monitoring period",a.jsx("br",{})," ",a.jsx("strong",{children:"Penting:"})," Ini adalah lapisan terakhir - gunakan jika rate limiter tidak cukup"]})]})]})]}),a.jsxs("div",{className:"bg-red-100 dark:bg-red-950/40 border border-red-300 dark:border-red-700 rounded p-3 mt-3",children:[a.jsx("strong",{className:"text-sm text-red-800 dark:text-red-200",children:" Konfigurasi Optimal untuk DDoS Protection:"}),a.jsxs("div",{className:"text-xs mt-2 space-y-1 text-red-700 dark:text-red-300",children:[a.jsx("p",{children:"Untuk perlindungan maksimal terhadap DDoS attack, gunakan konfigurasi berikut:"}),a.jsxs("ul",{className:"list-disc list-inside ml-2 mt-1 space-y-1",children:[a.jsxs("li",{children:[a.jsx("strong",{children:"Min Multiplier:"})," 0.1 - 0.3 (limit turun hingga 10-30% dari base)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Stress Latency Threshold:"})," 500 - 1000ms (deteksi cepat)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Adjustment Interval:"})," 10 - 30 detik (respons cepat)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Base Limits:"})," Konservatif (Reads: 50-100, Writes: 20-30, RPC: 10-20, Auth: 5-10)"]}),a.jsxs("li",{children:[a.jsx("strong",{children:"Circuit Breaker Failure Threshold:"})," 3-5 (last resort protection)"]})]}),a.jsx("p",{className:"mt-2 font-semibold",children:"Dengan konfigurasi ini, saat DDoS attack terjadi:"}),a.jsxs("ol",{className:"list-decimal list-inside ml-2 mt-1 space-y-1",children:[a.jsxs("li",{children:["Response time naik ",">"," ",R.stressLatencyThreshold,"ms (dalam 10-30 detik)"]}),a.jsxs("li",{children:["Adaptive limiter turunkan limit ke ",(R.minMultiplier*100).toFixed(0),"% (minimal)"]}),a.jsx("li",{children:"70-90% request diblokir dengan HTTP 429"}),a.jsx("li",{children:"Jika masih gagal, circuit breaker OPEN  100% request diblokir"}),a.jsx("li",{children:"Database terlindungi dari crash"})]})]})]})]})]}),a.jsxs("div",{className:"bg-yellow-50 dark:bg-yellow-950/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-sm mb-2 text-yellow-800 dark:text-yellow-200",children:"Lapisan Perlindungan Berlapis"}),a.jsxs("div",{className:"text-sm space-y-2",children:[a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-mono bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"1"}),a.jsxs("div",{children:[a.jsx("strong",{children:"Adaptive Rate Limiter (Lapisan Pertama):"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:"Membatasi jumlah request per menit dengan limit yang dinamis. Mencegah database overload dengan menyesuaikan limit berdasarkan kondisi sistem."})]})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-mono bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"2"}),a.jsxs("div",{children:[a.jsx("strong",{children:"Request Timeout (Lapisan Kedua):"}),a.jsxs("p",{className:"text-muted-foreground mt-1",children:["Setiap request memiliki timeout maksimal ",M.timeout/1e3," detik. Request yang terlalu lama dianggap gagal dan tidak menumpuk di database."]})]})]}),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx("span",{className:"font-mono bg-white dark:bg-gray-800 px-2 py-1 rounded",children:"3"}),a.jsxs("div",{children:[a.jsx("strong",{children:"Circuit Breaker (Lapisan Ketiga):"}),a.jsxs("p",{className:"text-muted-foreground mt-1",children:["Jika tetap terjadi ",M.failureThreshold," kegagalan dalam ",(M.monitoringPeriod/1e3).toFixed(0)," detik, circuit breaker akan OPEN dan memblokir semua request untuk melindungi database sepenuhnya."]})]})]})]})]}),a.jsxs("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg p-4",children:[a.jsx("h4",{className:"font-semibold text-sm mb-2 text-blue-800 dark:text-blue-200",children:"Penjelasan Detail Setiap Input Konfigurasi"}),a.jsxs("div",{className:"text-sm space-y-4 text-muted-foreground",children:[a.jsxs("div",{children:[a.jsx("strong",{className:"text-blue-700 dark:text-blue-300 text-base",children:"1. Base Limits (Limit Dasar)"}),a.jsx("p",{className:"mt-1 mb-2",children:"Limit dasar adalah jumlah maksimal request per menit yang diizinkan saat sistem dalam kondisi normal. Limit aktual akan disesuaikan otomatis berdasarkan kondisi sistem (dikalikan dengan multiplier)."}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-3 space-y-2",children:[a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Reads Base Limit: ",R.baseConfig.read.limit,"/min"]}),a.jsxs("p",{className:"text-xs mt-1",children:["Limit dasar untuk operasi ",a.jsx("strong",{children:"READ"})," (membaca data dari database). Operasi ini termasuk SELECT queries, fetching data, dll.",a.jsx("br",{})," Operasi read biasanya lebih aman dan lebih cepat dibanding write",a.jsx("br",{})," Limit default: 100 request/menit (dapat disesuaikan 10-1000)",a.jsx("br",{})," Saat sistem sehat: Dapat naik hingga ",Math.round(R.baseConfig.read.limit*R.maxMultiplier),"/min",a.jsx("br",{})," Saat sistem stres: Dapat turun hingga ",Math.round(R.baseConfig.read.limit*R.minMultiplier),"/min"]})]}),a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Writes Base Limit: ",R.baseConfig.write.limit,"/min"]}),a.jsxs("p",{className:"text-xs mt-1",children:["Limit dasar untuk operasi ",a.jsx("strong",{children:"WRITE"})," (menulis/mengubah data di database). Operasi ini termasuk INSERT, UPDATE, DELETE, UPSERT.",a.jsx("br",{})," Operasi write lebih berisiko dan lebih lambat dibanding read",a.jsx("br",{})," Limit default: 30 request/menit (dapat disesuaikan 5-500)",a.jsx("br",{})," Lebih ketat dari reads karena dapat menyebabkan race condition atau data corruption jika terlalu banyak",a.jsx("br",{})," Saat sistem sehat: Dapat naik hingga ",Math.round(R.baseConfig.write.limit*R.maxMultiplier),"/min",a.jsx("br",{})," Saat sistem stres: Dapat turun hingga ",Math.round(R.baseConfig.write.limit*R.minMultiplier),"/min"]})]}),a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["RPC Base Limit: ",R.baseConfig.rpc.limit,"/min"]}),a.jsxs("p",{className:"text-xs mt-1",children:["Limit dasar untuk operasi ",a.jsx("strong",{children:"RPC"})," (Remote Procedure Call / fungsi database). Operasi ini termasuk panggilan fungsi PostgreSQL, stored procedures, dll.",a.jsx("br",{})," RPC biasanya lebih kompleks dan lebih berat dibanding query biasa",a.jsx("br",{})," Limit default: 20 request/menit (dapat disesuaikan 5-200)",a.jsx("br",{})," RPC sering digunakan untuk operasi batch atau analytics, jadi perlu lebih ketat",a.jsx("br",{})," Saat sistem sehat: Dapat naik hingga ",Math.round(R.baseConfig.rpc.limit*R.maxMultiplier),"/min",a.jsx("br",{})," Saat sistem stres: Dapat turun hingga ",Math.round(R.baseConfig.rpc.limit*R.minMultiplier),"/min"]})]}),a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Auth Base Limit: ",R.baseConfig.auth.limit,"/min"]}),a.jsxs("p",{className:"text-xs mt-1",children:["Limit dasar untuk operasi ",a.jsx("strong",{children:"AUTH"})," (autentikasi dan otorisasi). Operasi ini termasuk login, logout, refresh token, verifikasi session.",a.jsx("br",{})," Operasi auth sangat penting untuk keamanan, jadi perlu dibatasi",a.jsx("br",{})," Limit default: 10 request/menit (dapat disesuaikan 2-100)",a.jsx("br",{})," Mencegah brute force attack dan credential stuffing",a.jsx("br",{})," Saat sistem sehat: Dapat naik hingga ",Math.round(R.baseConfig.auth.limit*R.maxMultiplier),"/min",a.jsx("br",{})," Saat sistem stres: Dapat turun hingga ",Math.round(R.baseConfig.auth.limit*R.minMultiplier),"/min"]})]})]})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-blue-700 dark:text-blue-300 text-base",children:"2. Multiplier Range (Rentang Pengali)"}),a.jsx("p",{className:"mt-1 mb-2",children:"Multiplier menentukan seberapa banyak limit base dapat berubah. Sistem akan mengalikan base limit dengan multiplier saat ini untuk mendapatkan limit efektif."}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-3 space-y-2",children:[a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Min Multiplier: ",(R.minMultiplier*100).toFixed(0),"%"]}),a.jsxs("p",{className:"text-xs mt-1",children:["Multiplier ",a.jsx("strong",{children:"minimum"})," yang akan digunakan saat sistem dalam kondisi ",a.jsx("strong",{children:"stres"}),".",a.jsx("br",{})," Nilai: 0.5 = 50% dari base limit (default: 0.5, range: 0.1 - 1.0)",a.jsx("br",{})," Digunakan ketika: Response time > ",R.stressLatencyThreshold,"ms ATAU error rate > 20%",a.jsx("br",{})," Contoh: Jika Reads base = ",R.baseConfig.read.limit,", min multiplier = ",R.minMultiplier,", maka limit efektif minimum = ",Math.round(R.baseConfig.read.limit*R.minMultiplier),"/min",a.jsx("br",{})," ",a.jsx("strong",{children:"Mengapa penting?"})," Memberi waktu recovery untuk database dengan mengurangi beban saat sistem stres, mencegah overload total"]})]}),a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Max Multiplier: ",(R.maxMultiplier*100).toFixed(0),"%"]}),a.jsxs("p",{className:"text-xs mt-1",children:["Multiplier ",a.jsx("strong",{children:"maksimum"})," yang akan digunakan saat sistem dalam kondisi ",a.jsx("strong",{children:"sehat"}),".",a.jsx("br",{})," Nilai: 2.0 = 200% dari base limit (default: 2.0, range: 1.0 - 5.0)",a.jsx("br",{})," Digunakan ketika: Response time < ",R.healthyLatencyThreshold,"ms DAN error rate < 5%",a.jsx("br",{})," Contoh: Jika Reads base = ",R.baseConfig.read.limit,", max multiplier = ",R.maxMultiplier,", maka limit efektif maksimum = ",Math.round(R.baseConfig.read.limit*R.maxMultiplier),"/min",a.jsx("br",{})," ",a.jsx("strong",{children:"Mengapa penting?"})," Memanfaatkan kapasitas database saat kondisi optimal, meningkatkan throughput aplikasi"]})]})]})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-blue-700 dark:text-blue-300 text-base",children:"3. Latency Thresholds (Ambang Waktu Respons)"}),a.jsx("p",{className:"mt-1 mb-2",children:'Threshold menentukan kapan sistem dianggap "sehat" atau "stres" berdasarkan waktu respons database. Sistem menggunakan threshold ini untuk memutuskan apakah harus meningkatkan atau menurunkan limit.'}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-3 space-y-2",children:[a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Healthy Latency Threshold: ",R.healthyLatencyThreshold,"ms"]}),a.jsxs("p",{className:"text-xs mt-1",children:["Batas atas response time yang dianggap ",a.jsx("strong",{children:"sehat"}),". Jika response time database di bawah nilai ini, sistem akan meningkatkan limit.",a.jsx("br",{})," Default: 200ms (range: 50ms - 1000ms)",a.jsx("br",{})," Kondisi: Response time < ",R.healthyLatencyThreshold,"ms DAN error rate < 5%",a.jsx("br",{})," Aksi: Limit akan ",a.jsx("strong",{children:"naik secara bertahap"})," (maks 10% per adjustment) hingga mencapai max multiplier",a.jsx("br",{})," ",a.jsx("strong",{children:"Mengapa penting?"})," Mengidentifikasi saat database dapat menangani lebih banyak request, memaksimalkan throughput",a.jsx("br",{})," ",a.jsx("strong",{children:"Tips:"})," Jika database Anda biasanya sangat cepat (< 50ms), turunkan nilai ini. Jika database lambat, naikkan."]})]}),a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Stress Latency Threshold: ",R.stressLatencyThreshold,"ms"]}),a.jsxs("p",{className:"text-xs mt-1",children:["Batas bawah response time yang dianggap ",a.jsx("strong",{children:"stres"}),". Jika response time database di atas nilai ini, sistem akan menurunkan limit.",a.jsx("br",{})," Default: 1000ms (range: 500ms - 10000ms)",a.jsx("br",{})," Kondisi: Response time > ",R.stressLatencyThreshold,"ms ATAU error rate > 20%",a.jsx("br",{})," Aksi: Limit akan ",a.jsx("strong",{children:"turun secara bertahap"})," (maks 20% per adjustment) hingga mencapai min multiplier",a.jsx("br",{})," ",a.jsx("strong",{children:"Mengapa penting?"})," Mengidentifikasi saat database mulai overload, mengurangi beban sebelum database benar-benar crash",a.jsx("br",{})," ",a.jsx("strong",{children:"Tips:"})," Jika database Anda dapat menangani response time tinggi (> 2s), naikkan nilai ini. Jika database sensitif, turunkan."]})]}),a.jsx("div",{className:"bg-yellow-50 dark:bg-yellow-950/20 border border-yellow-200 dark:border-yellow-800 rounded p-2 mt-2",children:a.jsxs("p",{className:"text-xs text-yellow-700 dark:text-yellow-300",children:[a.jsx("strong",{children:" Catatan:"})," Jika response time di antara ",R.healthyLatencyThreshold,"ms dan ",R.stressLatencyThreshold,"ms, sistem akan perlahan mengembalikan multiplier ke 1.0 (100% dari base limit)."]})})]})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-blue-700 dark:text-blue-300 text-base",children:"4. Adjustment Interval (Interval Penyesuaian)"}),a.jsx("p",{className:"mt-1 mb-2",children:"Interval menentukan seberapa sering sistem memeriksa metrik dan menyesuaikan limit. Sistem akan query metrik dari Supabase dan menghitung response time serta error rate untuk memutuskan apakah perlu mengubah multiplier."}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded p-3",children:a.jsxs("div",{children:[a.jsxs("strong",{className:"text-sm",children:["Adjustment Interval: ",R.adjustmentInterval/1e3," detik (",R.adjustmentInterval,"ms)"]}),a.jsxs("p",{className:"text-xs mt-1",children:["Frekuensi pengecekan dan penyesuaian limit oleh sistem.",a.jsx("br",{})," Default: 60 detik (60000ms, range: 10s - 600s)",a.jsx("br",{})," Setiap interval, sistem akan:",a.jsx("br",{}),"1. Query metrik dari tabel ",a.jsx("code",{className:"bg-gray-100 dark:bg-gray-900 px-1 rounded",children:"circuit_breaker_metrics"})," di Supabase (5 menit terakhir)",a.jsx("br",{}),"2. Hitung rata-rata response time dan error rate",a.jsx("br",{}),"3. Bandingkan dengan threshold (healthy/stress)",a.jsx("br",{}),"4. Sesuaikan multiplier untuk setiap operasi (read/write/rpc/auth)",a.jsx("br",{}),"5. Simpan multiplier baru ke localStorage dan update limit efektif",a.jsx("br",{})," ",a.jsx("strong",{children:"Mengapa penting?"}),a.jsx("br",{}),"- Interval terlalu pendek: Sistem terlalu reaktif, limit berubah-ubah terlalu sering (tidak stabil)",a.jsx("br",{}),"- Interval terlalu panjang: Sistem lambat merespons perubahan kondisi (tidak efektif)",a.jsx("br",{})," ",a.jsx("strong",{children:"Tips:"}),a.jsx("br",{}),"- Untuk aplikasi dengan traffic stabil: Gunakan 60-120 detik",a.jsx("br",{}),"- Untuk aplikasi dengan traffic volatile: Gunakan 30-60 detik",a.jsx("br",{}),"- Jangan kurang dari 10 detik (terlalu agresif)",a.jsx("br",{}),"- Jangan lebih dari 600 detik (terlalu lambat)"]})]})})]}),a.jsxs("div",{children:[a.jsx("strong",{className:"text-blue-700 dark:text-blue-300 text-base",children:"5. Cara Kerja Bersama-Sama"}),a.jsx("p",{className:"mt-1 mb-2",children:"Semua parameter ini bekerja bersama untuk menciptakan sistem perlindungan yang adaptif dan responsif."}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded p-3 space-y-2",children:[a.jsxs("div",{className:"text-xs",children:[a.jsx("strong",{children:"Alur Kerja:"}),a.jsxs("ol",{className:"list-decimal list-inside ml-2 mt-1 space-y-1",children:[a.jsxs("li",{children:["Sistem memantau setiap request database dan mencatat metrik (response time, success/failure) ke ",a.jsx("code",{className:"bg-gray-100 dark:bg-gray-900 px-1 rounded",children:"circuit_breaker_metrics"})]}),a.jsxs("li",{children:["Setiap ",R.adjustmentInterval/1e3," detik, adaptive rate limiter memeriksa metrik 5 menit terakhir"]}),a.jsx("li",{children:"Menghitung rata-rata response time dan error rate"}),a.jsxs("li",{children:["Membandingkan dengan threshold:",a.jsxs("ul",{className:"list-disc list-inside ml-4 mt-1",children:[a.jsxs("li",{children:["Jika response time < ",R.healthyLatencyThreshold,"ms DAN error < 5%  ",a.jsx("strong",{children:"Naikkan limit"})," (max ",(R.maxMultiplier*100).toFixed(0),"%)"]}),a.jsxs("li",{children:["Jika response time > ",R.stressLatencyThreshold,"ms ATAU error > 20%  ",a.jsx("strong",{children:"Turunkan limit"})," (min ",(R.minMultiplier*100).toFixed(0),"%)"]}),a.jsxs("li",{children:["Jika di antara keduanya  ",a.jsx("strong",{children:"Kembalikan limit"})," perlahan ke 100%"]})]})]}),a.jsx("li",{children:"Update multiplier dan hitung limit efektif baru (base limit  multiplier saat ini)"}),a.jsx("li",{children:"Limit efektif baru diterapkan untuk semua request berikutnya"}),a.jsxs("li",{children:["Proses ini berulang setiap ",R.adjustmentInterval/1e3," detik"]})]})]}),a.jsx("div",{className:"bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800 rounded p-2 mt-2",children:a.jsxs("p",{className:"text-xs text-green-700 dark:text-green-300",children:[a.jsx("strong",{children:" Contoh Praktis:"}),a.jsx("br",{}),"Base Reads Limit = ",R.baseConfig.read.limit,"/min",a.jsx("br",{}),"Sistem sehat (response < ",R.healthyLatencyThreshold,"ms)  Multiplier = ",R.maxMultiplier,"  Effective Limit = ",Math.round(R.baseConfig.read.limit*R.maxMultiplier),"/min",a.jsx("br",{}),"Sistem stres (response > ",R.stressLatencyThreshold,"ms)  Multiplier = ",R.minMultiplier,"  Effective Limit = ",Math.round(R.baseConfig.read.limit*R.minMultiplier),"/min",a.jsx("br",{}),"Sistem normal  Multiplier = 1.0  Effective Limit = ",R.baseConfig.read.limit,"/min (base)"]})})]})]}),a.jsxs("p",{className:"text-xs mt-3 pt-2 border-t",children:[" ",a.jsx("strong",{children:"Tip Penting:"}),' Limit efektif saat ini dapat dilihat di bagian "Adaptive Rate Limiter Configuration" di atas. Limit akan berubah secara real-time berdasarkan kondisi sistem. Perhatikan perubahan multiplier - jika terus turun, itu berarti sistem sedang stres dan perlu perhatian.']})]})]})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[a.jsx(Nw,{className:"h-5 w-5 text-blue-600"}),"Memahami Metrik Circuit Breaker"]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 space-y-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Success Rate:"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:"Persentase request yang berhasil. Nilai rendah (< 90%) menunjukkan masalah potensial dengan database atau koneksi."})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Total Requests:"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:"Jumlah total request sejak inisialisasi. Membantu memahami volume traffic aplikasi."})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Operations by Type:"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:"Distribusi operasi berdasarkan jenis (read/write/RPC/auth). Membantu mengidentifikasi jenis operasi yang paling bermasalah."})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Circuit Breaker States:"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:"Menunjukkan berapa banyak operasi yang terjadi pada setiap state. Banyak operasi di OPEN state = sistem sering bermasalah."})]})]})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[a.jsx(Ef,{className:"h-5 w-5 text-green-600"}),"Best Practices"]}),a.jsx("div",{className:"bg-green-50 dark:bg-green-950/20 border border-green-200 dark:border-green-800 rounded-lg p-4 space-y-2 text-sm",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1 text-muted-foreground",children:[a.jsx("li",{children:"Monitor metrik secara berkala untuk mendeteksi masalah sejak dini"}),a.jsx("li",{children:"Biarkan adaptive rate limiter bekerja otomatis - jangan sering reset manual kecuali benar-benar diperlukan"}),a.jsx("li",{children:"Jika circuit sering terbuka, pertimbangkan untuk optimasi query atau scaling database"}),a.jsx("li",{children:"Gunakan cache untuk mengurangi beban database pada query yang sering digunakan"}),a.jsx("li",{children:"Review dan sesuaikan threshold jika circuit breaker terlalu sensitif atau tidak sensitif"}),a.jsx("li",{children:"Perhatikan perubahan limit adaptive rate limiter - penurunan drastis menunjukkan sistem sedang stres"}),a.jsx("li",{children:"Dokumentasikan setiap insiden circuit breaker dan traffic spike untuk analisis tren"}),a.jsx("li",{children:"Trust the adaptive system - limit akan menyesuaikan otomatis berdasarkan kondisi sistem"})]})})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[a.jsx(Ia,{className:"h-5 w-5 text-blue-600"}),"Referensi Konfigurasi"]}),a.jsxs("div",{className:"bg-gray-50 dark:bg-gray-900 rounded-lg p-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Circuit Breaker Configuration"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Failure Threshold:"})," ",M.failureThreshold,a.jsx("p",{className:"text-xs text-muted-foreground",children:"Buka circuit setelah kegagalan ini"})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Reset Timeout:"})," ",M.resetTimeout/1e3,"s",a.jsx("p",{className:"text-xs text-muted-foreground",children:"Tunggu sebelum uji pemulihan"})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Success Threshold:"})," ",M.successThreshold,a.jsx("p",{className:"text-xs text-muted-foreground",children:"Sukses untuk tutup circuit"})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Monitoring Period:"})," ",M.monitoringPeriod/1e3,"s",a.jsx("p",{className:"text-xs text-muted-foreground",children:"Jendela waktu hitungan"})]}),a.jsxs("div",{className:"md:col-span-2",children:[a.jsx("strong",{children:"Request Timeout:"})," ",M.timeout/1e3,"s",a.jsx("p",{className:"text-xs text-muted-foreground",children:"Timeout maksimal per request"})]})]})]}),a.jsxs("div",{className:"pt-3 border-t",children:[a.jsx("h4",{className:"font-semibold text-sm mb-2",children:"Adaptive Rate Limiter Configuration"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("strong",{children:"Reads Base Limit:"})," ",R.baseConfig.read.limit,"/min",a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Effective: ",zt.getEffectiveLimit("read"),"/min (",(X.read*100).toFixed(0),"%)"]})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Writes Base Limit:"})," ",R.baseConfig.write.limit,"/min",a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Effective: ",zt.getEffectiveLimit("write"),"/min (",(X.write*100).toFixed(0),"%)"]})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"RPC Base Limit:"})," ",R.baseConfig.rpc.limit,"/min",a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Effective: ",zt.getEffectiveLimit("rpc"),"/min (",(X.rpc*100).toFixed(0),"%)"]})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Auth Base Limit:"})," ",R.baseConfig.auth.limit,"/min",a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Effective: ",zt.getEffectiveLimit("auth"),"/min (",(X.auth*100).toFixed(0),"%)"]})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Multiplier Range:"})," ",(R.minMultiplier*100).toFixed(0),"% - ",(R.maxMultiplier*100).toFixed(0),"%",a.jsx("p",{className:"text-xs text-muted-foreground",children:"Range penyesuaian limit otomatis"})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Adjustment Interval:"})," ",R.adjustmentInterval/1e3,"s",a.jsx("p",{className:"text-xs text-muted-foreground",children:"Frekuensi penyesuaian limit"})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Healthy Threshold:"})," < ",R.healthyLatencyThreshold,"ms",a.jsx("p",{className:"text-xs text-muted-foreground",children:"Response time untuk meningkatkan limit"})]}),a.jsxs("div",{children:[a.jsx("strong",{children:"Stress Threshold:"})," > ",R.stressLatencyThreshold,"ms",a.jsx("p",{className:"text-xs text-muted-foreground",children:"Response time untuk menurunkan limit"})]})]})]})]})]})]}),a.jsx(Pa,{children:a.jsx(se,{variant:"default",onClick:()=>j(!1),children:"Tutup"})})]})}),a.jsx(xn,{open:b,onOpenChange:_,children:a.jsxs(un,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[a.jsxs(dn,{children:[a.jsxs(hn,{className:"flex items-center gap-2",children:[a.jsx(Ia,{className:"h-5 w-5 text-blue-500"}),"Edit Adaptive Rate Limiter Configuration"]}),a.jsx(Hr,{children:"Ubah konfigurasi adaptive rate limiter. Limit akan secara otomatis menyesuaikan berdasarkan kondisi sistem."})]}),a.jsxs("div",{className:"py-4 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-sm mb-3",children:"Base Limits (per menit)"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"readLimit",children:["Reads Base Limit",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{side:"right",align:"start",sideOffset:12,className:"max-w-xs whitespace-normal break-words",children:a.jsx("p",{children:"Limit dasar untuk operasi read (min: 10, max: 1000)"})})]})]}),a.jsx(it,{id:"readLimit",inputMode:"numeric",pattern:"[0-9]*",min:10,max:1e3,onKeyDown:W=>{["e","E","+","-","."].includes(W.key)&&W.preventDefault()},value:Number.isFinite(Je)?Je:"",onChange:W=>{const q=W.target.value.replace(/\D/g,"");E(Y=>{if(q==="")return{...Y,baseConfig:{...Y.baseConfig,read:{...Y.baseConfig.read,limit:NaN}}};const ne=parseInt(q,10);if(!Number.isFinite(ne))return{...Y,baseConfig:{...Y.baseConfig,read:{...Y.baseConfig.read,limit:NaN}}};const _e=Math.min(1e3,ne);return{...Y,baseConfig:{...Y.baseConfig,read:{...Y.baseConfig.read,limit:_e}}}})}}),!nt&&a.jsx("p",{className:"text-xs text-red-500",children:"Reads base limit must be between 10 and 1000 requests per minute."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"writeLimit",children:["Writes Base Limit",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{side:"left",align:"end",sideOffset:12,className:"max-w-xs whitespace-normal break-words",children:a.jsx("p",{children:"Limit dasar untuk operasi write (min: 5, max: 500)"})})]})]}),a.jsx(it,{id:"writeLimit",inputMode:"numeric",pattern:"[0-9]*",min:5,max:500,onKeyDown:W=>{["e","E","+","-","."].includes(W.key)&&W.preventDefault()},value:Number.isFinite(te)?te:"",onChange:W=>{const q=W.target.value.replace(/\D/g,"");E(Y=>{if(q==="")return{...Y,baseConfig:{...Y.baseConfig,write:{...Y.baseConfig.write,limit:NaN}}};const ne=parseInt(q,10);if(!Number.isFinite(ne))return{...Y,baseConfig:{...Y.baseConfig,write:{...Y.baseConfig.write,limit:NaN}}};const _e=Math.min(500,ne);return{...Y,baseConfig:{...Y.baseConfig,write:{...Y.baseConfig.write,limit:_e}}}})}}),!vt&&a.jsx("p",{className:"text-xs text-red-500",children:"Writes base limit must be between 5 and 500 requests per minute."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"rpcLimit",children:["RPC Base Limit",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{side:"right",align:"start",sideOffset:12,className:"max-w-xs whitespace-normal break-words",children:a.jsx("p",{children:"Limit dasar untuk operasi RPC (min: 5, max: 200)"})})]})]}),a.jsx(it,{id:"rpcLimit",inputMode:"numeric",pattern:"[0-9]*",min:5,max:200,onKeyDown:W=>{["e","E","+","-","."].includes(W.key)&&W.preventDefault()},value:Number.isFinite(We)?We:"",onChange:W=>{const q=W.target.value.replace(/\D/g,"");E(Y=>{if(q==="")return{...Y,baseConfig:{...Y.baseConfig,rpc:{...Y.baseConfig.rpc,limit:NaN}}};const ne=parseInt(q,10);if(!Number.isFinite(ne))return{...Y,baseConfig:{...Y.baseConfig,rpc:{...Y.baseConfig.rpc,limit:NaN}}};const _e=Math.min(200,ne);return{...Y,baseConfig:{...Y.baseConfig,rpc:{...Y.baseConfig.rpc,limit:_e}}}})}}),!xt&&a.jsx("p",{className:"text-xs text-red-500",children:"RPC base limit must be between 5 and 200 requests per minute."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"authLimit",children:["Auth Base Limit",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{side:"left",align:"end",sideOffset:12,className:"max-w-xs whitespace-normal break-words",children:a.jsx("p",{children:"Limit dasar untuk operasi autentikasi (min: 2, max: 100)"})})]})]}),a.jsx(it,{id:"authLimit",inputMode:"numeric",pattern:"[0-9]*",min:2,max:100,onKeyDown:W=>{["e","E","+","-","."].includes(W.key)&&W.preventDefault()},value:Number.isFinite(Ue)?Ue:"",onChange:W=>{const q=W.target.value.replace(/\D/g,"");E(Y=>{if(q==="")return{...Y,baseConfig:{...Y.baseConfig,auth:{...Y.baseConfig.auth,limit:NaN}}};const ne=parseInt(q,10);if(!Number.isFinite(ne))return{...Y,baseConfig:{...Y.baseConfig,auth:{...Y.baseConfig.auth,limit:NaN}}};const _e=Math.min(100,ne);return{...Y,baseConfig:{...Y.baseConfig,auth:{...Y.baseConfig.auth,limit:_e}}}})}}),!wt&&a.jsx("p",{className:"text-xs text-red-500",children:"Auth base limit must be between 2 and 100 requests per minute."})]})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold text-sm mb-3",children:"Adjustment Parameters"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"minMultiplier",children:["Min Multiplier",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{side:"right",align:"center",sideOffset:12,className:"max-w-xs whitespace-normal break-words",children:a.jsx("p",{children:"Multiplier minimum (misal: 0.5 = 50%). Digunakan saat sistem stres (min: 0.1, max: 1.0)"})})]})]}),a.jsx(it,{id:"minMultiplier",inputMode:"decimal",pattern:"^[0-9]*[.]?[0-9]*$",min:.1,max:1,step:.1,onKeyDown:W=>{["e","E","+","-"].includes(W.key)&&W.preventDefault()},value:I,onChange:W=>{var Le;let q=W.target.value.replace(/[^0-9.]/g,"");if((((Le=q.match(/\./g))==null?void 0:Le.length)??0)>1)return;if(q.startsWith(".")&&(q=`0${q}`),q.includes(".")){const[be,ee]=q.split("."),oe=(ee??"").slice(0,3);q=`${be}.${oe}`}if(q===""||q==="."){P(""),E(be=>({...be,minMultiplier:NaN}));return}const Y=parseFloat(q);if(!Number.isFinite(Y)){P(""),E(be=>({...be,minMultiplier:NaN}));return}const ne=Math.min(1,Y),_e=Y>ne?ne.toFixed(3).replace(/\.?0+$/,""):q;P(_e),E(be=>({...be,minMultiplier:parseFloat(_e)}))}}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Minimum:"," ",Number.isFinite(ue)?`${(ue*100).toFixed(0)}% dari base limit`:"Enter a minimum multiplier value"]}),!ht&&a.jsx("p",{className:"text-xs text-red-500",children:"Min multiplier must be between 0.1 and 1.0."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"maxMultiplier",children:["Max Multiplier",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{side:"left",align:"center",sideOffset:12,className:"max-w-xs whitespace-normal break-words",children:a.jsx("p",{children:"Multiplier maksimum (misal: 2.0 = 200%). Digunakan saat sistem sehat (min: 1.0, max: 5.0)"})})]})]}),a.jsx(it,{id:"maxMultiplier",inputMode:"decimal",pattern:"^[0-9]*[.]?[0-9]*$",min:1,max:5,step:.1,onKeyDown:W=>{["e","E","+","-"].includes(W.key)&&W.preventDefault()},value:U,onChange:W=>{var Le;let q=W.target.value.replace(/[^0-9.]/g,"");if((((Le=q.match(/\./g))==null?void 0:Le.length)??0)>1)return;if(q.startsWith(".")&&(q=`0${q}`),q.includes(".")){const[be,ee]=q.split("."),oe=(ee??"").slice(0,3);q=`${be}.${oe}`}if(q===""||q==="."){Z(""),E(be=>({...be,maxMultiplier:NaN}));return}const Y=parseFloat(q);if(!Number.isFinite(Y)){Z(""),E(be=>({...be,maxMultiplier:NaN}));return}const ne=Math.min(5,Y),_e=Y>ne?ne.toFixed(3).replace(/\.?0+$/,""):q;Z(_e),E(be=>({...be,maxMultiplier:parseFloat(_e)}))}}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Maximum:"," ",Number.isFinite(xe)?`${(xe*100).toFixed(0)}% dari base limit`:"Enter a maximum multiplier value"]}),!_t&&a.jsx("p",{className:"text-xs text-red-500",children:"Max multiplier must be between 1.0 and 5.0."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"healthyLatency",children:["Healthy Latency Threshold (ms)",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{side:"right",align:"center",sideOffset:12,className:"max-w-xs whitespace-normal break-words",children:a.jsx("p",{children:"Response time di bawah ini dianggap sehat. Sistem akan meningkatkan limit (min: 50ms, max: 1000ms)"})})]})]}),a.jsx(it,{id:"healthyLatency",inputMode:"numeric",pattern:"[0-9]*",min:50,max:1e3,step:50,onKeyDown:W=>{["e","E","+","-","."].includes(W.key)&&W.preventDefault()},value:Number.isFinite(ce)?ce:"",onChange:W=>{const q=W.target.value.replace(/\D/g,"");E(Y=>{if(q==="")return{...Y,healthyLatencyThreshold:NaN};const ne=parseInt(q,10);if(!Number.isFinite(ne))return{...Y,healthyLatencyThreshold:NaN};const _e=Math.min(1e3,ne);return{...Y,healthyLatencyThreshold:_e}})}}),a.jsx("p",{className:"text-xs text-muted-foreground",children:Number.isFinite(ce)?`${(ce/1e3).toFixed(1)} seconds`:"Enter a value between 50 and 1000 milliseconds"}),!Wt&&a.jsx("p",{className:"text-xs text-red-500",children:"Healthy latency threshold must be between 50 and 1000 milliseconds."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"stressLatency",children:["Stress Latency Threshold (ms)",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{side:"left",align:"center",sideOffset:12,className:"max-w-xs whitespace-normal break-words",children:a.jsx("p",{children:"Response time di atas ini dianggap stres. Sistem akan menurunkan limit (min: 500ms, max: 10000ms)"})})]})]}),a.jsx(it,{id:"stressLatency",inputMode:"numeric",pattern:"[0-9]*",min:500,max:1e4,step:100,onKeyDown:W=>{["e","E","+","-","."].includes(W.key)&&W.preventDefault()},value:Number.isFinite(qe)?qe:"",onChange:W=>{const q=W.target.value.replace(/\D/g,"");E(Y=>{if(q==="")return{...Y,stressLatencyThreshold:NaN};const ne=parseInt(q,10);if(!Number.isFinite(ne))return{...Y,stressLatencyThreshold:NaN};const _e=Math.min(1e4,ne);return{...Y,stressLatencyThreshold:_e}})}}),a.jsx("p",{className:"text-xs text-muted-foreground",children:Number.isFinite(qe)?`${(qe/1e3).toFixed(1)} seconds`:"Enter a value between 500 and 10000 milliseconds"}),!pe&&a.jsx("p",{className:"text-xs text-red-500",children:"Stress latency threshold must be between 500 and 10000 milliseconds."})]}),a.jsxs("div",{className:"space-y-2 md:col-span-2",children:[a.jsxs(Qe,{htmlFor:"adjustmentInterval",children:["Adjustment Interval (ms)",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{side:"right",align:"center",sideOffset:12,className:"max-w-xs whitespace-normal break-words",children:a.jsx("p",{children:"Frekuensi pengecekan dan penyesuaian limit (min: 10000ms, max: 600000ms)"})})]})]}),a.jsx(it,{id:"adjustmentInterval",inputMode:"numeric",pattern:"[0-9]*",min:1e4,max:6e5,step:1e4,onKeyDown:W=>{["e","E","+","-","."].includes(W.key)&&W.preventDefault()},value:Number.isFinite(Se)?Se:"",onChange:W=>{const q=W.target.value.replace(/\D/g,"");E(Y=>{if(q==="")return{...Y,adjustmentInterval:NaN};const ne=parseInt(q,10);if(!Number.isFinite(ne))return{...Y,adjustmentInterval:NaN};const _e=Math.min(6e5,ne);return{...Y,adjustmentInterval:_e}})}}),a.jsx("p",{className:"text-xs text-muted-foreground",children:Number.isFinite(Se)?`Setiap ${(Se/1e3).toFixed(0)} detik`:"Enter an interval between 10000 and 600000 milliseconds."}),!Oe&&a.jsx("p",{className:"text-xs text-red-500",children:"Adjustment interval must be between 10000 and 600000 milliseconds."})]})]})]}),a.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:a.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:[" ",a.jsx("strong",{children:"Tips:"})," Adaptive rate limiter secara otomatis menyesuaikan limit berdasarkan metrik sistem (response time, error rate). Saat sistem sehat, limit akan naik. Saat sistem stres, limit akan turun untuk melindungi database dari overload."]})})]}),a.jsxs(Pa,{children:[a.jsx(se,{variant:"outline",onClick:()=>_(!1),children:"Batal"}),a.jsx(se,{variant:"default",onClick:Ze,disabled:!nt||!vt||!xt||!wt||!ht||!_t||!Wt||!pe||!Oe,children:"Simpan Perubahan"})]})]})}),a.jsx(xn,{open:x,onOpenChange:w,children:a.jsxs(un,{className:"max-w-2xl",children:[a.jsxs(dn,{children:[a.jsxs(hn,{className:"flex items-center gap-2",children:[a.jsx(Ia,{className:"h-5 w-5 text-blue-500"}),"Edit Circuit Breaker Configuration"]}),a.jsx(Hr,{children:"Ubah threshold dan timeout untuk circuit breaker. Perubahan akan langsung diterapkan."})]}),a.jsxs("div",{className:"py-4 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"failureThreshold",children:["Failure Threshold",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Jumlah kegagalan yang diperlukan sebelum circuit breaker terbuka (min: 1, max: 100)"})})]})]}),a.jsx(it,{id:"failureThreshold",inputMode:"numeric",pattern:"[0-9]*",min:1,max:100,value:Number.isFinite($.failureThreshold)?$.failureThreshold:"",onChange:W=>{const q=W.target.value.replace(/\D/g,"");if(q===""){z(ne=>({...ne,failureThreshold:1}));return}const Y=Math.min(100,Math.max(1,parseInt(q,10)));z(ne=>({...ne,failureThreshold:Y}))}})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"resetTimeout",children:["Reset Timeout (milliseconds)",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Waktu tunggu sebelum mencoba pemulihan (transisi ke HALF_OPEN). Min: 10000ms, Max: 300000ms"})})]})]}),a.jsx(it,{id:"resetTimeout",inputMode:"numeric",pattern:"[0-9]*",min:1e4,max:3e5,step:1e3,onKeyDown:W=>{["e","E","+","-","."].includes(W.key)&&W.preventDefault()},value:Number.isFinite($.resetTimeout)?$.resetTimeout:"",onChange:W=>{const q=W.target.value.replace(/\D/g,"");if(q===""){z(ne=>({...ne,resetTimeout:NaN}));return}const Y=parseInt(q,10);if(!Number.isFinite(Y)){z(ne=>({...ne,resetTimeout:NaN}));return}z(ne=>({...ne,resetTimeout:Y}))}}),a.jsx("p",{className:"text-xs text-muted-foreground",children:Number.isFinite($.resetTimeout)?`${($.resetTimeout/1e3).toFixed(0)} seconds`:"Enter a value between 10000 and 300000"}),Number.isFinite($.resetTimeout)&&$.resetTimeout<1e4&&a.jsx("p",{className:"text-xs text-red-500",children:"Minimum reset timeout is 10000 milliseconds (10 seconds)."}),Number.isFinite($.resetTimeout)&&$.resetTimeout>3e5&&a.jsx("p",{className:"text-xs text-red-500",children:"Maximum reset timeout is 300000 milliseconds."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"successThreshold",children:["Success Threshold",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Jumlah sukses berturut-turut di HALF_OPEN untuk menutup circuit (min: 1, max: 10)"})})]})]}),a.jsx(it,{id:"successThreshold",inputMode:"numeric",pattern:"[0-9]*",min:1,max:10,onKeyDown:W=>{["e","E","+","-","."].includes(W.key)&&W.preventDefault()},value:Number.isFinite($.successThreshold)?$.successThreshold:"",onChange:W=>{const q=W.target.value.replace(/\D/g,"");if(q===""){z(_e=>({..._e,successThreshold:NaN}));return}const Y=parseInt(q,10);if(!Number.isFinite(Y)){z(_e=>({..._e,successThreshold:NaN}));return}const ne=Math.min(10,Math.max(1,Y));z(_e=>({..._e,successThreshold:ne}))}}),(!Number.isFinite($.successThreshold)||$.successThreshold<1||$.successThreshold>10)&&a.jsx("p",{className:"text-xs text-red-500",children:"Success threshold must be a number between 1 and 10."})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs(Qe,{htmlFor:"monitoringPeriod",children:["Monitoring Period (milliseconds)",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Jendela waktu untuk menghitung kegagalan. Kegagalan di luar jendela ini tidak dihitung. Min: 1000ms, Max: 60000ms"})})]})]}),a.jsx(it,{id:"monitoringPeriod",inputMode:"numeric",pattern:"[0-9]*",min:1e3,max:6e4,step:1e3,onKeyDown:W=>{["e","E","+","-","."].includes(W.key)&&W.preventDefault()},value:Number.isFinite($.monitoringPeriod)?$.monitoringPeriod:"",onChange:W=>{const q=W.target.value.replace(/\D/g,"");if(q===""){z(ne=>({...ne,monitoringPeriod:NaN}));return}const Y=parseInt(q,10);if(!Number.isFinite(Y)){z(ne=>({...ne,monitoringPeriod:NaN}));return}z(ne=>({...ne,monitoringPeriod:Y}))}}),a.jsx("p",{className:"text-xs text-muted-foreground",children:Number.isFinite($.monitoringPeriod)?`${($.monitoringPeriod/1e3).toFixed(0)} seconds`:"Enter a value between 1000 and 60000"}),Number.isFinite($.monitoringPeriod)&&$.monitoringPeriod<1e3&&a.jsx("p",{className:"text-xs text-red-500",children:"Minimum monitoring period is 1000 milliseconds (1 second)."}),Number.isFinite($.monitoringPeriod)&&$.monitoringPeriod>6e4&&a.jsx("p",{className:"text-xs text-red-500",children:"Maximum monitoring period is 60000 milliseconds (60 seconds)."})]}),a.jsxs("div",{className:"space-y-2 md:col-span-2",children:[a.jsxs(Qe,{htmlFor:"timeout",children:["Request Timeout (milliseconds)",a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(Ke,{className:"h-3 w-3 inline ml-1 text-muted-foreground cursor-help"})}),a.jsx(ge,{children:a.jsx("p",{children:"Timeout maksimal untuk setiap request database. Request yang melebihi waktu ini akan dianggap gagal. Min: 1000ms, Max: 60000ms"})})]})]}),a.jsx(it,{id:"timeout",inputMode:"numeric",pattern:"[0-9]*",min:1e3,max:6e4,step:1e3,onKeyDown:W=>{["e","E","+","-","."].includes(W.key)&&W.preventDefault()},value:Number.isFinite($.timeout)?$.timeout:"",onChange:W=>{const q=W.target.value.replace(/\D/g,"");if(q===""){z(_e=>({..._e,timeout:NaN}));return}const Y=parseInt(q,10);if(!Number.isFinite(Y)){z(_e=>({..._e,timeout:NaN}));return}const ne=Math.min(6e4,Y);z(_e=>({..._e,timeout:ne}))}}),a.jsx("p",{className:"text-xs text-muted-foreground",children:Number.isFinite($.timeout)?`${($.timeout/1e3).toFixed(0)} seconds`:"Enter a value between 1000 and 60000"}),Number.isFinite($.timeout)&&$.timeout<1e3&&a.jsx("p",{className:"text-xs text-red-500",children:"Minimum request timeout is 1000 milliseconds (1 second)."})]})]}),a.jsx("div",{className:"bg-blue-50 dark:bg-blue-950/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3",children:a.jsxs("p",{className:"text-xs text-blue-700 dark:text-blue-300",children:[" ",a.jsx("strong",{children:"Tips:"})," Threshold yang terlalu rendah dapat membuat circuit breaker terlalu sensitif. Threshold yang terlalu tinggi dapat menunda respons terhadap masalah database. Gunakan nilai yang sesuai dengan karakteristik aplikasi Anda."]})})]}),a.jsxs(Pa,{children:[a.jsx(se,{variant:"outline",onClick:()=>w(!1),children:"Batal"}),a.jsx(se,{variant:"default",onClick:je,disabled:!Number.isFinite($.resetTimeout)||$.resetTimeout<1e4||$.resetTimeout>3e5||!Number.isFinite($.failureThreshold)||$.failureThreshold<1||$.failureThreshold>100||!Number.isFinite($.successThreshold)||$.successThreshold<1||$.successThreshold>10||!Number.isFinite($.monitoringPeriod)||$.monitoringPeriod<1e3||$.monitoringPeriod>6e4||!Number.isFinite($.timeout)||$.timeout<1e3||$.timeout>6e4||!nt||!vt||!xt||!wt||!ht||!_t||!Wt||!pe||!Oe,children:"Simpan Perubahan"})]})]})}),a.jsx(xn,{open:O,onOpenChange:A,children:a.jsxs(un,{className:"max-w-md",children:[a.jsx(dn,{children:a.jsxs(hn,{className:"flex items-center gap-2",children:[a.jsx(oo,{className:"h-5 w-5 text-red-500"}),"Error"]})}),a.jsx("div",{className:"py-4",children:a.jsx("p",{className:"text-sm text-red-600 dark:text-red-400",children:N})}),a.jsx(Pa,{children:a.jsx(se,{variant:"destructive",onClick:()=>A(!1),children:"Tutup"})})]})})]})}const B9=p.forwardRef(({role:e,roles:t=[],requireAll:n=!1,fallback:r=null,children:s},i)=>{const{hasRole:o,hasAnyRole:l,loading:c}=Nr();if(c)return null;const u=e?[e,...t]:t,d=n?u.every(f=>o(f)):l(u),h=!Array.isArray(s)&&typeof s!="string"&&typeof s!="number";return d?h?a.jsx(bN,{ref:i,children:s}):a.jsx(a.Fragment,{children:s}):a.jsx(a.Fragment,{children:r})});function i5e(){const[e,t]=KN(),{deleteMultipleContacts:n}=FC(),[r,s]=p.useState(""),[i,o]=p.useState(!1),[l,c]=p.useState(null),[u,d]=p.useState(!1),[h,f]=p.useState(90),[m,g]=p.useState(!1),[v,y]=p.useState(""),[x,w]=p.useState(null),[b,_]=p.useState(!1),[k,j]=p.useState(!1),[S,T]=p.useState(null),[O,A]=p.useState(null),[N,L]=p.useState(null),[M,B]=p.useState(null),[$,z]=p.useState(null),[R,C]=p.useState(!1),[D,E]=p.useState(!1),[F,I]=p.useState(""),P=p.useMemo(()=>Array.from(new Set(r.split(/[\s,\n]+/).map(Q=>Q.trim()).filter(Boolean))),[r]),U=Q=>{const fe=new URLSearchParams(e);fe.set("menu",Q),t(fe)},Z=()=>{try{fo.clear(),ze.success("Local caches cleared")}catch{ze.error("Failed to clear cache")}},X=async()=>{try{const{data:{user:Q}}=await le.auth.getUser();if(!Q)return null;const{data:fe}=await le.from("org_members").select("org_id").eq("user_id",Q.id).limit(1).maybeSingle();return(fe==null?void 0:fe.org_id)??null}catch{return null}},K=async()=>{try{const Q=await X();if(!Q)return;const{data:fe,error:Be}=await kt.from("org_settings").select("retention_days").eq("org_id",Q).maybeSingle();if(Be)throw Be;c((fe==null?void 0:fe.retention_days)??90),f((fe==null?void 0:fe.retention_days)??90)}catch(Q){console.error("Failed to fetch retention settings:",Q)}},ie=async()=>{try{const Q=await X();if(!Q)return;const{data:fe,error:Be}=await kt.from("org_settings").select("ai_paused, ai_paused_reason, ai_paused_at, ai_paused_by_user_id").eq("org_id",Q).maybeSingle();if(Be)throw Be;T(!!(fe!=null&&fe.ai_paused)),A((fe==null?void 0:fe.ai_paused_reason)??null),L((fe==null?void 0:fe.ai_paused_at)??null);const je=(fe==null?void 0:fe.ai_paused_by_user_id)??null;if(B(je),je)try{const{data:Ce}=await kt.from("users_profile").select("user_id, display_name").eq("user_id",je).maybeSingle();if(Ce!=null&&Ce.display_name)z(Ce.display_name);else{const{data:Ze}=await kt.from("v_users").select("id, email").eq("id",je).maybeSingle();z((Ze==null?void 0:Ze.email)??je)}}catch{z(je)}else z(null)}catch(Q){console.error("Failed to fetch AI pause status:",Q)}},H=async()=>{try{C(!0);const Q=await X();if(!Q)throw new Error("Unable to resolve organization");const{error:fe}=await kt.from("org_settings").update({ai_paused:!1,ai_paused_reason:null,ai_paused_at:null,ai_paused_by_user_id:null}).eq("org_id",Q);if(fe)throw fe;T(!1),A(null),L(null),B(null),z(null),ze.success("AI auto responses resumed");try{await en({action:"ai.resume",resource:"org_settings"})}catch{}}catch(Q){ze.error((Q==null?void 0:Q.message)||"Failed to resume AI responses")}finally{C(!1)}},he=async()=>{try{C(!0);const{data:{user:Q}}=await le.auth.getUser(),fe=(Q==null?void 0:Q.id)??null,Be=await X();if(!Be)throw new Error("Unable to resolve organization");const{error:je}=await kt.from("org_settings").update({ai_paused:!0,ai_paused_reason:(F==null?void 0:F.trim())||null,ai_paused_at:new Date().toISOString(),ai_paused_by_user_id:fe}).eq("org_id",Be);if(je)throw je;T(!0),A((F==null?void 0:F.trim())||null),L(new Date().toISOString()),B(fe),z(null),E(!1),ze.success("AI auto responses paused");try{await en({action:"ai.pause",resource:"org_settings",context:{reason:(F==null?void 0:F.trim())||null}})}catch{}ie()}catch(Q){ze.error((Q==null?void 0:Q.message)||"Failed to pause AI responses")}finally{C(!1),I("")}},me=async()=>{try{_(!0);const Q=await X();if(!Q)throw new Error("Unable to resolve organization");const{error:fe}=await kt.from("org_settings").update({retention_days:h}).eq("org_id",Q);if(fe)throw fe;c(h),d(!1),ze.success(`Retention period updated to ${h} days`);try{await en({action:"retention.update",resource:"org_settings",context:{retention_days:h}})}catch{}}catch(Q){ze.error((Q==null?void 0:Q.message)||"Failed to update retention settings")}finally{_(!1)}},ae=async()=>{try{_(!0);const{data:Q,error:fe}=await kt.rpc("cleanup_old_chat_data",{p_days:l??90});if(fe)throw fe;w(Q),ze.success(`Cleanup completed: ${(Q==null?void 0:Q.threads_deleted)||0} threads, ${(Q==null?void 0:Q.messages_deleted)||0} messages deleted`);try{await en({action:"retention.cleanup",resource:"chat_data",context:Q})}catch{}}catch(Q){ze.error((Q==null?void 0:Q.message)||"Failed to run cleanup")}finally{_(!1)}},Ne=async()=>{if(!v.trim()){ze.error("Please enter contact UUID");return}try{j(!0);const{data:Q,error:fe}=await kt.rpc("gdpr_delete_user_data",{p_contact_id:v.trim()});if(fe)throw fe;ze.success(`GDPR deletion completed: ${(Q==null?void 0:Q.threads_deleted)||0} threads, ${(Q==null?void 0:Q.messages_deleted)||0} messages, ${(Q==null?void 0:Q.contact_deleted)||0} contacts deleted`),g(!1),y("");try{await en({action:"gdpr.delete_request",resource:"contact",resourceId:v,context:Q})}catch{}}catch(Q){ze.error((Q==null?void 0:Q.message)||"Failed to execute GDPR deletion")}finally{j(!1)}};p.useEffect(()=>{K(),ie()},[]);const de=async()=>{if(P.length===0){ze.error("Provide at least one contact UUID");return}if(window.confirm(`Delete ${P.length} contact(s)? This cannot be undone.`))try{o(!0),await n(P),s(""),ze.success("Contacts deleted")}catch{ze.error("Bulk delete failed")}finally{o(!1)}};return a.jsx(B9,{role:yn.MASTER_AGENT,fallback:a.jsx("div",{className:"text-sm text-muted-foreground",children:"Admin Panel is available to Master Agents only."}),children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-semibold",children:"Admin Panel"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Centralized controls for master agents."})]}),a.jsx(At,{className:"bg-blue-100 text-blue-700 border-0",children:"Master Agent"})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{className:"flex items-center gap-2",children:[a.jsx(bo,{className:"h-4 w-4"})," Access & Management"]})}),a.jsxs(lt,{className:"grid gap-3 sm:grid-cols-2 lg:grid-cols-3",children:[a.jsxs(se,{variant:"outline",className:"justify-start",onClick:()=>U("permissions"),children:[a.jsx(F4,{className:"h-4 w-4 mr-2"})," Manage Roles & Permissions"]}),a.jsxs(se,{variant:"outline",className:"justify-start",onClick:()=>U("humanagents"),children:[a.jsx(EN,{className:"h-4 w-4 mr-2"})," Human Agents"]}),a.jsxs(se,{variant:"outline",className:"justify-start",onClick:()=>U("platforms"),children:[a.jsx(L4,{className:"h-4 w-4 mr-2"})," Platforms & Integrations"]}),a.jsxs(se,{variant:"outline",className:"justify-start",onClick:()=>U("analytics"),children:[a.jsx(E4,{className:"h-4 w-4 mr-2"})," Analytics"]}),a.jsxs(se,{variant:"outline",className:"justify-start",onClick:()=>U("logs"),children:[a.jsx(O4,{className:"h-4 w-4 mr-2"})," Audit Logs"]}),a.jsxs(se,{variant:"outline",className:"justify-start",onClick:()=>U("contacts"),children:[a.jsx(D4,{className:"h-4 w-4 mr-2"})," Contacts"]})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{className:"flex items-center gap-2",children:[a.jsx(xo,{className:"h-4 w-4"})," Reliability & Circuit Breaker"]})}),a.jsx(lt,{children:a.jsx(s5e,{})})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{className:"flex items-center gap-2",children:[a.jsx(xo,{className:"h-4 w-4"})," AI Auto Responses"]})}),a.jsxs(lt,{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"font-medium",children:"Status:"}),S?a.jsx(At,{className:"bg-red-100 text-red-700 border-0",children:"Paused"}):a.jsx(At,{className:"bg-emerald-100 text-emerald-700 border-0",children:"Active"})]}),S&&a.jsxs("div",{className:"mt-2 text-xs text-muted-foreground space-y-1",children:[O?a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Reason:"})," ",O]}):null,a.jsxs("div",{children:[a.jsx("span",{className:"font-medium",children:"Paused"}),$?a.jsxs(a.Fragment,{children:[" by ",$]}):null,N?a.jsxs(a.Fragment,{children:[" at ",new Date(N).toLocaleString()]}):null]})]})]}),a.jsx("div",{className:"flex items-center gap-2",children:S?a.jsxs(se,{onClick:H,disabled:R,children:[a.jsx(WV,{className:"h-4 w-4 mr-2"})," ",R?"Resuming...":"Resume AI Responses"]}):a.jsxs(se,{variant:"destructive",onClick:()=>E(!0),disabled:R,children:[a.jsx(zV,{className:"h-4 w-4 mr-2"})," Pause AI Responses"]})})]}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"When paused, AI will not auto reply across all channels until resumed."})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{className:"flex items-center gap-2",children:[a.jsx(VT,{className:"h-4 w-4"})," Utilities"]})}),a.jsx(lt,{className:"flex flex-wrap gap-2",children:a.jsxs(se,{variant:"outline",onClick:Z,children:[a.jsx(VT,{className:"h-4 w-4 mr-2"})," Clear Local Cache"]})})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{className:"flex items-center gap-2",children:"Data Retention Policy"})}),a.jsxs(lt,{className:"space-y-3",children:[a.jsx(Qe,{className:"text-sm font-medium",children:"Retention Period (days)"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(it,{type:"number",value:l??90,onChange:Q=>f(parseInt(Q.target.value)||90),className:"max-w-xs"}),a.jsx(se,{variant:"outline",onClick:()=>{f(l??90),d(!0)},children:"Edit"})]}),a.jsxs("div",{className:"text-xs text-muted-foreground",children:["Current: ",l??90," days. Chats older than this will be automatically deleted."]}),a.jsx(se,{onClick:ae,disabled:b,className:"w-full",children:b?"Running Cleanup...":"Run Cleanup Now"}),x&&a.jsxs("div",{className:"text-xs text-muted-foreground",children:["Last cleanup: ",x.threads_deleted," threads, ",x.messages_deleted," messages, ",x.contacts_deleted," contacts"]})]})]}),a.jsxs(He,{className:"border-red-200",children:[a.jsx(dt,{children:a.jsx(ct,{className:"flex items-center gap-2 text-red-700",children:"GDPR/PDPA Right to Erasure"})}),a.jsxs(lt,{className:"space-y-3",children:[a.jsx(Qe,{className:"text-sm font-medium",children:"Contact ID"}),a.jsx(it,{placeholder:"Enter contact UUID",value:v,onChange:Q=>y(Q.target.value)}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Enter the contact ID (UUID) gotten from contact detail to delete all associated data permanently."}),a.jsx(nn,{permission:"contacts.delete",children:a.jsx(se,{variant:"destructive",onClick:()=>g(!0),disabled:!v.trim()||k,className:"w-full",children:"Delete User Data"})}),a.jsx("div",{className:"text-xs text-red-600",children:"Warning: This action permanently deletes all data and cannot be undone."})]})]})]}),a.jsx(xn,{open:u,onOpenChange:d,children:a.jsxs(un,{className:"max-w-md",children:[a.jsxs(dn,{children:[a.jsx(hn,{children:"Configure Data Retention"}),a.jsx(Hr,{children:"Set how many days to retain chat data. Data older than this period will be automatically deleted."})]}),a.jsxs("div",{className:"py-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx(Qe,{htmlFor:"retention-days",children:"Retention Period (days)"}),a.jsx(it,{id:"retention-days",type:"number",value:h,onChange:Q=>f(parseInt(Q.target.value)||90)})]}),a.jsx("div",{className:"text-xs text-muted-foreground",children:"Automatic cleanup runs daily at 2 AM UTC. You can also trigger manual cleanup from the main panel."})]}),a.jsxs(Pa,{children:[a.jsx(se,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),a.jsx(se,{onClick:me,disabled:b,children:b?"Saving...":"Save"})]})]})}),a.jsx(xn,{open:D,onOpenChange:E,children:a.jsxs(un,{className:"max-w-md",children:[a.jsxs(dn,{children:[a.jsx(hn,{children:"Pause AI Auto Responses"}),a.jsx(Hr,{children:"This will pause all AI auto replies across all platforms. You can resume anytime."})]}),a.jsx("div",{className:"py-4 space-y-4",children:a.jsxs("div",{children:[a.jsx(Qe,{htmlFor:"pause-reason",children:"Reason (optional)"}),a.jsx(qr,{id:"pause-reason",placeholder:"Enter a reason for pausing (visible to admins)",value:F,onChange:Q=>I(Q.target.value),className:"min-h-[90px]"})]})}),a.jsxs(Pa,{children:[a.jsx(se,{variant:"outline",onClick:()=>E(!1),disabled:R,children:"Cancel"}),a.jsx(se,{variant:"destructive",onClick:he,disabled:R,children:R?"Pausing...":"Confirm Pause"})]})]})}),a.jsx(xn,{open:m,onOpenChange:g,children:a.jsxs(un,{className:"max-w-md",children:[a.jsxs(dn,{children:[a.jsx(hn,{children:"Confirm GDPR Data Deletion"}),a.jsxs(Hr,{children:["This action will permanently delete all data associated with contact ID: ",a.jsx("code",{className:"bg-muted px-1 rounded",children:v})]})]}),a.jsxs(Pa,{children:[a.jsx(se,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),a.jsx(se,{variant:"destructive",onClick:Ne,disabled:k,children:k?"Deleting...":"Confirm Deletion"})]})]})}),a.jsxs(He,{className:"border-red-200",children:[a.jsx(dt,{children:a.jsxs(ct,{className:"flex items-center gap-2 text-red-700",children:[a.jsx(oo,{className:"h-4 w-4"})," Danger Zone"]})}),a.jsx(lt,{className:"space-y-3",children:a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Paste contact UUIDs (comma/newline separated) to delete permanently."}),a.jsx(qr,{value:r,onChange:Q=>s(Q.target.value),placeholder:"uuid-1, uuid-2, uuid-3",className:"min-h-[120px]"}),a.jsxs("div",{className:"mt-2 flex items-center justify-between",children:[a.jsxs("div",{className:"text-xs text-muted-foreground",children:["Parsed: ",P.length]}),a.jsx(nn,{permission:"contacts.delete",children:a.jsxs(se,{variant:"destructive",onClick:de,disabled:i||P.length===0,children:[a.jsx(xa,{className:"h-4 w-4 mr-2"})," Delete ",P.length||""," Contact",P.length>1?"s":""]})})]})]})})]})]})})}function o5e(){var z,R;Ar();const[e,t]=p.useState([]),[n,r]=p.useState(20),[s,i]=p.useState(1),[o,l]=p.useState(0),[c,u]=p.useState("all"),[d,h]=p.useState("all"),[f,m]=p.useState(),[g,v]=p.useState([]),[y,x]=p.useState([]),[w,b]=p.useState({}),[_,k]=p.useState(!1),[j,S]=p.useState(null),[T,O]=p.useState(null),[A,N]=p.useState(!1),L=p.useMemo(()=>{if(!(f!=null&&f.from)||!(f!=null&&f.to))return{from:null,to:null};const C=Ul(f.from).toISOString(),D=kC(f.to).toISOString();return{from:C,to:D}},[f]),M=async()=>{const{data:C}=await le.from("audit_logs").select("user_id").not("user_id","is",null).limit(1e3),D=Array.from(new Set((C||[]).map(F=>F.user_id)));if(D.length>0){const{data:F}=await le.from("v_users").select("id,email,display_name").in("id",D),I=(F||[]).map(U=>({id:U.id,email:U.email}));v(I);const P={};for(const U of F||[])P[U.id]={email:U.email,display_name:U.display_name};b(U=>({...U,...P}))}else v([]);const{data:E}=await le.from("audit_logs").select("action").limit(1e3);x(Array.from(new Set((E||[]).map(F=>F.action))))},B=async()=>{const C=(s-1)*n,{data:D,error:E}=await le.rpc("get_audit_logs",{p_user_id:c!=="all"?c:null,p_action:d!=="all"?d:null,p_from:L.from,p_to:L.to,p_limit:n,p_offset:C});if(!E){const F=D||[];t(F);let I=le.from("audit_logs").select("id",{count:"exact"});c!=="all"&&(I=I.eq("user_id",c)),d!=="all"&&(I=I.eq("action",d)),L.from&&(I=I.gte("created_at",L.from)),L.to&&(I=I.lte("created_at",L.to));const{count:P}=await I;l(P||0);const Z=Array.from(new Set(F.map(X=>X.user_id).filter(Boolean))).filter(X=>!w[X]);if(Z.length>0){const{data:X}=await le.from("v_users").select("id,email,display_name").in("id",Z),K={};for(const ie of X||[])K[ie.id]={email:ie.email,display_name:ie.display_name};Object.keys(K).length&&b(ie=>({...ie,...K}))}}};p.useEffect(()=>{M()},[]),p.useEffect(()=>{if(f!=null&&f.from&&!(f!=null&&f.to)){O("Select both a start date and an end date to filter logs.");return}if(f!=null&&f.to&&!(f!=null&&f.from)){m({from:f.to,to:f.to}),O(null);return}O(null)},[f]),p.useEffect(()=>{B()},[s,n,c,d,L.from,L.to]),p.useEffect(()=>{const C=le.channel("realtime:logs").on("postgres_changes",{event:"INSERT",schema:"public",table:"audit_logs"},D=>{const E=D.new;t(I=>[E,...I].slice(0,n));const F=E.user_id;F&&!w[F]&&le.from("v_users").select("id,email,display_name").eq("id",F).maybeSingle().then(({data:I})=>{I&&b(P=>({...P,[I.id]:{email:I.email,display_name:I.display_name}}))}),l(I=>I+1)}).subscribe();return()=>{le.removeChannel(C)}},[n]);const $=Math.max(1,Math.ceil(o/n));return a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsx("h1",{className:"text-2xl font-semibold",children:"Logs"}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsx(ct,{children:"Filters"})}),a.jsxs(lt,{className:"grid grid-cols-1 md:grid-cols-5 gap-3",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:"User"}),a.jsxs(tn,{value:c,onValueChange:u,children:[a.jsx(Jt,{className:"h-9",children:a.jsx(Gt,{placeholder:"All"})}),a.jsxs(Qt,{children:[a.jsx(st,{value:"all",children:"All"}),g.map(C=>a.jsx(st,{value:C.id,children:C.email},C.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs text-muted-foreground",children:"Action"}),a.jsxs(tn,{value:d,onValueChange:h,children:[a.jsx(Jt,{className:"h-9",children:a.jsx(Gt,{placeholder:"All"})}),a.jsxs(Qt,{children:[a.jsx(st,{value:"all",children:"All"}),y.map(C=>a.jsx(st,{value:C,children:C},C))]})]})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("label",{className:"text-xs text-muted-foreground block mb-1",children:"Date Range"}),a.jsxs(Ii,{open:A,onOpenChange:C=>N(C),children:[a.jsx(Ri,{asChild:!0,onClick:()=>N(!0),children:a.jsxs(se,{variant:"outline",className:Ie("justify-start text-left font-normal h-9 w-full",!(f!=null&&f.from)&&!(f!=null&&f.to)&&"text-muted-foreground"),children:[a.jsx(Hc,{className:"mr-2 h-4 w-4"}),f!=null&&f.from&&(f!=null&&f.to)?`${f.from.toLocaleDateString()}  ${f.to.toLocaleDateString()}`:"Select date range"]})}),a.jsx(ni,{className:"w-auto min-w-[560px] p-0",align:"start",children:a.jsx(Mm,{initialFocus:!0,mode:"range",defaultMonth:f==null?void 0:f.from,selected:f,onSelect:C=>{m(C),C!=null&&C.from&&(C!=null&&C.to)&&N(!1)},numberOfMonths:2})})]}),T?a.jsx("p",{className:"text-xs text-destructive mt-1",children:T}):null]}),a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsxs(tn,{value:String(n),onValueChange:C=>r(Number(C)),children:[a.jsx(Jt,{className:"h-9",children:a.jsx(Gt,{placeholder:"Page size"})}),a.jsx(Qt,{children:[10,20,50,100].map(C=>a.jsxs(st,{value:String(C),children:[C," / page"]},C))})]}),a.jsx(se,{variant:"outline",onClick:()=>{const C=e.map(D=>{var E;return{time:new Date(D.created_at).toISOString(),user:D.user_id?((E=w[D.user_id])==null?void 0:E.email)||D.user_id:"",action:D.action,resource:D.resource,resource_id:D.resource_id||"",ip:D.ip?D.ip.replace(/(\d+\.\d+\.\d+)\.\d+/,"$1.*"):"",context:JSON.stringify(H4(D.context||{}))}});LG(`logs_${new Date().toISOString()}.csv`,C)},children:"Export CSV"})]})]})]}),a.jsxs(He,{children:[a.jsx(dt,{children:a.jsxs(ct,{children:["Entries (",o,")"]})}),a.jsxs(lt,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs(Zb,{children:[a.jsx(e0,{children:a.jsxs(mo,{children:[a.jsx(tr,{children:"Time"}),a.jsx(tr,{children:"User"}),a.jsx(tr,{children:"Action"}),a.jsx(tr,{children:"Resource"}),a.jsx(tr,{children:"Resource ID"}),a.jsx(tr,{children:"IP"}),a.jsx(tr,{})]})}),a.jsx(t0,{children:e.map(C=>{var D,E;return a.jsxs(mo,{children:[a.jsx(qn,{children:new Date(C.created_at).toLocaleString()}),a.jsx(qn,{children:C.user_id?((D=w[C.user_id])==null?void 0:D.display_name)||((E=w[C.user_id])==null?void 0:E.email)||C.user_id:""}),a.jsx(qn,{children:C.action}),a.jsx(qn,{children:C.resource}),a.jsx(qn,{children:C.resource_id||""}),a.jsx(qn,{children:C.ip||""}),a.jsx(qn,{className:"text-right",children:a.jsx(se,{variant:"outline",size:"sm",onClick:()=>{S(C),k(!0)},children:"Details"})})]},C.id)})})]})}),a.jsxs("div",{className:"flex items-center justify-between mt-4",children:[a.jsxs("div",{className:"text-sm text-muted-foreground",children:["Page ",s," of ",$]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(se,{variant:"outline",disabled:s<=1,onClick:()=>i(C=>Math.max(1,C-1)),children:"Prev"}),a.jsx(se,{variant:"outline",disabled:s>=$,onClick:()=>i(C=>Math.min($,C+1)),children:"Next"})]})]})]})]}),a.jsx(xn,{open:_,onOpenChange:k,children:a.jsxs(un,{className:"max-w-2xl",children:[a.jsxs(dn,{children:[a.jsx(hn,{children:"Log Details"}),a.jsx(Hr,{children:j?new Date(j.created_at).toLocaleString():""})]}),j&&a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-muted-foreground",children:"User"}),a.jsx("div",{children:j.user_id?((z=w[j.user_id])==null?void 0:z.display_name)||((R=w[j.user_id])==null?void 0:R.email)||j.user_id:""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-muted-foreground",children:"Action"}),a.jsx("div",{children:j.action})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-muted-foreground",children:"Resource"}),a.jsx("div",{children:j.resource})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-muted-foreground",children:"Resource ID"}),a.jsx("div",{children:j.resource_id||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-muted-foreground",children:"IP"}),a.jsx("div",{children:j.ip||""})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-muted-foreground",children:"User Agent"}),a.jsx("div",{className:"truncate",title:j.user_agent||void 0,children:j.user_agent||""})]})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-sm text-muted-foreground mb-1",children:"Context"}),a.jsx("pre",{className:"max-h-64 overflow-auto rounded bg-muted p-3 text-xs",children:JSON.stringify(j.context??{},null,2)})]})]}),a.jsx(Pa,{children:a.jsx(se,{variant:"outline",onClick:()=>k(!1),children:"Close"})})]})})]})}const jD=({children:e})=>{var h,f,m,g;const{user:t,signOut:n}=Ar();p.useState("profile");const[r,s]=p.useState(!0),[i,o]=p.useState(!1),l=Va(),c=(v,y)=>v?v.split(" ").map(x=>x[0]).join("").toUpperCase().slice(0,2):y.substring(0,2).toUpperCase(),u=async()=>{try{await n()}catch(v){console.error("Error signing out:",v)}},d=()=>{l("/reset-password")};return a.jsxs(Ii,{children:[a.jsx(Ri,{asChild:!0,children:e}),a.jsx(ni,{className:"w-[300px] h-[320px] p-0 overflow-hidden",side:"left",align:"start",children:a.jsx("div",{className:"flex h-full",children:a.jsx("div",{className:"flex-1 p-4",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(Da,{className:"h-10 w-10",children:[a.jsx(Yc,{src:(h=t==null?void 0:t.user_metadata)==null?void 0:h.avatar_url,alt:((f=t==null?void 0:t.user_metadata)==null?void 0:f.full_name)||(t==null?void 0:t.email)}),a.jsx(La,{className:"text-sm bg-blue-100 text-blue-600",children:c((m=t==null?void 0:t.user_metadata)==null?void 0:m.full_name,(t==null?void 0:t.email)||"")})]}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-sm font-semibold",children:((g=t==null?void 0:t.user_metadata)==null?void 0:g.full_name)||"Audit 4"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:t==null?void 0:t.email})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Online Status"}),a.jsx("div",{className:"text-xs font-medium",children:"Online"})]}),a.jsx(Di,{checked:r,onCheckedChange:s,className:"scale-75"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-xs text-muted-foreground",children:"Notifications"}),a.jsx("div",{className:"text-xs font-medium",children:"Disabled"})]}),a.jsx(Di,{checked:i,onCheckedChange:o,className:"scale-75"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs font-medium",children:"Reset Password"}),a.jsx(se,{variant:"ghost",size:"sm",className:"p-1 h-6 w-6",onClick:d,children:a.jsx(xm,{className:"h-3 w-3 text-muted-foreground"})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-xs font-medium",children:"Log Out"}),a.jsx(se,{variant:"ghost",size:"sm",className:"p-1 h-6 w-6",onClick:u,children:a.jsx(AN,{className:"h-3 w-3 text-muted-foreground"})})]})]})]})})})})]})};function l5e({icon:e,label:t,active:n=!1,onClick:r,collapsed:s,permissions:i,requireAll:o=!1,resourceAny:l=[],requiredRoles:c=[],roleBypass:u=[]}){const{hasAnyPermission:d,hasAllPermissions:h,hasAnyRole:f,loading:m}=Nr();if(m)return null;const g=o?h(i):d(i),v=c.length===0||f(c);return!(u.length>0&&f(u))&&(!g||!v)?null:a.jsxs("button",{type:"button",onClick:r,className:Ie("group grid h-10 w-full grid-cols-[1.125rem,1fr] items-center rounded-md px-3 text-left text-sm transition-all duration-200 gap-2",n?"bg-blue-100 text-blue-700 border border-blue-200":"text-muted-foreground hover:bg-blue-50 hover:text-blue-600 hover:border hover:border-blue-100",s&&"grid-cols-[1.125rem,0fr]"),"aria-current":n?"page":void 0,title:s?t:void 0,children:[a.jsx(e,{className:`h-4 w-4 shrink-0 transition-colors ${n?"text-blue-600":"group-hover:text-blue-600"}`}),a.jsx("span",{className:Ie("overflow-hidden whitespace-nowrap text-ellipsis transition-opacity duration-200",s&&"opacity-0 pointer-events-none"),children:t})]})}const Bu=e=>{const t=id[e];return Array.isArray(t)?t.filter(n=>n==="read"||n.startsWith("read_")).map(n=>`${e}.${n}`):[]},n_={admin:{key:"admin",label:"Admin Panel",icon:xo,permissions:["admin_panel.read"],requireAll:!1,requiredRoles:[yn.MASTER_AGENT],description:"Master agent control center"},chat:{key:"chat",label:"Chat",icon:Lc,permissions:Bu("threads"),requireAll:!1,description:"View and manage conversations"},analytics:{key:"analytics",label:"Analytics",icon:E4,permissions:Bu("analytics"),requireAll:!1,description:"View performance metrics and insights"},logs:{key:"logs",label:"Logs",icon:O4,permissions:["audit_logs.read"],requireAll:!0,description:"View user action logs"},contacts:{key:"contacts",label:"Contacts",icon:EN,permissions:Bu("contacts"),requireAll:!1,description:"Manage customer contacts and identities"},platforms:{key:"platforms",label:"Connected Platforms",icon:L4,permissions:Bu("channels"),requireAll:!1,description:"Manage connected channels and integrations"},aiagents:{key:"aiagents",label:"AI Agents",icon:A4,permissions:Bu("ai_profiles"),requireAll:!1,description:"Configure and manage AI agents",forbiddenRoles:[yn.AGENT]},humanagents:{key:"humanagents",label:"Human Agents",icon:F4,permissions:Bu("super_agents"),requireAll:!1,roleBypass:[yn.MASTER_AGENT,yn.SUPER_AGENT],description:"Manage human agent assignments and roles"},permissions:{key:"permissions",label:"Permissions",icon:bo,permissions:["roles.read"],requireAll:!0,requiredRoles:[yn.MASTER_AGENT],description:"Manage roles and permissions"}},z9=["admin","chat","analytics","logs","contacts","platforms","aiagents","humanagents","permissions"];function c5e(){const{hasAnyPermission:e,hasAllPermissions:t,hasAnyRole:n,userRoles:r,userPermissions:s}=Nr(),i=u=>{const d=n_[u];return!d||(Array.isArray(d.forbiddenRoles)&&d.forbiddenRoles.length>0?n(d.forbiddenRoles):!1)?!1:(Array.isArray(d.roleBypass)&&d.roleBypass.length>0?n(d.roleBypass):!1)?!0:(d.permissions.length===0?!0:d.requireAll?t(d.permissions):e(d.permissions))?!d.requiredRoles||d.requiredRoles.length===0?!0:n(d.requiredRoles):!1},o=()=>z9.filter(u=>i(u));return{canAccessNavItem:i,getAccessibleNavItems:o,getDefaultNavItem:()=>{const u=o();return u.length>0?u[0]:null},getNavItem:u=>n_[u],navigationConfig:n_}}const xv=({step:e,title:t,description:n,emoji:r})=>a.jsxs("div",{className:"flex items-start gap-4 rounded-lg border border-border bg-card p-4 shadow-sm transition-transform hover:-translate-y-0.5",children:[a.jsx("div",{className:"text-2xl animate-float","aria-hidden":!0,children:r}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(At,{variant:"secondary",children:[e,"."]}),a.jsx("h3",{className:"text-base font-semibold text-foreground",children:t})]}),a.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:n})]})]}),_D=()=>{var z,R,C,D,E;const[e,t]=p.useState("chat"),[n,r]=p.useState(!1),{user:s,signOut:i,setAccountDeactivated:o,accountDeactivated:l}=Ar();Va();const[c,u]=KN(),{loading:d,hasRole:h}=Nr(),{getDefaultNavItem:f,getNavItem:m,canAccessNavItem:g,getAccessibleNavItems:v}=c5e(),[y,x]=p.useState(!1),[w,b]=p.useState(!1),[_,k]=p.useState(null),[j,S]=p.useState(null),T="synka_ai_paused_ack",O=z9,A=(F,I)=>{const P=new URLSearchParams(c);P.set("menu",F),u(P,I)};p.useEffect(()=>{if(d)return;const F=c.get("menu");if(F&&O.includes(F)){const I=F;if(g(I))I!==e&&t(I);else{const P=f();P&&P!==e&&(t(P),A(P,{replace:!0}))}}else if(!F){const I=f();A(I||"chat",{replace:!0})}},[c,g,f,d]),p.useEffect(()=>{if(d)return;const F=f();(!O.includes(e)||!g(e))&&F&&(t(F),A(F,{replace:!0}))},[f,g,e,O,d]);const N=async()=>{try{await i()}catch(F){console.error("Error signing out:",F)}},L=(F,I)=>F?F.split(" ").map(P=>P[0]).join("").toUpperCase().slice(0,2):I.substring(0,2).toUpperCase();p.useEffect(()=>{(async()=>{var I;try{const{data:P}=await le.auth.getUser(),U=(I=P==null?void 0:P.user)==null?void 0:I.id;if(!U)return;const{data:Z}=await le.from("org_members").select("org_id").eq("user_id",U).limit(1).maybeSingle(),X=Z==null?void 0:Z.org_id;if(!X)return;const{data:K,error:ie}=await kt.from("org_settings").select("ai_paused, ai_paused_at, ai_paused_by_user_id").eq("org_id",X).maybeSingle();if(ie)throw ie;const H=!!(K!=null&&K.ai_paused);b(H),k((K==null?void 0:K.ai_paused_at)??null);const he=K==null?void 0:K.ai_paused_by_user_id;if(he){let me=null;try{const{data:ae}=await kt.from("users_profile").select("user_id, display_name").eq("user_id",he).maybeSingle();if(me=(ae==null?void 0:ae.display_name)??null,!me){const{data:Ne}=await kt.from("v_users").select("id, email").eq("id",he).maybeSingle();me=(Ne==null?void 0:Ne.email)??he}}catch{me=he}S(me)}else S(null)}catch{}})()},[]),p.useEffect(()=>{w?localStorage.getItem(T)||x(!0):(localStorage.removeItem(T),x(!1))},[w]);const M=()=>{try{localStorage.setItem(T,Date.now().toString())}catch{}x(!1)},B=()=>{t("admin"),A("admin")},$=h(yn.MASTER_AGENT)||h(yn.SUPER_AGENT);return l?a.jsx("div",{className:"min-h-screen bg-background text-foreground",children:a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Akun Dinonaktifkan"}),a.jsx("p",{className:"text-gray-600",children:"Akun Anda telah dinonaktifkan dan tidak dapat mengakses sistem."})]})})}):a.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[a.jsxs("div",{className:"mx-auto flex min-h-screen",children:[a.jsxs("aside",{className:`shrink-0 border-r border-sidebar-border bg-sidebar transition-all duration-300 ease-in-out ${n?"w-64":"w-[4.7rem]"} md:flex md:flex-col p-4 sticky top-0 h-screen overflow-y-auto`,onMouseEnter:()=>r(!0),onMouseLeave:()=>r(!1),children:[a.jsx("div",{className:"flex items-center justify-center px-2 py-3 transition-all duration-200",children:n?a.jsx("img",{src:"/synka.png",alt:"Synka",className:"h-10 w-auto object-contain transition-all duration-300 scale-125"}):a.jsx("img",{src:"/synka_logo.png",alt:"Synka Logo",className:"h-10 w-auto object-contain transition-all duration-300 scale-110"})}),a.jsx(Kd,{className:"mb-4 mt-1"}),a.jsx("nav",{className:"flex flex-col gap-1 flex-1",children:v().map(F=>{const I=m(F);return a.jsx(l5e,{icon:I.icon,label:I.label,active:e===F,onClick:()=>{t(F),A(F)},collapsed:!n,permissions:I.permissions,requireAll:I.requireAll,resourceAny:I.resourceAny,requiredRoles:I.requiredRoles,roleBypass:I.roleBypass},F)})}),a.jsxs("div",{className:"mt-auto flex flex-col gap-1 pt-6",children:[a.jsx(Kd,{className:"mb-3"}),a.jsx(jD,{children:a.jsxs("button",{type:"button",className:Ie("group grid h-10 w-full grid-cols-[1.125rem,1fr] items-center rounded-md px-3 text-left text-sm transition-all duration-200 gap-2","text-muted-foreground hover:bg-blue-50 hover:text-blue-600 hover:border hover:border-blue-100",!n&&"grid-cols-[1.125rem,0fr]"),title:n?void 0:"Profile",children:[a.jsx(nG,{className:"h-4 w-4 shrink-0 transition-colors group-hover:text-blue-600"}),a.jsx("span",{className:Ie("overflow-hidden whitespace-nowrap text-ellipsis transition-opacity duration-200",!n&&"opacity-0 pointer-events-none"),children:"Profile"})]})})]})]}),a.jsxs("main",{className:"flex-1",children:[a.jsx("header",{className:"sticky top-0 z-10 border-b border-border bg-background/80 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:a.jsxs("div",{className:"flex items-center justify-between gap-4 px-4 py-3 md:px-8",children:[a.jsx("div",{className:"flex items-center gap-2 md:gap-3"}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx(At,{className:"hidden sm:inline-flex bg-success text-success-foreground cursor-help",children:"Online"})}),a.jsx(ge,{children:a.jsx("p",{children:"Status pengguna saat ini: Online"})})]}),a.jsx(hU,{}),a.jsxs("div",{className:"text-right hidden sm:block min-w-0",children:[a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("div",{className:"text-sm font-medium max-w-[28ch] truncate cursor-help",children:((z=s==null?void 0:s.user_metadata)==null?void 0:z.full_name)||"User"})}),a.jsx(ge,{children:a.jsx("p",{children:"Nama lengkap pengguna"})})]}),a.jsxs(ve,{children:[a.jsx(ye,{asChild:!0,children:a.jsx("div",{className:"text-xs text-muted-foreground max-w-[32ch] truncate cursor-help",children:s==null?void 0:s.email})}),a.jsx(ge,{children:a.jsx("p",{children:"Alamat email pengguna"})})]})]}),a.jsxs(xc,{children:[a.jsx(bc,{asChild:!0,children:a.jsx(se,{variant:"ghost",className:"relative h-9 w-9 rounded-full",children:a.jsxs(Da,{className:"h-9 w-9",children:[a.jsx(Yc,{src:(R=s==null?void 0:s.user_metadata)==null?void 0:R.avatar_url,alt:((C=s==null?void 0:s.user_metadata)==null?void 0:C.full_name)||(s==null?void 0:s.email)}),a.jsx(La,{className:"text-sm",children:L((D=s==null?void 0:s.user_metadata)==null?void 0:D.full_name,(s==null?void 0:s.email)||"")})]})})}),a.jsxs(ul,{className:"w-56",align:"end",forceMount:!0,children:[a.jsx(eU,{className:"font-normal",children:a.jsxs("div",{className:"flex flex-col space-y-1",children:[a.jsx("p",{className:"text-sm font-medium leading-none",children:((E=s==null?void 0:s.user_metadata)==null?void 0:E.full_name)||"User"}),a.jsx("p",{className:"text-xs leading-none text-muted-foreground",children:s==null?void 0:s.email})]})}),a.jsx(T1,{}),a.jsx(jD,{children:a.jsxs("button",{className:"flex items-center w-full px-2 py-1.5 text-sm text-left hover:bg-accent hover:text-accent-foreground rounded-sm",children:[a.jsx(yy,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Profile"})]})}),a.jsx(T1,{}),a.jsxs(ma,{onClick:N,children:[a.jsx(AN,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Log out"})]})]})]})]})]})}),a.jsx("section",{className:"px-4 py-6 md:px-8",children:e==="admin"?a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"sr-only",children:"Admin Panel"}),a.jsx(i5e,{})]}):e==="chat"?a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"sr-only",children:"Chat Inbox"}),a.jsx(Wge,{})]}):e==="analytics"?a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"sr-only",children:"Analytics Dashboard"}),a.jsx(nn,{permission:"analytics.read",children:a.jsx(M3e,{})})]}):e==="contacts"?a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"sr-only",children:"Contacts Management"}),a.jsx(nn,{permission:"contacts.read",children:a.jsx(eve,{})})]}):e==="platforms"?a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"sr-only",children:"Connected Platforms"}),a.jsx(nn,{permission:"channels.read",children:a.jsx(ive,{})})]}):e==="aiagents"?a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"sr-only",children:"AI Agents"}),a.jsx(nn,{permission:"ai_profiles.read",children:a.jsx(Q3e,{})})]}):e==="humanagents"?a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"sr-only",children:"Human Agents"}),$?a.jsx(yD,{}):a.jsx(nn,{permission:"super_agents.read",fallback:a.jsx("div",{className:"text-sm text-muted-foreground",children:"You do not have access to Human Agents."}),children:a.jsx(yD,{})})]}):e==="permissions"?a.jsx(B9,{role:yn.MASTER_AGENT,fallback:a.jsx("div",{className:"text-sm text-muted-foreground",children:"You do not have access to Permissions."}),children:a.jsxs(nn,{permission:"roles.read",children:[a.jsx("h1",{className:"sr-only",children:"Permissions"}),a.jsx(n5e,{})]})}):e==="logs"?a.jsxs(nn,{permission:"audit_logs.read",fallback:a.jsx("div",{className:"text-sm text-muted-foreground",children:"You do not have access to Logs."}),children:[a.jsx("h1",{className:"sr-only",children:"Logs"}),a.jsx(o5e,{})]}):a.jsxs(a.Fragment,{children:[a.jsx("h1",{className:"text-2xl font-bold tracking-tight md:text-3xl",children:"Selamat datang kembali di Synka!"}),a.jsxs("div",{className:"mt-6 grid gap-4 md:max-w-2xl",children:[a.jsx(xv,{step:1,title:"Hubungkan Platform",description:"Mulai terima pesan dari Whatsapp, IG, dan FB Anda!",emoji:""}),a.jsx(xv,{step:2,title:"Buat AI Agent",description:"Jawab pesan masuk dengan Agent AI Anda.",emoji:""}),a.jsx(xv,{step:3,title:"Undang Agen Manusia",description:"Undang tim Anda untuk membantu menjawab chat.",emoji:""}),a.jsx(xv,{step:4,title:"Konek AI Agent ke Inbox",description:"Hubungkan AI Agent dan Human Agent ke platform.",emoji:""})]}),a.jsxs("p",{className:"mt-4 text-sm text-muted-foreground",children:["Butuh bantuan lebih? ",a.jsx("a",{className:"text-brand underline underline-offset-4",href:"#",children:"Lihat Tutorial Youtube kami"})]})]})})]})]}),a.jsx(Nae,{open:y,onClose:M,isMasterAgent:h(yn.MASTER_AGENT),pausedByName:j,pausedAt:_,onOpenAdminPanel:h(yn.MASTER_AGENT)?B:void 0})]})};function u5e(){var l,c,u,d;const{user:e,signOut:t}=Ar(),[n,r]=p.useState(!1),s=async()=>{r(!0);try{await t(),ze.success("Signed out successfully")}catch{ze.error("Failed to sign out")}finally{r(!1)}};if(!e)return null;const i=(h,f)=>h?h.split(" ").map(m=>m[0]).join("").toUpperCase().slice(0,2):f.substring(0,2).toUpperCase(),o=h=>new Date(h).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"});return a.jsxs(He,{className:"w-full max-w-md mx-auto",children:[a.jsxs(dt,{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsxs(Da,{className:"h-20 w-20",children:[a.jsx(Yc,{src:(l=e.user_metadata)==null?void 0:l.avatar_url,alt:((c=e.user_metadata)==null?void 0:c.full_name)||e.email}),a.jsx(La,{className:"text-lg",children:i((u=e.user_metadata)==null?void 0:u.full_name,e.email||"")})]})}),a.jsx(ct,{className:"text-xl",children:((d=e.user_metadata)==null?void 0:d.full_name)||"User"}),a.jsx(Ts,{children:e.email}),a.jsx("div",{className:"flex justify-center mt-2",children:a.jsxs(At,{variant:"secondary",className:"flex items-center gap-1",children:[a.jsx(bo,{className:"w-3 h-3"}),e.email_confirmed_at?"Verified":"Unverified"]})})]}),a.jsxs(lt,{className:"space-y-4",children:[a.jsx(Kd,{}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(vy,{className:"w-4 h-4 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"Email"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:e.email})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Hc,{className:"w-4 h-4 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"Member since"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:o(e.created_at)})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(yy,{className:"w-4 h-4 text-muted-foreground"}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium",children:"User ID"}),a.jsxs("p",{className:"text-sm text-muted-foreground font-mono",children:[e.id.substring(0,8),"..."]})]})]})]}),a.jsx(Kd,{}),a.jsxs(se,{variant:"outline",className:"w-full",onClick:s,disabled:n,children:[a.jsx(AN,{className:"w-4 h-4 mr-2"}),n?"Signing out...":"Sign Out"]})]})]})}function d5e(){const e=Va();return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-gray-900 dark:to-gray-800 p-4",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsxs(se,{variant:"ghost",onClick:()=>e("/"),children:[a.jsx(Rp,{className:"w-4 h-4 mr-2"}),"Back to Dashboard"]}),a.jsx(hU,{})]}),a.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Profile"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-2",children:"Manage your account settings and preferences"})]}),a.jsx(u5e,{})]})})}const kD=e=>e.replace(/\s/g,""),h5e=[{id:"lowercase",test:e=>/[a-z]/.test(e),message:"Minimal 1 huruf kecil (a-z)"},{id:"uppercase",test:e=>/[A-Z]/.test(e),message:"Minimal 1 huruf besar (A-Z)"},{id:"number",test:e=>/[0-9]/.test(e),message:"Minimal 1 angka (0-9)"},{id:"symbol",test:e=>/[^A-Za-z0-9]/.test(e),message:"Minimal 1 simbol (contoh: !@#$)"},{id:"length",test:e=>e.length>=8,message:"Minimal 8 karakter"}],SD=e=>h5e.filter(t=>!t.test(e)).map(t=>t.message);function ND(){const[e,t]=p.useState(""),[n,r]=p.useState(""),[s,i]=p.useState(!1),[o,l]=p.useState(!1),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),g=Va();p.useEffect(()=>{(async()=>{try{const _=new URL(window.location.href).searchParams.get("code");_&&await le.auth.exchangeCodeForSession(_);const{data:{session:k}}=await le.auth.getSession();k||u("Invalid or expired reset link. Please request a new password reset.")}catch(b){console.warn("Password setup init failed",b)}})()},[]);const v=async w=>{if(w.preventDefault(),l(!0),u(null),!e){u("Kata sandi baru belum diisi."),m(!0),l(!1);return}if(SD(e).length>0){u("Pastikan kata sandi memenuhi semua persyaratan."),m(!0),l(!1);return}if(e!==n){u("Konfirmasi kata sandi tidak sama."),l(!1);return}try{const{error:_}=await le.auth.updateUser({password:e});if(_)throw _;try{const{data:{user:k}}=await le.auth.getUser();k&&await le.from("users_profile").update({password_set:!0}).eq("user_id",k.id)}catch(k){console.warn("Failed to update password_set flag:",k)}h(!0),ze.success("Password updated successfully!");try{await le.auth.signOut()}catch{}try{localStorage.removeItem("otpVerified"),localStorage.removeItem("otpRequired"),localStorage.removeItem("app.lastAuthEvent"),localStorage.removeItem("auth.intent")}catch{}setTimeout(()=>{g("/")},1500)}catch(_){console.error("Password reset error:",_),u(_ instanceof Error?_.message:"Gagal memperbarui kata sandi."),ze.error("Gagal memperbarui kata sandi.")}finally{l(!1)}},y=f&&e.length>0,x=p.useMemo(()=>y?SD(e):[],[e,y]);return d?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-slate-950 dark:to-slate-900 p-4",children:a.jsxs(He,{className:"w-full max-w-md",children:[a.jsxs(dt,{className:"text-center",children:[a.jsx(ct,{className:"text-2xl font-bold text-green-600",children:"Success!"}),a.jsx(Ts,{children:"Your password has been updated successfully. You will be redirected to the login page shortly."})]}),a.jsx(lt,{className:"text-center",children:a.jsx(se,{onClick:()=>g("/"),className:"w-full",children:"Go to Login"})})]})}):a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-slate-950 dark:to-slate-900 p-4",children:a.jsxs(He,{className:"w-full max-w-md",children:[a.jsxs(dt,{className:"space-y-1",children:[a.jsxs(se,{variant:"ghost",size:"sm",onClick:()=>g("/"),className:"absolute top-4 left-4",children:[a.jsx(Rp,{className:"w-4 h-4 mr-2"}),"Back to Login"]}),a.jsxs("div",{className:"text-center",children:[a.jsx(ct,{className:"text-2xl font-bold",children:"Reset Password"}),a.jsx(Ts,{children:"Enter your new password below"})]})]}),a.jsxs(lt,{children:[c&&a.jsx(Pm,{className:"mb-4 border-red-200 bg-red-50",children:a.jsx(Om,{className:"text-red-800",children:c})}),a.jsxs("form",{onSubmit:v,className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{htmlFor:"password",children:"New Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(xm,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(it,{id:"password",type:s?"text":"password",placeholder:"Enter new password",value:e,onChange:w=>{f||m(!0),t(kD(w.target.value))},onKeyDown:w=>{w.key===" "&&w.preventDefault()},className:"pl-10 pr-10",required:!0,minLength:8}),a.jsx(se,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>i(!s),children:s?a.jsx(I4,{className:"h-4 w-4"}):a.jsx(CN,{className:"h-4 w-4"})})]}),x.length>0&&a.jsx("div",{className:"mt-2 space-y-1",children:x.map(w=>a.jsxs("p",{className:"flex items-center gap-2 text-xs text-red-600",children:[a.jsx(P4,{className:"h-3 w-3"}),w]},w))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Qe,{htmlFor:"confirm-password",children:"Confirm New Password"}),a.jsxs("div",{className:"relative",children:[a.jsx(xm,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),a.jsx(it,{id:"confirm-password",type:s?"text":"password",placeholder:"Confirm new password",value:n,onChange:w=>r(kD(w.target.value)),onKeyDown:w=>{w.key===" "&&w.preventDefault()},className:"pl-10",required:!0,minLength:8})]})]}),a.jsx(se,{type:"submit",className:"w-full",disabled:o,children:o?a.jsxs(a.Fragment,{children:[a.jsx(Ht,{className:"mr-2 h-4 w-4 animate-spin"}),"Updating password..."]}):"Update Password"})]})]})]})})}var f5e=Object.defineProperty,m5e=Object.defineProperties,p5e=Object.getOwnPropertyDescriptors,$x=Object.getOwnPropertySymbols,W9=Object.prototype.hasOwnProperty,q9=Object.prototype.propertyIsEnumerable,CD=(e,t,n)=>t in e?f5e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,g5e=(e,t)=>{for(var n in t||(t={}))W9.call(t,n)&&CD(e,n,t[n]);if($x)for(var n of $x(t))q9.call(t,n)&&CD(e,n,t[n]);return e},v5e=(e,t)=>m5e(e,p5e(t)),y5e=(e,t)=>{var n={};for(var r in e)W9.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&$x)for(var r of $x(e))t.indexOf(r)<0&&q9.call(e,r)&&(n[r]=e[r]);return n};function x5e(e){let t=setTimeout(e,0),n=setTimeout(e,10),r=setTimeout(e,50);return[t,n,r]}function b5e(e){let t=p.useRef();return p.useEffect(()=>{t.current=e}),t.current}var w5e=18,H9=40,j5e=`${H9}px`,_5e=["[data-lastpass-icon-root]","com-1password-button","[data-dashlanecreated]",'[style$="2147483647 !important;"]'].join(",");function k5e({containerRef:e,inputRef:t,pushPasswordManagerStrategy:n,isFocused:r}){let[s,i]=p.useState(!1),[o,l]=p.useState(!1),[c,u]=p.useState(!1),d=p.useMemo(()=>n==="none"?!1:(n==="increase-width"||n==="experimental-no-flickering")&&s&&o,[s,o,n]),h=p.useCallback(()=>{let f=e.current,m=t.current;if(!f||!m||c||n==="none")return;let g=f,v=g.getBoundingClientRect().left+g.offsetWidth,y=g.getBoundingClientRect().top+g.offsetHeight/2,x=v-w5e,w=y;document.querySelectorAll(_5e).length===0&&document.elementFromPoint(x,w)===f||(i(!0),u(!0))},[e,t,c,n]);return p.useEffect(()=>{let f=e.current;if(!f||n==="none")return;function m(){let v=window.innerWidth-f.getBoundingClientRect().right;l(v>=H9)}m();let g=setInterval(m,1e3);return()=>{clearInterval(g)}},[e,n]),p.useEffect(()=>{let f=r||document.activeElement===t.current;if(n==="none"||!f)return;let m=setTimeout(h,0),g=setTimeout(h,2e3),v=setTimeout(h,5e3),y=setTimeout(()=>{u(!0)},6e3);return()=>{clearTimeout(m),clearTimeout(g),clearTimeout(v),clearTimeout(y)}},[t,r,n,h]),{hasPWMBadge:s,willPushPWMBadge:d,PWM_BADGE_SPACE_WIDTH:j5e}}var K9=p.createContext({}),V9=p.forwardRef((e,t)=>{var n=e,{value:r,onChange:s,maxLength:i,textAlign:o="left",pattern:l,placeholder:c,inputMode:u="numeric",onComplete:d,pushPasswordManagerStrategy:h="increase-width",pasteTransformer:f,containerClassName:m,noScriptCSSFallback:g=S5e,render:v,children:y}=n,x=y5e(n,["value","onChange","maxLength","textAlign","pattern","placeholder","inputMode","onComplete","pushPasswordManagerStrategy","pasteTransformer","containerClassName","noScriptCSSFallback","render","children"]),w,b,_,k,j;let[S,T]=p.useState(typeof x.defaultValue=="string"?x.defaultValue:""),O=r??S,A=b5e(O),N=p.useCallback(de=>{s==null||s(de),T(de)},[s]),L=p.useMemo(()=>l?typeof l=="string"?new RegExp(l):l:null,[l]),M=p.useRef(null),B=p.useRef(null),$=p.useRef({value:O,onChange:N,isIOS:typeof window<"u"&&((b=(w=window==null?void 0:window.CSS)==null?void 0:w.supports)==null?void 0:b.call(w,"-webkit-touch-callout","none"))}),z=p.useRef({prev:[(_=M.current)==null?void 0:_.selectionStart,(k=M.current)==null?void 0:k.selectionEnd,(j=M.current)==null?void 0:j.selectionDirection]});p.useImperativeHandle(t,()=>M.current,[]),p.useEffect(()=>{let de=M.current,Q=B.current;if(!de||!Q)return;$.current.value!==de.value&&$.current.onChange(de.value),z.current.prev=[de.selectionStart,de.selectionEnd,de.selectionDirection];function fe(){if(document.activeElement!==de){I(null),U(null);return}let Ce=de.selectionStart,Ze=de.selectionEnd,rt=de.selectionDirection,Je=de.maxLength,te=de.value,We=z.current.prev,Ue=-1,ue=-1,xe;if(te.length!==0&&Ce!==null&&Ze!==null){let nt=Ce===Ze,vt=Ce===te.length&&te.length<Je;if(nt&&!vt){let xt=Ce;if(xt===0)Ue=0,ue=1,xe="forward";else if(xt===Je)Ue=xt-1,ue=xt,xe="backward";else if(Je>1&&te.length>1){let wt=0;if(We[0]!==null&&We[1]!==null){xe=xt<We[1]?"backward":"forward";let ht=We[0]===We[1]&&We[0]<Je;xe==="backward"&&!ht&&(wt=-1)}Ue=wt+xt,ue=wt+xt+1}}Ue!==-1&&ue!==-1&&Ue!==ue&&M.current.setSelectionRange(Ue,ue,xe)}let ce=Ue!==-1?Ue:Ce,qe=ue!==-1?ue:Ze,Se=xe??rt;I(ce),U(qe),z.current.prev=[ce,qe,Se]}if(document.addEventListener("selectionchange",fe,{capture:!0}),fe(),document.activeElement===de&&E(!0),!document.getElementById("input-otp-style")){let Ce=document.createElement("style");if(Ce.id="input-otp-style",document.head.appendChild(Ce),Ce.sheet){let Ze="background: transparent !important; color: transparent !important; border-color: transparent !important; opacity: 0 !important; box-shadow: none !important; -webkit-box-shadow: none !important; -webkit-text-fill-color: transparent !important;";kf(Ce.sheet,"[data-input-otp]::selection { background: transparent !important; color: transparent !important; }"),kf(Ce.sheet,`[data-input-otp]:autofill { ${Ze} }`),kf(Ce.sheet,`[data-input-otp]:-webkit-autofill { ${Ze} }`),kf(Ce.sheet,"@supports (-webkit-touch-callout: none) { [data-input-otp] { letter-spacing: -.6em !important; font-weight: 100 !important; font-stretch: ultra-condensed; font-optical-sizing: none !important; left: -1px !important; right: 1px !important; } }"),kf(Ce.sheet,"[data-input-otp] + * { pointer-events: all !important; }")}}let Be=()=>{Q&&Q.style.setProperty("--root-height",`${de.clientHeight}px`)};Be();let je=new ResizeObserver(Be);return je.observe(de),()=>{document.removeEventListener("selectionchange",fe,{capture:!0}),je.disconnect()}},[]);let[R,C]=p.useState(!1),[D,E]=p.useState(!1),[F,I]=p.useState(null),[P,U]=p.useState(null);p.useEffect(()=>{x5e(()=>{var de,Q,fe,Be;(de=M.current)==null||de.dispatchEvent(new Event("input"));let je=(Q=M.current)==null?void 0:Q.selectionStart,Ce=(fe=M.current)==null?void 0:fe.selectionEnd,Ze=(Be=M.current)==null?void 0:Be.selectionDirection;je!==null&&Ce!==null&&(I(je),U(Ce),z.current.prev=[je,Ce,Ze])})},[O,D]),p.useEffect(()=>{A!==void 0&&O!==A&&A.length<i&&O.length===i&&(d==null||d(O))},[i,d,A,O]);let Z=k5e({containerRef:B,inputRef:M,pushPasswordManagerStrategy:h,isFocused:D}),X=p.useCallback(de=>{let Q=de.currentTarget.value.slice(0,i);if(Q.length>0&&L&&!L.test(Q)){de.preventDefault();return}typeof A=="string"&&Q.length<A.length&&document.dispatchEvent(new Event("selectionchange")),N(Q)},[i,N,A,L]),K=p.useCallback(()=>{var de;if(M.current){let Q=Math.min(M.current.value.length,i-1),fe=M.current.value.length;(de=M.current)==null||de.setSelectionRange(Q,fe),I(Q),U(fe)}E(!0)},[i]),ie=p.useCallback(de=>{var Q,fe;let Be=M.current;if(!f&&(!$.current.isIOS||!de.clipboardData||!Be))return;let je=de.clipboardData.getData("text/plain"),Ce=f?f(je):je;de.preventDefault();let Ze=(Q=M.current)==null?void 0:Q.selectionStart,rt=(fe=M.current)==null?void 0:fe.selectionEnd,Je=(Ze!==rt?O.slice(0,Ze)+Ce+O.slice(rt):O.slice(0,Ze)+Ce+O.slice(Ze)).slice(0,i);if(Je.length>0&&L&&!L.test(Je))return;Be.value=Je,N(Je);let te=Math.min(Je.length,i-1),We=Je.length;Be.setSelectionRange(te,We),I(te),U(We)},[i,N,L,O]),H=p.useMemo(()=>({position:"relative",cursor:x.disabled?"default":"text",userSelect:"none",WebkitUserSelect:"none",pointerEvents:"none"}),[x.disabled]),he=p.useMemo(()=>({position:"absolute",inset:0,width:Z.willPushPWMBadge?`calc(100% + ${Z.PWM_BADGE_SPACE_WIDTH})`:"100%",clipPath:Z.willPushPWMBadge?`inset(0 ${Z.PWM_BADGE_SPACE_WIDTH} 0 0)`:void 0,height:"100%",display:"flex",textAlign:o,opacity:"1",color:"transparent",pointerEvents:"all",background:"transparent",caretColor:"transparent",border:"0 solid transparent",outline:"0 solid transparent",boxShadow:"none",lineHeight:"1",letterSpacing:"-.5em",fontSize:"var(--root-height)",fontFamily:"monospace",fontVariantNumeric:"tabular-nums"}),[Z.PWM_BADGE_SPACE_WIDTH,Z.willPushPWMBadge,o]),me=p.useMemo(()=>p.createElement("input",v5e(g5e({autoComplete:x.autoComplete||"one-time-code"},x),{"data-input-otp":!0,"data-input-otp-placeholder-shown":O.length===0||void 0,"data-input-otp-mss":F,"data-input-otp-mse":P,inputMode:u,pattern:L==null?void 0:L.source,"aria-placeholder":c,style:he,maxLength:i,value:O,ref:M,onPaste:de=>{var Q;ie(de),(Q=x.onPaste)==null||Q.call(x,de)},onChange:X,onMouseOver:de=>{var Q;C(!0),(Q=x.onMouseOver)==null||Q.call(x,de)},onMouseLeave:de=>{var Q;C(!1),(Q=x.onMouseLeave)==null||Q.call(x,de)},onFocus:de=>{var Q;K(),(Q=x.onFocus)==null||Q.call(x,de)},onBlur:de=>{var Q;E(!1),(Q=x.onBlur)==null||Q.call(x,de)}})),[X,K,ie,u,he,i,P,F,x,L==null?void 0:L.source,O]),ae=p.useMemo(()=>({slots:Array.from({length:i}).map((de,Q)=>{var fe;let Be=D&&F!==null&&P!==null&&(F===P&&Q===F||Q>=F&&Q<P),je=O[Q]!==void 0?O[Q]:null,Ce=O[0]!==void 0?null:(fe=c==null?void 0:c[Q])!=null?fe:null;return{char:je,placeholderChar:Ce,isActive:Be,hasFakeCaret:Be&&je===null}}),isFocused:D,isHovering:!x.disabled&&R}),[D,R,i,P,F,x.disabled,O]),Ne=p.useMemo(()=>v?v(ae):p.createElement(K9.Provider,{value:ae},y),[y,ae,v]);return p.createElement(p.Fragment,null,g!==null&&p.createElement("noscript",null,p.createElement("style",null,g)),p.createElement("div",{ref:B,"data-input-otp-container":!0,style:H,className:m},Ne,p.createElement("div",{style:{position:"absolute",inset:0,pointerEvents:"none"}},me)))});V9.displayName="Input";function kf(e,t){try{e.insertRule(t)}catch{console.error("input-otp could not insert CSS rule:",t)}}var S5e=`
[data-input-otp] {
  --nojs-bg: white !important;
  --nojs-fg: black !important;

  background-color: var(--nojs-bg) !important;
  color: var(--nojs-fg) !important;
  caret-color: var(--nojs-fg) !important;
  letter-spacing: .25em !important;
  text-align: center !important;
  border: 1px solid var(--nojs-fg) !important;
  border-radius: 4px !important;
  width: 100% !important;
}
@media (prefers-color-scheme: dark) {
  [data-input-otp] {
    --nojs-bg: black !important;
    --nojs-fg: white !important;
  }
}`;const G9=p.forwardRef(({className:e,containerClassName:t,...n},r)=>a.jsx(V9,{ref:r,containerClassName:Ie("flex items-center gap-2 has-[:disabled]:opacity-50",t),className:Ie("disabled:cursor-not-allowed",e),...n}));G9.displayName="InputOTP";const Y9=p.forwardRef(({className:e,...t},n)=>a.jsx("div",{ref:n,className:Ie("flex items-center",e),...t}));Y9.displayName="InputOTPGroup";const vc=p.forwardRef(({index:e,className:t,...n},r)=>{const s=p.useContext(K9),{char:i,hasFakeCaret:o,isActive:l}=s.slots[e];return a.jsxs("div",{ref:r,className:Ie("relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md",l&&"z-10 ring-2 ring-ring ring-offset-background",t),...n,children:[i,o&&a.jsx("div",{className:"pointer-events-none absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"h-4 w-px animate-caret-blink bg-foreground duration-1000"})})]})});vc.displayName="InputOTPSlot";const N5e=p.forwardRef(({...e},t)=>a.jsx("div",{ref:t,role:"separator",...e,children:a.jsx(HV,{})}));N5e.displayName="InputOTPSeparator";function C5e(){const e=Va(),t=$o(),{user:n,session:r,otpRequired:s,setOtpVerified:i}=Ar(),[o,l]=p.useState(""),[c,u]=p.useState(!1),[d,h]=p.useState(!1),[f,m]=p.useState(null),[g,v]=p.useState(null),[y,x]=p.useState(!1),[w,b]=p.useState(0),[_,k]=p.useState(0);p.useEffect(()=>{v((n==null?void 0:n.email)??null),(!n||!s)&&e("/",{replace:!0});try{const O=new URL(window.location.href),A=O.searchParams.get("type"),N=!!O.searchParams.get("code"),M=(window.location.hash||"").includes("access_token=");x(A==="recovery"||N||M);const B=localStorage.getItem("otpCooldownUntil"),$=B?parseInt(B,10):0;$&&$>Date.now()&&b($)}catch{}},[n,s,e]),p.useEffect(()=>{if(!w){k(0);return}const O=()=>{const N=Math.ceil((w-Date.now())/1e3);if(N<=0){k(0),b(0);try{localStorage.removeItem("otpCooldownUntil")}catch{}}else k(N)};O();const A=setInterval(O,1e3);return()=>clearInterval(A)},[w]);const j=async O=>{var A,N;O.preventDefault(),u(!0),m(null);try{const L=n==null?void 0:n.email,{data:M,error:B}=await le.rpc("verify_email_2fa",{p_code:o,p_session_minutes:10,p_user:n==null?void 0:n.id});if(B)throw B;if(!M)throw new Error("Invalid code");i(!0);try{localStorage.setItem("otpVerified","true"),localStorage.removeItem("auth.intent")}catch{}if(ze.success("Verification successful"),(((A=t==null?void 0:t.state)==null?void 0:A.intent)||null)==="recovery"||y)e("/reset-password",{replace:!0});else{const z=((N=t==null?void 0:t.state)==null?void 0:N.from)||"/";e(z,{replace:!0})}}catch(L){m((L==null?void 0:L.message)||"Verification failed"),ze.error("Verification failed")}finally{u(!1)}},S=async()=>{if(!(_>0)){h(!0);try{await le.functions.invoke("send-2fa-login-email",{headers:r!=null&&r.access_token?{Authorization:`Bearer ${r.access_token}`}:void 0}),ze.success("A new code was sent");const O=Date.now()+3e4;b(O);try{localStorage.setItem("otpCooldownUntil",String(O))}catch{}}catch{ze.error("Could not resend code")}finally{h(!1)}}},T=async()=>{try{await le.auth.signOut()}catch{}try{localStorage.removeItem("otpVerified"),localStorage.removeItem("otpRequired"),localStorage.removeItem("auth.intent"),localStorage.removeItem("otpCooldownUntil")}catch{}e("/",{replace:!0})};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-slate-950 dark:to-slate-900 p-4",children:a.jsxs(He,{className:"w-full max-w-md",children:[a.jsxs(dt,{className:"space-y-1 text-center",children:[a.jsx(ct,{className:"text-2xl font-bold",children:"Enter verification code"}),a.jsxs(Ts,{children:["We sent a 6-digit code to ",g?a.jsx("span",{className:"font-medium",children:g}):"your email","."]})]}),a.jsxs(lt,{children:[f&&a.jsx(Pm,{className:"mb-4 border-red-200 bg-red-50",children:a.jsx(Om,{className:"text-red-800",children:f})}),a.jsxs("form",{onSubmit:j,className:"space-y-6",children:[a.jsx("div",{className:"flex justify-center",children:a.jsx(G9,{maxLength:6,value:o,onChange:l,autoFocus:!0,children:a.jsxs(Y9,{children:[a.jsx(vc,{index:0}),a.jsx(vc,{index:1}),a.jsx(vc,{index:2}),a.jsx(vc,{index:3}),a.jsx(vc,{index:4}),a.jsx(vc,{index:5})]})})}),a.jsx(se,{type:"submit",className:"w-full",disabled:c||o.length!==6,children:c?a.jsxs(a.Fragment,{children:[a.jsx(Ht,{className:"mr-2 h-4 w-4 animate-spin"}),"Verifying..."]}):"Verify"}),a.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground",children:[a.jsx("span",{children:"Didn't get the code?"}),a.jsx(se,{type:"button",variant:"link",className:"px-0",onClick:S,disabled:d||_>0,children:d?"Resending...":_>0?`Resend in ${_}s`:"Resend code"})]}),a.jsx("div",{className:"flex items-center justify-center",children:a.jsx(se,{type:"button",variant:"ghost",onClick:T,children:"Sign out"})})]})]})]})})}function A5e(){const{signOut:e}=Ar(),t=Va();return p.useEffect(()=>{(async()=>{await e(),t("/login",{replace:!0})})()},[e,t]),null}const E5e=()=>{const e=$o();return p.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",e.pathname)},[e.pathname]),a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),a.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),a.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})};var vi="Accordion",T5e=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[kE,P5e,O5e]=Pp(vi),[G0,CUe]=Mr(vi,[O5e,P9]),SE=P9(),X9=G.forwardRef((e,t)=>{const{type:n,...r}=e,s=r,i=r;return a.jsx(kE.Provider,{scope:e.__scopeAccordion,children:n==="multiple"?a.jsx(D5e,{...i,ref:t}):a.jsx(M5e,{...s,ref:t})})});X9.displayName=vi;var[J9,I5e]=G0(vi),[Q9,R5e]=G0(vi,{collapsible:!1}),M5e=G.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},collapsible:i=!1,...o}=e,[l,c]=Ha({prop:n,defaultProp:r??"",onChange:s,caller:vi});return a.jsx(J9,{scope:e.__scopeAccordion,value:G.useMemo(()=>l?[l]:[],[l]),onItemOpen:c,onItemClose:G.useCallback(()=>i&&c(""),[i,c]),children:a.jsx(Q9,{scope:e.__scopeAccordion,collapsible:i,children:a.jsx(Z9,{...o,ref:t})})})}),D5e=G.forwardRef((e,t)=>{const{value:n,defaultValue:r,onValueChange:s=()=>{},...i}=e,[o,l]=Ha({prop:n,defaultProp:r??[],onChange:s,caller:vi}),c=G.useCallback(d=>l((h=[])=>[...h,d]),[l]),u=G.useCallback(d=>l((h=[])=>h.filter(f=>f!==d)),[l]);return a.jsx(J9,{scope:e.__scopeAccordion,value:o,onItemOpen:c,onItemClose:u,children:a.jsx(Q9,{scope:e.__scopeAccordion,collapsible:!0,children:a.jsx(Z9,{...i,ref:t})})})}),[L5e,Y0]=G0(vi),Z9=G.forwardRef((e,t)=>{const{__scopeAccordion:n,disabled:r,dir:s,orientation:i="vertical",...o}=e,l=G.useRef(null),c=Ot(l,t),u=P5e(n),h=Ih(s)==="ltr",f=Ve(e.onKeyDown,m=>{var T;if(!T5e.includes(m.key))return;const g=m.target,v=u().filter(O=>{var A;return!((A=O.ref.current)!=null&&A.disabled)}),y=v.findIndex(O=>O.ref.current===g),x=v.length;if(y===-1)return;m.preventDefault();let w=y;const b=0,_=x-1,k=()=>{w=y+1,w>_&&(w=b)},j=()=>{w=y-1,w<b&&(w=_)};switch(m.key){case"Home":w=b;break;case"End":w=_;break;case"ArrowRight":i==="horizontal"&&(h?k():j());break;case"ArrowDown":i==="vertical"&&k();break;case"ArrowLeft":i==="horizontal"&&(h?j():k());break;case"ArrowUp":i==="vertical"&&j();break}const S=w%x;(T=v[S].ref.current)==null||T.focus()});return a.jsx(L5e,{scope:n,disabled:r,direction:s,orientation:i,children:a.jsx(kE.Slot,{scope:n,children:a.jsx(ot.div,{...o,"data-orientation":i,ref:c,onKeyDown:r?void 0:f})})})}),Fx="AccordionItem",[$5e,NE]=G0(Fx),eH=G.forwardRef((e,t)=>{const{__scopeAccordion:n,value:r,...s}=e,i=Y0(Fx,n),o=I5e(Fx,n),l=SE(n),c=pr(),u=r&&o.value.includes(r)||!1,d=i.disabled||e.disabled;return a.jsx($5e,{scope:n,open:u,disabled:d,triggerId:c,children:a.jsx(R9,{"data-orientation":i.orientation,"data-state":iH(u),...l,...s,ref:t,disabled:d,open:u,onOpenChange:h=>{h?o.onItemOpen(r):o.onItemClose(r)}})})});eH.displayName=Fx;var tH="AccordionHeader",nH=G.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,s=Y0(vi,n),i=NE(tH,n);return a.jsx(ot.h3,{"data-orientation":s.orientation,"data-state":iH(i.open),"data-disabled":i.disabled?"":void 0,...r,ref:t})});nH.displayName=tH;var kS="AccordionTrigger",rH=G.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,s=Y0(vi,n),i=NE(kS,n),o=R5e(kS,n),l=SE(n);return a.jsx(kE.ItemSlot,{scope:n,children:a.jsx(q3e,{"aria-disabled":i.open&&!o.collapsible||void 0,"data-orientation":s.orientation,id:i.triggerId,...l,...r,ref:t})})});rH.displayName=kS;var aH="AccordionContent",sH=G.forwardRef((e,t)=>{const{__scopeAccordion:n,...r}=e,s=Y0(vi,n),i=NE(aH,n),o=SE(n);return a.jsx(H3e,{role:"region","aria-labelledby":i.triggerId,"data-orientation":s.orientation,...o,...r,ref:t,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...e.style}})});sH.displayName=aH;function iH(e){return e?"open":"closed"}var F5e=X9,U5e=eH,B5e=nH,oH=rH,lH=sH;const z5e=F5e,cH=p.forwardRef(({className:e,...t},n)=>a.jsx(U5e,{ref:n,className:Ie("border-b",e),...t}));cH.displayName="AccordionItem";const uH=p.forwardRef(({className:e,children:t,...n},r)=>a.jsx(B5e,{className:"flex",children:a.jsxs(oH,{ref:r,className:Ie("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",e),...n,children:[t,a.jsx(Ma,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));uH.displayName=oH.displayName;const dH=p.forwardRef(({className:e,children:t,...n},r)=>a.jsx(lH,{ref:r,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...n,children:a.jsx("div",{className:Ie("pb-4 pt-0",e),children:t})}));dH.displayName=lH.displayName;const AD=`# Change Log\r
\r
# [0.1.98] FE WEB CEKAT 2026-02-27\r
\r
### Messages Data Stucture\r
\r
- **Unified Message Body**: Deprecated and removed the \`file_link\` column from the database interaction layer. All message contentwhether plain text or attachment URLsis now stored consistently in the \`body\` field.\r
\r
# [0.1.97] FE/BE CEKAT 2026-02-23\r
\r
### LiveChat Architecture & Orchestration\r
\r
- **Frontend-driven Orchestration**: Refactored the LiveChat widget (\`useLiveChat.ts\`) to handle core database operations natively.\r
  - Replaced the monolithic n8n webhook with a streamlined flow, shifting the responsibility of thread creation, context fetching, and welcome messages to the frontend.\r
  - Integrated a new Supabase edge function (\`livechat-orchestrator\`) to bypass RLS for secure, anonymous contact and thread creation (\`ensure_thread\`), and to fetch AI profile context (\`get_ai_context\`).\r
- **Post-Response Pipeline**:\r
  - The n8n workflow is now simplified and strictly focuses on AI agent routing, knowledge retrieval, and logging AI message responses (\`insert_ai_message\`, \`log_token_usage\`, \`check_handover\`).\r
- **Bug Fixes & UX Polish**:\r
  - **Returning Visitor Recognition**: Fixed a bug where returning visitors wouldn't have their \`contact_id\` resolved locally, ensuring n8n always receives valid contact info.\r
  - **Welcome Message Timing**: Moved the welcome message insertion to fire _before_ the AI webhook call. This guarantees the welcome bubble renders instantly before the AI response starts streaming.\r
\r
# [0.1.96] FE WEB CEKAT 2026-02-23\r
\r
### Embed Widget\r
\r
- **Auto-detect Username**: Updated the embed code config to automatically extract the logged-in username from the host site's navbar DOM (\`document.querySelector('.navbar-right strong').innerText.trim()\`) instead of requiring manual input. This applies to both the preview textarea and the copy-to-clipboard snippet.\r
  - Updated: \`src/components/platforms/ConnectedPlatforms.tsx\`\r
\r
# [0.1.95] FE WEB CEKAT 2026-02-23\r
\r
### Messaging Architecture & Attachments\r
\r
- **Unified Message Body**: Deprecated and removed the \`file_link\` column from the database interaction layer. All message contentwhether plain text or attachment URLsis now stored consistently in the \`body\` field.\r
- **Two-Row Image-with-Caption Pattern**: Refactored both the Admin Dashboard and LiveChat widget to handle captioned images as two distinct database rows (an attachment row followed by a text row). This ensures cleaner searchability and more robust rendering across all channels.\r
- **Smart Media Rendering**: Rewrote the rendering logic in \`MessageList.tsx\` and \`ConversationPage.tsx\` to dynamically detect and display attachments based on message type and file extension, eliminating the previous "double image" rendering bug.\r
- **Cleanup**: Professionally removed legacy \`file_link\` checks and redundant \`isBodySameAsFileLink\` logic, simplifying the frontend rendering engine.\r
\r
# [0.1.94] FE WEB CEKAT 2026-02-23\r
\r
### Messaging & UI/UX\r
\r
- **Omnichannel Direct Insertion**: Enabled instant database insertion for both the LiveChat widget (user side) and the Conversation Page (admin side). This bypasses webhook latency for "web" channel messages, ensuring a much snappier chat experience.\r
- **Deduplication & Sync Protocol**: Implemented client-side UUID generation shared between direct inserts and webhook payloads. This allows the backend (n8n) to deduplicate incoming messages and ensures the frontend UI can seamlessly merge optimistic states with real records.\r
- **Image Priority Logic**:\r
  - Both admin and user messages now automatically set the image public URL as the message \`body\` if no text caption is provided.\r
  - Refined \`MessageList.tsx\` and \`ConversationPage.tsx\` to detect when \`body\` matches \`file_link\`, suppressing the redundant raw URL text bubble.\r
- **Admin Attribution Tracking**: Fixed \`actor_id\` and \`actor_kind\` population in \`useConversations.ts\`, ensuring all dashboard responses are accurately attributed to the responding agent in the database.\r
- **Cleanup**: Removed the legacy \`persistFileLink\` retry loop in \`useLiveChat.ts\` as file links are now handled in the primary message insert.\r
\r
# [0.1.93] FE WEB CEKAT 2026-02-22\r
\r
### Messaging & Webhooks\r
\r
- **Attachment Forwarding**: Enhanced the outbound webhook payload to support media messages.\r
  - Added \`file_url\` field to forward attachment URLs (images, videos, etc.) to external channel providers.\r
  - Updated \`type\` field to be dynamic based on the media type (e.g., 'image', 'video', 'file') instead of hardcoded to 'text'.\r
\r
# [0.1.92] FE WEB CEKAT 2026-02-21\r
\r
### Messaging & Webhooks\r
\r
- **Payload Standardization**: Updated the outbound message webhook payload in \`useConversations.ts\` for consistency with backend requirements.\r
  - Added \`thread_id\` to the payload.\r
  - Renamed \`contact_id\` to \`actor_id\` to better represent the message sender.\r
  - Automatically populates \`actor_id\` with the current admin user's ID for messages sent from the dashboard.\r
- **External Channel Optimization**: Refactored \`sendMessage\` logic for Telegram and WhatsApp channels.\r
  - Frontend now skips direct database insertion for these channels, delegating the operation to n8n workflows to ensure a single source of truth and consistency with automated replies.\r
  - Implemented updated optimistic state handling: messages are marked as 'sent' locally and replaced by the real database record once synced via Supabase Realtime/n8n.\r
- **Automated Follow-ups**: Prepared an updated version of the \`process-followups\` edge function with aligned payload structures (\`thread_id\` inclusion and \`actor_id: null\` for automated actions).\r
  - Updated: \`src/hooks/useConversations.ts\`, \`.artifacts/process-followups-updated.ts\`\r
\r
# [0.1.91] FE WEB CEKAT 2026-02-20\r
\r
### Attachment Rendering\r
\r
- **External Platform Fix**: Fixed images from Telegram/WhatsApp (via n8n) not rendering in the chat UI. These messages store the Supabase storage URL in the \`body\` field with \`type: 'text'\` and \`file_link: null\`, causing them to appear as raw URL links instead of images.\r
  - Added detection logic in \`ConversationPage.tsx\` and \`MessageList.tsx\` to identify body-only storage URLs and treat them as attachments.\r
  - Extension-less URLs (Telegram hash-style filenames like \`AgACAgUAAxkBAAP...\`) now default to \`image\` type instead of generic \`file\`.\r
  - Raw URL text bubble is suppressed when an attachment is detected.\r
\r
- **AttachmentRenderer Enhancements**: Improved the shared \`AttachmentRenderer\` component in \`FileUploadButton.tsx\`.\r
  - Added PDF embedded preview with click-to-view and download link.\r
  - Auto-extracts file name from URL when not provided by the message.\r
\r
### Embed Widget\r
\r
- **Embed Code UX**: Restructured the embed code in platform details (\`ConnectedPlatforms.tsx\`) into two clear sections:\r
  - **Step 1**: A config block (\`window.chatConfig = { username, web }\`) that users edit.\r
  - **Step 2**: The widget loader script marked "DO NOT EDIT" with \`baseUrl\` and \`platformId\` pre-filled.\r
\r
- **Iframe Scrollbar Fix**: Fixed vertical scrollbar appearing inside the embedded LiveChat iframe (\`LiveChat.tsx\`). Added a \`useEffect\` to set \`overflow: hidden\` and \`height: 100%\` on \`html\`/\`body\`/\`#root\` only for the livechat route.\r
\r
- **Body Margin Reset**: Added \`margin: 0; padding: 0\` to body in \`index.css\` to prevent browser default margins from causing layout overflow.\r
\r
- **embed_test.html**: Simplified to simulate a real customer's website  paste the embed code, change \`username\` and \`web\`, done.\r
\r
# [0.1.90] FE WEB CEKAT 2026-02-19\r
\r
### Live Chat\r
\r
- **Assigned Status Logic**: Updated \`useLiveChat\` to strictly treat \`pending\` thread status as "Assigned".\r
  - **Typing Indicator**: The "AI is typing..." animation is now suppressed when a thread is assigned (pending).\r
  - **AI Handover**: The frontend now skips waiting for an AI response when validity checks confirm the thread is handled by a human agent, preventing accidental AI replies during handover.\r
  - Updated: \`src/hooks/useLiveChat.ts\`\r
\r
# [0.1.89] FE WEB CEKAT 2026-02-19\r
\r
### Live Chat & Follow-up Automation\r
\r
- **Follow-up Reliability**: Refactored \`process-followups\` edge function to split logic for 'web' vs external providers.\r
  - **Web Provider**: Now inserts follow-up messages directly into the database, bypassing the webhook to ensure reliable delivery and prevent "phantom success" issues.\r
  - **External Providers**: Continues to use webhooks for WhatsApp/Telegram.\r
  - **Cleanup**: Removed duplicate \`invoke-process-followups\` cron job from the Main environment.\r
\r
- **Duplicate Message Fix**: Resolved a race condition where the first message in a Live Chat session was often duplicated.\r
  - **Root Cause**: The client's retry timeout (1s) was shorter than the backend's processing time for new sessions (Welcome Message + AI response).\r
  - **Fix**: Increased \`sendMessageRetryDelay\` in \`useLiveChat.ts\` from 1s to 10s to accommodate backend processing time.\r
  - Updated: \`src/hooks/useLiveChat.ts\`\r
\r
# [0.1.88] FE WEB CEKAT 2026-02-18\r
\r
### Live Chat & Global Notifications\r
\r
- **Live Chat Refactoring**: optimizing the \`LiveChat.tsx\` component by splitting it into smaller, manageable sub-components (\`LiveChatHeader\`, \`MessageList\`, \`MessageInput\`) and extracting logic into a dedicated \`useLiveChat\` hook.\r
  - **Performance**: Improved state management and reduced re-renders.\r
  - **Deduplication**: Added \`deduplication_id\` to message handling to prevent duplicate message bubbles.\r
  - **UI Polish**: Added "New Message" scroll bubble to indicate incoming messages when scrolled up.\r
\r
- **Global Message Listener**:\r
  - **Centralized Notifications**: Replaced \`GlobalAudioListener\` with \`GlobalMessageListener\` to handle both audio and toast notifications for incoming messages across the entire application.\r
  - **Smart Visibility**: Toast notifications now correctly respect the user's current context. Toasts are suppressed if the user is actively viewing the chat thread, even if navigating between different menus (e.g., Platforms tab).\r
  - **Click Navigation**: Clicking a notification toast now smoothly navigates the user directly to the relevant chat thread.\r
\r
- **Handover Logic**:\r
  - **n8n-First Assignment**: Removed the database trigger (\`trg_reassign_to_online_agent\`) that automatically reassigned threads from super agents to online basic agents. Assignment logic is now fully delegated to n8n workflows for better control and flexibility.\r
\r
- **Edge Functions**:\r
  - **Idempotency**: Updated \`process-followups\` edge function to prevent duplicate processing of the same follow-up task.\r
\r
# [0.1.87] FE WEB CEKAT 2026-02-16\r
\r
### Live Chat\r
\r
- **Image Rendering Fix**: Resolved an issue where images sent without captions were invisible in the LiveChat UI. The renderer now correctly displays messages with attachments even if the text body is empty.\r
- **Attachment Persistence**: Fixed a Row Level Security (RLS) policy issue that prevented \`file_link\` updates from persisting. The update policy now robustly checks both the \`account_id\` column and \`additional_data\` JSON field.\r
\r
# [0.1.86] FE WEB CEKAT 2026-02-16\r
\r
### Database & Security\r
\r
- **RLS Policy Synchronization**: Performed a full audit and synchronization of Row Level Security (RLS) policies between Development and Main production environments.\r
  - **Threads**: Expanded permissions to allow Master Agents to create and delete threads.\r
  - **Messages**: Added missing \`anon_messages_update_by_account\` for guest updates and normalized authenticated update permissions.\r
  - **Channels**: Fixed access scope issues by implementing \`can_access_super_scope\`, allowing proper team member access.\r
  - **Migrations Applied**: \`20260216_sync_threads_policies.sql\`, \`20260216_sync_messages_updates.sql\`, \`20260216_sync_channels_policies.sql\`.\r
\r
# [0.1.85] FE WEB CEKAT 2026-02-16\r
\r
### Live Chat & Notifications\r
\r
- **Inline System Messages**: System messages (e.g., "Assignee changed") now appear as centered, distinct blocks within the chat timeline instead of generic bubbles, improving readability and context.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **Collaborator Notifications**: Agents now receive real-time toast notifications when a collaborator sends a message in a thread they are viewing, ensuring seamless multi-agent coordination.\r
  - Updated: \`src/hooks/useConversations.ts\`\r
- **Database Policy Sync**: Gap analysis identified and resolved missing RLS policies (\`anon_threads_by_account\`, \`anon_messages_by_account\`) on the Main production environment, ensuring consistent guest access for LiveChat across Dev and Prod.\r
  - Applied migration: \`supabase/migrations/20260216_livechat_schema_and_policies.sql\`\r
\r
# [0.1.84] FE WEB CEKAT 2026-02-16\r
\r
### Conversation UI Improvements\r
\r
- **Collaborator Highlight**: Conversations where the current user is a collaborator are now highlighted in yellow and sorted to the top of the list for immediate visibility.\r
- **Header Cleanup**: Removed the redundant "Handled by" section from the conversation header since this info is already visible in the sidebar.\r
\r
### Presence System Fixes\r
\r
- **Immediate Offline Status**: Fixed logout flow to immediately set \`last_seen_at\` to \`NULL\` via a secure RPC (\`go_offline\`), ensuring users appear offline instantly.\r
  - Mitigated race conditions where client-side heartbeats could overwrite the offline status.\r
- **Stale Data Fix**: Updated \`useHumanAgents\` hook to always fetch fresh presence data, preventing "Seen X ago" statuses from persisting incorrectly due to caching.\r
\r
### Database & Diagnostics\r
\r
- **Debug Logging**: Added \`debug_events\` table and triggers to log \`last_seen_at\` changes for precise debugging of presence issues.\r
- **Migration**: Consolidated debug logic and offline RPC into \`supabase/migrations/20260216_go_offline_rpc.sql\`.\r
\r
# [0.1.83] FE WEB CEKAT 2026-02-14\r
\r
### Human Agents UI\r
\r
- **Status Column Split**: Separated "Presence" and "Account Status" into distinct columns in the Human Agents table.\r
  - **Presence**: Displays real-time status (Online/Idle/Offline) with visual indicators. Read-only.\r
  - **Status**: Displays account status (Active/Inactive) with a dropdown for toggling activation.\r
  - Updated grid layout to accommodate the new column structure for both Active and Pending views.\r
  - Updated: \`src/components/humanagents/HumanAgents.tsx\`\r
\r
# [0.1.82] FE WEB CEKAT 2026-02-14\r
\r
### Presence System & User Status\r
\r
- **Presence System**: Implemented real-time user presence tracking (Online, Idle, Offline).\r
  - Added \`PresenceContext\` to manage status broadcasting and idle detection (5-minute timeout).\r
  - **Offline Persistence**: Added \`last_seen_at\` to \`users_profile\` to show "Seen X ago" for offline users.\r
  - Updated \`App.tsx\` to wrap application with \`PresenceProvider\`.\r
- **UI Indicators**:\r
  - **Human Agents**: Updated agent list to show live status dots (Green=Online, Orange=Idle, Gray=Offline/Last Seen).\r
  - **Chat Header**: Added "Handled by" section in conversation view with real-time agent status.\r
- **Database**: Added \`last_seen_at\` column to \`users_profile\` table.\r
- **Migration**: \`supabase/migrations/20260214000000_add_last_seen_at.sql\`\r
\r
# [0.1.81] FE WEB CEKAT 2026-02-13\r
\r
### Global Notification Features\r
\r
- **Global Audio Listener**: Added a dedicated component \`GlobalAudioListener\` that plays a notification sound for incoming user messages, ensuring agents never miss a reply even when navigating other pages.\r
  - **Smart Routing**: The sound only plays for the specific agent assigned to the thread, or for all **superadmins** (who monitor everything).\r
  - **Persistence**: Mounted at the root level (\`App.tsx\`), so it works globally across the application.\r
  - **Sound Source**: Uses the standard system alert sound (\`/tones/mixkit-message-pop-alert-2354.mp3\`).\r
  - **Tech**: Uses a dedicated Supabase Realtime subscription to \`messages\` (INSERT) that filters for \`role=user\` to catch customer replies immediately.\r
\r
# [0.1.80] FE/DB CEKAT 2026-02-10\r
\r
### Chat Attachments Improvements & Fixes\r
\r
- **Persistence Fix**: Solved critical issue where file attachments were not persisting.\r
  - Frontend now explicitly updates \`file_link\` and \`type\` in \`messages\` table after webhook creation.\r
  - Added retry logic to ensure message exists before update.\r
- **Video Support**: Added full support for video attachments.\r
  - Database: Added \`'video'\` to \`message_type\` enum.\r
  - UI: Video player support in chat and agent dashboard.\r
- **UI Enhancements**:\r
  - **Bubble-free Media**: Images and videos now render as standalone elements outside the chat bubble.\r
  - **Image Preview Modal**: Added \`MediaViewerModal\` for immersive image viewing (pop-up instead of new tab).\r
  - **Smart Type Inference**: Auto-detects attachment type from URL extension to fix rendering for legacy/stale messages.\r
- **Security (RLS)**: Added RLS policies allowing anon (web widget) and authenticated users to update \`file_link\` on their own messages.\r
- **Files**: \`LiveChat.tsx\`, \`ConversationPage.tsx\`, \`FileUploadButton.tsx\`, \`MediaViewerModal.tsx\`\r
\r
# [0.1.79] FE/DB CEKAT 2026-02-10\r
\r
### File Attachment Support\r
\r
- **File Attachments**: Added WhatsApp-like file attachment support to all chat interfaces:\r
  - **LiveChat** - End-user chat widget\r
  - **ConversationPage** - Agent inbox message viewing\r
  - **ChatPreview** - AI Agent Settings demo chat\r
- **New Component**: \`FileUploadButton.tsx\` with upload progress\r
- **Storage Bucket**: Created \`chat-attachments\` (10MB limit)\r
  - Images: jpeg, png, gif, webp\r
  - Documents: PDF\r
  - Media: mp4, mp3, ogg\r
- **Database**: Added \`file_link\` column to \`messages\` table\r
- **Migration**: \`supabase/migrations/20260210010000_chat_attachments.sql\`\r
\r
# [0.1.78] FE/BE/DB CEKAT 2026-02-09\r
\r
### Follow-up Message Automation - Separate Settings\r
\r
- **Separate Unassigned & Assigned Settings**: Follow-up messages can now be configured independently for:\r
  - **Unassigned Threads** (status = \`open\`) - When AI is handling\r
  - **Assigned Threads** (status = \`pending\`) - When human agent is handling\r
- Each has its own enable switch and inactivity timeout (seconds)\r
- Shared message template for both\r
- **UI**: Updated \`src/components/aiagents/AIAgentSettings.tsx\` with dual panels (orange for Unassigned, blue for Assigned)\r
- **Database**: Added \`enable_followup_assigned\` and \`followup_delay_assigned\` columns to \`ai_profiles\`\r
- **Migration**: \`supabase/migrations/20260209194800_separate_followup_settings.sql\`\r
- **Edge Function**: Updated \`process-followups\` to handle both \`open\` and \`pending\` statuses\r
\r
# [0.1.77] BE/DB CEKAT 2026-02-09\r
\r
### Follow-up Message Automation\r
\r
- **Status Filter Fix**: Follow-up messages now only trigger for **Unassigned** (status = \`open\`) threads.\r
  - Follow-ups will NOT be scheduled when a thread is Assigned (\`pending\`) or Done (\`closed\`).\r
  - Clears any pending follow-up when thread status changes from open.\r
  - Migration: \`supabase/migrations/20260209192200_followup_only_open_threads.sql\`\r
  - Updated: \`supabase/functions/process-followups/index.ts\`\r
\r
# [0.1.76] FE WEB CEKAT 2026-02-06\r
\r
### Chat UI Improvements\r
\r
- **Handover Reason Display**: Added "Handover Reason" field to the Conversation Details panel.\r
  - Displays the reason for agent handover (e.g., from AI to human).\r
  - Includes text truncation and a tooltip for long reasons to preserve layout.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`, \`src/hooks/useConversations.ts\`\r
- **Move to Unassigned Logic**:\r
  - Unassigning a thread now explicitly clears \`ai_handoff_at\` and \`handover_reason\` fields to ensure a clean state.\r
  - Updated: \`supabase/migrations/20260206163000_update_unassign_thread_clear_handover.sql\`\r
\r
# [0.1.75] BE/DB CEKAT 2026-02-04\r
\r
### Follow-up Message Automation\r
\r
- **Fix Conflict Error**: Fixed conflict error in AI Agent Settings.\r
\r
# [0.1.74] BE/DB CEKAT 2026-02-04\r
\r
### Follow-up Message Automation\r
\r
- **Backend Implementation**: Added automated follow-up message system that sends a configured message to users who haven't replied after a set delay.\r
  - New \`followup_at\` and \`is_followup_sent\` columns on \`threads\` table.\r
  - Database trigger (\`handle_followup_scheduling\`) automatically schedules/cancels follow-ups based on message activity.\r
  - Edge Function (\`process-followups\`) runs every minute via \`pg_cron\` to send due messages.\r
- **Safeguards**:\r
  - Follow-ups only trigger after confirmed user engagement (ignores empty/Welcome-only threads).\r
  - Ignores "test" messages to prevent false positives during development.\r
  - Updates: \`supabase/migrations/20260202200000_add_followup_scheduling_logic.sql\`, \`supabase/migrations/20260203160000_refine_followup_trigger.sql\`, \`supabase/functions/process-followups/index.ts\`\r
\r
# [0.1.73] FE WEB CEKAT 2026-02-03\r
\r
### Chat UI Improvements\r
\r
- **Dark Mode Visibility**: Fixed an issue where user messages appeared with black text on dark backgrounds by adding \`dark:prose-invert\` for proper contrast inversion.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
\r
### Human Agent Settings\r
\r
- **Dark Mode Table Styling**: Removed incorrect white backgrounds from nested agent rows (super agents, unassigned agents) in dark mode and improved text contrast for better readability.\r
  - Updated: \`src/components/humanagents/HumanAgents.tsx\`\r
\r
# [0.1.72] FE WEB CEKAT 2026-02-02\r
\r
### AI Agent Settings\r
\r
- **Granular Save Controls**: Added separate Save buttons for Knowledge Text and Q&A sections, improving the workflow for managing knowledge sources.\r
  - Added "Save Text" button to the Text tab.\r
  - Added "Save Q&A" button to the Q&A tab.\r
  - Updated: \`src/components/aiagents/AIAgentSettings.tsx\`\r
\r
### Configuration\r
\r
- **App Origin Update**: Updated the default production \`APP_ORIGIN\` to \`synkaai.netlify.app\` for accurate deep linking and embeds.\r
  - Updated: \`src/config/urls.ts\`\r
\r
# [0.1.71] FE WEB CEKAT 2026-02-02\r
\r
### Chat UI Improvements\r
\r
- **Multi-Link Previews**: Messages containing multiple URLs now render individual preview cards for each unique link.\r
- **Improved Image Detection**: Image URLs without standard extensions (like \`picsum.photos\`) are now correctly identified and rendered as images directly.\r
- **Centralized Link Logic**: Moved link detection and URL extraction to shared utilities in \`src/lib/utils.ts\` for consistency.\r
  - Updated: \`src/pages/LiveChat.tsx\`, \`src/components/chat/ConversationPage.tsx\`, \`src/lib/utils.ts\`\r
\r
# [0.1.70] FE WEB CEKAT 2026-02-02\r
\r
### Live Chat Improvements\r
\r
- **Message Deduplication Removed**: Intentionally removed the 2000ms window deduplication guard in the LiveChat widget to allow identical messages to be visible in the UI.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
\r
# [0.1.69] FE WEB CEKAT 2026-02-02\r
\r
### Chat UI Improvements\r
\r
- **Markdown & Multi-line Support**:\r
  - Full markdown support using \`ReactMarkdown\` with \`remark-gfm\`.\r
  - Added \`remark-breaks\` to ensure single newlines (Shift+Enter) are preserved in chat bubbles.\r
  - Upgraded chat inputs to multi-line \`Textarea\` with \`Shift+Enter\` for new lines and \`Enter\` to send.\r
- **Rich Media & Link Previews**:\r
  - **Auto-Image Detection**: Links to images (.jpg, .png, etc.) now render directly in the chat.\r
  - **Rich Previews**: Website links now display a rich preview card with title, description, and site image (WhatsApp-style).\r
- **Layout & Style Refinement**:\r
  - **Smart Wrapping**: Prevents overflow by breaking long strings (like base64) while keeping natural words together.\r
  - **Aesthetics**: Restored premium \`rounded-2xl\` bubbles and \`px-4 py-2\` padding.\r
  - **Bug Fixes**: Restored sidebar tab layouts, fixed corrupted Tailwind classes, and improved system message centering.\r
  - Updated: \`src/pages/LiveChat.tsx\`, \`src/components/chat/ConversationPage.tsx\`, \`src/components/chat/LinkPreview.tsx\`, \`src/components/chat/ContactThreadPickerDialog.tsx\`, \`src/lib/utils.ts\`\r
\r
# [0.1.68] FE WEB CEKAT 2026-01-30\r
\r
### WhatsApp (WAHA) Integration\r
\r
- **Connect Button for Empty Sessions**: Added a Connect button when no WhatsApp session is found for a channel.\r
  - Previously only showed "No session found for this channel." text without any action button.\r
  - Users can now initiate WhatsApp connection directly from the empty state.\r
  - Updated: \`src/components/platforms/ConnectedPlatforms.tsx\`\r
\r
# [0.1.67] FE WEB CEKAT 2026-01-30\r
\r
### WhatsApp (WAHA) Integration\r
\r
- **API Authentication Header**: Added \`x-api-key\` header to all WAHA API requests for authentication.\r
  - All fetch calls to \`WAHA_BASE_URL\` now include \`x-api-key: "asd"\` in request headers.\r
  - Updated: \`src/components/platforms/ConnectedPlatforms.tsx\` (3 locations: session list, session details, QR polling)\r
  - Updated: \`src/components/platforms/WhatsAppPlatformForm.tsx\` (1 location: session status check)\r
\r
# [0.1.66] FE WEB CEKAT 2026-01-28\r
\r
### AI Agent Knowledge Sources\r
\r
- **Simplified File Management**: Migrated knowledge sources to a unified \`files\` table architecture, removing complex intermediary tables.\r
  - Enabled simpler toggling of file availability for AI agents via \`is_enabled\` flag.\r
  - Added direct file toggle controls (Checkbox) in the Knowledge > File list.\r
  - Improved retrieval performance by indexing documents directly to \`file_id\`.\r
  - Updated: \`supabase/migrations/20260126000000_knowledge_sources_v1.sql\`, \`src/components/aiagents/AIAgentSettings.tsx\`\r
\r
### Authentication & User Management\r
\r
- **Account Status Guard**: Implemented immediate account status check after login.\r
  - Users with \`is_active: false\` profile status are now instantly redirected to \`/account-deactivated\` upon sign-in.\r
  - Updated: \`src/components/auth/Login.tsx\`\r
\r
# [0.1.65] FE WEB CEKAT 2026-01-24\r
\r
### Dark Mode Support\r
\r
- **Application-Wide Dark Mode**: Implemented comprehensive dark mode theming across the application\r
  - Created \`ThemeContext\` (\`src/contexts/ThemeContext.tsx\`) for managing theme state (light/dark/system)\r
  - Added \`ThemeToggle\` component (\`src/components/ThemeToggle.tsx\`) with dropdown for Light/Dark/System options\r
  - Theme preference persists to localStorage and respects system preference when set to "System"\r
  - Added ThemeToggle to main header (\`src/pages/Index.tsx\`) next to Online badge for easy access\r
  - Added ThemeToggle to Profile page (\`src/pages/Profile.tsx\`) as secondary access point\r
  - Wrapped app with \`ThemeProvider\` in \`App.tsx\` for global theme context\r
\r
- **Conversations Sidebar Dark Mode Fix**: Fixed hardcoded light colors that broke dark mode\r
  - Updated tab buttons (Assigned/Unassigned/Done) with dark mode alternatives (\`dark:bg-blue-950\`, \`dark:bg-red-950\`, \`dark:bg-green-950\`)\r
  - Changed conversation list item styles to use \`dark:\` variants for hover and selected states\r
  - Replaced hardcoded \`text-gray-600\`/\`text-gray-500\` with theme-aware \`text-muted-foreground\`\r
  - Fixed tab container background from \`bg-white\` to \`bg-card\`\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
\r
### AI Agent Settings\r
\r
- **Dynamic Guide Content**: Replaced hardcoded "Panduan Umum" with customizable knowledge text\r
  - Added \`guide_content\` (TEXT) column to \`ai_profiles\` table for storing custom guide text\r
  - Added \`history_limit\` (INTEGER) column for message-count based history limit\r
  - Created migration: \`supabase/migrations/20260124000000_add_guide_content_history_limit.sql\`\r
  - Updated \`AIProfile\` TypeScript interface in \`src/hooks/useAIProfiles.ts\`\r
  - Updated Supabase types in \`src/integrations/supabase/types.ts\`\r
\r
- **Message-Based History Limit**: Changed conversation history from token-based to message-based\r
  - Updated \`HISTORY_PRACTICAL_MAX\` (50 messages) and \`HISTORY_HARD_MAX\` (100 messages)\r
  - Changed UI labels, tooltips, and helper text from "tokens" to "messages"\r
  - Updated: \`src/components/aiagents/AIAgentSettings.tsx\`\r
\r
- **Knowledge Sources UI Cleanup**: Simplified the Text tab interface\r
  - Removed non-functional "Add" and "Default" buttons\r
  - Removed decorative formatting toolbar (Undo/Redo/Bold/Italic/Alignment buttons)\r
  - Kept simple textarea for Knowledge Text Content that saves with main Save button\r
  - Updated: \`src/components/aiagents/AIAgentSettings.tsx\`\r
\r
# [0.1.64] FE WEB CEKAT 2026-01-22\r
\r
### AI Agent Management\r
\r
- **Enhanced AI Agent Creation & Editing UI**: Improved interface with better organization and validation\r
  - Separated AI Agent creation into dedicated dialog with enhanced form layout\r
  - Added comprehensive model selection system with pricing and provider information\r
  - Implemented fallback model selection for automatic failover when primary model unavailable\r
  - Updated model display with cost per 1M tokens, provider badges, and descriptions\r
  - Improved AI Agent Settings with better input handling and validation\r
  - Updated: \`src/components/aiagents/AIAgents.tsx\`, \`src/components/aiagents/AIAgentSettings.tsx\`\r
  - Updated: \`src/hooks/useAIProfiles.ts\`\r
\r
### Supabase Integration\r
\r
- **Type System Updates**: Enhanced type definitions for AI profiles and database integration\r
  - Added \`model_id\` and \`fallback_model_id\` fields to AI profile types\r
  - Updated type definitions to match database schema changes\r
  - Improved type safety across AI agent operations\r
  - Updated: \`src/integrations/supabase/types.ts\`\r
\r
### Webhook Configuration\r
\r
- **Webhook URL Enhancements**: Improved webhook payload structure and URL handling\r
  - Enhanced webhook configuration with better URL construction\r
  - Updated webhook payload format for file uploads\r
  - Improved error handling and validation\r
  - Updated: \`src/config/webhook.ts\`\r
\r
# [0.1.63] FE WEB CEKAT 2026-01-22\r
\r
### AI Agent Knowledge Files\r
\r
- **PDF Upload Reliability**: Fixed \`crypto.subtle.digest\` crash in non-secure contexts by adding fallback hash generation using file metadata.\r
  - Primary: SHA-256 via Web Crypto API when available\r
  - Fallback: DJB2-like hash from file name/size/timestamp for non-HTTPS contexts\r
  - Updated: \`src/components/aiagents/AIAgentSettings.tsx\`\r
- **Early PDF Validation**: Files are now validated as PDFs before entering the upload queue; non-PDF files are rejected with a toast error.\r
  - Updated: \`src/components/aiagents/AIAgentSettings.tsx\`\r
- **Webhook Payload Enhancement**: File upload webhook now includes \`file_url\` (Supabase storage path) dynamically constructed from \`SUPABASE_URL\`.\r
  - Updated: \`src/components/aiagents/AIAgentSettings.tsx\`\r
\r
### Development Environment\r
\r
- **HTTPS Enabled in Dev**: Vite dev server now runs with \`https: true\`, enabling Web Crypto API support and aligning dev with production security context.\r
  - Updated: \`vite.config.ts\`\r
\r
# [0.1.62] FE WEB CEKAT 2026-01-18\r
\r
### Connected Platforms\r
\r
- **Fixed chat takeover AI still has access to reply**: Added the variable change of ai_access_enabled to false when taking over whatsapp chat.\r
\r
# [0.1.61] FE WEB CEKAT 2026-01-18\r
\r
### Connected Platforms\r
\r
- **Removed toLowerCase for session_name**: Session names are now preserved with their original casing when sent to WhatsApp API endpoints, maintaining case-sensitive session identifiers.\r
  - Updated: \`src/components/platforms/ConnectedPlatforms.tsx\`\r
\r
# [0.1.60] FE WEB CEKAT 2026-01-15\r
\r
### Chat Filter\r
\r
- **Removed redundant inbox filter**: Filter modal drops the inbox selector since channel type already scopes conversations, keeping the dialog lean.\r
  - Updated: \`src/components/chat/ChatFilter.tsx\`\r
\r
# [0.1.59] FE WEB CEKAT 2026-01-15\r
\r
### Supabase\r
\r
- Reopen on inbound messages now clears \`collaborator_user_id\` so reopened/unassigned conversations have no collaborator. Migration: \`20260115124500_reopen_clear_collaborator.sql\`.\r
\r
# [0.1.58] FE WEB CEKAT 2026-01-15\r
\r
### Contacts\r
\r
- **Removed per-row delete button**: Contacts list no longer shows the single-contact delete action; bulk multi-select delete now covers this flow for master/super agents.\r
  - Updated: \`src/components/contacts/Contacts.tsx\`\r
- **Handled-by filter cleanup**: Filter uses a truthy check instead of comparing to an empty string, keeping TS types aligned while filtering assigned vs unassigned contacts.\r
  - Updated: \`src/components/contacts/Contacts.tsx\`\r
\r
# [0.1.57]  FE WEB CEKAT 2026-01-15\r
\r
### Supabase\r
\r
- Removed main-only public/anon policies on \`job\`, \`job_run_details\`, and \`storage.objects\` to match development. Migration: \`20260115123000_remove_extra_public_policies.sql\`.\r
\r
# [0.1.56] FE WEB CEKAT 2026-01-15\r
\r
### Supabase\r
\r
- **takeover_thread matches dev**: returns the updated thread, sets \`collaborator_user_id\`, \`status='pending'\`, keeps \`assigned_at\` if present. Migration: \`20260115120000_align_functions.sql\`.\r
- **reopen_thread_on_user_message matches dev**: reopens closed threads without clearing handled-by fields. Migration: \`20260115120000_align_functions.sql\`.\r
\r
# [0.1.55] FE WEB CEKAT 2026-01-15\r
\r
### Supabase (main aligned to development)\r
\r
- **Trigger parity**: Removed main-only thread triggers and added the channel super-agent sync trigger (\`tr_update_contacts_threads_on_channel_super_agent_change\`) to mirror development. New migration: \`20260115113000_align_triggers.sql\`.\r
- **Function parity**: Added missing \`unassign_thread\` SECURITY DEFINER function to main. New migration: \`20260115114000_add_unassign_thread.sql\`.\r
\r
# [0.1.54] FE WEB CEKAT 2026-01-15\r
\r
### Supabase (schema & RLS alignment)\r
\r
- **Contacts owned by super agents**: Added \`contacts.super_agent_id\`, backfilled from channel ownership, dropped \`channel_id\`, and rewrote contacts RLS to super-agent scope. New migration: \`20260115100000_contacts_super_agent.sql\`.\r
- **Scope-based RLS**: Introduced helper functions (\`can_access_super_scope\`, \`can_access_channel_scope\`, \`can_access_message_scope\`) and replaced channels/threads/messages policies with scope-based, account-aware, and web-widget rules. New migration: \`20260115103000_scope_based_policies.sql\`.\r
- **Audit/channel agents RLS parity**: Tightened \`audit_logs\` to permission-based read and simplified \`channel_agents\` to a single authenticated policy. New migration: \`20260115110000_audit_logs_channel_agents_policies.sql\`.\r
\r
# [0.1.53] FE WEB CEKAT 2026-01-15\r
\r
### Live Chat\r
\r
- **Late-arriving user rows replace optimistics**: If the backend inserts the real user message after the AI reply, the message now replaces its optimistic twin instead of showing twice, eliminating double Hello bubbles.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **Commit**: \`fix: livechat dedupe optimistic user messages\`\r
\r
# [0.1.52] FE WEB CEKAT 2026-01-14\r
\r
### Conversations & Assignment Flow\r
\r
- **Unassign keeps handled-by, clears collaborator**: Moving a chat to Unassigned now only nulls \`collaborator_user_id\`, reopens AI, and keeps the handled-by assignee intact while placing the thread in the Unassigned tab.\r
  - Updated: \`src/hooks/useConversations.ts\`, \`src/components/chat/ConversationPage.tsx\`\r
- **Takeover sets collaborator**: Takeover without reassignment now sets \`collaborator_user_id\` to the agent who took over, without touching handled-by.\r
  - Updated: \`src/hooks/useConversations.ts\`\r
- **Commit**: \`chore: unassign clears collaborator only; takeover sets collaborator; lock collaborator replies\`\r
\r
# [0.1.51] FE WEB CEKAT 2026-01-15\r
\r
### Conversations & System Events\r
\r
- **System logs for assignment actions**: Takeover, Move to Unassigned, and Resolve now add system \`event\` messages to the thread timeline with actor details, keeping the audit trail visible in chat.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`, \`src/hooks/useConversations.ts\`\r
\r
# [0.1.50] FE WEB CEKAT 2026-01-14\r
\r
### Conversations & Ownership\r
\r
- **Collaborators are now read-only**: The sidebar shows the current collaborator label while only Takeover Chat reclaims the slot; the select was removed to enforce the one-collaborator invariant.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
- **Takeover/Unassign RPCs respect status**: \`takeover_thread\`/\`unassign_thread\` now only swap \`collaborator_user_id\` / status/assigned_at, and the frontend trusts the returned \`status\` so Move to Unassigned stays open after refresh.\r
  - Updated: \`src/hooks/useConversations.ts\`\r
- **RPC definitions and constraints**: Supabase migration adds status/collaborator invariants plus SECURITY DEFINER RPCs (\`takeover_thread\`, \`unassign_thread\`) that preserve \`assignee_user_id\` while updating collaborators.\r
  - Updated: \`supabase/migrations/20260114090000_thread_collab_takeover.sql\`\r
\r
# [0.1.49] FE WEB CEKAT 2026-01-13\r
\r
### Add delete button in contacts\r
\r
- **Added button for delete contact**: button delete contact is available for role master agent and super agent.\r
\r
# [0.1.48] FE WEB CEKAT 2026-01-13\r
\r
### Conversation Ownership\r
\r
- **Handled By now respects real assignees**: \`computeAssignmentState\` keeps the \`assignee_user_id\` if the thread is assigned, so \`ConversationPage\` can show the handlers display name again instead of rendering .\r
  - Updated: \`src/hooks/useConversations.ts\`\r
\r
### Platform Ownership\r
\r
- **Super-agent scoped human/AI selection**: The Connected Platforms sidebar only lists human agents and AI profiles that belong to the channels assigned super agent while keeping the already selected options visible, keeping ownership aligned across collaborators and bots.\r
  - Updated: \`src/components/platforms/ConnectedPlatforms.tsx\`\r
\r
# [0.1.46] FE WEB CEKAT 2026-01-13\r
\r
### Live Chat\r
\r
- **Stable account names**: Friendly username is now stored per \`account_id\` (localStorage) instead of per session, so the same account cant generate multiple display names across sessions.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **Supabase types parity**: \`threads\` types include \`account_id\` to match the schema and avoid TS errors on account-based queries.\r
  - Updated: \`src/integrations/supabase/types.ts\`\r
- **Commit**: \`chore: bind livechat name to account and fix threads types\`\r
\r
# [0.1.45] FE WEB CEKAT 2026-01-13\r
\r
### Live Chat & Types\r
\r
- **Account-scoped attach only**: Live chat now only attaches to threads that match the current \`account_id\`/session and no longer reuses stored thread IDs; if none exist, it waits for an external creator (e.g., n8n) rather than auto-creating.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **Supabase types parity**: Added \`account_id\` to the \`threads\` types to match the schema changes and avoid TS errors on account-based selects.\r
  - Updated: \`src/integrations/supabase/types.ts\`\r
- **Commit**: \`chore: livechat account attach only & fix supabase types\`\r
\r
# [0.1.44] FE WEB CEKAT 2026-01-13\r
\r
### WhatsApp / n8n Proxy Hardening\r
\r
- **Session disconnect via proxy-n8n**: WhatsApp disconnect now calls the \`session.logout\` proxy route (no legacy Railways) before disconnecting, matching the n8n route table.\r
- **Scoped polling on disconnect**: Only WhatsApp sessions are refreshed during disconnect polling, using a fresh \`sessionsRef\` to avoid stale state; no broad platform refresh.\r
- **Spam-proof delete**: Danger zone delete button is guarded by the in-flight flag to prevent repeated clicks while deletion is in progress.\r
\r
### Supabase (live chat reference)\r
\r
- **Account-scoped anon access**: Policies persisted in migrations (\`20260113000001\`, \`20260113000002\`) enforce \`account_id\` + \`x-account-id\` for threads/messages; legacy null-account fallback removed. Anonymous users cannot fetch other accounts threads or messages.\r
- **Edge function routing**: \`proxy-n8n\` is the path for WhatsApp session actions; \`session.disconnect\` route added to n8n route table; \`DISCONNECT_SESSION\` now points to \`session.logout\`.\r
\r
# [0.1.43] FE WEB CEKAT 2026-01-13\r
\r
### Live Chat (Account-scoped reuse)\r
\r
- **One thread per account (frontend & DB guard)**: Live chat now reads \`account_id\` from \`localStorage\` and reuses/reopens the existing thread for that account/channel (falls back to session/alias if no account). Added \`account_id\` column plus a unique index on \`(channel_id, account_id)\` when set to prevent duplicate threads.\r
  - Updated: \`src/pages/LiveChat.tsx\`, \`src/hooks/useConversations.ts\`\r
  - New: \`supabase/migrations/20260113000001_add_account_id_to_threads.sql\`\r
- **Anonymous: new thread per cleared storage**: If local/session storage is empty, a fresh \`account_id\` is generated per channel and legacy thread auto-attach is disabled, so each new browser/cleared storage starts a new thread.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
  \r
### Live Chat (anon account-id hardening)\r
\r
- **Fetch-only on load (no auto-create)**: Live chat no longer creates threads on refresh; it only attaches to existing threads that match the current \`account_id\` (and session). Threads are expected to be created externally (e.g., n8n) and delivered via realtime or subsequent fetch.\r
- **Thread reuse by account only**: Stored thread reuse was removed; lookup now requires account/session match (no name fallback when account_id exists).\r
- **Headers for anon RLS**: The live chat Supabase client sends \`x-account-id\` for all requests so anon RLS policies apply.\r
\r
### Supabase (migration/reference)\r
\r
- **account_id column & unique index**: Added \`account_id\` to \`public.threads\` and a unique index \`(channel_id, account_id)\` when \`account_id\` is set (\`supabase/migrations/20260113000001_add_account_id_to_threads.sql\`).\r
- **Edge function auth**: \`proxy-n8n\` redeployed with \`verify_jwt=false\` to allow anonymous calls (still HMAC-signs to n8n).\r
- **RLS (anon by account_id)**:\r
  - Threads: \`anon_threads_by_account\` (SELECT) and \`anon_threads_insert_by_account\` (INSERT) require \`account_id\` = \`x-account-id\`.\r
  - Messages: \`anon_messages_by_account\` (SELECT) and \`anon_messages_insert_by_account\` (INSERT) require parent thread \`account_id\` = \`x-account-id\`.\r
  - Channels: \`anon_channels_web_minimal\` allows anon SELECT on web channels to read minimal metadata.\r
  - Legacy null-account fallback policies were removed; anon access now hinges on matching \`account_id\`.\r
\r
# [0.1.42] FE WEB CEKAT 2026-01-13\r
\r
### Conversations & Assignment Flow\r
\r
- **Realtime tab-safe updates**: Thread status/assignee changes now patch the conversation list via realtime updates without needing a manual refresh; tabs stay put even when counts change underneath.\r
  - Updated: \`src/hooks/useConversations.ts\`, \`src/components/chat/ConversationPage.tsx\`\r
- **Tab UX hardening**: Tabs remain clickable/selectable even when empty; user-selected tabs no longer auto-bounce when counts shift.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
- **Resolve re-enables AI**: Resolving a conversation now flips \`ai_access_enabled\` back on and clears \`ai_handoff_at\` so AI can respond immediately after resolution.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
\r
# [0.1.41] FE WEB CEKAT 2026-01-12\r
\r
- **Thread controls respect roles & stay real-time**: Move to Unassigned now only renders and functions for master/super agents (regular agents get  toast if they try), and the focused conversation keeps subscribing to its thread plus calling \`fetchMessages\` in a stable hook so status changes surface instantly.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`, \`src/hooks/useConversations.ts\`\r
- **Super agents can edit platform human agents**: The human-agent multi-select inside platform details now bypasses the \`channel_agents.update\` gate for \`super_agent\` roles so they can add/remove collaborators without an extra permission.\r
  - Updated: \`src/components/platforms/ConnectedPlatforms.tsx\`\r
\r
# [0.1.40] FE WEB CEKAT 2026-01-12\r
\r
### Conversations & Assignment Flow\r
\r
- **Correct tab mapping for statuses**: Assigned now strictly maps to \`status === "pending"\` while Unassigned maps to \`status === "open"\` so the sidebar tally matches the database truth, and the legacy \`assigned\` enum is only treated as assigned for backward compatibility.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
- **Render unassigned threads as open**: Assignment-sensitive logic now only considers a thread assigned when an assignee (or similar signal) exists; a bare \`pending\` status without an assignee rewrites to \`open\`, ensuring those rows appear under the Unassigned tab.\r
  - Updated: \`src/hooks/useConversations.ts\`\r
\r
# [0.1.39] FE WEB CEKAT 2026-01-11\r
\r
### Conversations & Assignment Flow\r
\r
- **Takeover preserves handled by**: Takeover chat action now only changes thread status from "pending" (Unassigned) to "assigned", without modifying the "Handled By" field. This ensures the original super agent assignment is preserved regardless of who takes over the conversation.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`, \`src/hooks/useConversations.ts\`\r
- **Conditional assignee updates**: Added \`setAssignee\` option to \`assignThread\` function for explicit assignment control. Takeover always uses \`setAssignee: false\` to preserve existing assignments.\r
  - Updated: \`src/hooks/useConversations.ts\`\r
\r
### UI/UX Improvements\r
\r
- **Login form cleanup**: Removed redundant UI text elements from login form (one-time code message and forgot password link) to streamline the authentication interface.\r
  - Updated: \`src/components/auth/Login.tsx\`\r
\r
# [0.1.38] FE WEB CEKAT 2026-01-11\r
\r
### Conversations & Assignment Flow\r
\r
- **Inline status controls**: Assigned threads now show a Move to Unassigned button next to Resolve, keeping status transitions and the list state in sync without page refreshes.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`, \`src/hooks/useConversations.ts\`\r
- **Server-truth status updates**: Removed optimistic status toggles (and stopped writing the unsupported \`'assigned'\` enum) so moving or taking over a single thread no longer makes other rows flicker; UI now waits for Supabase to confirm before updating.\r
- **Takeover preserves handled-by**: Regular agents now claim chats without overwriting the super agents Handled By field; only masters/supers promote themselves while collaborators simply flip the status and log the event.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`, \`src/hooks/useConversations.ts\`\r
\r
# [0.1.37] FE WEB CEKAT 2026-01-11\r
\r
### Conversations & Assignment Flow\r
\r
- Updated: \`src/components/chat/ConversationPage.tsx\`\r
- **Takeover scoped to Unassigned**: The Takeover Chat CTA now renders only when a thread is truly in the Unassigned state, preventing accidental reassignment attempts from other tabs.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
- **Role-based composer rules**: Collaborators (when theyre the logged-in user), super agents, and master agents now get the message composer even on unassigned threads, while other agents still see the takeover prompt until they claim the chat.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
- **Hide master agents from selectors**: Master agents can still act on any thread, but they no longer appear in the Handled By or Collaborator dropdowns to avoid accidental assignment to all-powerful accounts.\r
\r
# [0.1.36] FE WEB CEKAT 2026-01-11\r
\r
### Conversations & Assignment Flow\r
\r
- **Three-state workflow overhaul**: Replaced the legacy status heuristic with an explicit \`Assigned / Unassigned / Done\` flow that keys off \`status\` plus the presence of a collaborator. Counts, badges, tab filters, and auto-selection now stay in sync with the new rules and never fall back to the deprecated multi-collaborator state.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`, \`src/hooks/useConversations.ts\`\r
- **Collaborator switch stability**: Guarded the URL/thread synchronization logic so picking a collaborator no longer triggers a rapid tab flip that spammed list/message fetches.\r
\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
\r
### Collaboration Data Model & Permissions\r
\r
- **Single-column collaborator model**: Added a migration that backfills \`threads.collaborator_user_id\`, rewires all RLS policies to reference that column, and drops the obsolete \`thread_collaborators\` table plus its triggers.\r
  - New: \`supabase/migrations/20260110_remove_thread_collaborators.sql\`\r
  - Updated: \`supabase/migrations/permissions_update_and_policies_updates.sql\`, \`supabase/migrations/20251124230847_baseline.sql\`, \`supabase/schema.sql\`, \`sync/tables.config.json\`\r
- **Typed API parity**: Regenerated Supabase types so the frontend integrations include the new \`collaborator_user_id\` field and foreign key metadata.\r
  - Updated: \`src/integrations/supabase/types.ts\`\r
\r
### Navigation & RBAC\r
\r
- **Hide AI Agents for regular agents**: Sidebar configuration now outright hides the AI Agents menu when the signed-in user only has the \`agent\` role, preventing them from entering AI profile management.\r
  - Updated: \`src/config/navigation.ts\`, \`src/hooks/useNavigation.ts\`\r
\r
# [0.1.35] FE WEB CEKAT 2026-01-10\r
\r
### Housekeeping\r
\r
- **Line-ending normalization (no logic changes)**: Synchronized CRLF/LF on chat/contact pages and hooks to keep diffs clean without altering runtime behavior.\r
  - Touched: \`src/components/chat/ConversationPage.tsx\`, \`src/components/contacts/Contacts.tsx\`, \`src/hooks/useContacts.ts\`, \`src/hooks/useConversations.ts\`, \`src/pages/LiveChat.tsx\`\r
- **Migration formatting**: Tidied whitespace in the \`thread_status\` enum migration to match our SQL formatting conventions.\r
  - Updated: \`supabase/migrations/20260109000000_add_assigned_thread_status.sql\`\r
\r
# [0.1.34] FE WEB CEKAT 2026-01-09\r
\r
### Live Chat & Messaging\r
\r
- **Realtime Message Recovery**: Fixed a bug where customer messages (role: 'user') were filtered out of the realtime feed, ensuring the chat window correctly updates when messages are persisted to the database.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **Smart Message Deduplication**: Added a client-side deduplication pass that prevents "double bubbles" when both an optimistic send and a database insert arrive near-simultaneously (2-second window).\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **Resilient Thread Attachment**: Relaxed the thread lookup logic so the widget gracefully falls back to the most recent channel activity if a session-id match isn't immediately foundno more hanging on "Waiting for response".\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
\r
### Assignment & Status Management\r
\r
- **Thread Status Enum Extension**: Added a new \`assigned\` value to the database \`thread_status\` enum to properly distinguish between new inquiries and those handled by a super agent or human.\r
  - New: \`supabase/migrations/20260109000000_add_assigned_thread_status.sql\`\r
- **Automated Assignment Flow**: Threads now automatically transition to \`assigned\` status when a bot hands off or a super agent is linked to the platform, while remaining in \`open\` for fresh inquiries.\r
  - Updated: \`src/hooks/useConversations.ts\`\r
- **Enum Safety Fallback**: Added a catch for Supabase error \`22P02\` so the app gracefully falls back to \`open\` status if the new \`assigned\` enum value hasn't been applied to the database yet.\r
  - Updated: \`src/hooks/useConversations.ts\`\r
- **Handled-By Display Logic**: Refactored the UI to show the platform's super agent as the default handler for bot-managed threads without incorrectly flagging them as "Assigned" until a real handoff occurs.\r
  - Updated: \`src/hooks/useConversations.ts\`\r
\r
### UI/UX Polish\r
\r
- **Silent Background Refresh**: Implemented a "silent" fetch mode for conversation lists that bypasses global loading states, eliminating the screen "blinking" effect when sending messages or receiving updates.\r
  - Updated: \`src/hooks/useConversations.ts\`, \`src/components/chat/ConversationPage.tsx\`\r
- **Toaster Cleanup**: Removed redundant "Message sent successfully" notifications to reduce UI clutter, keeping toasts reserved for actual errors or critical events.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
- **Enhanced Contact Filtering**: Surfaced the new \`assigned\` status in the Contacts view with proper badge coloring and filter support.\r
  - Updated: \`src/components/contacts/Contacts.tsx\`, \`src/hooks/useContacts.ts\`\r
- **Live Chat Realtime Resync**: Added a lightweight catch-up mechanism that rehydrates conversations if the Supabase realtime channel drops or the tab wakes from suspensionno constant polling required.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **New Thread Subscription Fix**: Realtime subscriptions now hydrate newly created live chat threads immediately without requiring a manual refresh.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **Queued Catch-Up Requests**: Ensures live chat queues multiple background fetches when the first message creates a thread so the AI reply appears without manual reloads, retries the AI webhook on transient failures, and preserves message order for streaming replies.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **Session-Scoped Live Chat Threads**: Persist the live chat thread per browser session and only attach to threads created for the current session username, so concurrent visitors no longer see mixed conversations.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **Streaming Placeholder Cleanup**: Replace temporary assistant bubbles with the persisted Supabase message as soon as it arrives, preventing the UI from flickering or reordering when replies land.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **Thread Restore Fallbacks**: If Supabase hasn't stamped a \`session_id\`, the live chat gracefully falls back to the contact alias when restoring or attaching to a threadno more blank states or scrolling jumps.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **Realtime Catch-Up Safety Net**: After each API send, the widget aggressively refetches the thread so AI replies render even if realtime events arrive late.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
\r
# [0.1.33] FE WEB CEKAT 2026-01-08\r
\r
### Conversations\r
\r
- **Role-aware Message Composer**: Chat input now enables whenever a user has \`messages.create\`, is a master/super agent, is the current handled-by assignee, or is the selected collaboratorensuring the right people can reply without manual overrides.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
\r
# [0.1.32] FE WEB CEKAT 2026-01-08\r
\r
### Platform Management\r
\r
- **Live Chat Link Quality-of-Life**: Added copy-to-clipboard buttons with toast feedback for both the live chat URL and embed snippet so teammates can drop links/widgets faster without selecting text manually.\r
  - Updated: \`src/components/platforms/ConnectedPlatforms.tsx\`\r
\r
### Navigation & RBAC\r
\r
- **Guaranteed Human Agents Menu for Supervisors**: Super agents now always see the Human Agents sidebar item (role bypass) and can open the roster even if their read permissions are still syncing.\r
  - Updated: \`src/config/navigation.ts\`, \`src/hooks/useNavigation.ts\`, \`src/components/navigation/PermissionNavItem.tsx\`, \`src/pages/Index.tsx\`\r
\r
### Human Agent Management\r
\r
- **Super Agent Focused View**: When a super agent opens the roster the Create button and Pending tab disappear, role/status filters are hidden, and all action buttons (status, limits, delete) are automatically allowed for members in their own cluster thanks to the new \`roleBypass\` helper.\r
  - Updated: \`src/components/humanagents/HumanAgents.tsx\`, \`src/components/rbac/PermissionGate.tsx\`\r
\r
### Conversation Sidebar\r
\r
- **Handled By Read-Only**: The Handled By field is now display-only, preventing mid-conversation reassignment from the info pane while still showing who currently owns the thread.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
\r
# [0.1.31] FE WEB CEKAT 2026-01-08\r
\r
- **Live Chat Realtime-Only Sync**: Removed the 2-second polling loop from the live chat widget so updates rely solely on Supabase realtime subsciptions, cutting unnecessary network and memory usage.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
\r
# [0.1.30] FE WEB CEKAT 2026-01-07\r
\r
### Platform Management\r
\r
- **Live Chat Takeover Notices**: System takeover events now render as toast notifications instead of chat bubbles, keeping conversation history clean while still informing customers.\r
  - Updated: \`src/pages/LiveChat.tsx\`\r
- **Human Agent Assignment UX**: Selecting agents in platform edit autosaves immediately; no more extra click to add collaborators.\r
  - Updated: \`src/components/platforms/ConnectedPlatforms.tsx\`\r
- **Header Cleanup**: Removed redundant save/delete buttons from platform edit header; autosave flow handles updates and delete remains available in the existing danger zone.\r
  - Updated: \`src/components/platforms/ConnectedPlatforms.tsx\`\r
\r
# [0.1.29] FE WEB CEKAT 2026-01-07\r
\r
### Conversation Management\r
\r
- **Single Collaborator Restriction**: Changed Collaborators field from multi-select to single-select, allowing only one collaborator per thread.\r
  - Replaced \`SearchableMultiSelect\` with \`SearchableSelect\` component for collaborator selection.\r
  - When a new collaborator is selected, it automatically replaces any existing collaborator for that thread.\r
  - Collaborator field supports clearing selection to remove the collaborator entirely.\r
  - Existing threads with multiple collaborators are automatically trimmed to a single collaborator when accessed.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
\r
- **Role-Based Takeover Chat Button**: Implemented role-based access control for the "Takeover Chat" button.\r
  - **Master agents and super agents**: Takeover button is always enabled (when thread is unassigned).\r
  - **Regular agents**: Takeover button is only enabled when no collaborator exists for the thread.\r
  - Regular agents see a disabled button with tooltip explanation when a collaborator is already assigned.\r
  - Prevents regular agents from taking over conversations that already have a collaborator assigned.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
\r
# [0.1.28] FE WEB CEKAT 2026-01-07\r
\r
### Security & Data Access Control\r
\r
- **Super Agent Data Isolation**: Implemented Row Level Security (RLS) policies to ensure super agents can only view their own data in platform creation forms.\r
  - Secured \`v_users\` view to prevent data leakage by removing direct access to \`auth.users\` table.\r
  - View now anchors on \`users_profile\` table with proper RLS enforcement, ensuring super agents only see their own profile.\r
  - Master agents retain full visibility to all users within their organization via \`is_master_agent_in_org()\` function.\r
  - Database migration applied to enforce RLS policies at the database level for true security (not just frontend filtering).\r
\r
### Platform Creation Forms\r
\r
- **Auto-Select Super Agent for Super Agent Users**: Enhanced platform creation forms (Telegram, WhatsApp, Web) to automatically select and lock the Super Agent dropdown when the current user is a super agent.\r
  - Super Agent field is automatically populated with the current user's ID when form opens for super agent users.\r
  - Field becomes read-only (disabled) with visual indication when user is a super agent, preventing them from changing their own assignment.\r
  - Helper text updated to indicate that super agent is automatically determined by the current user's account for super agent users.\r
  - Master agents continue to see and can select from all available super agents in the dropdown.\r
  - Updated: \`src/components/platforms/TelegramPlatformForm.tsx\`, \`src/components/platforms/WebPlatformForm.tsx\`, \`src/components/platforms/WhatsAppPlatformForm.tsx\`\r
\r
# [0.1.27] FE WEB CEKAT 2026-01-02\r
\r
### Conversation Management\r
\r
- **Handled By Clearing**: Users can now remove super agent assignments from conversations using a clear button in the "Handled By" selector.\r
  - Added \`allowClear\` prop to \`SearchableSelect\` component with inline clear button (X icon) that appears when a value is selected.\r
  - "Handled By" selector in conversation sidebar now supports clearing assignments, allowing conversations to be unassigned.\r
  - Updated \`assignThreadToUser\` function to accept \`null\` for unassigning conversations, properly clearing assignment metadata and creating "conversation unassigned" system event messages.\r
  - When clearing "Handled By", all collaborators are automatically removed to maintain data consistency.\r
  - Updated: \`src/components/ui/searchable-select.tsx\`, \`src/components/chat/ConversationPage.tsx\`, \`src/hooks/useConversations.ts\`\r
- **Resolved Thread Read-Only Controls**: Closed conversations now lock their "Handled By" and collaborator selectors.\r
  - \`SearchableSelect\` and \`SearchableMultiSelect\` honor the disabled state (no clear button, no chip removal) when a thread is resolved.\r
  - Collaborator add/remove handlers bail early for resolved threads to prevent accidental edits.\r
  - Updated: \`src/components/ui/searchable-select.tsx\`, \`src/components/chat/ConversationPage.tsx\`\r
\r
# [0.1.26] FE WEB CEKAT 2026-01-01\r
\r
### Supabase Configuration\r
\r
- **Env-only credentials**: \`src/config/supabase.ts\` now reads \`VITE_SUPABASE_URL\` and \`VITE_SUPABASE_ANON_KEY\` (or \`VITE_SUPABASE_PUBLISHABLE_KEY\`) directly from the environment, with clear error messages when either is missing.\r
- **Removed baked-in keys**: Any hardcoded DEV/PROD URLs or anonymous keys have been removed, eliminating mismatched-session logouts when the production build refreshes.\r
- **Commit:** \`chore: document proxy routing updates\`  aligned the config with environment-driven credentials and documented the change.\r
\r
# [0.1.25] FE WEB CEKAT 2025-12-30\r
\r
### Webhook Routing & Live Chat\r
\r
- **Proxy-aware production routing**: \`src/config/webhook.ts\` now prefers Supabase Edge proxy routes while still allowing explicit overrides and legacy fallbacks, ensuring production hits \`proxy-n8n\` even when \`VITE_WEBHOOK_BASE_URL\` is set to your Supabase host.\r
- **Client auth resilience**: \`src/lib/webhookClient.ts\` attempts to attach a session token when available but no longer blocks calls if the viewer lacks one, so widget traffic still reaches the proxy (and surfaces 401s when the function enforces auth).\r
- **Env guidance**: Documented the required \`VITE_SUPABASE_ANON_KEY\` in \`src/config/supabase.ts\` so deployments fail fast if keys are missing, and restored custom-domain detection so \`api.cssuper.com\` resolves to the production Supabase key when the variable is omitted.\r
- **Commit:** \`chore: document proxy routing updates\`  removed hardcoded Supabase fallbacks so \`src/config/supabase.ts\` now reads only the environment-provided URL/key, preventing prod refresh logouts caused by mismatched credentials.\r
\r
### Live Chat\r
\r
- **Streaming order stability**: \`src/pages/LiveChat.tsx\` now tracks a monotonic render order so assistant replies consistently appear beneath the triggering user message without requiring a refresh.\r
- **Proxy-first webhook**: The Live Chat send flow always calls the Supabase \`proxy-n8n\` function before falling back to the legacy webhook, so both production and development environments continue to hit the proxy listener.\r
\r
# [0.1.24] FE WEB CEKAT 2025-12-30\r
\r
### Contacts  Conversations (Multi-Thread Support)\r
\r
- **Thread Picker for Open conversation**: Contacts now open a thread/channel picker instead of jumping directly to \`/chat\` by contact, solving ambiguity when a contact has multiple threads across channels.\r
  - New component: \`src/components/chat/ContactThreadPickerDialog.tsx\`\r
  - Updated: \`src/components/contacts/Contacts.tsx\` now opens the picker and navigates with \`menu=chat&contact=<id>&thread=<id>\`\r
\r
### Conversations: Deterministic Thread Selection\r
\r
- **URL-based thread deep link**: \`ConversationPage\` now supports \`thread=<threadId>\` and prioritizes it over \`contact=<contactId>\`, ensuring the correct thread opens even when the same contact has multiple channel threads.\r
  - Clicking a conversation updates the URL (\`thread\` + \`contact\`) so navigation is stable and shareable.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
\r
### Conversations UI\r
\r
- **Platform tags**: Conversation rows now show provider badges (e.g. Telegram/Web/WhatsApp) for clearer channel context.\r
  - Updated: \`src/components/chat/ConversationPage.tsx\`\r
\r
### Thread Picker UI Polish\r
\r
- **Better list layout**: Improved thread list rendering to avoid clipped/trimmed rows and to pin the platform chip to the bottom-right of each row (timestamp top-right).\r
  - Updated: \`src/components/chat/ContactThreadPickerDialog.tsx\`\r
\r
# [0.1.23] FE WEB CEKAT 2025-12-29\r
\r
### Authentication & User Management\r
\r
- **Whitespace-Free Email & Password Inputs**: Login, reset-password, and agent creation forms now strip spaces and force lowercase emails while blocking space characters in passwords, preventing accidental invalid credentials.\r
  - \`src/components/auth/Login.tsx\` sanitizes email input across login, reset, and (future) signup tabs and blocks whitespace in password fields.\r
  - \`src/pages/ResetPassword.tsx\` applies the same input guards to new/confirm password fields.\r
  - \`src/components/humanagents/HumanAgents.tsx\` normalizes emails when creating agents to avoid duplicate entries caused by casing or trailing spaces.\r
\r
### Conversations\r
\r
- **WhatsApp-Style Day Separators**: Chat threads display \`Today\`, \`Yesterday\`, or a formatted date badge between message clusters, making timelines easier to scan.\r
  - Implemented in \`src/components/chat/ConversationPage.tsx\` with memoized grouping so the list stays performant.\r
\r
### Analytics\r
\r
- **Unified Date Range Picker**: Replaced separate \`From\`/\`To\` inputs with a single range calendar that mirrors the contacts page behavior and keeps queries bounded to today.\r
  - \`src/components/analytics/Analytics.tsx\` stores normalized \`YYYY-MM-DD\` strings and offers a quick Clear action.\r
- **Stable Refresh Logic**: Prevented stale data by delaying metric/database fetches until the user finishes selecting the range (popover closes), ensuring the latest \`from/to\` pair drives every refresh.\r
\r
# [0.1.22] FE WEB CEKAT 2025-12-24\r
\r
### Authentication & Environment\r
\r
- **Supabase Config Hardening**: Prevented Invalid API key errors in Netlify preview/dev deploys caused by URL/key mismatches.\r
  - \`src/config/supabase.ts\` now infers dev/prod pairing from the Supabase URL host when only one override is provided.\r
  - Defaults to a dev-safe target unless the URL clearly points to \`api.cssuper.com\`.\r
  - Still supports explicit \`VITE_SUPABASE_URL\` and \`VITE_SUPABASE_ANON_KEY\` overrides.\r
\r
### Platforms (WhatsApp)\r
\r
- **Delete Webhook Payload**: When deleting WhatsApp channels, the webhook call now includes the channel identifier.\r
  - \`DELETE_SESSION\` payload now sends \`channel_id\` and \`org_id\` alongside \`session_name\` for reliable backend cleanup.\r
\r
- **External ID Consistency**: WhatsApp channels now maintain a stable external identifier across lifecycle states.\r
  - On create, WhatsApp channels set \`external_id\` to the normalized WAHA session name and store \`credentials.waha_session_name\`.\r
  - WAHA session sync now upgrades \`external_id\` to the real WhatsApp \`me.id\` (e.g. \`628...@c.us\`) once available, and never wipes it back to null.\r
  - Added a fallback lookup to \`GET /api/sessions/{name}\` when the WAHA list endpoint does not include \`me.id\`.\r
  - Standardized WAHA session naming to \`toLowerCase().replace(/\\s/g,'')\` for consistent matching.\r
\r
# [0.1.21] FE WEB CEKAT 2025-12-24\r
\r
### Circuit Breaker Settings\r
\r
- **Date Range Validation**: Updated chat date filter to require both "From" and "To" values before applying.\r
  - Prevents half-filled date ranges from running and warns users when only one side is selected.\r
  - Disallows selecting an end date earlier than the start date and keeps calendars constrained to valid ranges.\r
- **Audit Log Date Filter Guardrails**: Logs page now requires selecting both "From" and "To" dates and constrains pickers to valid ranges.\r
  - Displays inline guidance when only one side of the range is provided.\r
  - Ensures backend queries use start/end-of-day boundaries for inclusive day filtering.\r
  - Replaced separate date inputs with a single range calendar so start and end dates are chosen together.\r
\r
# [0.1.20] FE WEB CEKAT 2025-12-24\r
\r
### Conversations: Filter UX & Correctness\r
\r
- **Channel Type Filter Fixed**: Channel Type now correctly filters threads at the query level.\r
  - Updated \`useConversations\` to use an inner join (\`channels!inner(...)\`) so \`channels.provider\` filters actually constrain \`threads\` results (PostgREST behavior).\r
  - Added defensive client-side filtering for \`channelType\`, \`inbox\`, and \`platformId\` to ensure consistent UI results.\r
\r
- **Persistent Applied Filters**: Applied filters now persist and are shareable.\r
  - Filters are serialized into URL query params (\`f_*\`) so refresh/back/forward retains the exact filtered view.\r
  - If URL has no filter params, the last applied filters are restored from localStorage (per-user key).\r
\r
- **Visible Active Filters**: Users can now see whats currently applied.\r
  - \`ConversationPage\` renders active filter badges under the Conversations header (Channel, Platform, Status, Agent, Resolved By, Date, Inbox).\r
  - \`ChatFilter\` modal is now controlled via a \`value\` prop so reopening the modal shows the currently applied values.\r
\r
### Configuration & Environment Management\r
\r
- **Centralized URL Configuration**: Created comprehensive URL and environment configuration system\r
  - New \`src/config/urls.ts\` centralizes all app base URLs (APP_ORIGIN, WAHA_BASE_URL) with environment-aware defaults\r
  - New \`src/config/supabase.ts\` centralizes Supabase URL and key configuration with automatic dev/prod switching\r
  - Production app origin now defaults to \`https://synkaai.netlify.app\` (even in dev) for consistent LiveChat links\r
  - Supabase URL automatically switches: DEV  \`bkynymyhbfrhvwxqqttk.supabase.co\`, PROD  \`api.cssuper.com\`\r
  - All configuration supports \`VITE_*\` environment variable overrides for flexible deployment\r
  - Removed all hardcoded Netlify and Supabase URLs from components\r
\r
- **Platform URL Updates**: Updated all platform-related URLs to use centralized configuration\r
  - \`ConnectedPlatforms.tsx\` now uses \`APP_ORIGIN\` and \`livechatUrl()\` helper instead of hardcoded URLs\r
  - LiveChat embed code now uses configurable \`APP_ORIGIN\` instead of hardcoded domain\r
  - \`WhatsAppPlatformForm.tsx\` uses \`WAHA_BASE_URL\` from config instead of hardcoded Railway URL\r
  - All platform forms now reference single source of truth for base URLs\r
\r
### AI Agent Settings Cleanup\r
\r
- **Removed Context Window Field**: Removed "Context Window (K tokens)" from Additional Settings UI\r
  - Field no longer visible or editable in AI Agent Settings interface\r
  - Removed all related state variables (\`contextLimitInput\`, \`contextLimitMax\`)\r
  - Removed input handler (\`handleContextLimitChange\`) and validation logic\r
  - Save logic still automatically persists safe default value (existing value or 28K tokens, clamped to model capability)\r
  - Ensures database writes continue to work without breaking changes\r
\r
### Conversation Filtering\r
\r
- **Removed Pipeline Status Filter**: Cleaned up thread filter interface\r
  - Removed "Pipeline Status" dropdown from chat filter dialog\r
  - Removed \`pipelineStatus\` from filter state and type definitions\r
  - Removed \`pipeline_status\` query filtering from \`useConversations\` hook\r
  - Simplified filter UI with cleaner, more focused options\r
\r
### Technical Improvements\r
\r
- **Code Organization**: Improved maintainability and consistency\r
  - Single source of truth for all environment-specific URLs\r
  - Consistent configuration pattern across all services\r
  - Better separation of concerns between UI and configuration\r
  - Enhanced type safety with centralized config exports\r
\r
# [0.1.19] FE WEB CEKAT 2025-12-24\r
\r
### Circuit Breaker Settings\r
\r
- **Robust Numeric Validation**: Reset timeout, monitoring period, request timeout, and threshold fields now accept temporary clears but enforce min/max bounds before saving.\r
  - Inline error messages and disabled save state prevent invalid submissions.\r
  - Inputs strip non-numeric characters, block scientific notation, and clamp values to their allowed ranges.\r
- **Latency Feedback**: Healthy and stress latency controls show live seconds previews, clarifying millisecond inputs.\r
- **Tooltip Refinement**: Repositioned tooltips to render beside their triggers, preventing clipping inside the modal.\r
\r
### Adaptive Rate Limiter Configuration\r
\r
- **Precision Controls**: Base limits and multiplier inputs now sanitize numeric entry, limit decimals to three places, and sync their raw display strings with validated state.\r
- **Validation Guardrails**: All adaptive fields surface inline errors and keep the save button disabled until values fall within allowed ranges.\r
- **Enhanced Summary**: Read-only configuration card now surfaces latency thresholds (with seconds) alongside existing multiplier and interval details.\r
- **Modal Tooltips**: Every helper tooltip aligns left/right relative to its column, ensuring full visibility within the dialog.\r
\r
# [0.1.18] FE WEB CEKAT 2025-12-24\r
\r
### Bug Fixes\r
\r
- **Fixed Platform Filter Not Finding Channels**: Resolved critical bug where selecting a channel type (Telegram, WhatsApp, Web) would show no platforms.\r
  - Changed platform filtering from \`channels.type\` to \`channels.provider\` to match actual database schema.\r
  - In database, \`channels.provider\` contains transport values (\`telegram\`, \`web\`, \`whatsapp\`) while \`channels.type\` contains implementation details (\`bot\`, \`inbox\`).\r
  - Updated both \`ChatFilter.tsx\` (UI filtering) and \`useConversations.ts\` (query filtering) to use \`channels.provider\`.\r
  - Telegram and other channel types now correctly display their platforms when selected.\r
\r
### Conversation Management\r
\r
- **Hierarchical Channel Type  Platform Filter**: Enhanced chat filter with parent-child filter relationship.\r
  - Platform filter now requires Channel Type selection first (Platform dropdown disabled until Channel Type is chosen).\r
  - Placeholder text changes to "Select channel type first" when Channel Type is not selected.\r
  - Changing Channel Type automatically clears Platform selection to prevent stale selections.\r
  - Improved UX with clear dependency indication between filters.\r
\r
- **Empty State for Platform Filter**: Added user-friendly empty state handling.\r
  - When selected Channel Type has no matching platforms, dropdown shows disabled option: "No platforms found for this channel type".\r
  - Prevents confusion when no results are available for a selected channel type.\r
  - Platform display simplified to show only \`display_name\` without provider/type suffix for cleaner UI.\r
\r
# [0.1.17] FE WEB CEKAT 2025-12-22\r
\r
### Bug Fixes\r
\r
- **Fixed Stale Data Persistence After Role Changes**: Resolved critical issue where threads and contacts persisted in the UI after role changes in the database.\r
  - Removed localStorage caching for threads (\`app.cachedConversations\`) to prevent stale data from persisting after authorization changes.\r
  - Disabled query caching for authorization-sensitive operations (threads, contacts) in \`protectedSupabase\` wrapper to ensure fresh data on role changes.\r
  - Threads and contacts now immediately clear and refetch when user roles change, preventing unauthorized data from being displayed.\r
  - Fixed issue where changing a user's role from \`master_agent\` to \`super_agent\` (or vice versa) in the database would not immediately reflect in the UI.\r
\r
### Technical Improvements\r
\r
- **Realtime Role Change Detection**: Implemented comprehensive authorization change detection system.\r
  - Added realtime subscription to \`user_roles\` table in \`RBACContext\` to detect role changes for the current user.\r
  - Created \`authz.ts\` utility module for centralized authorization change handling and cache invalidation.\r
  - Implemented event-based system (\`authzChanged\` event) to notify hooks when authorization changes occur.\r
  - \`useConversations\` and \`useContacts\` hooks now listen for authorization changes and automatically reset state + refetch data.\r
  - Ensures UI always reflects current user permissions without requiring manual refresh or logout/login.\r
\r
- **Cache Invalidation Strategy**: Enhanced cache management for authorization-sensitive data.\r
  - Authorization changes now trigger comprehensive cache clearing (localStorage, query cache, fallback handler).\r
  - Removed role-agnostic caching that could serve stale results after permission changes.\r
  - All authorization-sensitive queries now bypass cache to ensure data accuracy.\r
  - Improved security by preventing cached data from persisting after role downgrades.\r
\r
# [0.1.16] FE WEB CEKAT 2025-12-20\r
\r
### UI Components\r
\r
- **SearchableSelect Component**: Added a new reusable searchable single-select dropdown component.\r
  - Provides searchable dropdown functionality with keyboard navigation support.\r
  - Includes proper accessibility attributes and visual feedback for selected items.\r
  - Used for improved agent assignment interface in conversation management.\r
\r
- **SearchableMultiSelect Component**: Added a new reusable searchable multi-select component.\r
  - Supports selecting multiple items with badge display for selected values.\r
  - Includes add/remove callbacks for granular control over selection changes.\r
  - Displays selected items as removable badges with clear visual indicators.\r
\r
### Conversation Management\r
\r
- **Enhanced Agent Assignment UI**: Replaced popover-based assignment interface with searchable select components.\r
  - "Handled By" field now uses \`SearchableSelect\` for improved searchability and UX.\r
  - Streamlined assignment flow with better visual feedback and state management.\r
  - Added optimistic UI updates with proper state synchronization.\r
\r
- **Improved Collaborator Management**: Enhanced thread collaborator interface with multi-select support.\r
  - Replaced popover-based collaborator addition with \`SearchableMultiSelect\` component.\r
  - Collaborator list now displays as removable badges for better visibility.\r
  - Added support for super agent member filtering - only members of the assigned super agent can be added as collaborators.\r
  - Collaborator selection is disabled until a "Handled By" agent is assigned.\r
  - Automatic fetching of super agent members when an agent is assigned.\r
\r
- **Manual Thread Assignment**: Added \`assignThreadToUser\` function for supervisor-level thread reassignment.\r
  - Allows supervisors to manually assign conversations to specific users.\r
  - Automatically creates system event messages when assignments occur.\r
  - Updates thread metadata including \`assigned_by_user_id\`, \`assigned_at\`, and \`handover_reason\`.\r
  - Disables AI access when manually assigned (\`ai_access_enabled: false\`).\r
\r
- **User Label Resolution**: Improved user display name resolution for agents and collaborators.\r
  - Fetches user profile data for agents not present in the human agents list.\r
  - Caches user labels to avoid redundant API calls.\r
  - Provides fallback display names when profile data is unavailable.\r
\r
### Bug Fixes\r
\r
- **Fixed Handled By State Leak**: Resolved critical bug where assigning a thread to an agent would incorrectly show that agent as assigned to all other threads.\r
  - Scoped \`handledByOverride\` state to specific thread IDs instead of using global state.\r
  - Optimistic UI updates now only apply to the thread being assigned, preventing state leakage when navigating between conversations.\r
  - Fixed issue where changing "Handled By" for one thread would temporarily display the same value for all threads until server refresh.\r
\r
# [0.1.15] FE WEB CEKAT 2025-12-19\r
\r
### Database & Policies\r
\r
- **Threads Update Policy**: Master agents can now resolve conversations across all environments.\r
  - Updated the \`threads update perm update_own\` policy to allow updates when \`is_master_agent_in_org(org_id)\` is true.\r
  - Applied the policy change to main, development, and backup Supabase projects and added a migration for consistency.\r
\r
### Conversation Management\r
\r
- **Resolved Thread Cleanup**: UI now hides take-over controls once a thread is closed.\r
  - Removed the takeover button and composer input when \`status === 'closed'\`, preventing accidental actions on resolved chats.\r
\r
### Contacts\r
\r
- **Unassigned Filter Accuracy**: Ensured the contacts list reflects only unassigned records without altering assigned data.\r
  - Adjusted Supabase querying and client filtering so contacts with no assigned agent (or no thread yet) display correctly.\r
  - Total counters and pagination now show filtered counts (e.g. \`12 of 16\`) when a handled-by filter is active.\r
- **Export to CSV**: Added a one-click export that downloads the current contact dataset (with latest thread info) as a CSV.\r
  - Includes contact fields (name, phone, email, notes, created_at) and latest thread metadata (status, handled by, channel).\r
- **Toolbar Cleanup**: Removed the unused Customize Columns button for a leaner toolbar experience.\r
\r
# [0.1.14] FE WEB CEKAT 2025-12-18\r
\r
### Platform Forms (WhatsApp / Telegram / Web)\r
\r
- **Top Spacing Layout Fix**: Standardized form spacing under dialog headers for a cleaner, consistent layout across all platform setup forms.\r
\r
### Telegram Platform\r
\r
- **Bot Token Validation (Required)**: Added a **Validate** button beside the Telegram Bot Token field and made validation mandatory before creating a Telegram platform.\r
  - Create is blocked with an error until the token has been validated.\r
- **Token Verification via Supabase Edge Function**: Token verification now calls the Supabase Edge Function endpoint (\`/functions/v1/telegram-verify-token\`) with a strict response contract (\`{ valid: boolean }\`).\r
  - \`callWebhook()\` now auto-attaches Supabase auth headers for Supabase Edge Function URLs.\r
\r
# [0.1.13] FE WEB CEKAT 2025-12-17\r
\r
### Conversation Management\r
\r
- **Date Filter Fix**: Resolved an issue where the date filter in the conversations menu would incorrectly exclude valid conversations.\r
  - Switched from server-side filtering on \`created_at\`/\`last_msg_at\` (which could be stale) to client-side filtering using the computed last message time.\r
  - Ensures the filter now perfectly matches the dates displayed in the UI, correctly showing threads active within the selected range.\r
\r
# [0.1.12] FE WEB CEKAT 2025-12-14\r
\r
### Human Agents UI Protection\r
\r
- **Master Agent UI Safeguards**: Enhanced protection for master agent accounts in the Human Agents interface.\r
  - Status dropdown button is now disabled for master agents across all sections (master agents, super agents, regular agents, and pending invitations).\r
  - Chevron dropdown icon is conditionally hidden for master agents to provide clear visual indication that status cannot be changed.\r
  - Delete button is completely hidden for master agents (replacing the previous disabled button with tooltip approach) across all agent sections.\r
  - Applied consistent protection logic using \`primaryRole === 'master_agent'\` checks throughout the component.\r
  - Provides cleaner UI experience by removing non-functional controls rather than showing disabled states.\r
\r
### Authentication & OTP\r
\r
- **2FA Email Edge Function Update**: Updated edge function reference for login-specific 2FA emails.\r
  - Changed edge function call from \`send-2fa-email\` to \`send-2fa-login-email\` in \`AuthContext.tsx\` and \`Otp.tsx\`.\r
  - Aligns with backend function naming convention for better clarity and separation of login vs other 2FA email flows.\r
\r
# [0.1.11] FE WEB CEKAT 2025-12-10\r
\r
### Conversation Management\r
\r
- **Status Filter Cleanup**: Removed the redundant "Resolved" option from the conversation status filter.\r
  - The "Closed" status now serves as the single source of truth for completed conversations.\r
  - Simplified the filtering logic to remove unnecessary status checks.\r
\r
# [0.1.10] FE WEB CEKAT 2025-12-09\r
\r
### Human Agents & Permissions\r
\r
- **Create Agent Permission Gate**: Simplified and hardened the Create Agent button on the Human Agents page.\r
  - Button is now directly gated by \`users_profile.create\` via \`PermissionGate\`, following the same pattern as other RBAC-protected actions.\r
  - When the user lacks permission, the button stays visible but disabled with a clear tooltip (You do not have permission to create agents.).\r
  - Removed the extra client-side lookup against the \`permissions\` table and associated state (\`createPermissionKey\`, \`checkingCreatePermission\`) to reduce complexity and runtime edge cases.\r
\r
### Navigation & RBAC Consistency\r
\r
- **Super Agents Schema Alignment**: Updated \`PERMISSIONS_SCHEMA\` to include the full \`super_agents\` action set (\`create\`, \`update\`, \`delete\`, \`read_all\`, \`read_own\`), matching the backend \`permissions\` table.\r
- **Navigation Read-Gates**: Centralized navigation gating to use read scopes consistently:\r
  - Added a defensive \`readPerms(resource)\` helper that safely derives \`resource.read*\` keys from \`PERMISSIONS_SCHEMA\`.\r
  - Human Agents sidebar item now depends on any \`super_agents\` read scope (e.g. \`super_agents.read_all\` / \`super_agents.read_own\`), keeping menu visibility aligned with DB permissions.\r
- **useNavigation Stability**: Adjusted \`useNavigation\` to skip DB permission recomputation while RBAC is still loading, preventing transient context errors during hot reloads while keeping the existing has_perm-first behavior.\r
\r
# [0.1.9] FE WEB CEKAT 2025-12-03\r
\r
### AI Agents\r
\r
- Replaced the browser \`confirm()\` with a first-class modal when deleting AI agents.\r
  - Uses the shared \`AlertDialog\` component with explicit cancel/confirm controls.\r
  - Shows the agent name inside the confirmation copy and blocks dismissal while the request is in flight.\r
  - Surfaces loader feedback and only closes when the Supabase delete succeeds.\r
\r
# [0.1.8] FE WEB CEKAT 2025-12-03\r
\r
### Platform Forms: Super Agent Management & Scoping\r
\r
- **Explicit Super Agent Selection**: All platform forms (WhatsApp, Telegram, Web) now require explicit Super Agent selection before AI Agent selection\r
  - Super Agent field is now a required, selectable dropdown (previously derived from AI Agent)\r
  - Field appears above AI Agent selection with clear labeling and tooltips\r
  - Form validation prevents submission without Super Agent selection\r
  - Helper text explains that Super Agent can be changed independently of AI Agent\r
\r
- **AI Agent Filtering by Super Agent**: Enhanced AI Agent selection with strict scoping\r
  - AI Agent dropdown only shows agents belonging to the selected Super Agent\r
  - Validation prevents selecting AI agents that don't belong to the selected Super Agent\r
  - Error toast notifications when attempting invalid selections\r
  - Form automatically resets AI Agent selection when Super Agent changes\r
  - Warning message displayed if selected AI Agent lacks a Super Agent assignment\r
\r
- **Human Agent Scoping**: Improved human agent assignment with role-based filtering\r
  - Human Agent multi-select only shows agents assigned to the selected Super Agent\r
  - "Select All" and "Unselect All" buttons for quick agent assignment\r
  - Multi-select disabled until Super Agent is selected\r
  - Clear placeholder text indicating selection requirements\r
  - Consistent behavior across all platform types (WhatsApp, Telegram, Web)\r
\r
- **AI Agent Creation Enhancement**: Super Agent assignment during creation\r
  - Super Agent selection required in AI Agent creation dialog\r
  - Searchable dropdown for Super Agent selection\r
  - Super Agent information displayed in AI Agent cards\r
  - Validation ensures Super Agent is selected before agent creation\r
\r
### Navigation & Permissions Updates\r
\r
- **Navigation Configuration**: Updated navigation items and permission mappings\r
  - Refined permission checks for navigation visibility\r
  - Enhanced role-based access control for navigation items\r
  - Improved database permission checks in useNavigation hook\r
\r
- **Permission Schema**: Updated permissions configuration\r
  - Aligned permission schema with backend requirements\r
  - Enhanced permission categorization and validation\r
\r
### Live Chat Improvements\r
\r
- **Message Handling**: Enhanced message synchronization and streaming\r
  - Improved realtime message updates\r
  - Better handling of streaming responses\r
  - Optimized message deduplication logic\r
  - Enhanced user message timeout handling\r
\r
### Webhook Configuration\r
\r
- **Webhook Routing**: Updated webhook endpoint configuration\r
  - Enhanced proxy-aware routing\r
  - Improved endpoint resolution for different providers\r
  - Better error handling for webhook calls\r
\r
### Technical Improvements\r
\r
- **Hooks Enhancement**: Improved data fetching and scoping\r
  - Enhanced useAIAgents hook with better super agent scoping\r
  - Improved useNavigation hook with database permission checks\r
  - Better error handling and loading states\r
  - Optimized cache management\r
\r
# [0.1.7] FE WEB CEKAT 2025-12-03\r
\r
### RBAC & Permissions (Finalized Alignment)\r
\r
- Standardized PERMISSIONS_SCHEMA to match production backend exactly:\r
  analytics, ai_profiles, ai_sessions, channels, contacts, contact_identities, threads, messages, ai_agent_files, admin_panel, roles, audit_logs, alerts.\r
- Permission Matrix UX revamp (purely permission-driven):\r
  - Card sections enforced per resource: Manage (create/update/delete), Access Level (read variants), Special Actions (send/ack).\r
  - Mutually exclusive Access Level pills; Threads uses My Channels (read_channel_owned), Collaborator, All.\r
  - Special actions exposed as toggles: messages.send (Send), alerts.ack (Acknowledge).\r
  - Select All sets Manage + Special Actions ON and selects the most permissive single read level; Unselect All resets to None.\r
  - Labels updated (Update Settings for admin_panel.update); consistent wording across cards.\r
  - Added concise tooltips for threads/messages read scopes and alerts.ack.\r
- Removed bundle-based Menu Access from PermissionsPage; no more ghost toggles or bundles.\r
- Fixed toggle handler so switches reflect intended state; role permission grant/revoke now gated by roles.update.\r
- Debounced RBAC refresh during bulk edits to prevent UI lag.\r
\r
### Navigation & Visibility (Policy-First)\r
\r
- Menu visibility now depends on DB has_perm checks; items are hidden if the user lacks any read scope for that section.\r
- Updated gating keys to align with schema:\r
  - Admin Panel: admin_panel.read (menu), admin_panel.update (controls)\r
  - Permissions: roles.read\r
  - Chat: threads.read_* (any of read_all/read_channel_owned/read_collaborator)\r
  - Analytics: analytics.read\r
  - Contacts: contacts.read_*; Platforms: channels.read_*; AI Agents: ai_profiles.read_*; Logs: audit_logs.read\r
- Sidebar renders only items from getAccessibleNavItems(); fixed ReferenceError by properly destructuring the hook return.\r
- Reduced has_perm spam: policy checks recompute only when RBAC roles/permissions change.\r
\r
### Admin Panel\r
\r
- Replaced legacy access_rules.configure gates:\r
  - Controls now use admin_panel.update; navigation uses admin_panel.read.\r
\r
### Misc\r
\r
- Added contact_identities to schema.\r
- Consistency/cleanup across labels, ordering, and spacing in Permission Matrix.\r
\r
# [0.1.6] FE WEB CEKAT 2025-11-30\r
\r
### Cache Management & Session Reliability\r
\r
- **Comprehensive Cache Clearing on Logout**: Enhanced logout functionality to clear all cached data\r
  - Clears all localStorage items (including \`app.cached*\`, \`app.currentUserId\`, etc.)\r
  - Clears all sessionStorage items\r
  - Clears all Supabase auth tokens\r
  - Prevents stale data from persisting after logout\r
  - Applied to both \`AuthContext.signOut()\` and \`Logout.tsx\` page\r
\r
- **localStorage-Based User ID Storage**: Improved session reliability by storing user ID in localStorage\r
  - User ID and email stored in localStorage as \`app.currentUserId\` and \`app.currentUserEmail\` on login\r
  - Added \`getCurrentUserId()\` helper function that prefers localStorage over Supabase session\r
  - Updated \`logAction()\` to use localStorage user_id first, then fallback to Supabase session\r
  - Ensures consistent user identification even when Supabase session is temporarily unavailable\r
\r
### Bug Fixes\r
\r
- **Merge Conflict Resolution**: Resolved merge conflict in \`useAIAgents.ts\` by combining \`scopeMode\` and \`superAgentId\` logic\r
- **Policy Role Fix**: Fixed \`threads_master_read\` policy to use \`authenticated\` role instead of \`public\` role\r
- **Cache Persistence**: Fixed issue where cached data persisted after logout, causing users to see unauthorized data\r
\r
# [0.1.5] FE WEB CEKAT 2025-11-30\r
\r
### Webhook & Supabase URL Consistency\r
\r
- **Single Source for Supabase URL**: Exported a shared \`SUPABASE_URL\` constant from the Supabase client so all front-end integrations reference the same base URL sinstead of duplicating it.\r
- **Proxy Edge Function Alignment**: Updated \`WEBHOOK_CONFIG\` to derive the proxy base (\`/functions/v1/proxy-n8n\`) from the shared \`SUPABASE_URL\`, removing the old hardcoded Supabase project host and keeping proxy routing aligned with the active project.\r
- **WhatsApp WAHA Webhook Normalization**: Swapped the hardcoded Railway webhook host in \`WhatsAppPlatformForm\` for \`WEBHOOK_CONFIG.BASE_URL\`, ensuring WAHA sessions always post back into the currently configured webhook environment.\r
\r
# [0.1.4] FE WEB CEKAT 2025-11-28\r
\r
### Bug Fixes\r
\r
- **PermissionsPage Duplicate Declaration Fix**: Resolved "Identifier 'permissionSearch' has already been declared" syntax error\r
  - Removed duplicate state declarations for \`permissionSearch\`, \`permissionResourceFilter\`, and \`permissionActionFilter\`\r
  - Kept the properly typed versions of these state variables\r
  - Fixed runtime error that prevented the Permissions page from loading\r
\r
# [0.1.3] FE WEB CEKAT 2025-11-28\r
\r
### AI Agent Visibility\r
\r
- Agents now only see AI agents owned by their assigned super agent; a new \`useSuperAgentScope\` hook drives consistent filtering across dashboards, dropdowns, and cached data.\r
- The AI Agents list and helpers surface localized messaging when an agent has no supervising cluster, preventing stale cross-team data from leaking through local storage.\r
\r
### Database Access Control\r
\r
- Tightened the \`ai_profiles\` RLS guard so master agents retain full visibility, super agents stay scoped to their own records, and agents inherit their supervising super agents access.\r
\r
# [0.1.2] FE WEB CEKAT 2025-11-26\r
\r
### Platform Form Enhancements for Super Agents\r
\r
- **Super Agent Field Auto-Prefill**: All platform creation forms (Telegram, WhatsApp, Web) now automatically prefill the super agent field when the current user is a super agent\r
  - Super agent field is automatically populated with the current user's super agent username/ID when form opens\r
  - Field becomes readonly (visual indication with reduced opacity) when user is a super agent\r
  - Helper text updated to indicate super agent is determined by current user's account for super agent users\r
  - Prevents super agent users from changing their own super agent assignment\r
\r
- **AI Agent Filtering for Super Agents**: Enhanced platform forms to filter AI agents based on super agent role\r
  - Super agent users only see AI agents that belong to their account in the AI agent dropdown\r
  - Validation prevents selecting AI agents that don't belong to the super agent's account\r
  - Error toast notification shown when attempting to select invalid AI agents\r
  - Master agents continue to see all AI agents as before\r
\r
- **Role-Based Form Behavior**: Implemented role-aware form logic across all platform types\r
  - Added \`useRBAC()\` hook integration to check for \`ROLES.SUPER_AGENT\` role\r
  - Automatic super agent ID detection from \`humanAgents\` list when form opens\r
  - Form reset logic preserves super agent ID for super agent users\r
  - Consistent behavior across Telegram, WhatsApp, and Web platform forms\r
\r
### Technical Improvements\r
\r
- **Component Updates**: Enhanced platform form components with role-based logic\r
  - Added \`useEffect\` hooks to prefill super agent field on form open\r
  - Integrated \`useRBAC\` context for role checking\r
  - Added conditional rendering and validation based on user role\r
  - Improved form state management to preserve super agent selection for super agent users\r
\r
# [0.1.1] FE WEB CEKAT 2025-11-27\r
\r
### Permissions Console\r
\r
- **Regression Fix**: Reintroduced missing permission search and filter state in \`PermissionsPage\`; restores the role configuration screen and avoids the \`permissionSearch is not defined\` runtime error.\r
- **Master Agent Safety Rail**: Hard-blocked deletion of the Master Agent from both UI and API helpers; delete buttons are disabled with guidance and back-end guards stop any direct calls.\r
\r
### UI Localization\r
\r
- **Master Agent Deletion Message**: Updated the modal tooltip and toast that appear when attempting to delete a master agent; the copy now follows the latest localization requirements.\r
\r
# [0.1.0] FE WEB CEKAT 2025-11-27\r
\r
### FINALIZED FOR PRODUCTION\r
\r
### Agent Creation UX\r
\r
- **Modal-Friendly Errors**: Duplicate-email validation now surfaces purely as a toast; the Create Agent dialog stays open and no longer renders the full-page error banner, making it easy to adjust the address and resubmit.\r
\r
# [0.0.49] FE WEB CEKAT 2025-11-27\r
\r
### Human Agents Roster\r
\r
- **Duplicate Entry Cleanup**: Adjusted role grouping logic so master agents no longer appear in both the master and agent sections of the Human Agents table; prevents a single email from showing twice and keeps assignment status accurate.\r
\r
### Login & Session Guardrails\r
\r
- **Refresh Spinner Fix**: Added watchdog timers around Supabase session/bootstrap calls so a stalled \`auth.getSession()\` or 2FA profile check cant trap users behind the infinite Loading screen; stale sessions now fall back to the login view within a few seconds.\r
- **Account Status Timeouts**: Soft-capped the account status RPC to keep token refreshes responsive even if the database briefly stops responding.\r
\r
# [0.0.48] FE WEB CEKAT 2025-11-26\r
\r
### RBAC & Permissions System Enhancements\r
\r
- **Master Agent Root Role Treatment**: Master Agent is now treated as root role with full system privileges\r
  - Master Agent role is designated as root role with unrestricted access across the system\r
  - Permission matrix editing is disabled for Master Agent to prevent accidental permission removal\r
  - Root role status ensures Master Agent maintains full privileges regardless of permission configuration\r
\r
- **Permission Matrix UI Updates**: Disabled permission matrix editing for Master Agent role\r
  - Added root role detection in PermissionsPage component (\`isRootSelected\` check)\r
  - Permission matrix sections (Menu Access, CRUD Permissions, Special Permissions) are disabled when configuring Master Agent\r
  - Added informational "Root Role" card explaining Master Agent's full privilege status\r
  - All permission checkboxes and bundle toggles are disabled with helpful tooltips ("Master Agent is root; matrix disabled")\r
  - Clear visual indication that Master Agent has full privileges and doesn't require permission configuration\r
  - Prevents accidental permission removal for root role through UI safeguards\r
  - Early return guards prevent any permission toggle operations when Master Agent is selected\r
\r
### Technical Improvements\r
\r
- **PermissionsPage Component**: Enhanced role configuration logic\r
  - Added \`isRootSelected\` state check based on role name comparison\r
  - Conditional rendering of root role information card\r
  - Disabled state applied to all permission matrix controls for Master Agent\r
  - Improved tooltip messaging for disabled root role controls\r
- **Open Conversation Navigation Fix**: Ensured contacts page button opens chat inbox\r
  - \`Open conversation\` now routes to chat inbox with \`menu=chat\`\r
  - Automatically selects the relevant contact thread when available\r
\r
# [0.0.47] FE WEB CEKAT 2025-11-25\r
\r
### Supabase Baseline Refresh\r
\r
- **Single Source Migration**: Replaced the entire migrations stack with \`20251124230847_baseline.sql\`, capturing todays production schema so every environment can rebuild from a single, clean baseline.\r
- **Vector Extension Guardrails**: Ensured the baseline creates the \`vector\` extension in the \`public\` schema and updates every dependent function/column to reference the schema-qualified type.\r
- **Config Hardening**: Explicitly pins Supabase Storage to \`v1.31.1\` in \`supabase/config.toml\`, preventing CLI diffs from failing on missing storage migrations.\r
\r
### Branch & Data Maintenance\r
\r
- **Development Branch Reset**: Repaired Supabase migration history, reapplied the new baseline, and reset the \`development\` branch so it replays the trimmed migration set without legacy drift.\r
- **Main  Dev Data Parity**: Dumped production \`public\` + \`auth\` data and restored it into the development branch, then pruned historic test accounts to keep both environments aligned.\r
- **Backup Hygiene**: Ran the same user cleanup on the backup project (\`igtizjvhxgajijjjxnzi\`) to ensure the automated sync worker starts from a consistent dataset.\r
\r
# [0.0.46] FE WEB CEKAT 2025-11-24\r
\r
### Database Migration Hardening\r
\r
- **Legacy Platform Support**: Updated the \`20250828000000_merge_platforms_into_channels.sql\` migration to add any missing \`platforms\` columns (\`display_name\`, \`website_url\`, \`status\`, \`secret_token\`, \`profile_photo_url\`, \`ai_profile_id\`) on the fly so historical environments can replay migrations without schema drift.\r
- **Main Branch Hotfix Migration**: Applied Supabase migration \`20250827950000_fix_platforms_schema\` on production to backfill those columns immediately, unblocking rebase operations across environments.\r
- **Rebase Reliability**: Re-ran the Supabase rebase workflow to verify the new safeguards; future branch syncs no longer fail on missing column errors when promoting channels data.\r
\r
# [0.0.45] FE WEB CEKAT 2025-11-23\r
\r
### QA Testing Guide Expansion\r
\r
- **End-to-End Flow Coverage**: Expanded \`DOCUMENTATION.md\` with exhaustive step-by-step flows covering login, OTP, password reset, human/AI agent lifecycle, contacts, permissions, admin utilities, analytics, and audit logs so QA can validate every button and path without code access.\r
- **Button & Validation Matrix**: Documented the enabled/disabled states, confirmation dialogs, toasts, and edge-case behaviour for all primary actions (create, save, delete, export, toggle) across the application.\r
- **Role-Based Walkthroughs**: Added guidance on testing from master, super, and agent perspectives, including navigation expectations and restricted-card behaviour on the dashboard.\r
\r
### Documentation Quality Improvements\r
\r
- **Live Chat & Admin Deep Dives**: Added detailed instructions for conversation tools (notes, tags, canned responses, SLAs), AI pause/resume workflow, circuit breaker monitoring, and platform onboarding (WhatsApp, Telegram, Web).\r
- **Human Agent Lifecycle**: Documented invite, resend, cancellation, token limit management, usage analytics, and removal to ensure QA covers onboarding and offboarding scenarios end-to-end.\r
- **Changelog & Profile Flows**: Captured interactive changelog behaviour, search/filter expectations, and full profile/session management (2FA toggle, password change, device sign-out).\r
\r
### Super Agent Clustering\r
\r
- **AI Agent Ownership**: Introduced \`super_agent_id\` on \`ai_profiles\`, enforced via migrations and new RLS policies. Super agents only see/manage their own AI agents; master agents can reassign via settings.\r
- **Auto-Inherited Platform Ownership**: Platform creation/editing now derives \`channels.super_agent_id\` from the selected AI agent, eliminating manual super agent selection while keeping human-agent assignment intact.\r
- **Scoped Listings**: AI agent lists, stats, and platform forms filter to the current super agent automatically; agents without clusters are prevented from being used until assigned.\r
\r
### Platform Assignment Guard\r
\r
- **Scoped Agent Dropdowns**: When creating WhatsApp, Telegram, or Web platforms as a master agent, the human-agent selector now lists only agents assigned to the chosen super agentpreventing unassigned agents from appearing in the multi-select.\r
\r
# [0.0.44] FE WEB CEKAT 2025-11-19\r
\r
### Changelog Experience Revamp\r
\r
- **Interactive Release Browser**: Introduced a dynamic changelog page with searchable release list, color-coded highlights, and accordion sections for each area of work.\r
- **Dual View Modes**: Added interactive and classic tabs so readers can switch between the immersive UI and the original Markdown in one place.\r
- **Automatic Highlight Extraction**: Generate summary badges from markdown bullet points to surface the most important updates per release.\r
- **Styling Updates**: Applied gradient backgrounds, elevated cards, and refined typography for a colorful, engaging presentation.\r
- **Comprehensive Documentation**: Added \`DOCUMENTATION.md\` detailing auth flows, feature modules, Supabase schema, and operational processes.\r
\r
# [0.0.43] FE WEB CEKAT 2025-11-18\r
\r
### AI Pause Notification System\r
\r
- **New AI Paused Modal Component**: Created dedicated modal for org-wide AI pause notifications\r
  - Modal displays when AI responses are paused across all channels\r
  - Shows who paused AI and when (for master agents)\r
  - Different messaging for master agents vs regular agents\r
  - Master agents can directly navigate to Admin Panel from modal\r
  - Modal appears once per browser session (acknowledgment stored in localStorage)\r
  - Integrated into main Index page with automatic status checking\r
\r
- **Org-Wide AI Pause Status Monitoring**: Enhanced AI pause state management\r
  - Automatic fetching of org-wide AI pause status on app load\r
  - Resolves paused-by user name from profile or email\r
  - Modal auto-dismisses when AI pause is lifted\r
  - Session-based acknowledgment prevents modal spam\r
\r
### Conversation Page UI Improvements\r
\r
- **Fixed Tab Color Styling**: Resolved issue where selected tab colors were not displaying\r
  - Restructured Tooltip/TabsTrigger relationship (Tooltip now inside TabsTrigger)\r
  - Assigned tab: Blue background and text when active\r
  - Unassigned tab: Red background and text when active\r
  - Resolved tab: Green background and text when active\r
  - Proper \`data-[state=active]\` attribute application from Radix UI\r
\r
- **Improved Conversation Sorting**: Enhanced conversation list sorting logic\r
  - Removed unreplied priority sorting (now purely by latest activity)\r
  - Conversations sorted by \`last_msg_at\` timestamp (most recent first)\r
  - Fallback to \`created_at\` if \`last_msg_at\` unavailable\r
  - More intuitive ordering based on actual activity\r
\r
- **Enhanced Timestamp Display**: Improved date/time formatting in conversation list\r
  - Added "Yesterday" display for messages from previous day\r
  - Changed date format from \`dd/MM/yy\` to \`MM/dd/yyyy\` for better clarity\r
  - Better hour-based calculations for relative time display\r
  - More accurate time representation\r
\r
- **TypeScript Fixes**: Resolved type errors\r
  - Removed reference to non-existent \`updated_at\` field on \`ConversationWithDetails\`\r
  - Fixed sorting logic to use only available timestamp fields\r
\r
### Code Quality Improvements\r
\r
- **Conversation Hooks Cleanup**: Minor refactoring in \`useConversations\` hook\r
  - Code cleanup and optimization\r
  - Improved type safety\r
\r
# [0.0.42] FE WEB CEKAT 2025-11-03\r
\r
### Admin Panel & Centralized Management\r
\r
- **New Admin Panel Component**: Created centralized admin control center for master agents\r
  - New dedicated Admin Panel page accessible via navigation (master agents only)\r
  - Moved data retention and GDPR controls from Analytics to Admin Panel for better organization\r
  - Added quick access links to all admin sections (Permissions, Human Agents, Platforms, Analytics, Logs, Contacts)\r
  - Integrated Circuit Breaker Status monitoring directly in admin panel\r
  - Added cache clearing utility for local storage cleanup\r
  - Bulk contact deletion interface with UUID parsing (comma/newline separated)\r
  - Enhanced data retention controls with manual cleanup trigger\r
  - GDPR/PDPA deletion interface with confirmation modals\r
  - All admin features consolidated in single, role-gated interface\r
\r
### Webhook Infrastructure Refactoring\r
\r
- **Centralized Webhook Client**: Created new \`webhookClient.ts\` for unified webhook handling\r
  - Automatic authentication for proxy endpoints using Supabase session tokens\r
  - Support for both legacy and proxy-based endpoints\r
  - Automatic API key injection for proxy requests\r
  - Consistent error handling across all webhook calls\r
  - \`callWebhook()\` function replaces direct \`fetch()\` calls throughout application\r
\r
- **Proxy-Aware Webhook Configuration**: Major refactoring of webhook routing system\r
  - Introduced \`route:\` prefix system for proxy-based endpoints\r
  - Automatic routing to Supabase Edge Function proxy (\`proxy-n8n\`) for prefixed endpoints\r
  - Legacy endpoint support maintained for backward compatibility\r
  - Provider-specific endpoint resolution (\`resolveSendMessageEndpoint()\`)\r
  - Enhanced provider normalization (wa/whatsapp_cloud  whatsapp, tg/tele  telegram)\r
  - All platform forms (WhatsApp, Telegram) now use centralized webhook client\r
  - Live Chat component updated to use new webhook client\r
\r
### AI Agent Enhancements\r
\r
- **AI Model Selection System**: Comprehensive model management in AI Agent creation and settings\r
  - Model selection dropdown in AI Agent creation dialog with pricing and provider information\r
  - Fallback model selection for automatic failover when primary model unavailable\r
  - Model-specific context window and history limit validation\r
  - Dynamic limit calculation based on selected model capabilities\r
  - Enhanced model display with cost per 1M tokens, provider badges, and descriptions\r
  - Model filtering (regular vs fallback models) for better UX\r
  - Auto-selection of first available model on load\r
\r
- **AI Agent Settings UI Improvements**: Enhanced settings interface with better input handling\r
  - Replaced numeric inputs with text inputs using \`inputMode="numeric"\` for better mobile support\r
  - Added input validation with clamping to model-specific maximums\r
  - Context window input now in "K tokens" format with model-specific limits\r
  - History limit shows model-specific maximums with helpful descriptions\r
  - Auto-resolve timeout input with proper validation (0-1440 minutes)\r
  - Message cap input with placeholder examples\r
  - Removed "AI Read File Limit" field (commented out, not in use)\r
  - Better label clarity: "Enable auto-resolve", "Auto-resolve timeout", "Conversation History (tokens)", "Context Window (K tokens)", "Creativity Preset", "AI Message Cap"\r
  - Model selection card with primary and fallback model sections\r
  - Real-time display of model capabilities and limits\r
\r
- **AI Agent Creation Flow**: Enhanced creation process\r
  - Model selection required before agent creation\r
  - Fallback model optional selection during creation\r
  - Better validation and error messages\r
  - Improved dialog with cancel button and loading states\r
\r
### Analytics Component Cleanup\r
\r
- **Removed Admin Controls**: Moved data retention and GDPR controls to Admin Panel\r
  - Removed data retention policy card from Analytics Conversation tab\r
  - Removed GDPR deletion card from Analytics\r
  - Removed Circuit Breaker Status from Analytics (now in Admin Panel)\r
  - Simplified Analytics component focusing on analytics and reporting only\r
  - Better separation of concerns between analytics and administration\r
\r
### Database & Permissions\r
\r
- **New Migration**: Added \`users_profile.create\` permission\r
  - Created migration \`20251103_add_users_profile_create_permission.sql\`\r
  - Grants \`users_profile.create\` permission to \`master_agent\` and \`super_agent\` roles\r
  - Enables proper RBAC for user profile creation operations\r
\r
### Enhanced Caching & Performance\r
\r
- **Query Signature-Based Caching**: Improved cache key generation in \`supabaseProtected.ts\`\r
  - Added query signature serialization for more accurate cache keys\r
  - Cache keys now include query method signatures and arguments\r
  - Prevents cache collisions between similar but different queries\r
  - Better cache invalidation with pattern matching\r
  - Enhanced cache hit rates with more granular key generation\r
\r
- **Cache Invalidation Improvements**: Better cache management\r
  - Contact deletion now invalidates related query caches\r
  - Thread deletion invalidates conversation caches\r
  - Pattern-based cache invalidation using \`defaultFallbackHandler.invalidatePattern()\`\r
\r
### Conversation & Contact Management\r
\r
- **Enhanced Conversation Hooks**: Improved conversation management\r
  - Added \`deleteThread()\` function to \`useConversations\` hook\r
  - Provider-aware message sending using \`resolveSendMessageEndpoint()\`\r
  - Better provider detection from conversation data\r
  - Cache invalidation on thread deletion\r
\r
- **Contact Management**: Improved deletion handling\r
  - Enhanced bulk deletion with cache invalidation\r
  - Better error handling in contact operations\r
  - Improved cache management for contact queries\r
\r
### Platform Integration Updates\r
\r
- **WhatsApp Platform**: Updated to use new webhook client\r
  - Session creation, login QR, logout, disconnect, and delete operations use \`callWebhook()\`\r
  - Consistent error handling across all WhatsApp operations\r
\r
- **Telegram Platform**: Updated to use new webhook client\r
  - Platform creation and webhook deletion use centralized webhook client\r
  - Better error handling and response parsing\r
\r
- **Connected Platforms**: Enhanced platform management\r
  - All webhook calls migrated to \`callWebhook()\` function\r
  - Better error handling and user feedback\r
  - Consistent authentication across all platform operations\r
\r
### Navigation & Routing\r
\r
- **New Admin Panel Route**: Added admin panel to navigation\r
  - New "Admin Panel" navigation item (master agents only)\r
  - Requires \`access_rules.configure\` permission\r
  - Added to navigation config and routing\r
  - Default navigation fallback improved to handle permission-based routing\r
\r
### UI/UX Improvements\r
\r
- **Human Agents**: Enhanced creation dialog\r
  - Better validation and error messages\r
  - Cancel button in creation dialog\r
  - Improved loading states\r
  - Permission-based UI (disabled buttons with tooltips when permission missing)\r
\r
- **Input Improvements**: Better form inputs throughout application\r
  - Numeric inputs use \`inputMode="numeric"\` for mobile keyboards\r
  - Better placeholder text and validation messages\r
  - Improved accessibility with proper input types\r
\r
### Technical Improvements\r
\r
- **Code Organization**: Better separation of concerns\r
  - Admin functionality centralized in Admin Panel component\r
  - Webhook logic centralized in webhook client\r
  - Better component structure and maintainability\r
\r
- **Type Safety**: Enhanced TypeScript types\r
  - Added \`model_id\` to AIProfile interface\r
  - Better type definitions for webhook responses\r
  - Improved type safety in platform forms\r
\r
- **Error Handling**: Consistent error handling\r
  - Unified error handling in webhook client\r
  - Better error messages throughout application\r
  - Improved user feedback with toast notifications\r
\r
# [0.0.41] FE WEB CEKAT 2025-11-01\r
\r
### Data Retention & GDPR Compliance\r
\r
- **Data Retention Policy System**: Implemented configurable data retention with automatic cleanup\r
  - Added 90-day default retention policy (adjustable from 1-365 days) stored in \`org_settings\` table\r
  - Created \`cleanup_old_chat_data()\` PostgreSQL function for automatic deletion of old chat data\r
  - Scheduled daily cleanup job at 2 AM UTC via \`pg_cron\` extension\r
  - Respects organization-specific retention periods stored in \`org_settings.retention_days\`\r
  - Only deletes data older than retention period (rolling window, not everything daily)\r
  - Deletes old threads, messages, and orphaned contacts based on \`created_at\` timestamps\r
  - Supports both org-specific cleanup and global cleanup for all organizations\r
\r
- **GDPR/PDPA Right to Erasure**: Implemented compliant user data deletion functionality\r
  - Created \`gdpr_delete_user_data()\` PostgreSQL function for permanent deletion of user data\r
  - Deletes all threads, messages, and contact records for a specific contact UUID\r
  - Validates contact belongs to requesting organization before deletion\r
  - Returns detailed deletion results (threads, messages, contacts deleted count)\r
  - Permanently removes all user-associated data in compliance with GDPR/PDPA regulations\r
  - Action cannot be undone with clear warning messages in UI\r
\r
- **Admin Controls in Analytics**: Added data retention and GDPR controls in Conversation tab\r
  - Data Retention Policy card with current retention period display and edit functionality\r
  - Manual "Run Cleanup Now" button for immediate cleanup execution\r
  - GDPR/PDPA deletion card with contact UUID input field\r
  - Restricted to users with \`access_rules.configure\` permission (master/super agents only)\r
  - Real-time success/error message display for all operations\r
  - Last cleanup results display showing threads, messages, and contacts deleted counts\r
\r
- **Database Migration**: Applied comprehensive migration for data retention features\r
  - Migration \`20250102_data_retention_and_gdpr.sql\` successfully applied via Supabase MCP\r
  - Created \`cleanup_old_chat_data()\` and \`gdpr_delete_user_data()\` functions with proper security\r
  - Added RLS policies for \`org_settings\` table updates restricted to master/super agents\r
  - Initialized default 90-day retention for all existing organizations\r
  - Ensured \`is_current_user_active()\` dependency function exists for RLS checks\r
\r
### Contact Management Enhancements\r
\r
- **Contact UUID Detail Modal**: Added master agent-only contact UUID display\r
  - New UUID section in contact details modal visible only to master agents\r
  - Displays contact UUID with copy-to-clipboard functionality\r
  - Includes helpful description for GDPR deletion requests and system integrations\r
  - Uses RBAC role check (\`hasRole('master_agent')\`) to restrict visibility\r
  - Styled with monospace font and muted background for clear readability\r
  - Badge indicator showing "Master Agent Only" restriction\r
\r
### Technical Improvements\r
\r
- **Supabase Integration**: Full integration with Supabase database functions\r
  - \`fetchRetentionSettings()\` reads from \`org_settings\` table via protected Supabase client\r
  - \`saveRetentionDays()\` updates retention period using upsert operation\r
  - \`triggerCleanup()\` calls \`cleanup_old_chat_data\` RPC function\r
  - \`executeGdprDeletion()\` calls \`gdpr_delete_user_data\` RPC function\r
  - All operations use \`protectedSupabase\` client respecting circuit breaker and RLS\r
  - Proper error handling and user feedback for all database operations\r
\r
- **RBAC Integration**: Enhanced role-based access control for admin features\r
  - Permission gates around data retention and GDPR controls\r
  - Master agent role check for contact UUID visibility\r
  - Secure access control using \`useRBAC\` context hooks\r
\r
### UI/UX Enhancements\r
\r
- **Data Retention UI**: Comprehensive admin interface for retention management\r
  - Edit modal for configuring retention period (1-365 days range)\r
  - Visual display of current retention period with clear descriptions\r
  - Warning messages explaining automatic cleanup schedule\r
  - Success/error message toasts for user feedback\r
\r
- **GDPR Deletion UI**: Secure and user-friendly deletion interface\r
  - Two-step confirmation process with warning modal\r
  - Clear indication of what will be deleted (threads, messages, contacts)\r
  - Contact UUID input with validation\r
  - Destructive button styling to indicate permanent action\r
\r
### Security & Compliance\r
\r
- **Data Protection**: Enhanced data protection mechanisms\r
  - Row Level Security (RLS) policies enforce master/super agent access only\r
  - Automatic cleanup respects retention periods to prevent accidental data loss\r
  - GDPR deletion function validates organization membership before deletion\r
  - All database operations use security definer functions with proper permissions\r
\r
# [0.0.40] FE WEB CEKAT 2025-11-01\r
\r
### Adaptive Rate Limiter Integration & DDoS Protection\r
\r
- **Adaptive Rate Limiter Full Integration**: Integrated adaptive rate limiter into Supabase protection system\r
  - Enhanced AdaptiveRateLimiter class with getConfig() and updateConfig() methods for runtime configuration\r
  - Added localStorage persistence for adaptive rate limiter configuration and multipliers\r
  - Integrated adaptive rate limiter into supabaseProtected.ts, replacing static rate limiter for all operations\r
  - Implemented automatic limit adjustment based on system health metrics (response time, error rate)\r
  - Added query to circuit_breaker_metrics table in Supabase for real-time metrics analysis\r
  - Automatic adjustment loop runs every adjustment interval to update limits dynamically\r
\r
- **Adaptive Rate Limiter Configuration UI**: Added comprehensive configuration interface\r
  - Created new "Adaptive Rate Limiter Configuration" section in Limit Configuration\r
  - Display base limits for all 4 operations (Reads, Writes, RPC, Auth) with current effective limits\r
  - Real-time display of multipliers (percentage) for each operation type\r
  - Show min/max multiplier, adjustment interval, and latency thresholds\r
  - Added "Edit" button with comprehensive modal for editing all adaptive rate limiter parameters\r
  - Visual status indicator showing adaptive rate limiter is active and protecting database\r
  - All configuration values are editable with proper validation and range limits\r
\r
- **Enhanced Rate Limiter Card**: Updated to show adaptive limits\r
  - Changed card title to "Rate Limiter (Adaptive)" to reflect dynamic nature\r
  - Display effective limits (dynamically calculated) instead of static limits\r
  - Show multiplier percentage for each operation type\r
  - Real-time updates every second to reflect current adaptive limits\r
  - Informative tooltips explaining how adaptive limits work for traffic spike protection\r
\r
- **Comprehensive Circuit Breaker Documentation Updates**: Enhanced documentation with detailed input explanations\r
  - Added detailed explanation section for all Circuit Breaker inputs (5 parameters)\r
    - Failure Threshold: When circuit opens, tips, recommendations\r
    - Reset Timeout: Recovery time, tips for different scenarios\r
    - Success Threshold: Recovery validation, recommendations\r
    - Monitoring Period: Sliding window explanation, impact on detection\r
    - Request Timeout: Timeout handling, recommendations per operation type\r
  - Added comprehensive explanation for all Adaptive Rate Limiter inputs (7+ parameters)\r
    - Base Limits: Explanation for Reads/Writes/RPC/Auth with recommendations\r
    - Min/Max Multiplier: How multipliers affect limits, examples with calculations\r
    - Latency Thresholds: Healthy vs Stress thresholds, tips for optimization\r
    - Adjustment Interval: How often limits adjust, recommendations for different scenarios\r
  - Added "How They Work Together" sections showing complete workflow for both systems\r
\r
- **DDoS & Traffic Spike Protection Guide**: Added dedicated protection guide\r
  - Created comprehensive guide section explaining inputs specifically for DDoS protection\r
  - Ranked inputs by importance: Min Multiplier (most important), Stress Threshold, Base Limits, etc.\r
  - Detailed recommendations for each input with effectiveness ratings\r
  - Provided optimal configuration preset for maximum DDoS protection\r
  - Explained complete attack scenario flow (5-step process)\r
  - Visual color-coded sections for easy reference (red borders for critical inputs)\r
\r
- **Documentation Improvements**: Enhanced existing documentation sections\r
  - Updated "Best Practices" section to include adaptive rate limiter tips\r
  - Enhanced "Configuration Reference" to show both Circuit Breaker and Adaptive Rate Limiter configs\r
  - Added effective limits display with multiplier percentages in configuration reference\r
  - Updated troubleshooting section to mention adaptive rate limiter as protection layer\r
  - All documentation now uses dynamic values from current configuration (real-time)\r
\r
### Technical Improvements\r
\r
- **Type System Enhancements**: Improved TypeScript type exports\r
  - Re-exported OperationType from adaptiveRateLimiter for better type consistency\r
  - Fixed import issues in CircuitBreakerStatus component\r
  - All types properly exported and available for external use\r
\r
- **Storage Management**: Enhanced persistence system\r
  - Adaptive rate limiter config persists to localStorage with multipliers\r
  - Automatic loading of saved configuration on initialization\r
  - Interval ID management for proper cleanup when adjustment interval changes\r
  - Backward compatible with existing localStorage data\r
\r
### UI/UX Enhancements\r
\r
- **Configuration Visualization**: Better display of adaptive limits\r
  - Show both base limit and effective limit side-by-side\r
  - Multiplier percentage displayed with color coding (green for healthy)\r
  - Real-time status indicators showing system is actively protecting\r
  - Clear distinction between static base limits and dynamic effective limits\r
\r
- **Documentation UX**: Improved documentation readability\r
  - Color-coded input explanations (red, orange, yellow, blue, purple borders)\r
  - Step-by-step workflows with numbered lists\r
  - Practical examples using actual configuration values\r
  - Tips and recommendations clearly separated from explanations\r
  - Warning boxes for critical information\r
\r
### Performance & Security\r
\r
- **DDoS Protection**: Multi-layered defense system\r
  - Adaptive rate limiter as first line of defense (reduces limits automatically)\r
  - Request timeout as second layer (cancels slow requests)\r
  - Circuit breaker as last resort (blocks all requests if needed)\r
  - Complete protection against traffic spikes and DDoS attacks\r
\r
- **Smart Limit Adjustment**: Intelligent limit management\r
  - Limits increase when system is healthy (up to 200% of base)\r
  - Limits decrease when system is stressed (down to 50% of base by default)\r
  - Gradual adjustment prevents sudden changes (max 10% increase, 20% decrease per cycle)\r
  - Automatic return to normal limits when system recovers\r
\r
# [0.0.39] FE WEB CEKAT 2025-11-01\r
\r
### Circuit Breaker Enhancements & Documentation\r
\r
- **Circuit Breaker Configuration Management**: Added comprehensive limit configuration interface for admins\r
  - Created "Limit Configuration" section displaying all circuit breaker thresholds (disabled by default)\r
  - Added "Edit" button to open configuration modal for modifying limits\r
  - Implemented getConfig() and updateConfig() methods in CircuitBreaker class\r
  - Added configuration persistence to localStorage for client-side recovery\r
  - Configuration values are now dynamically displayed and editable\r
  - Each configuration field includes descriptive tooltips explaining the purpose\r
\r
- **Circuit Breaker Documentation System**: Implemented comprehensive documentation modal\r
  - Added documentation card section above "Danger Zone" with "Lihat Dokumentasi Circuit Breaker" button\r
  - Created detailed documentation modal covering:\r
    - What is Circuit Breaker and its purpose\r
    - How Circuit Breaker works (three states: CLOSED, OPEN, HALF_OPEN)\r
    - Step-by-step workflow with dynamic configuration values\r
    - What to do when circuit breaker opens (troubleshooting guide)\r
    - Understanding metrics and their meanings\r
    - Best practices for monitoring and optimization\r
    - Configuration reference with current values\r
  - All documentation content in Indonesian language with clear formatting\r
  - Modal is scrollable and responsive for better readability\r
\r
- **Enhanced UI/UX for Circuit Breaker Analytics**: Improved user experience and safety\r
  - Added question mark icons (HelpCircle) beside all labels in "Limit Configuration" section\r
  - Each icon displays informative tooltip on hover with Indonesian descriptions\r
  - Reorganized admin controls into two distinct sections:\r
    - "Limit Configuration": For viewing and editing circuit breaker thresholds\r
    - "Danger Zone": For critical admin actions with enhanced warnings\r
  - Added tooltips to all buttons in "Danger Zone" explaining their effects\r
  - Enhanced visual hierarchy with color-coded sections (blue for docs, red for danger)\r
  - All tooltips and descriptions use dynamic values from current configuration\r
\r
- **Circuit Breaker Class Improvements**: Enhanced circuit breaker functionality\r
  - Added getConfig() method to retrieve current configuration\r
  - Added updateConfig() method to modify configuration at runtime\r
  - Configuration is automatically saved to localStorage on update\r
  - Configuration is automatically loaded from localStorage on initialization\r
  - Maintains backward compatibility with existing circuit breaker state\r
\r
### AI Agent Settings Cleanup\r
\r
- **Removed Timezone Field**: Cleaned up unused timezone configuration\r
  - Removed timezone field from AI Agent Settings UI component\r
  - Dropped timezone column from ai_profiles table via database migration\r
  - Removed timezone state variables and related logic from frontend\r
  - Updated TypeScript types to remove timezone references\r
  - Note: timezone field in users_profile table remains unchanged (separate feature)\r
\r
### Technical Improvements\r
\r
- **Code Organization**: Better separation of concerns in Circuit Breaker Status component\r
  - Split admin controls into logical sections (Documentation, Limit Configuration, Danger Zone)\r
  - Improved component structure for better maintainability\r
  - Enhanced modal management with dedicated state variables\r
  - Better error handling and user feedback\r
\r
### UI/UX Enhancements\r
\r
- **Documentation Integration**: Added comprehensive help system\r
  - Documentation card with prominent call-to-action button\r
  - Modal-based documentation with scrollable content\r
  - Color-coded sections for better visual hierarchy\r
  - Responsive design for all screen sizes\r
  - Dark mode support throughout documentation modal\r
\r
- **Enhanced Tooltips**: Improved user guidance\r
  - Question mark icons next to all configuration labels\r
  - Contextual tooltips explaining each configuration parameter\r
  - Tooltips on danger zone buttons with detailed warnings\r
  - All tooltips in Indonesian language for consistency\r
\r
# [0.0.38] FE WEB CEKAT 2025-10-30\r
\r
### Refactor Authentication & RBAC\r
\r
- Removed unnecessary debug logging from authentication and RBAC components.\r
- Enhanced role checks within navigation for more secure access control.\r
- Improved account status handling to better manage user states.\r
- Added role-based restrictions directly in navigation configuration.\r
- Updated related components for improved clarity and performance.\r
\r
# [0.0.37] FE WEB CEKAT 2025-10-30\r
\r
### Circuit Breaker & Database Protection System\r
\r
- **Comprehensive Circuit Breaker Implementation**: Implemented full-featured circuit breaker system for database protection\r
  - Created core CircuitBreaker class with state machine (CLOSED, OPEN, HALF_OPEN) and configurable thresholds\r
  - Added state persistence using localStorage for client-side recovery across page refreshes\r
  - Implemented event emitter pattern for real-time monitoring and state change notifications\r
  - Added time-windowed failure counting (10s monitoring period) with automatic state transitions\r
\r
- **Rate Limiting & Request Management**: Implemented advanced rate limiting and request optimization\r
  - Created sliding window rate limiter with per-user and per-endpoint tracking\r
  - Implemented request queue with deduplication, priority handling, and debouncing\r
  - Added request batching for similar queries to reduce total request count\r
  - Created adaptive rate limiter that adjusts limits based on system health metrics\r
\r
- **Enhanced Error Handling & Caching**: Implemented comprehensive error management and response caching\r
  - Created error classifier utility mapping Supabase error codes to categories (network, database, auth, rate limit, timeout)\r
  - Implemented retry logic with exponential backoff (1s, 2s, 4s, 8s max) and error-specific strategies\r
  - Added response caching with IndexedDB/localStorage using stale-while-revalidate pattern\r
  - Implemented offline mode support with write operation queuing and sync on connection restore\r
\r
- **Database Analytics & Monitoring**: Added comprehensive database performance monitoring\r
  - Created new "Database" tab in Analytics section with detailed database statistics\r
  - Implemented PostgreSQL functions for database metrics (table sizes, row counts, index performance, memory stats)\r
  - Added real-time database activity monitoring with KPI cards and interactive charts\r
  - Created comprehensive table statistics view with scan ratios, vacuum timestamps, and DML operations\r
\r
- **Circuit Breaker Analytics Dashboard**: Integrated circuit breaker monitoring into Analytics section\r
  - Added new "Circuit Breaker" tab displaying real-time status and metrics\r
  - Created CircuitBreakerStatus component with admin controls and visual indicators\r
  - Implemented metrics collection and storage in circuit_breaker_metrics table\r
  - Added comprehensive help tooltips with Indonesian descriptions for all labels\r
\r
- **Protected Supabase Integration**: Wrapped all database operations with circuit breaker protection\r
  - Created protectedSupabase wrapper replacing direct Supabase calls in critical components\r
  - Integrated circuit breaker, rate limiting, caching, and metrics collection\r
  - Updated Analytics, ConversationPage, and useConversations hooks to use protected wrapper\r
  - Implemented graceful degradation and fallback mechanisms for failed operations\r
\r
- **Admin Controls & Safety Features**: Added comprehensive admin controls with safety measures\r
  - Implemented custom modal dialogs replacing browser confirm/alert dialogs\r
  - Added confirmation popups with detailed Indonesian warnings for all admin actions\r
  - Created color-coded modal themes (orange for reset, red for critical actions, blue for info)\r
  - Added success/error feedback modals with proper error handling\r
\r
### Technical Improvements\r
\r
- **Performance Optimizations**: Resolved application freezing and lag issues\r
  - Fixed infinite loop in background cache refresh mechanism\r
  - Optimized metrics collection with batching and throttling (50 batch size, 30s interval)\r
  - Implemented caching for getUserId calls with 1-minute TTL and 500ms timeout\r
  - Added cooldown periods to prevent refresh storms (30s for queries, 60s for RPCs)\r
  - Made rate limiting more lenient for read operations to prevent blocking\r
\r
- **Database Schema Updates**: Enhanced database with circuit breaker metrics\r
  - Created circuit_breaker_metrics table with comprehensive operation tracking\r
  - Added RLS policies and indexes for efficient metrics querying\r
  - Implemented 30-day retention policy with cleanup_old_metrics function\r
  - Added database analytics functions for comprehensive performance monitoring\r
\r
### UI/UX Enhancements\r
\r
- **Modal System**: Replaced browser dialogs with custom modal components\r
  - Created consistent modal design matching application theme\r
  - Added proper dark mode support and responsive design\r
  - Implemented clear visual hierarchy with icons and color coding\r
  - Added comprehensive warning messages in Indonesian language\r
\r
- **Help System**: Enhanced user guidance throughout the application\r
  - Added question mark icons with tooltips to all analytics labels\r
  - Implemented LabelWithHelp component for consistent help integration\r
  - Created comprehensive Indonesian descriptions for all circuit breaker features\r
  - Added contextual help for admin controls and safety warnings\r
\r
# [0.0.36] FE WEB CEKAT 2025-10-25\r
\r
### Security & Authentication\r
\r
- **Account Deactivation System**: Implemented comprehensive account deactivation blocking system\r
  - Added database-level RLS policies to prevent deactivated users from accessing system resources\r
  - Created dedicated \`/account-deactivated\` warning page with Indonesian content\r
  - Implemented pre-login account status validation to prevent deactivated users from authenticating\r
  - Added automatic redirect to warning page when deactivated account is detected\r
  - Enhanced security with "fail closed" approach - blocks access if account status cannot be verified\r
\r
### User Experience Improvements\r
\r
- **Enhanced Navigation**: Fixed navigation issues and improved user flow\r
  - Replaced modal-based account deactivation with dedicated warning page\r
  - Added "Kembali ke Halaman Login" button with complete cleanup functionality\r
  - Implemented localStorage clearing and user signout on account deactivation\r
  - Fixed infinite loading issues caused by component conflicts\r
  - Added loading states and prevented multiple button clicks during navigation\r
\r
### Technical Improvements\r
\r
- **Component Architecture**: Streamlined authentication flow components\r
  - Removed deprecated \`AccountDeactivatedModal\` component\r
  - Created dedicated \`AccountDeactivated\` page component with proper routing\r
  - Fixed Router context issues by restructuring component hierarchy in App.tsx\r
  - Enhanced error handling and timeout management for signOut operations\r
  - Added comprehensive debugging and logging for authentication flow\r
\r
### Database & Security\r
\r
- **Row Level Security (RLS)**: Enhanced database security policies\r
  - Updated RLS policies to include active user checks for all major tables\r
  - Created \`is_current_user_active()\` helper function for consistent security checks\r
  - Applied security policies to \`users_profile\`, \`org_members\`, \`channels\`, \`contacts\`, \`threads\`, and \`messages\` tables\r
  - Implemented strict access control preventing deactivated users from reading sensitive data\r
\r
### Bug Fixes\r
\r
- **Authentication Flow**: Resolved multiple authentication-related issues\r
  - Fixed flicker when logging in with deactivated accounts\r
  - Resolved race conditions in account status checking\r
  - Fixed logout button functionality by preventing account deactivation interference\r
  - Corrected database column name from \`is_f2a_email_enabled\` to \`is_2fa_email_enabled\`\r
  - Fixed CORS errors with edge function approach by implementing direct database validation\r
\r
### UI/UX Enhancements\r
\r
- **Account Deactivation Warning Page**: Created comprehensive user feedback system\r
  - Added clear Indonesian messaging explaining account deactivation\r
  - Implemented contact instructions for Master Agent reactivation\r
  - Added visual warning indicators with appropriate icons and styling\r
  - Created responsive design with proper loading states and button interactions\r
\r
# [0.0.35] FE WEB CEKAT 2025-16-09\r
\r
### Updates\r
\r
- Added HCaptcha site key to .env for CAPTCHA validation.\r
- Enhanced Login component to include CAPTCHA verification.\r
- Improved ConversationPage to display channel logos.\r
- Updated HumanAgents component for better pagination and agent management.\r
- Adjusted useConversations and useHumanAgents hooks to support new fields for channel logos and agent organization.\r
- Implemented strict checks for super agent assignments in usePlatforms hook.\r
\r
# [0.0.34] FE WEB CEKAT 2025-11-09\r
\r
### Updates\r
\r
### AIAgentSettings\r
\r
- Added new state variables:\r
  - \`historyLimit\`\r
  - \`readFileLimit\`\r
  - \`contextLimit\`\r
  - \`responseTemperature\`\r
  - \`messageAwait\`\r
  - \`messageLimit\`\r
  - \`timezone\`\r
\r
- Improved overall usage tracking and configurability.\r
\r
### HumanAgent\r
\r
- Introduced **usage range option** for better monitoring.\r
\r
- Refactored **agent visibility logic** for clearer access control.\r
- Enhanced handling of **agent roles and statuses** for more robust management.\r
\r
# [0.0.33] FE WEB CEKAT 2025-10-09\r
\r
### Updates\r
\r
- Update project branding, enhance chat functionality, and improve permissions management\r
- Added aria-labels for accessibility in chat components\r
- Refined URL state synchronization in ConversationPage\r
- Implemented sorting and editing features in Contacts\r
- Removed legacy policy editing from PermissionsPage\r
- Updated navigation permissions for better clarity\r
\r
# [0.0.32] FE WEB CEKAT 2025-10-04\r
\r
### Updates\r
\r
- Fixed Live chat error and detail chat\r
- Update project branding to **Synka AI**\r
- Enhance **chat functionality**\r
- Improve **permissions management**\r
- Key changes include:\r
  - Renaming titles and meta descriptions\r
  - Adding a direct route to the chat inbox\r
  - Updating permission checks\r
  - Refining UI elements for better user experience\r
\r
Updating permission checks\r
\r
Refining UI elements for better user experience\r
\r
# [0.0.31] FE WEB CEKAT 2025-10-04\r
\r
### Updates\r
\r
- Introduced a new endpoint \`CHAT_TEST\` for testing AI agent chat settings.\r
- Updated \`AIAgentSettings\` component to include profile handling and improved UI with collapsible sections for behavior, welcome message, and transfer conditions.\r
- Enhanced \`ChatPreview\` to support profile ID and adjusted styling for better user experience.\r
- Refactored platform forms to remove profile photo upload functionality.\r
\r
# [0.0.30] FE WEB CEKAT 2025-10-04\r
\r
### Updates\r
\r
- Fix invite\r
\r
# [0.0.29] FE WEB CEKAT 2025-10-04\r
\r
Commit: Invite flow fixes, required field validation, form improvements\r
\r
### Updates\r
\r
- Invite Flow Fixes\r
  - Fixed invite flow to redirect users directly to password creation page instead of 2FA page\r
  - Added invite flow detection to skip 2FA requirements for invited users\r
  - Prevented duplicate 2FA emails for invited users\r
  - Added \`/invite\` route for proper invite handling\r
  - Enhanced ProtectedRoute to detect and redirect invite flows appropriately\r
- Form Validation Improvements\r
  - Made "Attach to Super Agent" field required for regular agents\r
  - Added visual indicators (red asterisks) for all required fields\r
  - Implemented real-time form validation with disabled submit button\r
  - Added contextual help text explaining field requirements\r
  - Enhanced error messages with specific validation feedback\r
- User Experience Enhancements\r
  - Submit button now disabled until all required fields are filled\r
  - Clear visual hierarchy distinguishing required vs optional fields\r
  - Real-time validation feedback as users type/select\r
  - Improved form accessibility with proper labeling\r
- Bug Fixes\r
  - Fixed invite users being incorrectly redirected to 2FA page\r
  - Resolved duplicate 2FA email sending for invited users\r
  - Corrected form submission logic for agent creation\r
  - Enhanced error handling for missing required fields\r
\r
# [0.0.28] FE WEB CEKAT 2025-10-04\r
\r
Commit: Auto-resolve functionality, thread timestamp fixes, audio notifications, UI improvements\r
\r
### Updates\r
\r
- Auto-Resolve System\r
  - Fixed auto-resolve functionality to work correctly with AI agents\r
  - Database triggers now properly set \`auto_resolve_at\` timestamp when AI responds\r
  - Auto-resolve function uses correct enum value \`'closed'\` instead of \`'resolved'\`\r
  - Periodic checking every 30 seconds for threads ready to auto-resolve\r
  - Real-time auto-resolve checks on message events\r
  - Threads auto-resolve after specified minutes of inactivity without user response\r
- Thread List Improvements\r
  - Fixed thread list to show latest message timestamp instead of first message timestamp\r
  - WhatsApp-style conversation sorting with unreplied threads at top\r
  - Real-time conversation preview updates without full list refresh\r
- Audio Notifications\r
  - Added audio notification system for new messages in opened threads\r
  - Two notification sounds: incoming (\`mixkit-message-pop-alert-2354.mp3\`) and outgoing (\`mixkit-long-pop-2358.wav\`)\r
  - Debounced notifications to prevent duplicate sounds\r
  - Tab visibility checks to only play sounds when tab is active\r
  - User controls: enable/disable audio notifications, test notification\r
- UI Improvements\r
  - Removed clock icon from chat message bubbles for cleaner appearance\r
  - Enhanced message streaming with better real-time updates\r
  - Improved conversation list performance with optimized refresh logic\r
- Database Schema Updates\r
  - Added \`channel_id\` to \`token_usage_logs\` table for better analytics\r
  - Added \`super_agent_id\` to \`channels\` table (moved from \`ai_profiles\`)\r
  - Updated RLS policies to use \`channels.super_agent_id\` for proper clustering\r
  - Fixed foreign key constraints and relationships\r
- Bug Fixes\r
  - Fixed page reload issues when alt+tabbing between browser tabs\r
  - Resolved conversation data leakage between different super agents\r
  - Fixed AI Agent dropdown filtering logic\r
  - Corrected thread timestamp display in conversation list\r
\r
# [0.0.27] FE WEB CEKAT 2025-10-03\r
\r
- Enabling AI Profiles fetch instead of using cache\r
\r
# [0.0.26] FE WEB CEKAT 2025-10-03\r
\r
Commit: Live Chat realtime + anon policies, auto-resolve with enable flag, reopen on user reply, UI polish\r
\r
### Updates\r
\r
- Live Chat (Embed)\r
  - Messages now stream from Supabase realtime (\`public.messages\`); webhook response is ignored for content.\r
  - Sends \`channel_id\`, \`session_id\`, and a persistent friendly \`username\` (stored per host in localStorage). Removed \`platform_id\` from payload.\r
  - Ringtones wired to \`public/tones\` assets; low = \`mixkit-message-pop-alert-2354.mp3\`, high = \`mixkit-long-pop-2358.wav\`.\r
  - Thread lookup uses \`contacts(name)\` with \`maybeSingle()\` (fixes PGRST116 when 0 rows).\r
- Database (Supabase)\r
  - Added anon SELECT RLS for web embed:\r
    - \`channels\`: \`allow_public_select_web_channels\` (provider='web' and active only).\r
    - \`threads\`: \`public_read_web_threads\` (via web channels).\r
    - \`messages\`: \`public_read_web_messages\` (via web channels).\r
    - Fixes 401/42501 when opening standalone live chat.\r
  - Auto-resolve framework:\r
    - \`ai_profiles.auto_resolve_after_minutes\` (int) and \`enable_resolve\` (bool).\r
    - \`threads.auto_resolve_at\` scheduled by trigger \`set_thread_auto_resolve_after_message\` on agent/assistant replies; cleared on user replies.\r
    - Function \`auto_close_due_threads()\` (cron-friendly) and helper \`schedule_auto_resolve_for_open_threads()\` for backfill.\r
  - Auto-reopen: trigger \`reopen_thread_on_user_message\` reopens closed threads and unassigns when a new user message arrives.\r
- AI Agent Settings\r
  - Enable Auto-resolve switch added; Auto-resolve after (minutes) is disabled when switch is off.\r
  - Removed sending \`system_prompt\` to webhook; UI still saves prompt to profile.\r
- Conversations UI\r
  - Unreplied badge restyled (soft red background, darker red text) to match Assigned styling.\r
\r
# [0.0.25] FE WEB CEKAT 2025-10-02\r
\r
Commit: Human vs AI handover analytics, WAHA sessions fetch, realtime chats, Platforms loop fix, UI polish\r
\r
### Updates\r
\r
- Analytics (Human Agent)\r
  - Handover rate redefined as Human/(Human+AI) across all conversations (not only resolved).\r
  - Added breakdowns: by Super Agent and by Agent, with Super Agent filter.\r
- Database (Supabase)\r
  - New/updated RPCs: \`get_handover_by_super_agent\`, \`get_handover_by_agent\`, \`get_agent_kpis\`.\r
  - Enabled realtime by adding \`public.threads\` and \`public.messages\` to \`supabase_realtime\`.\r
- Platforms (WhatsApp)\r
  - Fetch sessions from WAHA (\`/api/sessions\` and \`/api/sessions/{name}\`); removed dependency on webhook \`/get_sessions\` calls in UI.\r
  - Filter sessions to selected channel; debounced refresh; fixed infinite refresh loop on Platforms page.\r
  - QR polling uses WAHA session endpoint; Disconnect/Delete refresh safely.\r
- Conversations\r
  - Live-updating conversation list and counts via realtime subscriptions to \`threads\` and \`messages\` (debounced).\r
- UI\r
  - Delete Channel button shows spinner + Deleting and subtle pulse while processing.\r
- Changelog\r
  - Source from root \`CHANGELOG.md\` only; removed \`public/CHANGELOG.md\`; scripts updated to skip copy.\r
\r
# [0.0.24] FE WEB CEKAT 2025-09-30\r
\r
### Updates\r
\r
- Enhance message handling in ConversationPage and useConversations hooks.\r
- Optimistic UI updates for message status\r
\r
# [0.0.23] FE WEB CEKAT 2025-10-02\r
\r
### Updates\r
\r
- Live Chat\r
  - New embedded-only chat page at \`/livechat/:platform_id\` with blue-white palette, gradient background, glassy card, and clearer borders.\r
  - Sound notifications: low note on send, high note on AI reply; ringtone-style sequences; support external audio and synthesized chimes.\r
  - Netlify SPA routing for \`/livechat/*\` via redirects in \`netlify.toml\` and \`public/_redirects\`.\r
\r
- Connected Platforms\r
  - Live chat link and embed now use \`https://synkaai.netlify.app/livechat/{platform_id}\`.\r
  - Added Super Agent section (single-select; master-only). Human Agents now a searchable multi-select of regular agents only.\r
  - Removed Teams card. Agent chips show proper names and can be removed.\r
\r
- Platform Forms (Web, WhatsApp, Telegram)\r
  - Enforce Super Agent selection; filter AI/Human Agents by the selected Super Agent.\r
  - Fixed Telegram \`useEffect\` import error; safer webhook response handling.\r
  - Only selected human agents are attached on create.\r
\r
- Hooks and data\r
  - \`usePlatforms\`: join \`channel_agents\`; insert/remove on create/update; read/update \`channels.credentials.super_agent_id\`.\r
  - \`useAIAgents\`/\`LiveChat\`: dropped non-existent \`model\`; filter by \`super_agent_id\`.\r
  - \`useHumanAgents\`: include \`super_agent_id\` via \`super_agent_members\`.\r
\r
- Human Agents page\r
  - Clustering UI to manage Super Agents  Agents & AI Agents; token totals by cluster.\r
\r
- Database (Supabase)\r
  - New \`super_agent_members\` table (RLS) and \`ai_profiles.super_agent_id\` (NOT NULL).\r
  - Added \`users_profile.used_tokens\` plus \`refresh_used_tokens_for_super_agents\` function and trigger to aggregate token usage per super agent.\r
  - Deployed and backfilled via Supabase MCP; membership mappings added where needed.\r
\r
- Fixes\r
  - Resolved SPA 404s for \`/livechat/*\`.\r
  - Fixed \`users_profile.email\` and \`ai_profiles.model\` 42703 errors.\r
  - Ensured agent removal updates \`channel_agents\` and access.\r
\r
# [0.0.22] FE WEB CEKAT 2025-09-30\r
\r
### Updates\r
\r
- Fix platform creating for telegram\r
- Add saving functionality for selected AI agent in ConnectedPlatforms and prevent duplicate Telegram bot tokens in TelegramPlatform Form\r
- Enhance AI Agent Settings: Implement file upload functionality with Supabase integration, including upload progress tracking and error handling. Update UI to reflect file statuses and permissions. Add new knowledgebase endpoints for file management.\r
- Enhance file upload process in AIAgentSettings: pre-compute content hash for stable key, include additional metadata (storageName, storageSize, storageUpdatedAt) in upload response, and improve file validation checks.\r
\r
# [0.0.21] FE WEB CEKAT 2025-09-30\r
\r
### Updates\r
\r
- Update CHANGELOG and enhance Analytics and HumanAgents components.\r
- Added token usage tracking in Analytics with visualizations for daily usage and top models.\r
- Improved token aggregation logic in HumanAgents to account for super-agent clusters.\r
\r
# [0.0.20] FE WEB CEKAT 2025-09-30\r
\r
### Updates\r
\r
- Platform agent assignment\r
  - Persist selected agents on create to \`channel_agents\`; updates replace assignments.\r
  - Agents now only see platforms theyre assigned to; master/super see all.\r
  - Platforms list shows only attached human agents (no more org-wide members).\r
\r
- Platform details UI\r
  - New Super Agent section: shows assigned super agent; single-select; editable by master agents only; stored in \`channels.credentials.super_agent_id\`.\r
  - Human Agent manager: chips with remove (X) + searchable multi-select to add; lists only regular agents (excludes super/master).\r
  - Removed unused Teams card; unified details behavior across providers.\r
\r
- Telegram platform creation\r
  - Hits \`POST /telegram/create-platform\` (CREATE_PLATFORM) before channel insert.\r
  - Sends \`brand_name, display_name, description, telegram_bot_token, ai_profile_id, human_agent_ids, org_id\`.\r
  - Robust response handling for empty/non-JSON bodies; emits refresh after success.\r
\r
- Data fetching and names\r
  - Human agent names prefer \`users_profile.display_name\` with fallback to \`v_users.display_name\`; email sourced from \`v_users\`.\r
  - Fixed error when \`users_profile.email\` was selected (column doesnt exist).\r
\r
- Components\r
  - Added \`ui/multi-select\` (popover + search + checkbox) for multi-add of agents.\r
\r
- Fixes\r
  - Agent chips now display the correct agent name (not internal IDs).\r
  - Only the agents selected during platform creation are attached (no more all agents issue).\r
  - Resolved Telegram JSON parse errors and \`42703 users_profile.email\` error.\r
\r
# [0.0.19] FE WEB CEKAT 2025-09-23\r
\r
### Updates\r
\r
- Automatically switch to the Resolved tab when only closed conversations are present\r
- Updated Resolved tab UI to display the count of closed conversations.\r
\r
# [0.0.18] FE WEB CEKAT 2025-09-20\r
\r
### Updates\r
\r
- Added provider tabs (WhatsApp, Telegram, Live Chat) to filter the list; auto-select first item in active tab\r
- Replaced black status dot with green (active) / gray (inactive) indicator\r
\r
# [0.0.17] FE WEB CEKAT 2025-09-20\r
\r
### Updates\r
\r
- Scope data fetching and realtime to visible pages and active routes (Conversations, Human Agents, Platforms, Contacts, AI Agents, RBAC, Analytics)\r
- Add tab-visibility guards to avoid background fetch on tab-restore; hydrate from cache first where applicable\r
- Standardize React Query defaults (staleTime=60s, gc=5m, disable refetch on focus/reconnect)\r
- Reduce audit log verbosity: ignore refresh/update events; add 3s debounce in \`logAction\`; include current route in log context\r
- Analytics\r
  - Default to last 30 days and align to full-day UTC boundaries\r
  - Prevent invalid date ranges (From  To; To  From) with input min/max and clamping\r
  - Fetch once per change; removed duplicate initial fetch\r
- UI consistency: set Telegram Platform create button to blue\r
- Utilities: add \`isDocumentHidden\` and \`onDocumentVisible\` helpers\r
\r
# [0.0.16] FE WEB CEKAT 2025-09-19\r
\r
### Updates\r
\r
- Enhance real-time synchronization for conversations and messages; always fetch fresh data on mount\r
\r
# [0.0.15] FE WEB CEKAT 2025-09-19\r
\r
### Updates\r
\r
- Auth/OTP: eliminate redirect flicker by gating on \`otpEvaluated\`; \`ProtectedRoute\` and \`Otp\` now wait for evaluation; \`ResetPassword\` handles magic-link \`?code=\` with \`exchangeCodeForSession\`.\r
- Changelog page: render Markdown (react-markdown + GFM), Tailwind Typography, compact heading sizes; added Netlify \`public/_redirects\`; added \`prebuild\`/\`predev\` to copy root \`CHANGELOG.md\` to \`public/\`.\r
- Build: remove top-level await in \`main.tsx\` (wrap in async IIFE).\r
- Analytics (global): add graceful fallback when \`get_containment_and_handover\` is missing; improved handover reason labels; added per-user analytics (Assigned To, Takeovers Initiated, Resolved By, AIAgent Handovers).\r
- Human Agents:\r
  - Create Agent dialog with loader; 2FA enable checkbox on create; colored CTAs.\r
  - Add confirmation dialog with loader for deletion; wire hard delete.\r
  - Status changed to Active/Inactive; add \`users_profile.is_active\` column and update UI/actions.\r
  - Edit dialog shows Require Email 2FA switch and token limits; loads/saves \`is_2fa_email_enabled\`.\r
  - Role badges and submenu restyled (blue/green/gray).\r
- Edge Functions: \`admin-create-user\` (invite + profile + role, CORS) and \`admin-delete-user\` (hard delete auth user and related rows).\r
- Logging: \`logAction\` falls back to default org when \`org_id\` cannot be resolved (fixes audit log NOT NULL).\r
- UI theming: replaced remaining dark/black buttons with blue/green/red where appropriate.\r
\r
# [0.0.14] FE WEB CEKAT 2025-09-19\r
\r
### Updates\r
\r
- Fix changelog is not accessible in staging\r
\r
# [0.0.13] FE WEB CEKAT 2025-09-19\r
\r
### Updates\r
\r
- Implement OTP flow for login and enhance ProtectedRoute for OTP verification.\r
- Added new Otp and Logout pages\r
- Updated AuthContext to manage OTP state\r
- Modified Login component to handle OTP requirements.\r
\r
# [0.0.12] FE WEB CEKAT 2025-09-18\r
\r
### Updates\r
\r
- Enhance authentication flow with local storage caching and session restoration\r
- Implemented local storage caching for AI agents and conversations to improve performance and reduce flicker on refresh.\r
- Added session restoration from local storage to ensure user authentication state is maintained across page reloads.\r
- Updated AuthContext to prioritize local storage for session data before reconciling with Supabase.\r
- Introduced a loading state management to handle UI updates more smoothly during data fetching.\r
\r
# [0.0.11] FE WEB CEKAT 2025-09-17\r
\r
### Updates\r
\r
- Audit Logs self-read policy for non-master users.\r
- Added \`get_audit_logs\` RPC with server-side filters, paging, and master-only org-wide access.\r
- Analytics foundations: date-range controls and labeled charts; wired to secure RPCs.\r
- KPI RPCs: \`get_chats_timeseries\` and \`get_response_time_stats\` (avg/median/p90) with Asia/Jakarta bucketing.\r
- RBAC and conversation label changes now emit audit log entries.\r
- Analytics UI now uses new KPI RPCs with channel filter, time-series, and labeled bars.\r
- Containment/Handover groundwork: added \`threads.resolution\`, \`end_reason\`, \`handover_reason\`, AI auto-resolution trigger.\r
- Analytics RPCs: \`get_containment\` (with previous period) and \`get_handover_stats\` (reason breakdown).\r
- Server-side validation: handover reason now required when handover happens; added helpful indexes for analytics.\r
- Added \`get_non_contained\` RPC for drilldown of non-contained conversations.\r
- Containment/Handover dashboard cards with drilldown and reason pie chart.\r
- RBAC policy engine scaffold: \`rbac_policies\` table, RPCs (\`get_role_policy\`, \`put_role_policy\`, \`apply_role_policy\`), extended \`has_perm\` to honor policies.\r
- Role Policy editor UI (matrix) to manage per-resource actions; policy changes logged.\r
- Added docs/ANALYTICS_AND_LOGS.md covering RPCs, validation, and telemetry.\r
- Added PII sanitization tests for log CSV export.\r
- Added analytics time-series, containment, handover, and RBAC policy tests; basic E2E seed.\r
- TODO roadmap (server-validated) added for Analytics KPIs, Containment/Handover, RBAC policies, indexes, docs, and tests.\r
- implement OTP flow in login\r
- enhance ProtectedRoute for OTP verification\r
\r
# [0.0.10] FE WEB CEKAT 2025-09-16\r
\r
### Updates\r
\r
- fix: remove duplicate import of useRBAC in ConversationPage component\r
\r
# [0.0.9] FE WEB CEKAT 2025-09-16\r
\r
### Updates\r
\r
- Created loggings for every users, and only admin can access.\r
- Made Role Management for admins to setting the role.\r
\r
# [0.0.8] FE WEB CEKAT 2025-09-14\r
\r
### Updates\r
\r
- Replaced thread participants with collaborators in the database schema.\r
- Implemented checks for user collaboration status on conversations.\r
- Enhanced thread assignment logic to ensure proper user assignment and audit fields.\r
- Updated UI elements for chat takeover functionality to reflect new collaborator roles.\r
\r
# [0.0.7] FE WEB CEKAT 2025-09-13\r
\r
### Updates\r
\r
- Removed static permission constants in favor of direct string references for better alignment with database values.\r
- Updated components to utilize new permission string format, enhancing consistency across the application.\r
- Improved navigation logic to enforce permission checks when syncing active tabs, ensuring users only access permitted items.\r
- Streamlined permission-related code in various components, enhancing maintainability and readability.\r
\r
# [0.0.6] FE WEB CEKAT 2025-09-03\r
\r
### Updates\r
\r
- Implement OpenAI usage tracking and enhance analytics component\r
- Added OpenAI API key configuration to .env for usage tracking.\r
- Refactored vite.config.ts to include a usage proxy plugin for fetching OpenAI usage data.\r
- Enhanced Analytics component to display OpenAI token usage with dynamic date range selection and improved UI elements.\r
- Integrated charts to visualize input, output, and total tokens over selected time ranges.\r
- Implemented error handling and loading states for better user experience during data fetching.\r
\r
# [0.0.5] FE WEB CEKAT 2025-09-03\r
\r
### Updates\r
\r
- Updated PermissionNavItem and NavigationItem interfaces to use string arrays for permissions instead of PermissionName type for better flexibility.\r
- Modified NAVIGATION_CONFIG to replace permission constants with string representations for improved readability and consistency.\r
- Enhanced RBACProvider's hasPermission function to support various permission formats, including direct matches and synonyms for better user experience.\r
- Integrated a new PermissionsPage component into the main Index page, ensuring proper permission checks with PermissionGate.\r
\r
# [0.0.4] FE WEB CEKAT 2025-09-03\r
\r
### Updates\r
\r
- Integrate RBAC and enhance agent management features\r
- Added RBACProvider to App component for role-based access control.\r
- Updated HumanAgents component to utilize PermissionGate for role management and agent creation.\r
- Refactored agent role handling to support new roles: master_agent and super_agent.\r
- Enhanced ConversationPage to display channel provider information for better context.\r
- Improved useHumanAgents hook to fetch agents from the new v_users view, streamlining data retrieval and role assignment.\r
\r
# [0.0.3] FE WEB CEKAT 2025-09-03\r
\r
### Updates\r
\r
- Implement WhatsApp session polling and enhance deletion handling\r
- Added polling mechanism to check WhatsApp session status while the QR modal is open, improving user feedback on connection status.\r
- Introduced loading state management for channel deletion actions to prevent multiple submissions and enhance user experience.\r
- Removed phone number input from WhatsAppPlatformForm as per updated requirements, streamlining the form submission process.\r
\r
# [0.0.2] FE WEB CEKAT 2025-09-01\r
\r
### Updates\r
\r
- Deleted AUTHENTICATION_SETUP.md, CHAT_SETUP.md, HUMAN_AGENTS_SETUP.md, sample_data.sql, and simple_sample_data.sql as they are no longer relevant to the current project structure.\r
- Updated package.json version to 0.0.1 and removed unnecessary dev dependencies from package-lock.json.\r
- Enhanced Login component to display the current version of the application.\r
- Enhanced Whatsapp channel connecting flow and validation\r
\r
# [0.0.1] FE WEB CEKAT 2025-09-01\r
\r
### Updates\r
\r
- Enhance ClientEditProfileForm: Make company industry selection read-only for non-admin users\r
`,ED=["from-sky-400/60 via-cyan-400/20 to-transparent border-sky-500/40","from-fuchsia-400/60 via-purple-500/20 to-transparent border-fuchsia-500/30","from-emerald-400/60 via-lime-400/20 to-transparent border-emerald-500/30","from-amber-400/60 via-orange-400/20 to-transparent border-amber-500/30","from-indigo-400/60 via-violet-500/20 to-transparent border-indigo-500/30","from-rose-400/60 via-pink-500/20 to-transparent border-rose-500/30"];function TD(e){return e.split(`
`).map(t=>t.trim()).filter(t=>/^-\s*\*\*/.test(t)).map(t=>{const n=t.match(/^-\s*\*\*(.+?)\*\*:?\s*(.*)$/);if(!n)return t.replace(/^-+\s*/,"");const[,r,s]=n;return s?`${r.trim()}  ${s.trim()}`:r.trim()})}function hH(e){var s,i;const t=e.replace(/\r/g,"").trim();if(!t)return[];const n=t.split(/\n(?=# \[)/g).map(o=>o.trim()).filter(Boolean),r=[];for(const o of n){if(o.startsWith("# Change Log")){const y=o.replace(/^# Change Log\s*/,"").trim();if(!y)continue;const x=hH(y);r.push(...x);continue}const l=o.match(/^# \[(?<version>[^\]]+)\](?<title>.*?)(?:\n|$)/);if(!(l!=null&&l.groups))continue;const c=(s=l.groups.version)==null?void 0:s.trim();if(!c)continue;const u=((i=l.groups.title)==null?void 0:i.trim())??"";let d=u||void 0,h;if(u){const y=u.match(/(\d{4}-\d{2}-\d{2})/);y&&(h=y[1],d=u.replace(y[1],"").trim()||void 0)}const f=o.slice(l[0].length).trim(),m=f?f.split(/\n(?=### )/g).map(y=>y.trim()).filter(Boolean):[],g=m.length?m.map((y,x)=>{const[w,...b]=y.split(`
`),_=w.replace(/^###\s*/,"").trim()||`Section ${x+1}`,k=b.join(`
`).trim();return{heading:_,body:k,highlights:TD(k)}}):f?[{heading:"Updates",body:f,highlights:TD(f)}]:[],v=g.flatMap(y=>y.highlights).filter(Boolean).slice(0,5);r.push({version:c,label:d,date:h,sections:g,summary:v,raw:f})}return r}const W5e={p:({children:e})=>a.jsx("p",{className:"text-sm leading-relaxed text-slate-200",children:e}),ul:({children:e})=>a.jsx("ul",{className:"space-y-2 text-sm text-slate-200",children:e}),li:({children:e})=>a.jsxs("li",{className:"relative pl-6",children:[a.jsx("span",{className:"absolute left-0 top-2 h-2 w-2 rounded-full bg-gradient-to-r from-sky-400 to-blue-500 shadow-[0_0_12px_rgba(56,189,248,0.6)]"}),a.jsx("div",{className:"space-y-1",children:e})]}),strong:({children:e})=>a.jsx("span",{className:"font-semibold text-sky-200",children:e}),code:({children:e})=>a.jsx("code",{className:"rounded-md bg-slate-900/80 px-1.5 py-0.5 text-xs text-sky-200",children:e}),a:({children:e,href:t})=>a.jsx("a",{href:t,className:"text-sky-300 underline decoration-dotted underline-offset-4 transition hover:text-sky-200",target:"_blank",rel:"noreferrer",children:e})};function q5e(){var d;const e=p.useMemo(()=>hH(AD),[]),[t,n]=p.useState(""),[r,s]=p.useState("interactive"),[i,o]=p.useState(((d=e[0])==null?void 0:d.version)??""),l=t.trim().toLowerCase(),c=p.useMemo(()=>l?e.filter(h=>[h.version,h.label??"",h.date??"",h.raw,...h.sections.map(m=>m.heading),...h.sections.map(m=>m.body)].join(" ").toLowerCase().includes(l)?!0:h.sections.some(m=>m.highlights.some(g=>g.toLowerCase().includes(l)))):e,[e,l]);p.useEffect(()=>{var f;if(!c.length){o("");return}c.some(m=>m.version===i)||o(((f=c[0])==null?void 0:f.version)??"")},[c,i]);const u=c.find(h=>h.version===i)||c[0];return a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-950 via-slate-900 to-slate-950 px-4 py-10 text-foreground",children:a.jsxs("div",{className:"mx-auto flex w-full max-w-6xl flex-col gap-6",children:[a.jsxs("div",{className:"flex flex-col gap-2 text-center",children:[a.jsx("h1",{className:"text-3xl font-semibold tracking-tight text-white md:text-4xl",children:"Release Notes & Progress Journal"}),a.jsx("p",{className:"mx-auto max-w-2xl text-sm text-slate-300 md:text-base",children:"Explore every release with rich summaries, vivid highlights, and interactive sections. Filter by keyword, skim highlights, or dive deep into the full notes."})]}),a.jsxs(Gc,{value:r,onValueChange:h=>s(h),className:"w-full",children:[a.jsxs(Fl,{className:"mx-auto grid w-full max-w-xs grid-cols-2 bg-slate-900/60 p-1 shadow-inner shadow-slate-800/40",children:[a.jsx(_r,{value:"interactive",className:"data-[state=active]:bg-sky-500/20 data-[state=active]:text-sky-100",children:"Interactive"}),a.jsx(_r,{value:"markdown",className:"data-[state=active]:bg-slate-700/40 data-[state=active]:text-slate-100",children:"Classic"})]}),a.jsx(ir,{value:"interactive",className:"mt-6",children:a.jsxs("div",{className:"grid gap-6 lg:grid-cols-[320px_1fr]",children:[a.jsxs(He,{className:"border border-white/10 bg-slate-950/60 shadow-[0_12px_40px_-24px_rgba(56,189,248,0.65)] backdrop-blur",children:[a.jsxs(dt,{className:"space-y-4",children:[a.jsxs(ct,{className:"flex items-center gap-2 text-lg text-white",children:[a.jsx(QT,{className:"h-4 w-4 text-sky-300"}),"Releases"]}),a.jsx(Ts,{className:"text-xs text-slate-300",children:"Search and choose any release to explore tailored highlights and details. Recent entries glow brighter."}),a.jsxs("div",{className:"relative",children:[a.jsx(oi,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-slate-400"}),a.jsx(it,{placeholder:"Search versions, features, or dates...",value:t,onChange:h=>n(h.target.value),className:"bg-slate-900/70 pl-9 text-sm text-slate-100 placeholder:text-slate-400 focus-visible:ring-sky-400"})]})]}),a.jsx(lt,{className:"p-0",children:a.jsx(Lb,{className:"h-[540px]",children:a.jsxs("div",{className:"flex flex-col divide-y divide-white/5",children:[c.length===0&&a.jsx("div",{className:"p-6 text-center text-sm text-slate-400",children:"No release notes match your search. Try another term."}),c.map((h,f)=>{const m=h.version===(u==null?void 0:u.version);return a.jsx("button",{onClick:()=>o(h.version),className:Ie("group relative flex w-full flex-col items-start gap-3 px-5 py-4 text-left transition",m?"bg-sky-500/15":"hover:bg-slate-900/70"),children:a.jsxs("div",{className:"flex w-full items-start gap-3",children:[a.jsx("span",{className:Ie("mt-2 h-2.5 w-2.5 rounded-full bg-sky-400 shadow-[0_0_12px_rgba(56,189,248,0.7)] transition-transform",m&&"scale-125")}),a.jsxs("div",{className:"flex flex-1 flex-col gap-1",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[a.jsxs("span",{className:"text-sm font-semibold text-slate-100",children:["v",h.version]}),h.label&&a.jsx(At,{variant:"outline",className:"border-slate-500/50 bg-slate-900/60 px-2 py-0 text-[10px] font-medium uppercase tracking-wide text-slate-300",children:h.label}),h.date&&a.jsxs("span",{className:"flex items-center gap-1 text-[11px] uppercase tracking-wide text-slate-400",children:[a.jsx(qT,{className:"h-3 w-3 text-slate-400"}),h.date]})]}),h.summary.length>0&&a.jsx("div",{className:"flex flex-wrap gap-1.5 pt-1",children:h.summary.slice(0,3).map(g=>a.jsx(At,{variant:"secondary",className:"max-w-full truncate bg-sky-500/15 text-[10px] font-medium text-sky-100",title:g,children:g},g))})]})]})},h.version)})]})})})]}),a.jsx("div",{className:"space-y-6",children:u?a.jsxs("div",{className:"relative overflow-hidden rounded-3xl border border-white/10 bg-slate-950/70 p-1 shadow-[0_45px_90px_-60px_rgba(56,189,248,0.8)] backdrop-blur",children:[a.jsx("div",{className:"absolute -left-32 -top-32 h-64 w-64 rounded-full bg-sky-500/20 blur-3xl"}),a.jsx("div",{className:"absolute -bottom-24 -right-24 h-64 w-64 rounded-full bg-fuchsia-500/10 blur-3xl"}),a.jsxs("div",{className:"relative z-10 rounded-[calc(theme(borderRadius.3xl))] border border-white/10 bg-slate-950/80 px-8 py-8",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[a.jsxs(At,{className:"bg-sky-500/30 text-sky-50",children:["Version ",u.version]}),u.label&&a.jsx("h2",{className:"text-xl font-semibold text-white md:text-2xl",children:u.label}),u.date&&a.jsxs("span",{className:"flex items-center gap-1 text-sm text-slate-300",children:[a.jsx(qT,{className:"h-4 w-4 text-sky-300"}),u.date]})]}),u.summary.length>0&&a.jsx("div",{className:"mt-5 flex flex-wrap gap-2",children:u.summary.map(h=>a.jsxs(At,{variant:"outline",className:"gap-1 border-sky-400/40 bg-sky-500/15 px-3 py-1 text-[11px] font-medium text-sky-100",title:h,children:[a.jsx(QT,{className:"h-3 w-3 text-sky-200"}),a.jsx("span",{className:"max-w-[220px] truncate",children:h})]},h))}),a.jsx("div",{className:"mt-8 space-y-4",children:a.jsxs(z5e,{type:"multiple",defaultValue:u.sections.map((h,f)=>`section-${f}`),className:"space-y-4",children:[u.sections.map((h,f)=>{const m=ED[f%ED.length];return a.jsxs(cH,{value:`section-${f}`,className:Ie("border border-white/5","rounded-2xl bg-slate-950/60 shadow-[0_24px_60px_-35px_rgba(56,189,248,0.55)]"),children:[a.jsxs(uH,{className:"px-6 py-5 text-left hover:no-underline data-[state=open]:bg-slate-900/60",children:[a.jsxs("div",{className:"flex flex-1 flex-col gap-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:Ie("h-2.5 w-2.5 rounded-full bg-gradient-to-r shadow-[0_0_12px_rgba(56,189,248,0.6)]",m)}),a.jsx("span",{className:"text-base font-semibold text-white md:text-lg",children:h.heading})]}),h.highlights.length>0&&a.jsx("p",{className:"text-xs text-slate-300 md:text-sm",children:h.highlights[0]})]}),a.jsx(YT,{className:"h-4 w-4 text-sky-300"})]}),a.jsx(dH,{className:"px-6 pb-6",children:a.jsxs("div",{className:Ie("relative overflow-hidden rounded-xl border border-white/5 bg-slate-950/80 px-5 py-5","shadow-[inset_0_0_40px_-25px_rgba(56,189,248,0.75)]"),children:[a.jsx("div",{className:Ie("pointer-events-none absolute inset-0 bg-gradient-to-br opacity-40",m)}),a.jsx($y,{remarkPlugins:[Uy],components:W5e,className:"relative z-10 space-y-3",children:h.body})]})})]},h.heading+f)}),u.sections.length===0&&a.jsx("p",{className:"text-sm text-slate-300",children:"No detailed sections were found for this release. Check the classic view for raw notes."})]},u.version)})]})]}):a.jsxs(He,{className:"border border-white/10 bg-slate-950/60 p-12 text-center text-slate-300",children:[a.jsx(ct,{className:"text-xl text-white",children:"No entries available"}),a.jsx(Ts,{className:"mt-2 text-sm text-slate-300",children:"Try clearing the search filter to view release notes."})]})})]})}),a.jsx(ir,{value:"markdown",className:"mt-6",children:a.jsxs(He,{className:"border border-white/10 bg-slate-950/70 shadow-[0_30px_80px_-60px_rgba(15,23,42,0.95)]",children:[a.jsxs(dt,{children:[a.jsxs(ct,{className:"flex items-center gap-2 text-white",children:[a.jsx(YT,{className:"h-5 w-5 text-sky-300"}),"Full Markdown"]}),a.jsx(Ts,{className:"text-xs text-slate-300",children:"Prefer the traditional view? Browse the original changelog with full Markdown formatting."})]}),a.jsx(lt,{children:a.jsx("article",{className:"prose prose-sm max-w-none text-slate-200 dark:prose-invert prose-headings:text-white prose-a:text-sky-300 prose-strong:text-sky-200",children:a.jsx($y,{remarkPlugins:[Uy],children:AD})})})]})})]})]})})}const H5e="/tones/mixkit-message-pop-alert-2354.mp3",K5e="/tones/mixkit-long-pop-2358.wav",V5e=1e4,PD=3;async function r_(e,t){const n=`${Oo}/functions/v1/livechat-orchestrator`,r=await fetch(n,{method:"POST",headers:{"Content-Type":"application/json",apikey:QN},body:JSON.stringify({action:e,...t})});if(!r.ok){const s=await r.text();throw new Error(`Orchestrator ${e} failed (${r.status}): ${s}`)}return r.json()}function G5e(){const{platform_id:e,platformId:t}=aQ(),n=p.useMemo(()=>e||t||"unknown",[e,t]),[r,s]=p.useState([]),[i,o]=p.useState(""),[l,c]=p.useState(!1),[u,d]=p.useState(null),[h,f]=p.useState(!1),[m,g]=p.useState(!0),[v,y]=p.useState(!1),[x,w]=p.useState(!1),[b,_]=p.useState(""),[k,j]=p.useState(null),S=p.useRef(null),T=p.useRef(null),O=p.useRef(0),A=p.useRef(null),N=p.useRef(null),L=p.useRef(null),M=p.useRef(null),B=p.useRef(null),$=p.useRef(null),z=p.useRef(null),R=p.useRef(null),C=p.useRef(!1),D=p.useRef(null),E=p.useRef(!1),F=p.useRef(null),I=p.useRef([]),P=p.useRef([]),U=p.useRef(!1),Z=p.useRef(!1),X=p.useRef(new Set),[K,ie]=p.useState(null),[H,he]=p.useState(()=>{if(typeof window>"u")return null;try{const ne=new URLSearchParams(window.location.search),_e=ne.get("account_id")||ne.get("username");if(_e){try{window.localStorage.setItem("account_id",_e)}catch{}return _e}}catch{}const pe=window.localStorage,Oe=`livechat_account_${window.location.pathname}`,W=["user_id","userId","account_id","accountId"];for(const ne of W){const _e=pe.getItem(ne);if(_e)return _e}const q=pe.getItem(Oe);if(q)return q;const Y=typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():`anon_${Date.now()}_${Math.random().toString(36).slice(2,10)}`;try{pe.setItem(Oe,Y)}catch{}return Y}),[me]=p.useState(()=>{if(!(typeof window>"u"))try{return new URLSearchParams(window.location.search).get("web")||void 0}catch{return}}),[ae,Ne]=p.useState(()=>{if(typeof window>"u")return`session_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;const pe=`livechat_session_${n}`,Oe=window.sessionStorage.getItem(pe);if(Oe)return Oe;const W=`session_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;return window.sessionStorage.setItem(pe,W),W}),de=p.useMemo(()=>p3(Oo,QN,{auth:{persistSession:!1,autoRefreshToken:!1},global:{headers:H?{"x-account-id":H}:void 0}}),[H]),Q=()=>{const pe=window.AudioContext||window.webkitAudioContext;return A.current=A.current??new pe,A.current},fe=(pe,Oe,W,q,Y=.05,ne="sine")=>{const _e=pe.createOscillator(),Le=pe.createGain();_e.type=ne,_e.frequency.value=W,Le.gain.value=1e-4,_e.connect(Le),Le.connect(pe.destination);const be=Oe+q/1e3;Le.gain.setValueAtTime(1e-4,Oe),Le.gain.exponentialRampToValueAtTime(Y,Oe+.02),Le.gain.setValueAtTime(Y,Math.max(Oe+.02,be-.05)),Le.gain.exponentialRampToValueAtTime(1e-4,be),_e.start(Oe),_e.stop(be)},Be=(pe,Oe=110,W=.06)=>{try{const q=Q(),Y=q.currentTime+.01;pe.forEach((ne,_e)=>{const Le=Y+_e*Oe/1e3,be=Oe*.9;Array.isArray(ne)?ne.forEach(ee=>fe(q,Le,ee,be,W,"sine")):fe(q,Le,ne,be,W,"triangle")})}catch{}},je=async pe=>{var Oe,W;try{const Y=(pe==="low"?(Oe=window.chatConfig)==null?void 0:Oe.sendToneUrl:(W=window.chatConfig)==null?void 0:W.replyToneUrl)||(pe==="low"?H5e:K5e),ne=pe==="low"?N.current??(N.current=new Audio(Y)):L.current??(L.current=new Audio(Y));return ne.src!==Y&&(ne.src=Y),ne.currentTime=0,ne.volume=pe==="low"?.35:.45,await ne.play(),!0}catch{return!1}},Ce=async()=>{await je("low")||Be([493.88,523.25,493.88,523.25],110,.045)},Ze=async()=>{await je("high")||Be([1046.5,1318.5,1568,[1046.5,1318.5,1568,2093]],120,.06)},rt=(pe="smooth")=>{var Oe;S.current?(S.current.scrollTo({top:S.current.scrollHeight,behavior:pe}),y(!1),w(!1)):(Oe=T.current)==null||Oe.scrollIntoView({behavior:pe})},Je=()=>{if(!S.current)return;const{scrollTop:pe,scrollHeight:Oe,clientHeight:W}=S.current;Oe-pe-W<100?(y(!1),w(!1)):w(!0)};p.useEffect(()=>{const pe=S.current;if(pe)return pe.addEventListener("scroll",Je),()=>pe.removeEventListener("scroll",Je)},[]),p.useEffect(()=>{r.length>0&&(r[r.length-1].role==="user"?rt():x?y(!0):rt())},[r,x]);const te=()=>++O.current,We=()=>new Date(Date.now()+1).toISOString(),Ue=(pe,Oe)=>{var q;const W=(((q=pe[pe.length-1])==null?void 0:q.order)??0)+1;return[...pe,{...Oe,order:W}]},ue=pe=>{var Le;const Oe=z.current;if(!Oe)return pe;const W=pe.findIndex(be=>be.id===Oe);if(W<=-1)return pe;const q=$.current;if(!q)return pe;const Y=pe.findIndex(be=>be.id===q);if(Y===-1||Y>W)return pe;const ne=pe.slice(),[_e]=ne.splice(W,1);return ne.push(_e),ne[ne.length-1].order=(((Le=ne[ne.length-2])==null?void 0:Le.order)??0)+1,ne},xe=(pe,Oe)=>{Oe&&s(W=>{var ne;const q=W.findIndex(_e=>_e.id===pe);if(q>=0){const _e=W.slice(),Le=_e[q];return _e[q]={...Le,body:(Le.body||"")+Oe,streaming:!0,order:Le.order||te()},_e}const Y={id:pe,role:"assistant",body:Oe,at:We(),order:((ne=W[W.length-1])==null?void 0:ne.order)??0,streaming:!0};return ue(Ue(W,Y))})},ce=(pe,Oe)=>{s(W=>{var ne;const q=W.findIndex(_e=>_e.id===pe);if(q>=0){const _e=W.slice(),Le=_e[q];return _e[q]={...Le,body:Oe!==void 0?Oe:Le.body,streaming:!1},_e}if(Oe===void 0)return W;const Y={id:pe,role:"assistant",body:Oe,at:We(),order:((ne=W[W.length-1])==null?void 0:ne.order)??0,streaming:!1};return ue(Ue(W,Y))}),ie(null),z.current=null},qe=p.useCallback(pe=>{!pe||pe.length===0||s(Oe=>{const W=new Map;Oe.forEach(ne=>W.set(ne.id,ne));let q=!1;for(const ne of pe){if(!(ne!=null&&ne.id))continue;let _e="user";ne.role==="system"?_e="system":ne.role==="agent"||ne.role==="assistant"?_e="assistant":_e="user";let Le=null;if(_e==="assistant"&&$.current){for(const[Ee,Xe]of W.entries())if(Xe.id===$.current){Le=Xe.order,W.delete(Ee),$.current=null,q=!0;break}}if(_e==="user"){const Ee=new Date(ne.created_at||Date.now()).getTime();let Xe=null,$e=null,jt=Number.POSITIVE_INFINITY,et;for(const[It,Rt]of W.entries()){if(!It.startsWith("temp-")||Rt.role!=="user"||!((Rt.body||"").trim()===(ne.body||"").trim()))continue;const Vn=new Date(Rt.at).getTime(),Ln=Number.isFinite(Vn)?Math.abs(Ee-Vn):0;Ln<jt&&(jt=Ln,Xe=It,$e=Rt.order??null,et=Rt.type)}Xe&&(Le=$e,!ne.type&&et&&(ne.type=et),W.delete(Xe),z.current=null,q=!0)}const be=W.get(ne.id),ee=ne.created_at||new Date().toISOString(),oe=ne.body||"";if(be)be.body!==oe&&(be.body=oe,q=!0),be.at!==ee&&(be.at=ee,q=!0),ne.type&&!be.type&&(be.type=ne.type,q=!0),_e==="assistant"&&be.streaming&&(be.streaming=!1,q=!0);else{const Ee={id:ne.id,role:_e,body:oe,at:ee,order:Le??te(),...ne.type?{type:ne.type}:{}};W.set(Ee.id,Ee),q=!0}}const Y=Array.from(W.values());if(Y.sort((ne,_e)=>ne.order-_e.order),!q&&Y.length===Oe.length){let ne=!0;for(let _e=0;_e<Y.length;_e+=1)if(Y[_e]!==Oe[_e]){ne=!1;break}if(ne)return Oe}return Y})},[]),Se=()=>{P.current.length>0&&(P.current.forEach(pe=>{try{clearTimeout(pe)}catch{}}),P.current=[])},nt=async(pe,Oe)=>{if(!pe)return;const{data:W}=await de.from("messages").select("id, role, body, created_at, type").eq("thread_id",pe).order("created_at",{ascending:!0});Array.isArray(W)&&Oe(W)},vt=(pe,Oe,W)=>{if(Se(),!pe){U.current=!0;return}P.current=W.map(q=>window.setTimeout(async()=>{try{await nt(pe,Oe)}catch(Y){console.error("[LiveChat] catch-up failed",Y)}},q))},xt=p.useCallback(()=>{I.current.length!==0&&(I.current.forEach(pe=>{try{clearTimeout(pe)}catch{}}),I.current=[])},[]),wt=p.useCallback(async()=>{if(!n)return null;try{const{data:pe}=await de.from("threads").select("id, contact_id, created_at, additional_data, assignee_user_id, status, account_id, resolved_at, resolved_by_user_id, contacts(name)").eq("channel_id",n).order("last_msg_at",{ascending:!1}).order("created_at",{ascending:!1}).limit(50);if(!pe)return null;const Oe=F.current,W=pe.find(Y=>{var oe;const ne=Y==null?void 0:Y.additional_data,_e=H?(Y==null?void 0:Y.account_id)===H||(ne==null?void 0:ne.account_id)===H:!1,Le=ae?(ne==null?void 0:ne.session_id)===ae:!1,be=((oe=Y==null?void 0:Y.contacts)==null?void 0:oe.name)||"",ee=b?be.trim().toLowerCase()===b.trim().toLowerCase():!1;if(H){if(!(_e||Le))return!1}else if(!(Le||ee))return!1;if(Oe){const Ee=Y!=null&&Y.created_at?new Date(Y.created_at).getTime():0,Xe=new Date(Oe.startedAt).getTime()-15e3;if(Ee&&Ee<Xe)return!1;const $e=Oe.alias.trim().toLowerCase()===be.trim().toLowerCase();if(H){if(!Le&&!_e)return!1}else if(!$e&&!Le&&!_e)return!1}return!0});return W!=null&&W.id?W:pe.find(Y=>{var ne;return!(Y!=null&&Y.account_id)&&!((ne=Y==null?void 0:Y.additional_data)!=null&&ne.account_id)})??null}catch(pe){return console.warn("[LiveChat] findThreadForCurrentSession failed",pe),null}},[n,ae,b,H,de]),ht=p.useCallback(async pe=>{const Oe=((pe==null?void 0:pe.status)||"").toString().toLowerCase();if(!(Oe==="closed"||Oe==="done"||Oe==="resolved")||!(pe!=null&&pe.id))return(pe==null?void 0:pe.id)||null;try{const{error:q}=await de.from("threads").update({status:"pending",assignee_user_id:null,resolved_at:null,resolved_by_user_id:null}).eq("id",pe.id);if(q)throw q;return pe.id}catch(q){return console.warn("[LiveChat] failed to reopen resolved thread",q),(pe==null?void 0:pe.id)||null}},[]),_t=p.useCallback((pe=[])=>{xt(),pe.length&&(I.current=pe.map(Oe=>window.setTimeout(async()=>{var q;if(!E.current||M.current)return;const W=await wt();if(W!=null&&W.id)try{const Y=await ht(W);Y&&await((q=D.current)==null?void 0:q.call(D,Y))}catch(Y){console.warn("[LiveChat] retry attach failed",Y)}},Oe)))},[xt,wt,ht]);return p.useEffect(()=>{if(typeof window>"u")return;const pe=`livechat_session_${n}`,Oe=window.sessionStorage.getItem(pe);if(Oe&&Oe!==ae){Ne(Oe);return}if(!Oe){const W=`session_${Date.now()}_${Math.random().toString(36).slice(2,8)}`;window.sessionStorage.setItem(pe,W),Ne(W)}},[n]),p.useEffect(()=>{const pe=!!H,Oe=typeof window<"u"?pe?window.localStorage:window.sessionStorage:null;if(!Oe)return;const W=pe?`livechat_username_${n}_acct_${H}`:`livechat_username_${n}_${ae}`;let q="";try{q=Oe.getItem(W)||""}catch{}if(!q){const Y=["Happy","Bright","Calm","Brave","Kind","Sunny","Lucky","Cheerful","Swift","Clever"],ne=["User","Visitor","Friend","Guest","Buddy","Pal","Explorer","Champion","Star","Hero"],_e=Y[Math.floor(Math.random()*Y.length)],Le=ne[Math.floor(Math.random()*ne.length)],be=Math.floor(100+Math.random()*900);q=`${_e} ${Le} ${be}`;try{Oe.setItem(W,q)}catch{}}_(q)},[n,ae,H]),p.useEffect(()=>{M.current=M.current},[]),p.useEffect(()=>()=>Se(),[]),p.useEffect(()=>()=>xt(),[xt]),p.useEffect(()=>()=>{K&&($.current=null)},[K]),p.useEffect(()=>{n&&n!=="unknown"&&(async()=>{try{const{data:Oe,error:W}=await de.from("channels").select("ai_profile_id").eq("id",n).maybeSingle();!W&&(Oe!=null&&Oe.ai_profile_id)&&j(Oe.ai_profile_id)}catch(Oe){console.error("Error fetching AI profile ID:",Oe)}})()},[n]),p.useEffect(()=>{let pe=null,Oe=null;const W=async Y=>{if(M.current===Y&&pe){E.current=!1,vt(Y,qe,[0,1200]);return}if(pe){try{de.removeChannel(pe)}catch{}pe=null}M.current=Y,E.current=!1,F.current=null,xt(),X.current=new Set,Z.current=!1,Se();try{const{data:ne}=await de.from("threads").select("status").eq("id",Y).maybeSingle();B.current=(ne==null?void 0:ne.status)||null;const{data:_e}=await de.from("messages").select("id, role, body, created_at, type").eq("thread_id",Y).order("created_at",{ascending:!0});Array.isArray(_e)&&qe(_e);const Le=be=>de.channel(`livechat-msgs-${be}`).on("postgres_changes",{event:"*",schema:"public",table:"messages",filter:`thread_id=eq.${be}`},ee=>{const oe=(ee==null?void 0:ee.new)||(ee==null?void 0:ee.old);if(oe){if((oe==null?void 0:oe.role)==="system"){qe([oe]);return}ee.eventType!=="DELETE"&&((oe==null?void 0:oe.role)==="user"||(oe==null?void 0:oe.role)==="agent"||(oe==null?void 0:oe.role)==="assistant")&&qe([oe])}}).subscribe(ee=>{if(ee==="SUBSCRIBED")Z.current=!0;else if(ee==="CHANNEL_ERROR"||ee==="TIMED_OUT"){if(vt(M.current,qe,[0,1500]),pe)try{de.removeChannel(pe)}catch{}pe=Le(be)}});pe=Le(Y),vt(Y,qe,[0,800,2e3,5e3,1e4])}finally{Z.current=!0,g(!1)}};return D.current=W,(async()=>{const Y=await wt();if(Y!=null&&Y.id){const ne=await ht(Y);ne&&await W(ne);return}g(!1),E.current=!1})(),Oe=de.channel(`livechat-threads-${n}`).on("postgres_changes",{event:"INSERT",schema:"public",table:"threads",filter:`channel_id=eq.${n}`},async Y=>{var be,ee,oe;const ne=(be=Y==null?void 0:Y.new)==null?void 0:be.id;if(!ne||ne===M.current)return;const _e=(oe=(ee=Y==null?void 0:Y.new)==null?void 0:ee.additional_data)==null?void 0:oe.session_id;if(!(_e&&_e===ae)){try{const Ee=await wt();if(Ee!=null&&Ee.id){const Xe=await ht(Ee);Xe&&await W(Xe)}}catch{}return}try{const Ee=await ht(Y==null?void 0:Y.new);await W(Ee||ne)}catch{}}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"threads",filter:`channel_id=eq.${n}`},Y=>{const ne=Y==null?void 0:Y.new;if(!(ne!=null&&ne.id)||ne.id!==M.current)return;const _e=ne.status||null;B.current=_e,_e==="pending"&&c(!1)}).subscribe(()=>g(!1)),()=>{try{pe&&de.removeChannel(pe)}catch{}try{Oe&&de.removeChannel(Oe)}catch{}D.current=null}},[n,ae,b,qe,wt,ht,H]),{messages:r,draft:i,setDraft:o,loading:l,stagedFile:u,setStagedFile:d,isUploadingFile:h,booting:m,handleSend:async()=>{var oe,Ee,Xe;const pe=i.trim();if(!pe&&!u)return;const Oe=new Date().toISOString();if(!M.current)try{const $e=await wt();if($e!=null&&$e.id){$e.contact_id&&(R.current=$e.contact_id);const jt=await ht($e);jt&&await((oe=D.current)==null?void 0:oe.call(D,jt))}}catch{}if(!M.current)try{const $e=await r_("ensure_thread",{account_id:H||"",channel_id:n,session_id:ae,username:b||""});$e.thread_id&&(C.current=$e.is_new,R.current=$e.contact_id,await((Ee=D.current)==null?void 0:Ee.call(D,$e.thread_id)),$e.ai_profile_id&&!k&&j($e.ai_profile_id),B.current=$e.thread_status??"open")}catch($e){console.error("[LiveChat] ensure_thread failed",$e),E.current=!0,F.current={alias:b,startedAt:new Date().toISOString()},_t([0,300,900,2e3])}if(M.current)try{const{checkAIMessageLimit:$e,autoAssignToSuperAgent:jt}=await fu(async()=>{const{checkAIMessageLimit:It,autoAssignToSuperAgent:Rt}=await import("./aiMessageLimit-CzT5SAWG.js");return{checkAIMessageLimit:It,autoAssignToSuperAgent:Rt}},[]),et=await $e(de,M.current);if(et.isExceeded&&et.superAgentId){if((await jt(de,M.current,et.superAgentId)).success){ze.error("Batas pesan AI telah tercapai. Percakapan dialihkan ke super agent.");return}}else if(et.isExceeded){ze.error("Batas pesan AI tercapai. Tidak ada agen tersedia.");return}}catch{}let W=null;if(u){f(!0);try{W=await sA(u.file)}catch($e){ze.error(`Upload failed: ${$e.message}`),f(!1);return}f(!1),d(null)}const q=!!W,Y=pe.length>0,ne=[],_e=[];if(q){const jt={id:crypto.randomUUID(),thread_id:M.current,role:"user",direction:"in",body:W.url,type:W.type,payload:{}};if(ne.push(jt),_e.push({...jt,at:Oe,order:te()}),Y){const It={id:crypto.randomUUID(),thread_id:M.current,role:"user",direction:"in",body:pe,type:"text",payload:{}};ne.push(It),_e.push({...It,at:new Date(Date.now()+1).toISOString(),order:te()})}}else{const jt={id:crypto.randomUUID(),thread_id:M.current,role:"user",direction:"in",body:pe,type:"text",payload:{}};ne.push(jt),_e.push({...jt,at:Oe,order:te()})}if(M.current&&ne.length>0)try{await de.from("messages").insert(ne)}catch($e){console.warn("[LiveChat] direct insert failed",$e)}if(s($e=>[...$e,..._e]),z.current=_e[0].id,Ce(),o(""),B.current==="pending")return;let be=null;if(M.current)try{be=await r_("get_ai_context",{thread_id:M.current,channel_id:n,contact_id:R.current||""})}catch($e){console.warn("[LiveChat] get_ai_context failed",$e)}C.current&&M.current&&((Xe=be==null?void 0:be.ai_profile)!=null&&Xe.welcome_message)&&(r_("insert_welcome_message",{thread_id:M.current,welcome_message:be.ai_profile.welcome_message}).catch($e=>console.warn("[LiveChat] insert_welcome_message failed",$e)),C.current=!1),c(!0);const ee=`streaming-${Date.now()}`;ie(ee),$.current=ee;try{const $e={message:pe||(W==null?void 0:W.url)||"",account_id:H||void 0,channel_id:n,session_id:ae,username:b||void 0,web:me,stream:!0,thread_id:M.current,contact_id:R.current||void 0,super_agent_id:(be==null?void 0:be.super_agent_id)||void 0,ai_profile:(be==null?void 0:be.ai_profile)||void 0,contact_info:(be==null?void 0:be.contact_info)||void 0,chat_history:(be==null?void 0:be.chat_history)||""};let jt=0,et=null;for(;jt<PD;){try{et=await Ns(Nn.ENDPOINTS.AI_AGENT.CHAT_SETTINGS,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify($e)},{forceLegacy:jt>0})}catch{}if(et&&et.ok)break;jt+=1,jt<PD&&await new Promise(Rt=>setTimeout(Rt,V5e))}if(!et||!et.ok)throw new Error("Webhook failed");vt(M.current,qe,[0,600,1800,4e3,9e3,15e3]);let It="";if(et.body){const Rt=et.body.getReader(),En=new TextDecoder;let Vn="";try{for(;;){const{done:Ln,value:Yr}=await Rt.read();if(Ln)break;Vn+=En.decode(Yr,{stream:!0});const Ca=Vn.split(`
`);Vn=Ca.pop()||"";for(const cr of Ca)if(cr.trim()!=="")try{if(cr.startsWith("data: ")){const Tn=cr.slice(6);if(Tn==="[DONE]"){ce(ee);break}const pn=JSON.parse(Tn),ua=pn.content||pn.delta||"";ua&&(It+=ua,xe(ee,ua))}else{const Tn=JSON.parse(cr),pn=Tn.content||Tn.delta||"";pn&&(It+=pn,xe(ee,pn))}}catch{xe(ee,cr),It+=cr}}}finally{Rt.releaseLock()}}else{const Rt=await et.json();It=Rt.output||Rt.content||"Sorry, I couldn't process your message.",ce(ee,It)}Ze()}catch($e){console.error("Send error:",$e),ce(ee,"Sorry, I'm having trouble right now."),Ze(),E.current=!1}finally{c(!1)}},viewportRef:S,endRef:T,showScrollButton:v,scrollToBottom:rt,userScrolledUp:x}}function Y5e(){return a.jsx("div",{className:"flex items-center justify-between px-4 py-3 rounded-t-2xl bg-gradient-to-r from-blue-600 to-blue-500 text-white",children:a.jsx("div",{className:"text-sm font-medium tracking-wide",children:"Live Chat"})})}function X5e({messages:e,loading:t,booting:n,viewportRef:r,endRef:s,showScrollButton:i,onScrollToBottom:o,fmt:l}){const c=[...e].sort((d,h)=>d.order-h.order),u={a:({href:d,children:h})=>{const f=d||"";return Hf(f)?a.jsx("img",{src:f,alt:"User uploaded content",className:"rounded-lg max-w-full h-auto my-2 border border-black/10 shadow-sm",loading:"lazy"}):a.jsx("a",{href:f,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 font-medium underline hover:text-blue-800",children:h})},img:({src:d,alt:h})=>a.jsx("img",{src:d,alt:h,className:"rounded-lg max-w-full h-auto my-2 border border-black/10 shadow-sm overflow-hidden",loading:"lazy"})};return a.jsxs("div",{className:"relative flex-1 min-h-0 flex flex-col",children:[a.jsx(Lb,{className:"flex-1 p-4",viewportRef:r,children:a.jsxs("div",{className:"space-y-3",children:[n&&a.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin text-blue-600"}),"Preparing chat"]}),c.map(d=>!d.body||d.streaming&&(!d.body||d.body.trim()==="")?null:d.role==="system"?a.jsx("div",{className:"flex justify-center my-4",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-sm text-slate-500 bg-slate-100/50 px-3 py-1 rounded-full border border-slate-100",children:d.body||"System event"}),a.jsx("div",{className:"flex items-center justify-center gap-2 mt-1 text-[10px] text-slate-400",children:a.jsx("span",{children:l(d.at)})})]})},d.id):(()=>{var w,b;const h=(d.body||"").trim(),f=d.type==="text"||!d.type,m=!f&&h;let g=d.type;if(m&&(!g||g==="text")){const _=((b=(w=h.split(".").pop())==null?void 0:w.toLowerCase())==null?void 0:b.split("?")[0])??"";["jpg","jpeg","png","gif","webp","svg","bmp","avif"].includes(_)?g="image":["mp4","webm","mov","avi","mkv"].includes(_)?g="video":["mp3","wav","ogg","aac","flac","m4a"].includes(_)?g="voice":g="file"}const v=f&&h.length>0,y=m?h:null,x=d.role==="user"?{...u,a:({href:_,children:k})=>{const j=_||"";return Hf(j)?a.jsx("img",{src:j,alt:"User content",className:"rounded-lg max-w-full h-auto my-2 shadow-sm",loading:"lazy"}):a.jsx("a",{href:j,target:"_blank",rel:"noopener noreferrer",className:"text-blue-300 font-medium underline hover:text-white",children:k})}}:u;return a.jsx("div",{className:`flex ${d.role==="user"?"justify-end":"justify-start"}`,children:a.jsx("div",{className:`flex ${d.role==="user"?"flex-row-reverse":"flex-row"} items-end gap-2 max-w-[85%]`,children:a.jsxs("div",{className:`flex flex-col ${d.role==="user"?"items-end":"items-start"} min-w-0 max-w-full space-y-1`,children:[y&&g&&a.jsx("div",{className:"max-w-full",children:a.jsx(lA,{fileLink:y,type:g})}),v&&a.jsxs("div",{className:`px-4 py-2 text-sm rounded-2xl shadow-sm transition-colors ${d.role==="user"?"bg-blue-600 text-white rounded-br-md":"bg-white text-slate-900 border border-blue-100 rounded-bl-md"}`,children:[a.jsx("div",{className:`prose prose-sm leading-normal max-w-none [overflow-wrap:anywhere] [&>*:first-child]:mt-0 [&>*:last-child]:mb-0 ${d.role==="user"?"text-white [&_*]:text-inherit [&_li]:marker:text-white [&_code]:text-blue-100 [&_code]:bg-blue-700":""}`,children:a.jsx($y,{remarkPlugins:[Uy,zz],components:x,children:d.body})}),(()=>{const _=V4(d.body);return _.length===0?null:a.jsx("div",{className:"space-y-2 mt-2",children:_.map(k=>!Hf(k)&&a.jsx(Wz,{url:k,isDark:d.role==="user"},k))})})(),a.jsx("div",{className:`mt-1 text-[10px] ${d.role==="user"?"text-blue-200 text-right":"text-slate-400"}`,children:l(d.at)})]}),!v&&a.jsx("div",{className:`text-[10px] ${d.role==="user"?"text-blue-200 text-right":"text-slate-400"}`,children:l(d.at)})]})})},d.id)})()),t&&a.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-500",children:[a.jsx(Ht,{className:"h-4 w-4 animate-spin text-blue-600"}),"Typing"]}),a.jsx("div",{ref:s})]})}),i&&a.jsx("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 z-10",children:a.jsxs(se,{variant:"secondary",size:"sm",className:"rounded-full shadow-lg bg-blue-100/90 hover:bg-blue-200 text-blue-700 h-8 px-3 text-xs gap-1 border border-blue-200 animate-in fade-in slide-in-from-bottom-2",onClick:o,children:[a.jsx(to,{className:"h-3 w-3"}),"New message"]})})]})}function J5e({draft:e,setDraft:t,stagedFile:n,setStagedFile:r,loading:s,isUploadingFile:i,onSend:o}){const l=c=>{c.key==="Enter"&&!c.shiftKey&&(c.preventDefault(),o())};return a.jsxs("div",{className:"p-3 border-t border-blue-100 rounded-b-2xl bg-blue-50/40",children:[n&&a.jsx("div",{className:"mb-2",children:a.jsx(oA,{stagedFile:n,onRemove:()=>r(null),isUploading:i})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(iA,{onFileStaged:r,disabled:s||i||!!n,className:"text-blue-600 hover:text-blue-700 hover:bg-blue-100"}),a.jsx(qr,{placeholder:n?"Add a caption (optional)...":"Type a message",value:e,onChange:c=>t(c.target.value),onKeyDown:l,className:"rounded-xl min-h-[40px] max-h-[120px] resize-none px-4 py-2 border-blue-200 focus-visible:ring-blue-500 placeholder:text-slate-400 bg-white text-slate-900"}),a.jsx(se,{onClick:o,disabled:!e.trim()&&!n||s||i,className:"rounded-full h-10 w-10 p-0 bg-blue-600 hover:bg-blue-700 text-white",children:a.jsx(bm,{className:"h-4 w-4"})})]})]})}function OD(){p.useEffect(()=>{const g=document.documentElement,v=document.body;g.style.overflow="hidden",g.style.height="100%",v.style.overflow="hidden",v.style.height="100%",v.style.margin="0";const y=document.getElementById("root");return y&&(y.style.height="100%",y.style.overflow="hidden"),()=>{g.style.overflow="",g.style.height="",v.style.overflow="",v.style.height="",v.style.margin="",y&&(y.style.height="",y.style.overflow="")}},[]);const{messages:e,draft:t,setDraft:n,loading:r,stagedFile:s,setStagedFile:i,isUploadingFile:o,booting:l,handleSend:c,viewportRef:u,endRef:d,showScrollButton:h,scrollToBottom:f}=G5e(),m=g=>new Date(g).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return a.jsx("div",{className:"h-screen overflow-hidden bg-gradient-to-br from-blue-50 to-white flex items-center justify-center",children:a.jsx("div",{className:"mx-auto w-full max-w-xl h-full flex flex-col",children:a.jsx(He,{className:"border border-blue-100 shadow-xl rounded-2xl bg-white/90 backdrop-blur flex-1 flex flex-col overflow-hidden",children:a.jsxs(lt,{className:"p-0 flex-1 flex flex-col overflow-hidden",children:[a.jsx(Y5e,{}),a.jsx(X5e,{messages:e,loading:r,booting:l,viewportRef:u,endRef:d,showScrollButton:h,onScrollToBottom:()=>f(),fmt:m}),a.jsx(J5e,{draft:t,setDraft:n,stagedFile:s,setStagedFile:i,loading:r,isUploadingFile:o,onSend:c})]})})})})}function Q5e(){const{signOut:e}=Ar(),t=Va(),[n,r]=p.useState(!1),s=async()=>{if(!n){r(!0);try{localStorage.clear(),e().catch(()=>{}),t("/",{replace:!0})}catch(i){console.error("AccountDeactivated: Error in handleBackToLogin:",i),t("/",{replace:!0})}finally{r(!1)}}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-50 to-indigo-100 dark:from-slate-950 dark:to-slate-900 p-4",children:a.jsxs(He,{className:"w-full max-w-md",children:[a.jsxs(dt,{className:"text-center",children:[a.jsxs("div",{className:"flex items-center justify-center gap-3 mb-4",children:[a.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:a.jsx(oo,{className:"h-8 w-8 text-red-600"})}),a.jsx(ct,{className:"text-2xl font-bold text-red-800",children:"Akun Dinonaktifkan"})]}),a.jsx(Ts,{className:"text-muted-foreground text-base",children:"Akun Anda telah dinonaktifkan dan tidak dapat mengakses sistem."})]}),a.jsxs(lt,{className:"space-y-6",children:[a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(vy,{className:"h-5 w-5 text-red-600 mt-0.5 flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-medium text-red-800 mb-2",children:"Hubungi Master Agent"}),a.jsx("p",{className:"text-sm text-red-700",children:"Untuk mengaktifkan kembali akun Anda, silakan hubungi Master Agent di organisasi Anda. Mereka dapat mengaktifkan akun Anda kembali."})]})]})}),a.jsx("div",{className:"text-sm text-muted-foreground",children:a.jsx("p",{children:"Jika Anda yakin ini adalah kesalahan, silakan hubungi administrator sistem untuk bantuan lebih lanjut."})}),a.jsx("div",{className:"flex flex-col gap-3",children:a.jsxs(se,{onClick:s,variant:"outline",className:"w-full",disabled:n,children:[a.jsx(Rp,{className:"h-4 w-4 mr-2"}),n?"Memproses...":"Kembali ke Halaman Login"]})})]})]})})}const Z5e=new CJ({defaultOptions:{queries:{staleTime:6e4,gcTime:5*6e4,refetchOnWindowFocus:!1,refetchOnReconnect:!1,retry:1},mutations:{retry:0}}}),eUe=()=>a.jsx(EJ,{client:Z5e,children:a.jsx(pte,{children:a.jsx(CQ,{children:a.jsx(lte,{children:a.jsx(fte,{children:a.jsxs(o1,{children:[a.jsx(BG,{}),a.jsx(xY,{}),a.jsxs(mte,{children:[a.jsx(qte,{}),a.jsxs(xQ,{children:[a.jsx(Za,{path:"/",element:a.jsx(qg,{children:a.jsx(_D,{})})}),a.jsx(Za,{path:"/chat",element:a.jsx(qg,{children:a.jsx(_D,{})})}),a.jsx(Za,{path:"/profile",element:a.jsx(qg,{children:a.jsx(d5e,{})})}),a.jsx(Za,{path:"/reset-password",element:a.jsx(ND,{})}),a.jsx(Za,{path:"/invite",element:a.jsx(ND,{})}),a.jsx(Za,{path:"/account-deactivated",element:a.jsx(Q5e,{})}),a.jsx(Za,{path:"/otp",element:a.jsx(qg,{children:a.jsx(C5e,{})})}),a.jsx(Za,{path:"/logout",element:a.jsx(A5e,{})}),a.jsx(Za,{path:"/changelog",element:a.jsx(q5e,{})}),a.jsx(Za,{path:"/livechat/:platform_id",element:a.jsx(OD,{})}),a.jsx(Za,{path:"/livechat/:platformId",element:a.jsx(OD,{})}),a.jsx(Za,{path:"*",element:a.jsx(E5e,{})})]})]})]})})})})})}),tUe="sb-yoekcpoppfudmqtvjcby-auth-token";async function nUe(){var e,t;try{const n=localStorage.getItem(tUe);if(!n)return;const r=JSON.parse(n),s=(r==null?void 0:r.access_token)||((e=r==null?void 0:r.currentSession)==null?void 0:e.access_token),i=(r==null?void 0:r.refresh_token)||((t=r==null?void 0:r.currentSession)==null?void 0:t.refresh_token);s&&i&&await le.auth.setSession({access_token:s,refresh_token:i})}catch{}}(async()=>{try{await nUe()}catch{}e4(document.getElementById("root")).render(a.jsx(eUe,{}))})();
